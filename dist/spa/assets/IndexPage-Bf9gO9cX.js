var o5=Object.defineProperty;var eS=n=>{throw TypeError(n)};var l5=(n,e,t)=>e in n?o5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Xe=(n,e,t)=>l5(n,typeof e!="symbol"?e+"":e,t),I1=(n,e,t)=>e.has(n)||eS("Cannot "+t);var y=(n,e,t)=>(I1(n,e,"read from private field"),t?t.call(n):e.get(n)),oe=(n,e,t)=>e.has(n)?eS("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Z=(n,e,t,r)=>(I1(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),le=(n,e,t)=>(I1(n,e,"access private method"),t);var vi=(n,e,t,r)=>({set _(i){Z(n,e,i,t)},get _(){return y(n,e,r)}});import{i as c5,r as Sn,o as bf,w as Mi,a as Pt,g as Ls,A as u5,f as hx,B as tU,b as yv,C as d5,D as YT,E as ff,e as sl,F as nU,G as rU,h as Vt,H as Vd,T as h5,I as f5,J as iU,c as Qu,K as fx,p as p5,j as Bd,k as m5,m as g5,t as QT,u as F0,_ as _5,v as Yb,L as Ka,M as b5,N as y5,y as Zo,O as v5,P as tS}from"./index-Bfp9-E4a.js";import{d as Im,e as w5,h as Rl,v as x5,u as T5,f as E5,i as D5,j as M5,R as A5,Q as nS}from"./QBtn-BsxBYC66.js";let O1,Qb=0;const Gr=new Array(256);for(let n=0;n<256;n++)Gr[n]=(n+256).toString(16).substring(1);const C5=(()=>{const n=typeof crypto<"u"?crypto:typeof window<"u"?window.crypto||window.msCrypto:void 0;if(n!==void 0){if(n.randomBytes!==void 0)return n.randomBytes;if(n.getRandomValues!==void 0)return e=>{const t=new Uint8Array(e);return n.getRandomValues(t),t}}return e=>{const t=[];for(let r=e;r>0;r--)t.push(Math.floor(Math.random()*256));return t}})(),rS=4096;function px(){(O1===void 0||Qb+16>rS)&&(Qb=0,O1=C5(rS));const n=Array.prototype.slice.call(O1,Qb,Qb+=16);return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Gr[n[0]]+Gr[n[1]]+Gr[n[2]]+Gr[n[3]]+"-"+Gr[n[4]]+Gr[n[5]]+"-"+Gr[n[6]]+Gr[n[7]]+"-"+Gr[n[8]]+Gr[n[9]]+"-"+Gr[n[10]]+Gr[n[11]]+Gr[n[12]]+Gr[n[13]]+Gr[n[14]]+Gr[n[15]]}function S5(n){return n??null}function iS(n,e){return n??(e===!0?`f_${px()}`:null)}function P5({getValue:n,required:e=!0}={}){if(c5.value===!0){const t=n!==void 0?Sn(S5(n())):Sn(null);return e===!0&&t.value===null&&bf(()=>{t.value=`f_${px()}`}),n!==void 0&&Mi(n,r=>{t.value=iS(r,e)}),t}return n!==void 0?Pt(()=>iS(n(),e)):Sn(`f_${px()}`)}const sS=/^on[A-Z]/;function k5(){const{attrs:n,vnode:e}=Ls(),t={listeners:Sn({}),attributes:Sn({})};function r(){const i={},s={};for(const a in n)a!=="class"&&a!=="style"&&sS.test(a)===!1&&(i[a]=n[a]);for(const a in e.props)sS.test(a)===!0&&(s[a]=e.props[a]);t.attributes.value=i,t.listeners.value=s}return u5(r),r(),t}const ZT={dark:{type:Boolean,default:null}};function JT(n,e){return Pt(()=>n.dark===null?e.dark.isActive:n.dark)}function F5({validate:n,resetValidation:e,requiresQForm:t}){const r=hx(tU,!1);if(r!==!1){const{props:i,proxy:s}=Ls();Object.assign(s,{validate:n,resetValidation:e}),Mi(()=>i.disable,a=>{a===!0?(typeof e=="function"&&e(),r.unbindComponent(s)):r.bindComponent(s)}),bf(()=>{i.disable!==!0&&r.bindComponent(s)}),yv(()=>{i.disable!==!0&&r.unbindComponent(s)})}else t===!0&&console.error("Parent QForm not found on useFormChild()!")}const aS=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,oS=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,lS=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,Zb=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,Jb=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,U1={date:n=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(n),time:n=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(n),fulltime:n=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(n),timeOrFulltime:n=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(n),email:n=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n),hexColor:n=>aS.test(n),hexaColor:n=>oS.test(n),hexOrHexaColor:n=>lS.test(n),rgbColor:n=>Zb.test(n),rgbaColor:n=>Jb.test(n),rgbOrRgbaColor:n=>Zb.test(n)||Jb.test(n),hexOrRgbColor:n=>aS.test(n)||Zb.test(n),hexaOrRgbaColor:n=>oS.test(n)||Jb.test(n),anyColor:n=>lS.test(n)||Zb.test(n)||Jb.test(n)},I5=[!0,!1,"ondemand"],O5={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],default:!1,validator:n=>I5.includes(n)}};function U5(n,e){const{props:t,proxy:r}=Ls(),i=Sn(!1),s=Sn(null),a=Sn(!1);F5({validate:g,resetValidation:p});let o=0,l;const c=Pt(()=>t.rules!==void 0&&t.rules!==null&&t.rules.length!==0),u=Pt(()=>t.disable!==!0&&c.value===!0&&e.value===!1),d=Pt(()=>t.error===!0||i.value===!0),h=Pt(()=>typeof t.errorMessage=="string"&&t.errorMessage.length!==0?t.errorMessage:s.value);Mi(()=>t.modelValue,()=>{a.value=!0,u.value===!0&&t.lazyRules===!1&&b()});function f(){t.lazyRules!=="ondemand"&&u.value===!0&&a.value===!0&&b()}Mi(()=>t.reactiveRules,_=>{_===!0?l===void 0&&(l=Mi(()=>t.rules,f,{immediate:!0,deep:!0})):l!==void 0&&(l(),l=void 0)},{immediate:!0}),Mi(()=>t.lazyRules,f),Mi(n,_=>{_===!0?a.value=!0:u.value===!0&&t.lazyRules!=="ondemand"&&b()});function p(){o++,e.value=!1,a.value=!1,i.value=!1,s.value=null,b.cancel()}function g(_=t.modelValue){if(t.disable===!0||c.value===!1)return!0;const m=++o,v=e.value!==!0?()=>{a.value=!0}:()=>{},x=(T,E)=>{T===!0&&v(),i.value=T,s.value=E||null,e.value=!1},w=[];for(let T=0;T<t.rules.length;T++){const E=t.rules[T];let A;if(typeof E=="function"?A=E(_,U1):typeof E=="string"&&U1[E]!==void 0&&(A=U1[E](_)),A===!1||typeof A=="string")return x(!0,A),!1;A!==!0&&A!==void 0&&w.push(A)}return w.length===0?(x(!1),!0):(e.value=!0,Promise.all(w).then(T=>{if(T===void 0||Array.isArray(T)===!1||T.length===0)return m===o&&x(!1),!0;const E=T.find(A=>A===!1||typeof A=="string");return m===o&&x(E!==void 0,E),E===void 0},T=>(m===o&&(console.error(T),x(!0)),!1)))}const b=d5(g,0);return yv(()=>{l?.(),b.cancel()}),Object.assign(r,{resetValidation:p,validate:g}),YT(r,"hasError",()=>d.value),{isDirtyModel:a,hasRules:c,hasError:d,errorMessage:h,validate:g,resetValidation:p}}let mx=[],L5=[];function eE(n){L5.length===0?n():mx.push(n)}function R5(n){mx=mx.filter(e=>e!==n)}function Rm(n){return n!=null&&(""+n).length!==0}const sU={...ZT,...O5,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String},B5={...sU,maxlength:[Number,String]},aU=["update:modelValue","clear","focus","blur"];function oU({requiredForAttr:n=!0,tagProp:e,changeEvent:t=!1}={}){const{props:r,proxy:i}=Ls(),s=JT(r,i.$q),a=P5({required:n,getValue:()=>r.for});return{requiredForAttr:n,changeEvent:t,tag:e===!0?Pt(()=>r.tag):{value:"label"},isDark:s,editable:Pt(()=>r.disable!==!0&&r.readonly!==!0),innerLoading:Sn(!1),focused:Sn(!1),hasPopupOpen:!1,splitAttrs:k5(),targetUid:a,rootRef:Sn(null),targetRef:Sn(null),controlRef:Sn(null)}}function lU(n){const{props:e,emit:t,slots:r,attrs:i,proxy:s}=Ls(),{$q:a}=s;let o=null;n.hasValue===void 0&&(n.hasValue=Pt(()=>Rm(e.modelValue))),n.emitValue===void 0&&(n.emitValue=X=>{t("update:modelValue",X)}),n.controlEvents===void 0&&(n.controlEvents={onFocusin:M,onFocusout:F}),Object.assign(n,{clearValue:G,onControlFocusin:M,onControlFocusout:F,focus:E}),n.computedCounter===void 0&&(n.computedCounter=Pt(()=>{if(e.counter!==!1){const X=typeof e.modelValue=="string"||typeof e.modelValue=="number"?(""+e.modelValue).length:Array.isArray(e.modelValue)===!0?e.modelValue.length:0,V=e.maxlength!==void 0?e.maxlength:e.maxValues;return X+(V!==void 0?" / "+V:"")}}));const{isDirtyModel:l,hasRules:c,hasError:u,errorMessage:d,resetValidation:h}=U5(n.focused,n.innerLoading),f=n.floatingLabel!==void 0?Pt(()=>e.stackLabel===!0||n.focused.value===!0||n.floatingLabel.value===!0):Pt(()=>e.stackLabel===!0||n.focused.value===!0||n.hasValue.value===!0),p=Pt(()=>e.bottomSlots===!0||e.hint!==void 0||c.value===!0||e.counter===!0||e.error!==null),g=Pt(()=>e.filled===!0?"filled":e.outlined===!0?"outlined":e.borderless===!0?"borderless":e.standout?"standout":"standard"),b=Pt(()=>`q-field row no-wrap items-start q-field--${g.value}`+(n.fieldClass!==void 0?` ${n.fieldClass.value}`:"")+(e.rounded===!0?" q-field--rounded":"")+(e.square===!0?" q-field--square":"")+(f.value===!0?" q-field--float":"")+(m.value===!0?" q-field--labeled":"")+(e.dense===!0?" q-field--dense":"")+(e.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(n.isDark.value===!0?" q-field--dark":"")+(n.getControl===void 0?" q-field--auto-height":"")+(n.focused.value===!0?" q-field--focused":"")+(u.value===!0?" q-field--error":"")+(u.value===!0||n.focused.value===!0?" q-field--highlighted":"")+(e.hideBottomSpace!==!0&&p.value===!0?" q-field--with-bottom":"")+(e.disable===!0?" q-field--disabled":e.readonly===!0?" q-field--readonly":"")),_=Pt(()=>"q-field__control relative-position row no-wrap"+(e.bgColor!==void 0?` bg-${e.bgColor}`:"")+(u.value===!0?" text-negative":typeof e.standout=="string"&&e.standout.length!==0&&n.focused.value===!0?` ${e.standout}`:e.color!==void 0?` text-${e.color}`:"")),m=Pt(()=>e.labelSlot===!0||e.label!==void 0),v=Pt(()=>"q-field__label no-pointer-events absolute ellipsis"+(e.labelColor!==void 0&&u.value!==!0?` text-${e.labelColor}`:"")),x=Pt(()=>({id:n.targetUid.value,editable:n.editable.value,focused:n.focused.value,floatingLabel:f.value,modelValue:e.modelValue,emitValue:n.emitValue})),w=Pt(()=>{const X={};return n.targetUid.value&&(X.for=n.targetUid.value),e.disable===!0&&(X["aria-disabled"]="true"),X});function T(){const X=document.activeElement;let V=n.targetRef?.value;V&&(X===null||X.id!==n.targetUid.value)&&(V.hasAttribute("tabindex")===!0||(V=V.querySelector("[tabindex]")),V!==X&&V?.focus({preventScroll:!0}))}function E(){eE(T)}function A(){R5(T);const X=document.activeElement;X!==null&&n.rootRef.value.contains(X)&&X.blur()}function M(X){o!==null&&(clearTimeout(o),o=null),n.editable.value===!0&&n.focused.value===!1&&(n.focused.value=!0,t("focus",X))}function F(X,V){o!==null&&clearTimeout(o),o=setTimeout(()=>{o=null,!(document.hasFocus()===!0&&(n.hasPopupOpen===!0||n.controlRef===void 0||n.controlRef.value===null||n.controlRef.value.contains(document.activeElement)!==!1))&&(n.focused.value===!0&&(n.focused.value=!1,t("blur",X)),V?.())})}function G(X){ff(X),a.platform.is.mobile!==!0?(n.targetRef?.value||n.rootRef.value).focus():n.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),e.type==="file"&&(n.inputRef.value.value=null),t("update:modelValue",null),n.changeEvent===!0&&t("change",null),t("clear",e.modelValue),sl(()=>{const V=l.value;h(),l.value=V})}function S(X){[13,32].includes(X.keyCode)&&G(X)}function I(){const X=[];return r.prepend!==void 0&&X.push(Vt("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:Vd},r.prepend())),X.push(Vt("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},C())),u.value===!0&&e.noErrorIcon===!1&&X.push(B("error",[Vt(Im,{name:a.iconSet.field.error,color:"negative"})])),e.loading===!0||n.innerLoading.value===!0?X.push(B("inner-loading-append",r.loading!==void 0?r.loading():[Vt(w5,{color:e.color})])):e.clearable===!0&&n.hasValue.value===!0&&n.editable.value===!0&&X.push(B("inner-clearable-append",[Vt(Im,{class:"q-field__focusable-action",name:e.clearIcon||a.iconSet.field.clear,tabindex:0,role:"button","aria-hidden":"false","aria-label":a.lang.label.clear,onKeyup:S,onClick:G})])),r.append!==void 0&&X.push(Vt("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:Vd},r.append())),n.getInnerAppend!==void 0&&X.push(B("inner-append",n.getInnerAppend())),n.getControlChild!==void 0&&X.push(n.getControlChild()),X}function C(){const X=[];return e.prefix!==void 0&&e.prefix!==null&&X.push(Vt("div",{class:"q-field__prefix no-pointer-events row items-center"},e.prefix)),n.getShadowControl!==void 0&&n.hasShadow.value===!0&&X.push(n.getShadowControl()),n.getControl!==void 0?X.push(n.getControl()):r.rawControl!==void 0?X.push(r.rawControl()):r.control!==void 0&&X.push(Vt("div",{ref:n.targetRef,class:"q-field__native row",tabindex:-1,...n.splitAttrs.attributes.value,"data-autofocus":e.autofocus===!0||void 0},r.control(x.value))),m.value===!0&&X.push(Vt("div",{class:v.value},Rl(r.label,e.label))),e.suffix!==void 0&&e.suffix!==null&&X.push(Vt("div",{class:"q-field__suffix no-pointer-events row items-center"},e.suffix)),X.concat(Rl(r.default))}function H(){let X,V;u.value===!0?d.value!==null?(X=[Vt("div",{role:"alert"},d.value)],V=`q--slot-error-${d.value}`):(X=Rl(r.error),V="q--slot-error"):(e.hideHint!==!0||n.focused.value===!0)&&(e.hint!==void 0?(X=[Vt("div",e.hint)],V=`q--slot-hint-${e.hint}`):(X=Rl(r.hint),V="q--slot-hint"));const Q=e.counter===!0||r.counter!==void 0;if(e.hideBottomSpace===!0&&Q===!1&&X===void 0)return;const R=Vt("div",{key:V,class:"q-field__messages col"},X);return Vt("div",{class:"q-field__bottom row items-start q-field__bottom--"+(e.hideBottomSpace!==!0?"animated":"stale"),onClick:Vd},[e.hideBottomSpace===!0?R:Vt(h5,{name:"q-transition--field-message"},()=>R),Q===!0?Vt("div",{class:"q-field__counter"},r.counter!==void 0?r.counter():n.computedCounter.value):null])}function B(X,V){return V===null?null:Vt("div",{key:X,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},V)}let $=!1;return nU(()=>{$=!0}),rU(()=>{$===!0&&e.autofocus===!0&&s.focus()}),e.autofocus===!0&&bf(()=>{s.focus()}),yv(()=>{o!==null&&clearTimeout(o)}),Object.assign(s,{focus:E,blur:A}),function(){const V=n.getControl===void 0&&r.control===void 0?{...n.splitAttrs.attributes.value,"data-autofocus":e.autofocus===!0||void 0,...w.value}:w.value;return Vt(n.tag.value,{ref:n.rootRef,class:[b.value,i.class],style:i.style,...V},[r.before!==void 0?Vt("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:Vd},r.before()):null,Vt("div",{class:"q-field__inner relative-position col self-stretch"},[Vt("div",{ref:n.controlRef,class:_.value,tabindex:-1,...n.controlEvents},I()),p.value===!0?H():null]),r.after!==void 0?Vt("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:Vd},r.after()):null])}}const cS={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},I0={"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:n=>n.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:n=>n.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:n=>n.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:n=>n.toLocaleLowerCase()}},cU=Object.keys(I0);cU.forEach(n=>{I0[n].regex=new RegExp(I0[n].pattern)});const $5=new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+cU.join("")+"])|(.)","g"),uS=/[.*+?^${}()|[\]\\]/g,mr="",N5={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean};function z5(n,e,t,r){let i,s,a,o,l,c;const u=Sn(null),d=Sn(f());function h(){return n.autogrow===!0||["textarea","text","search","url","tel","password"].includes(n.type)}Mi(()=>n.type+n.autogrow,g),Mi(()=>n.mask,M=>{if(M!==void 0)b(d.value,!0);else{const F=E(d.value);g(),n.modelValue!==F&&e("update:modelValue",F)}}),Mi(()=>n.fillMask+n.reverseFillMask,()=>{u.value===!0&&b(d.value,!0)}),Mi(()=>n.unmaskedValue,()=>{u.value===!0&&b(d.value)});function f(){if(g(),u.value===!0){const M=w(E(n.modelValue));return n.fillMask!==!1?A(M):M}return n.modelValue}function p(M){if(M<i.length)return i.slice(-M);let F="",G=i;const S=G.indexOf(mr);if(S!==-1){for(let I=M-G.length;I>0;I--)F+=mr;G=G.slice(0,S)+F+G.slice(S)}return G}function g(){if(u.value=n.mask!==void 0&&n.mask.length!==0&&h(),u.value===!1){o=void 0,i="",s="";return}const M=cS[n.mask]===void 0?n.mask:cS[n.mask],F=typeof n.fillMask=="string"&&n.fillMask.length!==0?n.fillMask.slice(0,1):"_",G=F.replace(uS,"\\$&"),S=[],I=[],C=[];let H=n.reverseFillMask===!0,B="",$="";M.replace($5,(R,O,L,ne,de)=>{if(ne!==void 0){const we=I0[ne];C.push(we),$=we.negate,H===!0&&(I.push("(?:"+$+"+)?("+we.pattern+"+)?(?:"+$+"+)?("+we.pattern+"+)?"),H=!1),I.push("(?:"+$+"+)?("+we.pattern+")?")}else if(L!==void 0)B="\\"+(L==="\\"?"":L),C.push(L),S.push("([^"+B+"]+)?"+B+"?");else{const we=O!==void 0?O:de;B=we==="\\"?"\\\\\\\\":we.replace(uS,"\\\\$&"),C.push(we),S.push("([^"+B+"]+)?"+B+"?")}});const X=new RegExp("^"+S.join("")+"("+(B===""?".":"[^"+B+"]")+"+)?"+(B===""?"":"["+B+"]*")+"$"),V=I.length-1,Q=I.map((R,O)=>O===0&&n.reverseFillMask===!0?new RegExp("^"+G+"*"+R):O===V?new RegExp("^"+R+"("+($===""?".":$)+"+)?"+(n.reverseFillMask===!0?"$":G+"*")):new RegExp("^"+R));a=C,o=R=>{const O=X.exec(n.reverseFillMask===!0?R:R.slice(0,C.length+1));O!==null&&(R=O.slice(1).join(""));const L=[],ne=Q.length;for(let de=0,we=R;de<ne;de++){const be=Q[de].exec(we);if(be===null)break;we=we.slice(be.shift().length),L.push(...be)}return L.length!==0?L.join(""):R},i=C.map(R=>typeof R=="string"?R:mr).join(""),s=i.split(mr).join(F)}function b(M,F,G){const S=r.value,I=S.selectionEnd,C=S.value.length-I,H=E(M);F===!0&&g();const B=w(H),$=n.fillMask!==!1?A(B):B,X=d.value!==$;S.value!==$&&(S.value=$),X===!0&&(d.value=$),document.activeElement===S&&sl(()=>{if($===s){const Q=n.reverseFillMask===!0?s.length:0;S.setSelectionRange(Q,Q,"forward");return}if(G==="insertFromPaste"&&n.reverseFillMask!==!0){const Q=S.selectionEnd;let R=I-1;for(let O=l;O<=R&&O<Q;O++)i[O]!==mr&&R++;m.right(S,R);return}if(["deleteContentBackward","deleteContentForward"].indexOf(G)!==-1){const Q=n.reverseFillMask===!0?I===0?$.length>B.length?1:0:Math.max(0,$.length-($===s?0:Math.min(B.length,C)+1))+1:I;S.setSelectionRange(Q,Q,"forward");return}if(n.reverseFillMask===!0)if(X===!0){const Q=Math.max(0,$.length-($===s?0:Math.min(B.length,C+1)));Q===1&&I===1?S.setSelectionRange(Q,Q,"forward"):m.rightReverse(S,Q)}else{const Q=$.length-C;S.setSelectionRange(Q,Q,"backward")}else if(X===!0){const Q=Math.max(0,i.indexOf(mr),Math.min(B.length,I)-1);m.right(S,Q)}else{const Q=I-1;m.right(S,Q)}});const V=n.unmaskedValue===!0?E($):$;String(n.modelValue)!==V&&(n.modelValue!==null||V!=="")&&t(V,!0)}function _(M,F,G){const S=w(E(M.value));F=Math.max(0,i.indexOf(mr),Math.min(S.length,F)),l=F,M.setSelectionRange(F,G,"forward")}const m={left(M,F){const G=i.slice(F-1).indexOf(mr)===-1;let S=Math.max(0,F-1);for(;S>=0;S--)if(i[S]===mr){F=S,G===!0&&F++;break}if(S<0&&i[F]!==void 0&&i[F]!==mr)return m.right(M,0);F>=0&&M.setSelectionRange(F,F,"backward")},right(M,F){const G=M.value.length;let S=Math.min(G,F+1);for(;S<=G;S++)if(i[S]===mr){F=S;break}else i[S-1]===mr&&(F=S);if(S>G&&i[F-1]!==void 0&&i[F-1]!==mr)return m.left(M,G);M.setSelectionRange(F,F,"forward")},leftReverse(M,F){const G=p(M.value.length);let S=Math.max(0,F-1);for(;S>=0;S--)if(G[S-1]===mr){F=S;break}else if(G[S]===mr&&(F=S,S===0))break;if(S<0&&G[F]!==void 0&&G[F]!==mr)return m.rightReverse(M,0);F>=0&&M.setSelectionRange(F,F,"backward")},rightReverse(M,F){const G=M.value.length,S=p(G),I=S.slice(0,F+1).indexOf(mr)===-1;let C=Math.min(G,F+1);for(;C<=G;C++)if(S[C-1]===mr){F=C,F>0&&I===!0&&F--;break}if(C>G&&S[F-1]!==void 0&&S[F-1]!==mr)return m.leftReverse(M,G);M.setSelectionRange(F,F,"forward")}};function v(M){e("click",M),c=void 0}function x(M){if(e("keydown",M),f5(M)===!0||M.altKey===!0)return;const F=r.value,G=F.selectionStart,S=F.selectionEnd;if(M.shiftKey||(c=void 0),M.keyCode===37||M.keyCode===39){M.shiftKey&&c===void 0&&(c=F.selectionDirection==="forward"?G:S);const I=m[(M.keyCode===39?"right":"left")+(n.reverseFillMask===!0?"Reverse":"")];if(M.preventDefault(),I(F,c===G?S:G),M.shiftKey){const C=F.selectionStart;F.setSelectionRange(Math.min(c,C),Math.max(c,C),"forward")}}else M.keyCode===8&&n.reverseFillMask!==!0&&G===S?(m.left(F,G),F.setSelectionRange(F.selectionStart,S,"backward")):M.keyCode===46&&n.reverseFillMask===!0&&G===S&&(m.rightReverse(F,S),F.setSelectionRange(G,F.selectionEnd,"forward"))}function w(M){if(M==null||M==="")return"";if(n.reverseFillMask===!0)return T(M);const F=a;let G=0,S="";for(let I=0;I<F.length;I++){const C=M[G],H=F[I];if(typeof H=="string")S+=H,C===H&&G++;else if(C!==void 0&&H.regex.test(C))S+=H.transform!==void 0?H.transform(C):C,G++;else return S}return S}function T(M){const F=a,G=i.indexOf(mr);let S=M.length-1,I="";for(let C=F.length-1;C>=0&&S!==-1;C--){const H=F[C];let B=M[S];if(typeof H=="string")I=H+I,B===H&&S--;else if(B!==void 0&&H.regex.test(B))do I=(H.transform!==void 0?H.transform(B):B)+I,S--,B=M[S];while(G===C&&B!==void 0&&H.regex.test(B));else return I}return I}function E(M){return typeof M!="string"||o===void 0?typeof M=="number"?o(""+M):M:o(M)}function A(M){return s.length-M.length<=0?M:n.reverseFillMask===!0&&M.length!==0?s.slice(0,-M.length)+M:M+s.slice(M.length)}return{innerValue:d,hasMask:u,moveCursorForPaste:_,updateMaskValue:b,onMaskedKeydown:x,onMaskedClick:v}}const uU={name:String};function dU(n){return Pt(()=>n.name||n.for)}function hU(n,e){function t(){const r=n.modelValue;try{const i="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(r)===r&&("length"in r?Array.from(r):[r]).forEach(s=>{i.items.add(s)}),{files:i.files}}catch{return{files:void 0}}}return e===!0?Pt(()=>{if(n.type==="file")return t()}):Pt(t)}const W5=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,j5=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,V5=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,G5=/[a-z0-9_ -]$/i;function q5(n){return function(t){if(t.type==="compositionend"||t.type==="change"){if(t.target.qComposing!==!0)return;t.target.qComposing=!1,n(t)}else t.type==="compositionupdate"&&t.target.qComposing!==!0&&typeof t.data=="string"&&(iU.is.firefox===!0?G5.test(t.data)===!1:W5.test(t.data)===!0||j5.test(t.data)===!0||V5.test(t.data)===!0)===!0&&(t.target.qComposing=!0)}}const H5=Qu({name:"QInput",inheritAttrs:!1,props:{...B5,...N5,...uU,modelValue:[String,Number,FileList],shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...aU,"paste","change","keydown","click","animationend"],setup(n,{emit:e,attrs:t}){const{proxy:r}=Ls(),{$q:i}=r,s={};let a=NaN,o,l,c=null,u;const d=Sn(null),h=dU(n),{innerValue:f,hasMask:p,moveCursorForPaste:g,updateMaskValue:b,onMaskedKeydown:_,onMaskedClick:m}=z5(n,e,B,d),v=hU(n,!0),x=Pt(()=>Rm(f.value)),w=q5(C),T=oU({changeEvent:!0}),E=Pt(()=>n.type==="textarea"||n.autogrow===!0),A=Pt(()=>E.value===!0||["text","search","url","tel","password"].includes(n.type)),M=Pt(()=>{const O={...T.splitAttrs.listeners.value,onInput:C,onPaste:I,onChange:X,onBlur:V,onFocus:fx};return O.onCompositionstart=O.onCompositionupdate=O.onCompositionend=w,p.value===!0&&(O.onKeydown=_,O.onClick=m),n.autogrow===!0&&(O.onAnimationend=H),O}),F=Pt(()=>{const O={tabindex:0,"data-autofocus":n.autofocus===!0||void 0,rows:n.type==="textarea"?6:void 0,"aria-label":n.label,name:h.value,...T.splitAttrs.attributes.value,id:T.targetUid.value,maxlength:n.maxlength,disabled:n.disable===!0,readonly:n.readonly===!0};return E.value===!1&&(O.type=n.type),n.autogrow===!0&&(O.rows=1),O});Mi(()=>n.type,()=>{d.value&&(d.value.value=n.modelValue)}),Mi(()=>n.modelValue,O=>{if(p.value===!0){if(l===!0&&(l=!1,String(O)===a))return;b(O)}else f.value!==O&&(f.value=O,n.type==="number"&&s.hasOwnProperty("value")===!0&&(o===!0?o=!1:delete s.value));n.autogrow===!0&&sl($)}),Mi(()=>n.autogrow,O=>{O===!0?sl($):d.value!==null&&t.rows>0&&(d.value.style.height="auto")}),Mi(()=>n.dense,()=>{n.autogrow===!0&&sl($)});function G(){eE(()=>{const O=document.activeElement;d.value!==null&&d.value!==O&&(O===null||O.id!==T.targetUid.value)&&d.value.focus({preventScroll:!0})})}function S(){d.value?.select()}function I(O){if(p.value===!0&&n.reverseFillMask!==!0){const L=O.target;g(L,L.selectionStart,L.selectionEnd)}e("paste",O)}function C(O){if(!O||!O.target)return;if(n.type==="file"){e("update:modelValue",O.target.files);return}const L=O.target.value;if(O.target.qComposing===!0){s.value=L;return}if(p.value===!0)b(L,!1,O.inputType);else if(B(L),A.value===!0&&O.target===document.activeElement){const{selectionStart:ne,selectionEnd:de}=O.target;ne!==void 0&&de!==void 0&&sl(()=>{O.target===document.activeElement&&L.indexOf(O.target.value)===0&&O.target.setSelectionRange(ne,de)})}n.autogrow===!0&&$()}function H(O){e("animationend",O),$()}function B(O,L){u=()=>{c=null,n.type!=="number"&&s.hasOwnProperty("value")===!0&&delete s.value,n.modelValue!==O&&a!==O&&(a=O,L===!0&&(l=!0),e("update:modelValue",O),sl(()=>{a===O&&(a=NaN)})),u=void 0},n.type==="number"&&(o=!0,s.value=O),n.debounce!==void 0?(c!==null&&clearTimeout(c),s.value=O,c=setTimeout(u,n.debounce)):u()}function $(){requestAnimationFrame(()=>{const O=d.value;if(O!==null){const L=O.parentNode.style,{scrollTop:ne}=O,{overflowY:de,maxHeight:we}=i.platform.is.firefox===!0?{}:window.getComputedStyle(O),be=de!==void 0&&de!=="scroll";be===!0&&(O.style.overflowY="hidden"),L.marginBottom=O.scrollHeight-1+"px",O.style.height="1px",O.style.height=O.scrollHeight+"px",be===!0&&(O.style.overflowY=parseInt(we,10)<O.scrollHeight?"auto":"hidden"),L.marginBottom="",O.scrollTop=ne}})}function X(O){w(O),c!==null&&(clearTimeout(c),c=null),u?.(),e("change",O.target.value)}function V(O){O!==void 0&&fx(O),c!==null&&(clearTimeout(c),c=null),u?.(),o=!1,l=!1,delete s.value,n.type!=="file"&&setTimeout(()=>{d.value!==null&&(d.value.value=f.value!==void 0?f.value:"")})}function Q(){return s.hasOwnProperty("value")===!0?s.value:f.value!==void 0?f.value:""}yv(()=>{V()}),bf(()=>{n.autogrow===!0&&$()}),Object.assign(T,{innerValue:f,fieldClass:Pt(()=>`q-${E.value===!0?"textarea":"input"}`+(n.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:Pt(()=>n.type!=="file"&&typeof n.shadowText=="string"&&n.shadowText.length!==0),inputRef:d,emitValue:B,hasValue:x,floatingLabel:Pt(()=>x.value===!0&&(n.type!=="number"||isNaN(f.value)===!1)||Rm(n.displayValue)),getControl:()=>Vt(E.value===!0?"textarea":"input",{ref:d,class:["q-field__native q-placeholder",n.inputClass],style:n.inputStyle,...F.value,...M.value,...n.type!=="file"?{value:Q()}:v.value}),getShadowControl:()=>Vt("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(E.value===!0?"":" text-no-wrap")},[Vt("span",{class:"invisible"},Q()),Vt("span",n.shadowText)])});const R=lU(T);return Object.assign(r,{focus:G,select:S,getNativeElement:()=>d.value}),YT(r,"nativeEl",()=>d.value),R}}),K5=Qu({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(n,{slots:e,emit:t}){const r=Ls(),i=Sn(null);let s=0;const a=[];function o(f){const p=typeof f=="boolean"?f:n.noErrorFocus!==!0,g=++s,b=(v,x)=>{t(`validation${v===!0?"Success":"Error"}`,x)},_=v=>{const x=v.validate();return typeof x.then=="function"?x.then(w=>({valid:w,comp:v}),w=>({valid:!1,comp:v,err:w})):Promise.resolve({valid:x,comp:v})};return(n.greedy===!0?Promise.all(a.map(_)).then(v=>v.filter(x=>x.valid!==!0)):a.reduce((v,x)=>v.then(()=>_(x).then(w=>{if(w.valid===!1)return Promise.reject(w)})),Promise.resolve()).catch(v=>[v])).then(v=>{if(v===void 0||v.length===0)return g===s&&b(!0),!0;if(g===s){const{comp:x,err:w}=v[0];if(w!==void 0&&console.error(w),b(!1,x),p===!0){const T=v.find(({comp:E})=>typeof E.focus=="function"&&x5(E.$)===!1);T!==void 0&&T.comp.focus()}}return!1})}function l(){s++,a.forEach(f=>{typeof f.resetValidation=="function"&&f.resetValidation()})}function c(f){f!==void 0&&ff(f);const p=s+1;o().then(g=>{p===s&&g===!0&&(n.onSubmit!==void 0?t("submit",f):f?.target!==void 0&&typeof f.target.submit=="function"&&f.target.submit())})}function u(f){f!==void 0&&ff(f),t("reset"),sl(()=>{l(),n.autofocus===!0&&n.noResetFocus!==!0&&d()})}function d(){eE(()=>{if(i.value===null)return;(i.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||i.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||i.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(i.value.querySelectorAll("[tabindex]"),p=>p.tabIndex!==-1))?.focus({preventScroll:!0})})}p5(tU,{bindComponent(f){a.push(f)},unbindComponent(f){const p=a.indexOf(f);p!==-1&&a.splice(p,1)}});let h=!1;return nU(()=>{h=!0}),rU(()=>{h===!0&&n.autofocus===!0&&d()}),bf(()=>{n.autofocus===!0&&d()}),Object.assign(r.proxy,{validate:o,resetValidation:l,submit:c,reset:u,focus:d,getValidationComponents:()=>a}),()=>Vt("form",{class:"q-form",ref:i,onSubmit:c,onReset:u},Rl(e.default))}}),X5=Qu({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(n,{slots:e}){const t=Pt(()=>`q-card__section q-card__section--${n.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>Vt(n.tag,{class:t.value},Rl(e.default))}}),Y5=Qu({name:"QCard",props:{...ZT,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(n,{slots:e}){const{proxy:{$q:t}}=Ls(),r=JT(n,t),i=Pt(()=>"q-card"+(r.value===!0?" q-card--dark q-dark":"")+(n.bordered===!0?" q-card--bordered":"")+(n.square===!0?" q-card--square no-border-radius":"")+(n.flat===!0?" q-card--flat no-shadow":""));return()=>Vt(n.tag,{class:i.value},Rl(e.default))}}),Q5=Qu({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(n,{slots:e}){const{proxy:{$q:t}}=Ls(),r=hx(m5,Bd);if(r===Bd)return console.error("QPage needs to be a deep child of QLayout"),Bd;if(hx(g5,Bd)===Bd)return console.error("QPage needs to be child of QPageContainer"),Bd;const s=Pt(()=>{const o=(r.header.space===!0?r.header.size:0)+(r.footer.space===!0?r.footer.size:0);if(typeof n.styleFn=="function"){const l=r.isContainer.value===!0?r.containerHeight.value:t.screen.height;return n.styleFn(o,l)}return{minHeight:r.isContainer.value===!0?r.containerHeight.value-o+"px":t.screen.height===0?o!==0?`calc(100vh - ${o}px)`:"100vh":t.screen.height-o+"px"}}),a=Pt(()=>`q-page${n.padding===!0?" q-layout-padding":""}`);return()=>Vt("main",{class:a.value,style:s.value},Rl(e.default))}}),Z5={xs:8,sm:10,md:14,lg:20,xl:24},J5=Qu({name:"QChip",props:{...ZT,...T5,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(n,{slots:e,emit:t}){const{proxy:{$q:r}}=Ls(),i=JT(n,r),s=E5(n,Z5),a=Pt(()=>n.selected===!0||n.icon!==void 0),o=Pt(()=>n.selected===!0?n.iconSelected||r.iconSet.chip.selected:n.icon),l=Pt(()=>n.iconRemove||r.iconSet.chip.remove),c=Pt(()=>n.disable===!1&&(n.clickable===!0||n.selected!==null)),u=Pt(()=>{const b=n.outline===!0&&n.color||n.textColor;return"q-chip row inline no-wrap items-center"+(n.outline===!1&&n.color!==void 0?` bg-${n.color}`:"")+(b?` text-${b} q-chip--colored`:"")+(n.disable===!0?" disabled":"")+(n.dense===!0?" q-chip--dense":"")+(n.outline===!0?" q-chip--outline":"")+(n.selected===!0?" q-chip--selected":"")+(c.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(n.square===!0?" q-chip--square":"")+(i.value===!0?" q-chip--dark q-dark":"")}),d=Pt(()=>{const b=n.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:n.tabindex||0},_={...b,role:"button","aria-hidden":"false","aria-label":n.removeAriaLabel||r.lang.label.remove};return{chip:b,remove:_}});function h(b){b.keyCode===13&&f(b)}function f(b){n.disable||(t("update:selected",!n.selected),t("click",b))}function p(b){(b.keyCode===void 0||b.keyCode===13)&&(ff(b),n.disable===!1&&(t("update:modelValue",!1),t("remove")))}function g(){const b=[];c.value===!0&&b.push(Vt("div",{class:"q-focus-helper"})),a.value===!0&&b.push(Vt(Im,{class:"q-chip__icon q-chip__icon--left",name:o.value}));const _=n.label!==void 0?[Vt("div",{class:"ellipsis"},[n.label])]:void 0;return b.push(Vt("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},M5(e.default,_))),n.iconRight&&b.push(Vt(Im,{class:"q-chip__icon q-chip__icon--right",name:n.iconRight})),n.removable===!0&&b.push(Vt(Im,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:l.value,...d.value.remove,onClick:p,onKeyup:p})),b}return()=>{if(n.modelValue===!1)return;const b={class:u.value,style:s.value};return c.value===!0&&Object.assign(b,d.value.chip,{onClick:f,onKeyup:h}),D5("div",b,g(),"ripple",n.ripple!==!1&&n.disable!==!0,()=>[[A5,n.ripple]])}}});function $d(n,e,t,r){const i=[];return n.forEach(s=>{r(s)===!0?i.push(s):e.push({failedPropValidation:t,file:s})}),i}function ey(n){n?.dataTransfer&&(n.dataTransfer.dropEffect="copy"),ff(n)}const ez={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},tz=["rejected"];function nz({editable:n,dnd:e,getFileInput:t,addFilesToQueue:r}){const{props:i,emit:s,proxy:a}=Ls(),o=Sn(null),l=Pt(()=>i.accept!==void 0?i.accept.split(",").map(m=>(m=m.trim(),m==="*"?"*/":(m.endsWith("/*")&&(m=m.slice(0,m.length-1)),m.toUpperCase()))):null),c=Pt(()=>parseInt(i.maxFiles,10)),u=Pt(()=>parseInt(i.maxTotalSize,10));function d(m){if(n.value)if(m!==Object(m)&&(m={target:null}),m.target?.matches('input[type="file"]')===!0)m.clientX===0&&m.clientY===0&&fx(m);else{const v=t();v!==m.target&&v?.click(m)}}function h(m){n.value&&m&&r(null,m)}function f(m,v,x,w){let T=Array.from(v||m.target.files);const E=[],A=()=>{E.length!==0&&s("rejected",E)};if(i.accept!==void 0&&l.value.indexOf("*/")===-1&&(T=$d(T,E,"accept",M=>l.value.some(F=>M.type.toUpperCase().startsWith(F)||M.name.toUpperCase().endsWith(F))),T.length===0))return A();if(i.maxFileSize!==void 0){const M=parseInt(i.maxFileSize,10);if(T=$d(T,E,"max-file-size",F=>F.size<=M),T.length===0)return A()}if(i.multiple!==!0&&T.length!==0&&(T=[T[0]]),T.forEach(M=>{M.__key=M.webkitRelativePath+M.lastModified+M.name+M.size}),w===!0){const M=x.map(F=>F.__key);T=$d(T,E,"duplicate",F=>M.includes(F.__key)===!1)}if(T.length===0)return A();if(i.maxTotalSize!==void 0){let M=w===!0?x.reduce((F,G)=>F+G.size,0):0;if(T=$d(T,E,"max-total-size",F=>(M+=F.size,M<=u.value)),T.length===0)return A()}if(typeof i.filter=="function"){const M=i.filter(T);T=$d(T,E,"filter",F=>M.includes(F))}if(i.maxFiles!==void 0){let M=w===!0?x.length:0;if(T=$d(T,E,"max-files",()=>(M++,M<=c.value)),T.length===0)return A()}if(A(),T.length!==0)return T}function p(m){ey(m),e.value!==!0&&(e.value=!0)}function g(m){ff(m),(m.relatedTarget!==null||iU.is.safari!==!0?m.relatedTarget!==o.value:document.elementsFromPoint(m.clientX,m.clientY).includes(o.value)===!1)===!0&&(e.value=!1)}function b(m){ey(m);const v=m.dataTransfer.files;v.length!==0&&r(null,v),e.value=!1}function _(m){if(e.value===!0)return Vt("div",{ref:o,class:`q-${m}__dnd absolute-full`,onDragenter:ey,onDragover:ey,onDragleave:g,onDrop:b})}return Object.assign(a,{pickFiles:d,addFiles:h}),{pickFiles:d,addFiles:h,onDragover:p,onDragleave:g,processFiles:f,getDndNode:_,maxFilesNumber:c,maxTotalSizeNumber:u}}const dS=["B","KB","MB","GB","TB","PB"];function rz(n,e=1){let t=0;for(;parseInt(n,10)>=1024&&t<dS.length-1;)n/=1024,++t;return`${n.toFixed(e)}${dS[t]}`}const fU=Qu({name:"QFile",inheritAttrs:!1,props:{...sU,...uU,...ez,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...aU,...tz],setup(n,{slots:e,emit:t,attrs:r}){const{proxy:i}=Ls(),s=oU(),a=Sn(null),o=Sn(!1),l=dU(n),{pickFiles:c,onDragover:u,onDragleave:d,processFiles:h,getDndNode:f}=nz({editable:s.editable,dnd:o,getFileInput:S,addFilesToQueue:I}),p=hU(n),g=Pt(()=>Object(n.modelValue)===n.modelValue?"length"in n.modelValue?Array.from(n.modelValue):[n.modelValue]:[]),b=Pt(()=>Rm(g.value)),_=Pt(()=>g.value.map($=>$.name).join(", ")),m=Pt(()=>rz(g.value.reduce(($,X)=>$+X.size,0))),v=Pt(()=>({totalSize:m.value,filesNumber:g.value.length,maxFiles:n.maxFiles})),x=Pt(()=>({tabindex:-1,type:"file",title:"",accept:n.accept,capture:n.capture,name:l.value,...r,id:s.targetUid.value,disabled:s.editable.value!==!0})),w=Pt(()=>"q-file q-field--auto-height"+(o.value===!0?" q-file--dnd":"")),T=Pt(()=>n.multiple===!0&&n.append===!0);function E($){const X=g.value.slice();X.splice($,1),M(X)}function A($){const X=g.value.indexOf($);X!==-1&&E(X)}function M($){t("update:modelValue",n.multiple===!0?$:$[0])}function F($){$.keyCode===13&&Vd($)}function G($){($.keyCode===13||$.keyCode===32)&&c($)}function S(){return a.value}function I($,X){const V=h($,X,g.value,T.value),Q=S();Q!=null&&(Q.value=""),V!==void 0&&((n.multiple===!0?n.modelValue&&V.every(R=>g.value.includes(R)):n.modelValue===V[0])||M(T.value===!0?g.value.concat(V):V))}function C(){return[Vt("input",{class:[n.inputClass,"q-file__filler"],style:n.inputStyle})]}function H(){if(e.file!==void 0)return g.value.length===0?C():g.value.map((X,V)=>e.file({index:V,file:X,ref:this}));if(e.selected!==void 0)return g.value.length===0?C():e.selected({files:g.value,ref:this});if(n.useChips===!0)return g.value.length===0?C():g.value.map((X,V)=>Vt(J5,{key:"file-"+V,removable:s.editable.value,dense:!0,textColor:n.color,tabindex:n.tabindex,onRemove:()=>{E(V)}},()=>Vt("span",{class:"ellipsis",textContent:X.name})));const $=n.displayValue!==void 0?n.displayValue:_.value;return $.length!==0?[Vt("div",{class:n.inputClass,style:n.inputStyle,textContent:$})]:C()}function B(){const $={ref:a,...x.value,...p.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:I};return n.multiple===!0&&($.multiple=!0),Vt("input",$)}return Object.assign(s,{fieldClass:w,emitValue:M,hasValue:b,inputRef:a,innerValue:g,floatingLabel:Pt(()=>b.value===!0||Rm(n.displayValue)),computedCounter:Pt(()=>{if(n.counterLabel!==void 0)return n.counterLabel(v.value);const $=n.maxFiles;return`${g.value.length}${$!==void 0?" / "+$:""} (${m.value})`}),getControlChild:()=>f("file"),getControl:()=>{const $={ref:s.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:n.tabindex};return s.editable.value===!0&&Object.assign($,{onDragover:u,onDragleave:d,onKeydown:F,onKeyup:G}),Vt("div",$,[B()].concat(H()))}}),Object.assign(i,{removeAtIndex:E,removeFile:A,getNativeElement:()=>a.value}),YT(i,"nativeEl",()=>a.value),lU(s)}});var Bl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pU(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function iz(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var bs={},tE="1.13.7",hS=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},vv=Array.prototype,nE=Object.prototype,fS=typeof Symbol<"u"?Symbol.prototype:null,sz=vv.push,v_=vv.slice,Bm=nE.toString,az=nE.hasOwnProperty,mU=typeof ArrayBuffer<"u",oz=typeof DataView<"u",lz=Array.isArray,pS=Object.keys,mS=Object.create,gS=mU&&ArrayBuffer.isView,cz=isNaN,uz=isFinite,gU=!{toString:null}.propertyIsEnumerable("toString"),_S=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],dz=Math.pow(2,53)-1;function Pi(n,e){return e=e==null?n.length-1:+e,function(){for(var t=Math.max(arguments.length-e,0),r=Array(t),i=0;i<t;i++)r[i]=arguments[i+e];switch(e){case 0:return n.call(this,r);case 1:return n.call(this,arguments[0],r);case 2:return n.call(this,arguments[0],arguments[1],r)}var s=Array(e+1);for(i=0;i<e;i++)s[i]=arguments[i];return s[e]=r,n.apply(this,s)}}function ql(n){var e=typeof n;return e==="function"||e==="object"&&!!n}function _U(n){return n===null}function rE(n){return n===void 0}function iE(n){return n===!0||n===!1||Bm.call(n)==="[object Boolean]"}function bU(n){return!!(n&&n.nodeType===1)}function pi(n){var e="[object "+n+"]";return function(t){return Bm.call(t)===e}}const wv=pi("String"),sE=pi("Number"),yU=pi("Date"),vU=pi("RegExp"),wU=pi("Error"),aE=pi("Symbol"),oE=pi("ArrayBuffer");var xU=pi("Function"),hz=hS.document&&hS.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof hz!="function"&&(xU=function(n){return typeof n=="function"||!1});const fi=xU,TU=pi("Object");var EU=oz&&(!/\[native code\]/.test(String(DataView))||TU(new DataView(new ArrayBuffer(8)))),lE=typeof Map<"u"&&TU(new Map),fz=pi("DataView");function pz(n){return n!=null&&fi(n.getInt8)&&oE(n.buffer)}const $m=EU?pz:fz,Hl=lz||pi("Array");function Kl(n,e){return n!=null&&az.call(n,e)}var gx=pi("Arguments");(function(){gx(arguments)||(gx=function(n){return Kl(n,"callee")})})();const xv=gx;function DU(n){return!aE(n)&&uz(n)&&!isNaN(parseFloat(n))}function cE(n){return sE(n)&&cz(n)}function uE(n){return function(){return n}}function MU(n){return function(e){var t=n(e);return typeof t=="number"&&t>=0&&t<=dz}}function AU(n){return function(e){return e?.[n]}}const O0=AU("byteLength"),mz=MU(O0);var gz=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function _z(n){return gS?gS(n)&&!$m(n):mz(n)&&gz.test(Bm.call(n))}const dE=mU?_z:uE(!1),ji=AU("length");function bz(n){for(var e={},t=n.length,r=0;r<t;++r)e[n[r]]=!0;return{contains:function(i){return e[i]===!0},push:function(i){return e[i]=!0,n.push(i)}}}function CU(n,e){e=bz(e);var t=_S.length,r=n.constructor,i=fi(r)&&r.prototype||nE,s="constructor";for(Kl(n,s)&&!e.contains(s)&&e.push(s);t--;)s=_S[t],s in n&&n[s]!==i[s]&&!e.contains(s)&&e.push(s)}function Pr(n){if(!ql(n))return[];if(pS)return pS(n);var e=[];for(var t in n)Kl(n,t)&&e.push(t);return gU&&CU(n,e),e}function SU(n){if(n==null)return!0;var e=ji(n);return typeof e=="number"&&(Hl(n)||wv(n)||xv(n))?e===0:ji(Pr(n))===0}function hE(n,e){var t=Pr(e),r=t.length;if(n==null)return!r;for(var i=Object(n),s=0;s<r;s++){var a=t[s];if(e[a]!==i[a]||!(a in i))return!1}return!0}function _n(n){if(n instanceof _n)return n;if(!(this instanceof _n))return new _n(n);this._wrapped=n}_n.VERSION=tE;_n.prototype.value=function(){return this._wrapped};_n.prototype.valueOf=_n.prototype.toJSON=_n.prototype.value;_n.prototype.toString=function(){return String(this._wrapped)};function bS(n){return new Uint8Array(n.buffer||n,n.byteOffset||0,O0(n))}var yS="[object DataView]";function _x(n,e,t,r){if(n===e)return n!==0||1/n===1/e;if(n==null||e==null)return!1;if(n!==n)return e!==e;var i=typeof n;return i!=="function"&&i!=="object"&&typeof e!="object"?!1:PU(n,e,t,r)}function PU(n,e,t,r){n instanceof _n&&(n=n._wrapped),e instanceof _n&&(e=e._wrapped);var i=Bm.call(n);if(i!==Bm.call(e))return!1;if(EU&&i=="[object Object]"&&$m(n)){if(!$m(e))return!1;i=yS}switch(i){case"[object RegExp]":case"[object String]":return""+n==""+e;case"[object Number]":return+n!=+n?+e!=+e:+n==0?1/+n===1/e:+n==+e;case"[object Date]":case"[object Boolean]":return+n==+e;case"[object Symbol]":return fS.valueOf.call(n)===fS.valueOf.call(e);case"[object ArrayBuffer]":case yS:return PU(bS(n),bS(e),t,r)}var s=i==="[object Array]";if(!s&&dE(n)){var a=O0(n);if(a!==O0(e))return!1;if(n.buffer===e.buffer&&n.byteOffset===e.byteOffset)return!0;s=!0}if(!s){if(typeof n!="object"||typeof e!="object")return!1;var o=n.constructor,l=e.constructor;if(o!==l&&!(fi(o)&&o instanceof o&&fi(l)&&l instanceof l)&&"constructor"in n&&"constructor"in e)return!1}t=t||[],r=r||[];for(var c=t.length;c--;)if(t[c]===n)return r[c]===e;if(t.push(n),r.push(e),s){if(c=n.length,c!==e.length)return!1;for(;c--;)if(!_x(n[c],e[c],t,r))return!1}else{var u=Pr(n),d;if(c=u.length,Pr(e).length!==c)return!1;for(;c--;)if(d=u[c],!(Kl(e,d)&&_x(n[d],e[d],t,r)))return!1}return t.pop(),r.pop(),!0}function kU(n,e){return _x(n,e)}function yf(n){if(!ql(n))return[];var e=[];for(var t in n)e.push(t);return gU&&CU(n,e),e}function fE(n){var e=ji(n);return function(t){if(t==null)return!1;var r=yf(t);if(ji(r))return!1;for(var i=0;i<e;i++)if(!fi(t[n[i]]))return!1;return n!==OU||!fi(t[pE])}}var pE="forEach",FU="has",mE=["clear","delete"],IU=["get",FU,"set"],yz=mE.concat(pE,IU),OU=mE.concat(IU),vz=["add"].concat(mE,pE,FU);const UU=lE?fE(yz):pi("Map"),LU=lE?fE(OU):pi("WeakMap"),RU=lE?fE(vz):pi("Set"),BU=pi("WeakSet");function Zu(n){for(var e=Pr(n),t=e.length,r=Array(t),i=0;i<t;i++)r[i]=n[e[i]];return r}function $U(n){for(var e=Pr(n),t=e.length,r=Array(t),i=0;i<t;i++)r[i]=[e[i],n[e[i]]];return r}function gE(n){for(var e={},t=Pr(n),r=0,i=t.length;r<i;r++)e[n[t[r]]]=t[r];return e}function Nm(n){var e=[];for(var t in n)fi(n[t])&&e.push(t);return e.sort()}function _E(n,e){return function(t){var r=arguments.length;if(e&&(t=Object(t)),r<2||t==null)return t;for(var i=1;i<r;i++)for(var s=arguments[i],a=n(s),o=a.length,l=0;l<o;l++){var c=a[l];(!e||t[c]===void 0)&&(t[c]=s[c])}return t}}const bE=_E(yf),pf=_E(Pr),yE=_E(yf,!0);function wz(){return function(){}}function NU(n){if(!ql(n))return{};if(mS)return mS(n);var e=wz();e.prototype=n;var t=new e;return e.prototype=null,t}function zU(n,e){var t=NU(n);return e&&pf(t,e),t}function WU(n){return ql(n)?Hl(n)?n.slice():bE({},n):n}function jU(n,e){return e(n),n}function vE(n){return Hl(n)?n:[n]}_n.toPath=vE;function w_(n){return _n.toPath(n)}function wE(n,e){for(var t=e.length,r=0;r<t;r++){if(n==null)return;n=n[e[r]]}return t?n:void 0}function xE(n,e,t){var r=wE(n,w_(e));return rE(r)?t:r}function VU(n,e){e=w_(e);for(var t=e.length,r=0;r<t;r++){var i=e[r];if(!Kl(n,i))return!1;n=n[i]}return!!t}function Tv(n){return n}function ju(n){return n=pf({},n),function(e){return hE(e,n)}}function Ev(n){return n=w_(n),function(e){return wE(e,n)}}function x_(n,e,t){if(e===void 0)return n;switch(t??3){case 1:return function(r){return n.call(e,r)};case 3:return function(r,i,s){return n.call(e,r,i,s)};case 4:return function(r,i,s,a){return n.call(e,r,i,s,a)}}return function(){return n.apply(e,arguments)}}function GU(n,e,t){return n==null?Tv:fi(n)?x_(n,e,t):ql(n)&&!Hl(n)?ju(n):Ev(n)}function Dv(n,e){return GU(n,e,1/0)}_n.iteratee=Dv;function Vi(n,e,t){return _n.iteratee!==Dv?_n.iteratee(n,e):GU(n,e,t)}function qU(n,e,t){e=Vi(e,t);for(var r=Pr(n),i=r.length,s={},a=0;a<i;a++){var o=r[a];s[o]=e(n[o],o,n)}return s}function TE(){}function HU(n){return n==null?TE:function(e){return xE(n,e)}}function KU(n,e,t){var r=Array(Math.max(0,n));e=x_(e,t,1);for(var i=0;i<n;i++)r[i]=e(i);return r}function U0(n,e){return e==null&&(e=n,n=0),n+Math.floor(Math.random()*(e-n+1))}const mf=Date.now||function(){return new Date().getTime()};function XU(n){var e=function(s){return n[s]},t="(?:"+Pr(n).join("|")+")",r=RegExp(t),i=RegExp(t,"g");return function(s){return s=s==null?"":""+s,r.test(s)?s.replace(i,e):s}}const YU={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},QU=XU(YU),xz=gE(YU),ZU=XU(xz),JU=_n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L1=/(.)^/,Tz={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Ez=/\\|'|\r|\n|\u2028|\u2029/g;function Dz(n){return"\\"+Tz[n]}var Mz=/^\s*(\w|\$)+\s*$/;function eL(n,e,t){!e&&t&&(e=t),e=yE({},e,_n.templateSettings);var r=RegExp([(e.escape||L1).source,(e.interpolate||L1).source,(e.evaluate||L1).source].join("|")+"|$","g"),i=0,s="__p+='";n.replace(r,function(c,u,d,h,f){return s+=n.slice(i,f).replace(Ez,Dz),i=f+c.length,u?s+=`'+
((__t=(`+u+`))==null?'':_.escape(__t))+
'`:d?s+=`'+
((__t=(`+d+`))==null?'':__t)+
'`:h&&(s+=`';
`+h+`
__p+='`),c}),s+=`';
`;var a=e.variable;if(a){if(!Mz.test(a))throw new Error("variable is not a bare identifier: "+a)}else s=`with(obj||{}){
`+s+`}
`,a="obj";s=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+s+`return __p;
`;var o;try{o=new Function(a,"_",s)}catch(c){throw c.source=s,c}var l=function(c){return o.call(this,c,_n)};return l.source="function("+a+`){
`+s+"}",l}function tL(n,e,t){e=w_(e);var r=e.length;if(!r)return fi(t)?t.call(n):t;for(var i=0;i<r;i++){var s=n?.[e[i]];s===void 0&&(s=t,i=r),n=fi(s)?s.call(n):s}return n}var Az=0;function nL(n){var e=++Az+"";return n?n+e:e}function rL(n){var e=_n(n);return e._chain=!0,e}function iL(n,e,t,r,i){if(!(r instanceof e))return n.apply(t,i);var s=NU(n.prototype),a=n.apply(s,i);return ql(a)?a:s}var Ju=Pi(function(n,e){var t=Ju.placeholder,r=function(){for(var i=0,s=e.length,a=Array(s),o=0;o<s;o++)a[o]=e[o]===t?arguments[i++]:e[o];for(;i<arguments.length;)a.push(arguments[i++]);return iL(n,r,this,this,a)};return r});Ju.placeholder=_n;const EE=Pi(function(n,e,t){if(!fi(n))throw new TypeError("Bind must be called on a function");var r=Pi(function(i){return iL(n,r,e,this,t.concat(i))});return r}),ps=MU(ji);function ed(n,e,t,r){if(r=r||[],!e&&e!==0)e=1/0;else if(e<=0)return r.concat(n);for(var i=r.length,s=0,a=ji(n);s<a;s++){var o=n[s];if(ps(o)&&(Hl(o)||xv(o)))if(e>1)ed(o,e-1,t,r),i=r.length;else for(var l=0,c=o.length;l<c;)r[i++]=o[l++];else t||(r[i++]=o)}return r}const sL=Pi(function(n,e){e=ed(e,!1,!1);var t=e.length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var r=e[t];n[r]=EE(n[r],n)}return n});function aL(n,e){var t=function(r){var i=t.cache,s=""+(e?e.apply(this,arguments):r);return Kl(i,s)||(i[s]=n.apply(this,arguments)),i[s]};return t.cache={},t}const DE=Pi(function(n,e,t){return setTimeout(function(){return n.apply(null,t)},e)}),oL=Ju(DE,_n,1);function lL(n,e,t){var r,i,s,a,o=0;t||(t={});var l=function(){o=t.leading===!1?0:mf(),r=null,a=n.apply(i,s),r||(i=s=null)},c=function(){var u=mf();!o&&t.leading===!1&&(o=u);var d=e-(u-o);return i=this,s=arguments,d<=0||d>e?(r&&(clearTimeout(r),r=null),o=u,a=n.apply(i,s),r||(i=s=null)):!r&&t.trailing!==!1&&(r=setTimeout(l,d)),a};return c.cancel=function(){clearTimeout(r),o=0,r=i=s=null},c}function cL(n,e,t){var r,i,s,a,o,l=function(){var u=mf()-i;e>u?r=setTimeout(l,e-u):(r=null,t||(a=n.apply(o,s)),r||(s=o=null))},c=Pi(function(u){return o=this,s=u,i=mf(),r||(r=setTimeout(l,e),t&&(a=n.apply(o,s))),a});return c.cancel=function(){clearTimeout(r),r=s=o=null},c}function uL(n,e){return Ju(e,n)}function Mv(n){return function(){return!n.apply(this,arguments)}}function dL(){var n=arguments,e=n.length-1;return function(){for(var t=e,r=n[e].apply(this,arguments);t--;)r=n[t].call(this,r);return r}}function hL(n,e){return function(){if(--n<1)return e.apply(this,arguments)}}function ME(n,e){var t;return function(){return--n>0&&(t=e.apply(this,arguments)),n<=1&&(e=null),t}}const fL=Ju(ME,2);function AE(n,e,t){e=Vi(e,t);for(var r=Pr(n),i,s=0,a=r.length;s<a;s++)if(i=r[s],e(n[i],i,n))return i}function pL(n){return function(e,t,r){t=Vi(t,r);for(var i=ji(e),s=n>0?0:i-1;s>=0&&s<i;s+=n)if(t(e[s],s,e))return s;return-1}}const Av=pL(1),CE=pL(-1);function SE(n,e,t,r){t=Vi(t,r,1);for(var i=t(e),s=0,a=ji(n);s<a;){var o=Math.floor((s+a)/2);t(n[o])<i?s=o+1:a=o}return s}function mL(n,e,t){return function(r,i,s){var a=0,o=ji(r);if(typeof s=="number")n>0?a=s>=0?s:Math.max(s+o,a):o=s>=0?Math.min(s+1,o):s+o+1;else if(t&&s&&o)return s=t(r,i),r[s]===i?s:-1;if(i!==i)return s=e(v_.call(r,a,o),cE),s>=0?s+a:-1;for(s=n>0?a:o-1;s>=0&&s<o;s+=n)if(r[s]===i)return s;return-1}}const PE=mL(1,Av,SE),gL=mL(-1,CE);function zm(n,e,t){var r=ps(n)?Av:AE,i=r(n,e,t);if(i!==void 0&&i!==-1)return n[i]}function _L(n,e){return zm(n,ju(e))}function ua(n,e,t){e=x_(e,t);var r,i;if(ps(n))for(r=0,i=n.length;r<i;r++)e(n[r],r,n);else{var s=Pr(n);for(r=0,i=s.length;r<i;r++)e(n[s[r]],s[r],n)}return n}function ko(n,e,t){e=Vi(e,t);for(var r=!ps(n)&&Pr(n),i=(r||n).length,s=Array(i),a=0;a<i;a++){var o=r?r[a]:a;s[a]=e(n[o],o,n)}return s}function bL(n){var e=function(t,r,i,s){var a=!ps(t)&&Pr(t),o=(a||t).length,l=n>0?0:o-1;for(s||(i=t[a?a[l]:l],l+=n);l>=0&&l<o;l+=n){var c=a?a[l]:l;i=r(i,t[c],c,t)}return i};return function(t,r,i,s){var a=arguments.length>=3;return e(t,x_(r,s,4),i,a)}}const rh=bL(1),L0=bL(-1);function Nl(n,e,t){var r=[];return e=Vi(e,t),ua(n,function(i,s,a){e(i,s,a)&&r.push(i)}),r}function yL(n,e,t){return Nl(n,Mv(Vi(e)),t)}function R0(n,e,t){e=Vi(e,t);for(var r=!ps(n)&&Pr(n),i=(r||n).length,s=0;s<i;s++){var a=r?r[s]:s;if(!e(n[a],a,n))return!1}return!0}function B0(n,e,t){e=Vi(e,t);for(var r=!ps(n)&&Pr(n),i=(r||n).length,s=0;s<i;s++){var a=r?r[s]:s;if(e(n[a],a,n))return!0}return!1}function Is(n,e,t,r){return ps(n)||(n=Zu(n)),(typeof t!="number"||r)&&(t=0),PE(n,e,t)>=0}const vL=Pi(function(n,e,t){var r,i;return fi(e)?i=e:(e=w_(e),r=e.slice(0,-1),e=e[e.length-1]),ko(n,function(s){var a=i;if(!a){if(r&&r.length&&(s=wE(s,r)),s==null)return;a=s[e]}return a==null?a:a.apply(s,t)})});function Cv(n,e){return ko(n,Ev(e))}function wL(n,e){return Nl(n,ju(e))}function kE(n,e,t){var r=-1/0,i=-1/0,s,a;if(e==null||typeof e=="number"&&typeof n[0]!="object"&&n!=null){n=ps(n)?n:Zu(n);for(var o=0,l=n.length;o<l;o++)s=n[o],s!=null&&s>r&&(r=s)}else e=Vi(e,t),ua(n,function(c,u,d){a=e(c,u,d),(a>i||a===-1/0&&r===-1/0)&&(r=c,i=a)});return r}function xL(n,e,t){var r=1/0,i=1/0,s,a;if(e==null||typeof e=="number"&&typeof n[0]!="object"&&n!=null){n=ps(n)?n:Zu(n);for(var o=0,l=n.length;o<l;o++)s=n[o],s!=null&&s<r&&(r=s)}else e=Vi(e,t),ua(n,function(c,u,d){a=e(c,u,d),(a<i||a===1/0&&r===1/0)&&(r=c,i=a)});return r}var Cz=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function FE(n){return n?Hl(n)?v_.call(n):wv(n)?n.match(Cz):ps(n)?ko(n,Tv):Zu(n):[]}function IE(n,e,t){if(e==null||t)return ps(n)||(n=Zu(n)),n[U0(n.length-1)];var r=FE(n),i=ji(r);e=Math.max(Math.min(e,i),0);for(var s=i-1,a=0;a<e;a++){var o=U0(a,s),l=r[a];r[a]=r[o],r[o]=l}return r.slice(0,e)}function TL(n){return IE(n,1/0)}function EL(n,e,t){var r=0;return e=Vi(e,t),Cv(ko(n,function(i,s,a){return{value:i,index:r++,criteria:e(i,s,a)}}).sort(function(i,s){var a=i.criteria,o=s.criteria;if(a!==o){if(a>o||a===void 0)return 1;if(a<o||o===void 0)return-1}return i.index-s.index}),"value")}function Sv(n,e){return function(t,r,i){var s=e?[[],[]]:{};return r=Vi(r,i),ua(t,function(a,o){var l=r(a,o,t);n(s,a,l)}),s}}const DL=Sv(function(n,e,t){Kl(n,t)?n[t].push(e):n[t]=[e]}),ML=Sv(function(n,e,t){n[t]=e}),AL=Sv(function(n,e,t){Kl(n,t)?n[t]++:n[t]=1}),CL=Sv(function(n,e,t){n[t?0:1].push(e)},!0);function SL(n){return n==null?0:ps(n)?n.length:Pr(n).length}function Sz(n,e,t){return e in t}const OE=Pi(function(n,e){var t={},r=e[0];if(n==null)return t;fi(r)?(e.length>1&&(r=x_(r,e[1])),e=yf(n)):(r=Sz,e=ed(e,!1,!1),n=Object(n));for(var i=0,s=e.length;i<s;i++){var a=e[i],o=n[a];r(o,a,n)&&(t[a]=o)}return t}),PL=Pi(function(n,e){var t=e[0],r;return fi(t)?(t=Mv(t),e.length>1&&(r=e[1])):(e=ko(ed(e,!1,!1),String),t=function(i,s){return!Is(e,s)}),OE(n,t,r)});function UE(n,e,t){return v_.call(n,0,Math.max(0,n.length-(e==null||t?1:e)))}function ih(n,e,t){return n==null||n.length<1?e==null||t?void 0:[]:e==null||t?n[0]:UE(n,n.length-e)}function zu(n,e,t){return v_.call(n,e==null||t?1:e)}function kL(n,e,t){return n==null||n.length<1?e==null||t?void 0:[]:e==null||t?n[n.length-1]:zu(n,Math.max(0,n.length-e))}function FL(n){return Nl(n,Boolean)}function IL(n,e){return ed(n,e,!1)}const LE=Pi(function(n,e){return e=ed(e,!0,!0),Nl(n,function(t){return!Is(e,t)})}),OL=Pi(function(n,e){return LE(n,e)});function Wm(n,e,t,r){iE(e)||(r=t,t=e,e=!1),t!=null&&(t=Vi(t,r));for(var i=[],s=[],a=0,o=ji(n);a<o;a++){var l=n[a],c=t?t(l,a,n):l;e&&!t?((!a||s!==c)&&i.push(l),s=c):t?Is(s,c)||(s.push(c),i.push(l)):Is(i,l)||i.push(l)}return i}const UL=Pi(function(n){return Wm(ed(n,!0,!0))});function LL(n){for(var e=[],t=arguments.length,r=0,i=ji(n);r<i;r++){var s=n[r];if(!Is(e,s)){var a;for(a=1;a<t&&Is(arguments[a],s);a++);a===t&&e.push(s)}}return e}function jm(n){for(var e=n&&kE(n,ji).length||0,t=Array(e),r=0;r<e;r++)t[r]=Cv(n,r);return t}const RL=Pi(jm);function BL(n,e){for(var t={},r=0,i=ji(n);r<i;r++)e?t[n[r]]=e[r]:t[n[r][0]]=n[r][1];return t}function $L(n,e,t){e==null&&(e=n||0,n=0),t||(t=e<n?-1:1);for(var r=Math.max(Math.ceil((e-n)/t),0),i=Array(r),s=0;s<r;s++,n+=t)i[s]=n;return i}function NL(n,e){if(e==null||e<1)return[];for(var t=[],r=0,i=n.length;r<i;)t.push(v_.call(n,r,r+=e));return t}function RE(n,e){return n._chain?_n(e).chain():e}function BE(n){return ua(Nm(n),function(e){var t=_n[e]=n[e];_n.prototype[e]=function(){var r=[this._wrapped];return sz.apply(r,arguments),RE(this,t.apply(_n,r))}}),_n}ua(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var e=vv[n];_n.prototype[n]=function(){var t=this._wrapped;return t!=null&&(e.apply(t,arguments),(n==="shift"||n==="splice")&&t.length===0&&delete t[0]),RE(this,t)}});ua(["concat","join","slice"],function(n){var e=vv[n];_n.prototype[n]=function(){var t=this._wrapped;return t!=null&&(t=e.apply(t,arguments)),RE(this,t)}});const Pz=Object.freeze(Object.defineProperty({__proto__:null,VERSION:tE,after:hL,all:R0,allKeys:yf,any:B0,assign:pf,before:ME,bind:EE,bindAll:sL,chain:rL,chunk:NL,clone:WU,collect:ko,compact:FL,compose:dL,constant:uE,contains:Is,countBy:AL,create:zU,debounce:cL,default:_n,defaults:yE,defer:oL,delay:DE,detect:zm,difference:LE,drop:zu,each:ua,escape:QU,every:R0,extend:bE,extendOwn:pf,filter:Nl,find:zm,findIndex:Av,findKey:AE,findLastIndex:CE,findWhere:_L,first:ih,flatten:IL,foldl:rh,foldr:L0,forEach:ua,functions:Nm,get:xE,groupBy:DL,has:VU,head:ih,identity:Tv,include:Is,includes:Is,indexBy:ML,indexOf:PE,initial:UE,inject:rh,intersection:LL,invert:gE,invoke:vL,isArguments:xv,isArray:Hl,isArrayBuffer:oE,isBoolean:iE,isDataView:$m,isDate:yU,isElement:bU,isEmpty:SU,isEqual:kU,isError:wU,isFinite:DU,isFunction:fi,isMap:UU,isMatch:hE,isNaN:cE,isNull:_U,isNumber:sE,isObject:ql,isRegExp:vU,isSet:RU,isString:wv,isSymbol:aE,isTypedArray:dE,isUndefined:rE,isWeakMap:LU,isWeakSet:BU,iteratee:Dv,keys:Pr,last:kL,lastIndexOf:gL,map:ko,mapObject:qU,matcher:ju,matches:ju,max:kE,memoize:aL,methods:Nm,min:xL,mixin:BE,negate:Mv,noop:TE,now:mf,object:BL,omit:PL,once:fL,pairs:$U,partial:Ju,partition:CL,pick:OE,pluck:Cv,property:Ev,propertyOf:HU,random:U0,range:$L,reduce:rh,reduceRight:L0,reject:yL,rest:zu,restArguments:Pi,result:tL,sample:IE,select:Nl,shuffle:TL,size:SL,some:B0,sortBy:EL,sortedIndex:SE,tail:zu,take:ih,tap:jU,template:eL,templateSettings:JU,throttle:lL,times:KU,toArray:FE,toPath:vE,transpose:jm,unescape:ZU,union:UL,uniq:Wm,unique:Wm,uniqueId:nL,unzip:jm,values:Zu,where:wL,without:OL,wrap:uL,zip:RL},Symbol.toStringTag,{value:"Module"}));var bx=BE(Pz);bx._=bx;const kz=Object.freeze(Object.defineProperty({__proto__:null,VERSION:tE,after:hL,all:R0,allKeys:yf,any:B0,assign:pf,before:ME,bind:EE,bindAll:sL,chain:rL,chunk:NL,clone:WU,collect:ko,compact:FL,compose:dL,constant:uE,contains:Is,countBy:AL,create:zU,debounce:cL,default:bx,defaults:yE,defer:oL,delay:DE,detect:zm,difference:LE,drop:zu,each:ua,escape:QU,every:R0,extend:bE,extendOwn:pf,filter:Nl,find:zm,findIndex:Av,findKey:AE,findLastIndex:CE,findWhere:_L,first:ih,flatten:IL,foldl:rh,foldr:L0,forEach:ua,functions:Nm,get:xE,groupBy:DL,has:VU,head:ih,identity:Tv,include:Is,includes:Is,indexBy:ML,indexOf:PE,initial:UE,inject:rh,intersection:LL,invert:gE,invoke:vL,isArguments:xv,isArray:Hl,isArrayBuffer:oE,isBoolean:iE,isDataView:$m,isDate:yU,isElement:bU,isEmpty:SU,isEqual:kU,isError:wU,isFinite:DU,isFunction:fi,isMap:UU,isMatch:hE,isNaN:cE,isNull:_U,isNumber:sE,isObject:ql,isRegExp:vU,isSet:RU,isString:wv,isSymbol:aE,isTypedArray:dE,isUndefined:rE,isWeakMap:LU,isWeakSet:BU,iteratee:Dv,keys:Pr,last:kL,lastIndexOf:gL,map:ko,mapObject:qU,matcher:ju,matches:ju,max:kE,memoize:aL,methods:Nm,min:xL,mixin:BE,negate:Mv,noop:TE,now:mf,object:BL,omit:PL,once:fL,pairs:$U,partial:Ju,partition:CL,pick:OE,pluck:Cv,property:Ev,propertyOf:HU,random:U0,range:$L,reduce:rh,reduceRight:L0,reject:yL,rest:zu,restArguments:Pi,result:tL,sample:IE,select:Nl,shuffle:TL,size:SL,some:B0,sortBy:EL,sortedIndex:SE,tail:zu,take:ih,tap:jU,template:eL,templateSettings:JU,throttle:lL,times:KU,toArray:FE,toPath:vE,transpose:jm,unescape:ZU,union:UL,uniq:Wm,unique:Wm,uniqueId:nL,unzip:jm,values:Zu,where:wL,without:OL,wrap:uL,zip:RL},Symbol.toStringTag,{value:"Module"})),cr=iz(kz);var ty={},ys={},R1={exports:{}},ny={exports:{}},vS;function vf(){if(vS)return ny.exports;vS=1;var n=function(){return this===void 0}();if(n)ny.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(u,d){var h=Object.getOwnPropertyDescriptor(u,d);return!!(!h||h.writable||h.set)}};else{var e={}.hasOwnProperty,t={}.toString,r={}.constructor.prototype,i=function(u){var d=[];for(var h in u)e.call(u,h)&&d.push(h);return d},s=function(u,d){return{value:u[d]}},a=function(u,d,h){return u[d]=h.value,u},o=function(u){return u},l=function(u){try{return Object(u).constructor.prototype}catch{return r}},c=function(u){try{return t.call(u)==="[object Array]"}catch{return!1}};ny.exports={isArray:c,keys:i,names:i,defineProperty:a,getDescriptor:s,freeze:o,getPrototypeOf:l,isES5:n,propertyIsWritable:function(){return!0}}}return ny.exports}var zp,wS;function On(){if(wS)return zp;wS=1;var n={},e=vf(),t=typeof navigator>"u",r={e:{}},i,s=typeof self<"u"?self:typeof window<"u"?window:typeof Bl<"u"?Bl:zp!==void 0?zp:null;function a(){try{var L=i;return i=null,L.apply(this,arguments)}catch(ne){return r.e=ne,r}}function o(L){return i=L,a}var l=function(L,ne){var de={}.hasOwnProperty;function we(){this.constructor=L,this.constructor$=ne;for(var be in ne.prototype)de.call(ne.prototype,be)&&be.charAt(be.length-1)!=="$"&&(this[be+"$"]=ne.prototype[be])}return we.prototype=ne.prototype,L.prototype=new we,L.prototype};function c(L){return L==null||L===!0||L===!1||typeof L=="string"||typeof L=="number"}function u(L){return typeof L=="function"||typeof L=="object"&&L!==null}function d(L){return c(L)?new Error(E(L)):L}function h(L,ne){var de=L.length,we=new Array(de+1),be;for(be=0;be<de;++be)we[be]=L[be];return we[be]=ne,we}function f(L,ne,de){if(e.isES5){var we=Object.getOwnPropertyDescriptor(L,ne);if(we!=null)return we.get==null&&we.set==null?we.value:de}else return{}.hasOwnProperty.call(L,ne)?L[ne]:void 0}function p(L,ne,de){if(c(L))return L;var we={value:de,configurable:!0,enumerable:!1,writable:!0};return e.defineProperty(L,ne,we),L}function g(L){throw L}var b=function(){var L=[Array.prototype,Object.prototype,Function.prototype],ne=function(be){for(var Ee=0;Ee<L.length;++Ee)if(L[Ee]===be)return!0;return!1};if(e.isES5){var de=Object.getOwnPropertyNames;return function(be){for(var Ee=[],Fe=Object.create(null);be!=null&&!ne(be);){var xe;try{xe=de(be)}catch{return Ee}for(var ce=0;ce<xe.length;++ce){var ue=xe[ce];if(!Fe[ue]){Fe[ue]=!0;var Se=Object.getOwnPropertyDescriptor(be,ue);Se!=null&&Se.get==null&&Se.set==null&&Ee.push(ue)}}be=e.getPrototypeOf(be)}return Ee}}else{var we={}.hasOwnProperty;return function(be){if(ne(be))return[];var Ee=[];e:for(var Fe in be)if(we.call(be,Fe))Ee.push(Fe);else{for(var xe=0;xe<L.length;++xe)if(we.call(L[xe],Fe))continue e;Ee.push(Fe)}return Ee}}}(),_=/this\s*\.\s*\S+\s*=/;function m(L){try{if(typeof L=="function"){var ne=e.names(L.prototype),de=e.isES5&&ne.length>1,we=ne.length>0&&!(ne.length===1&&ne[0]==="constructor"),be=_.test(L+"")&&e.names(L).length>0;if(de||we||be)return!0}return!1}catch{return!1}}function v(L){return L}var x=/^[a-z$_][a-z$_0-9]*$/i;function w(L){return x.test(L)}function T(L,ne,de){for(var we=new Array(L),be=0;be<L;++be)we[be]=ne+be+de;return we}function E(L){try{return L+""}catch{return"[no string representation]"}}function A(L){return L!==null&&typeof L=="object"&&typeof L.message=="string"&&typeof L.name=="string"}function M(L){try{p(L,"isOperational",!0)}catch{}}function F(L){return L==null?!1:L instanceof Error.__BluebirdErrorTypes__.OperationalError||L.isOperational===!0}function G(L){return A(L)&&e.propertyIsWritable(L,"stack")}var S=function(){return"stack"in new Error?function(L){return G(L)?L:new Error(E(L))}:function(L){if(G(L))return L;try{throw new Error(E(L))}catch(ne){return ne}}}();function I(L){return{}.toString.call(L)}function C(L,ne,de){for(var we=e.names(L),be=0;be<we.length;++be){var Ee=we[be];if(de(Ee))try{e.defineProperty(ne,Ee,e.getDescriptor(L,Ee))}catch{}}}var H=function(L){return e.isArray(L)?L:null};if(typeof Symbol<"u"&&Symbol.iterator){var B=typeof Array.from=="function"?function(L){return Array.from(L)}:function(L){for(var ne=[],de=L[Symbol.iterator](),we;!(we=de.next()).done;)ne.push(we.value);return ne};H=function(L){return e.isArray(L)?L:L!=null&&typeof L[Symbol.iterator]=="function"?B(L):null}}var $=typeof process<"u"&&I(process).toLowerCase()==="[object process]",X=typeof process<"u"&&typeof n<"u";function V(L){return X?n[L]:void 0}function Q(){if(typeof Promise=="function")try{var L=new Promise(function(){});if({}.toString.call(L)==="[object Promise]")return Promise}catch{}}function R(L,ne){return L.bind(ne)}var O={isClass:m,isIdentifier:w,inheritedDataKeys:b,getDataPropertyOrDefault:f,thrower:g,isArray:e.isArray,asArray:H,notEnumerableProp:p,isPrimitive:c,isObject:u,isError:A,canEvaluate:t,errorObj:r,tryCatch:o,inherits:l,withAppended:h,maybeWrapAsError:d,toFastProperties:v,filledRange:T,toString:E,canAttachTrace:G,ensureErrorObject:S,originatesFromRejection:F,markAsOriginatingFromRejection:M,classString:I,copyDescriptors:C,hasDevTools:typeof chrome<"u"&&chrome&&typeof chrome.loadTimes=="function",isNode:$,hasEnvVariables:X,env:V,global:s,getNativePromise:Q,domainBind:R};O.isRecentNode=O.isNode&&function(){var L=process.versions.node.split(".").map(Number);return L[0]===0&&L[1]>10||L[0]>0}(),O.isNode&&O.toFastProperties(process);try{throw new Error}catch(L){O.lastLineError=L}return zp=O,zp}var ry={exports:{}},B1,xS;function Fz(){if(xS)return B1;xS=1;var n=On(),e,t=function(){throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)},r=n.getNativePromise();if(n.isNode&&typeof MutationObserver>"u"){var i=Bl.setImmediate,s=process.nextTick;e=n.isRecentNode?function(o){i.call(Bl,o)}:function(o){s.call(process,o)}}else if(typeof r=="function"&&typeof r.resolve=="function"){var a=r.resolve();e=function(o){a.then(o)}}else typeof MutationObserver<"u"&&!(typeof window<"u"&&window.navigator&&(window.navigator.standalone||window.cordova))?e=function(){var o=document.createElement("div"),l={attributes:!0},c=!1,u=document.createElement("div"),d=new MutationObserver(function(){o.classList.toggle("foo"),c=!1});d.observe(u,l);var h=function(){c||(c=!0,u.classList.toggle("foo"))};return function(p){var g=new MutationObserver(function(){g.disconnect(),p()});g.observe(o,l),h()}}():typeof setImmediate<"u"?e=function(o){setImmediate(o)}:typeof setTimeout<"u"?e=function(o){setTimeout(o,0)}:e=t;return B1=e,B1}var $1,TS;function Iz(){if(TS)return $1;TS=1;function n(t,r,i,s,a){for(var o=0;o<a;++o)i[o+s]=t[o+r],t[o+r]=void 0}function e(t){this._capacity=t,this._length=0,this._front=0}return e.prototype._willBeOverCapacity=function(t){return this._capacity<t},e.prototype._pushOne=function(t){var r=this.length();this._checkCapacity(r+1);var i=this._front+r&this._capacity-1;this[i]=t,this._length=r+1},e.prototype.push=function(t,r,i){var s=this.length()+3;if(this._willBeOverCapacity(s)){this._pushOne(t),this._pushOne(r),this._pushOne(i);return}var a=this._front+s-3;this._checkCapacity(s);var o=this._capacity-1;this[a+0&o]=t,this[a+1&o]=r,this[a+2&o]=i,this._length=s},e.prototype.shift=function(){var t=this._front,r=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,r},e.prototype.length=function(){return this._length},e.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},e.prototype._resizeTo=function(t){var r=this._capacity;this._capacity=t;var i=this._front,s=this._length,a=i+s&r-1;n(this,0,this,r,a)},$1=e,$1}var ES;function Oz(){if(ES)return ry.exports;ES=1;var n;try{throw new Error}catch(l){n=l}var e=Fz(),t=Iz(),r=On();function i(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new t(16),this._normalQueue=new t(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var l=this;this.drainQueues=function(){l._drainQueues()},this._schedule=e}i.prototype.setScheduler=function(l){var c=this._schedule;return this._schedule=l,this._customScheduler=!0,c},i.prototype.hasCustomScheduler=function(){return this._customScheduler},i.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},i.prototype.disableTrampolineIfNecessary=function(){r.hasDevTools&&(this._trampolineEnabled=!1)},i.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},i.prototype.fatalError=function(l,c){c?(process.stderr.write("Fatal "+(l instanceof Error?l.stack:l)+`
`),process.exit(2)):this.throwLater(l)},i.prototype.throwLater=function(l,c){if(arguments.length===1&&(c=l,l=function(){throw c}),typeof setTimeout<"u")setTimeout(function(){l(c)},0);else try{this._schedule(function(){l(c)})}catch{throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)}};function s(l,c,u){this._lateQueue.push(l,c,u),this._queueTick()}function a(l,c,u){this._normalQueue.push(l,c,u),this._queueTick()}function o(l){this._normalQueue._pushOne(l),this._queueTick()}return r.hasDevTools?(i.prototype.invokeLater=function(l,c,u){this._trampolineEnabled?s.call(this,l,c,u):this._schedule(function(){setTimeout(function(){l.call(c,u)},100)})},i.prototype.invoke=function(l,c,u){this._trampolineEnabled?a.call(this,l,c,u):this._schedule(function(){l.call(c,u)})},i.prototype.settlePromises=function(l){this._trampolineEnabled?o.call(this,l):this._schedule(function(){l._settlePromises()})}):(i.prototype.invokeLater=s,i.prototype.invoke=a,i.prototype.settlePromises=o),i.prototype._drainQueue=function(l){for(;l.length()>0;){var c=l.shift();if(typeof c!="function"){c._settlePromises();continue}var u=l.shift(),d=l.shift();c.call(u,d)}},i.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},i.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},i.prototype._reset=function(){this._isTickUsed=!1},ry.exports=i,ry.exports.firstLineError=n,ry.exports}var N1,DS;function zl(){if(DS)return N1;DS=1;var n=vf(),e=n.freeze,t=On(),r=t.inherits,i=t.notEnumerableProp;function s(_,m){function v(x){if(!(this instanceof v))return new v(x);i(this,"message",typeof x=="string"?x:m),i(this,"name",_),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return r(v,Error),v}var a,o,l=s("Warning","warning"),c=s("CancellationError","cancellation error"),u=s("TimeoutError","timeout error"),d=s("AggregateError","aggregate error");try{a=TypeError,o=RangeError}catch{a=s("TypeError","type error"),o=s("RangeError","range error")}for(var h="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),f=0;f<h.length;++f)typeof Array.prototype[h[f]]=="function"&&(d.prototype[h[f]]=Array.prototype[h[f]]);n.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var p=0;d.prototype.toString=function(){var _=Array(p*4+1).join(" "),m=`
`+_+`AggregateError of:
`;p++,_=Array(p*4+1).join(" ");for(var v=0;v<this.length;++v){for(var x=this[v]===this?"[Circular AggregateError]":this[v]+"",w=x.split(`
`),T=0;T<w.length;++T)w[T]=_+w[T];x=w.join(`
`),m+=x+`
`}return p--,m};function g(_){if(!(this instanceof g))return new g(_);i(this,"name","OperationalError"),i(this,"message",_),this.cause=_,this.isOperational=!0,_ instanceof Error?(i(this,"message",_.message),i(this,"stack",_.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}r(g,Error);var b=Error.__BluebirdErrorTypes__;return b||(b=e({CancellationError:c,TimeoutError:u,OperationalError:g,RejectionError:g,AggregateError:d}),n.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),N1={Error,TypeError:a,RangeError:o,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:l},N1}var z1,MS;function Uz(){return MS||(MS=1,z1=function(n,e){var t=On(),r=t.errorObj,i=t.isObject;function s(d,h){if(i(d)){if(d instanceof n)return d;var f=o(d);if(f===r){h&&h._pushContext();var p=n.reject(f.e);return h&&h._popContext(),p}else if(typeof f=="function"){if(c(d)){var p=new n(e);return d._then(p._fulfill,p._reject,void 0,p,null),p}return u(d,f,h)}}return d}function a(d){return d.then}function o(d){try{return a(d)}catch(h){return r.e=h,r}}var l={}.hasOwnProperty;function c(d){try{return l.call(d,"_promise0")}catch{return!1}}function u(d,h,f){var p=new n(e),g=p;f&&f._pushContext(),p._captureStackTrace(),f&&f._popContext();var b=!0,_=t.tryCatch(h).call(d,m,v);b=!1,p&&_===r&&(p._rejectCallback(_.e,!0,!0),p=null);function m(x){p&&(p._resolveCallback(x),p=null)}function v(x){p&&(p._rejectCallback(x,b,!0),p=null)}return g}return s}),z1}var W1,AS;function Lz(){return AS||(AS=1,W1=function(n,e,t,r,i){var s=On();s.isArray;function a(l){switch(l){case-2:return[];case-3:return{}}}function o(l){var c=this._promise=new n(e);l instanceof n&&c._propagateFrom(l,3),c._setOnCancel(this),this._values=l,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.inherits(o,i),o.prototype.length=function(){return this._length},o.prototype.promise=function(){return this._promise},o.prototype._init=function l(c,u){var d=t(this._values,this._promise);if(d instanceof n){d=d._target();var h=d._bitField;if(this._values=d,(h&50397184)===0)return this._promise._setAsyncGuaranteed(),d._then(l,this._reject,void 0,this,u);if((h&33554432)!==0)d=d._value();else return(h&16777216)!==0?this._reject(d._reason()):this._cancel()}if(d=s.asArray(d),d===null){var f=r("expecting an array or an iterable object but got "+s.classString(d)).reason();this._promise._rejectCallback(f,!1);return}if(d.length===0){u===-5?this._resolveEmptyArray():this._resolve(a(u));return}this._iterate(d)},o.prototype._iterate=function(l){var c=this.getActualLength(l.length);this._length=c,this._values=this.shouldCopyValues()?new Array(c):this._values;for(var u=this._promise,d=!1,h=null,f=0;f<c;++f){var p=t(l[f],u);p instanceof n?(p=p._target(),h=p._bitField):h=null,d?h!==null&&p.suppressUnhandledRejections():h!==null?(h&50397184)===0?(p._proxy(this,f),this._values[f]=p):(h&33554432)!==0?d=this._promiseFulfilled(p._value(),f):(h&16777216)!==0?d=this._promiseRejected(p._reason(),f):d=this._promiseCancelled(f):d=this._promiseFulfilled(p,f)}d||u._setAsyncGuaranteed()},o.prototype._isResolved=function(){return this._values===null},o.prototype._resolve=function(l){this._values=null,this._promise._fulfill(l)},o.prototype._cancel=function(){this._isResolved()||!this._promise._isCancellable()||(this._values=null,this._promise._cancel())},o.prototype._reject=function(l){this._values=null,this._promise._rejectCallback(l,!1)},o.prototype._promiseFulfilled=function(l,c){this._values[c]=l;var u=++this._totalResolved;return u>=this._length?(this._resolve(this._values),!0):!1},o.prototype._promiseCancelled=function(){return this._cancel(),!0},o.prototype._promiseRejected=function(l){return this._totalResolved++,this._reject(l),!0},o.prototype._resultCancelled=function(){if(!this._isResolved()){var l=this._values;if(this._cancel(),l instanceof n)l.cancel();else for(var c=0;c<l.length;++c)l[c]instanceof n&&l[c].cancel()}},o.prototype.shouldCopyValues=function(){return!0},o.prototype.getActualLength=function(l){return l},o}),W1}var j1,CS;function Rz(){return CS||(CS=1,j1=function(n){var e=!1,t=[];n.prototype._promiseCreated=function(){},n.prototype._pushContext=function(){},n.prototype._popContext=function(){return null},n._peekContext=n.prototype._peekContext=function(){};function r(){this._trace=new r.CapturedTrace(s())}r.prototype._pushContext=function(){this._trace!==void 0&&(this._trace._promiseCreated=null,t.push(this._trace))},r.prototype._popContext=function(){if(this._trace!==void 0){var a=t.pop(),o=a._promiseCreated;return a._promiseCreated=null,o}return null};function i(){if(e)return new r}function s(){var a=t.length-1;if(a>=0)return t[a]}return r.CapturedTrace=null,r.create=i,r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var a=n.prototype._pushContext,o=n.prototype._popContext,l=n._peekContext,c=n.prototype._peekContext,u=n.prototype._promiseCreated;r.deactivateLongStackTraces=function(){n.prototype._pushContext=a,n.prototype._popContext=o,n._peekContext=l,n.prototype._peekContext=c,n.prototype._promiseCreated=u,e=!1},e=!0,n.prototype._pushContext=r.prototype._pushContext,n.prototype._popContext=r.prototype._popContext,n._peekContext=n.prototype._peekContext=s,n.prototype._promiseCreated=function(){var d=this._peekContext();d&&d._promiseCreated==null&&(d._promiseCreated=this)}},r}),j1}var V1,SS;function Bz(){return SS||(SS=1,V1=function(n,e){var t=n._getDomain,r=n._async,i=zl().Warning,s=On(),a=s.canAttachTrace,o,l,c=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,u=/\((?:timers\.js):\d+:\d+\)/,d=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,h=null,f=null,p=!1,g,b=!!(s.env("BLUEBIRD_DEBUG")!=0&&(s.env("BLUEBIRD_DEBUG")||s.env("NODE_ENV")==="development")),_=!!(s.env("BLUEBIRD_WARNINGS")!=0&&(b||s.env("BLUEBIRD_WARNINGS"))),m=!!(s.env("BLUEBIRD_LONG_STACK_TRACES")!=0&&(b||s.env("BLUEBIRD_LONG_STACK_TRACES"))),v=s.env("BLUEBIRD_W_FORGOTTEN_RETURN")!=0&&(_||!!s.env("BLUEBIRD_W_FORGOTTEN_RETURN"));n.prototype.suppressUnhandledRejections=function(){var j=this._target();j._bitField=j._bitField&-1048577|524288},n.prototype._ensurePossibleRejectionHandled=function(){(this._bitField&524288)===0&&(this._setRejectionIsUnhandled(),r.invokeLater(this._notifyUnhandledRejection,this,void 0))},n.prototype._notifyUnhandledRejectionIsHandled=function(){ue("rejectionHandled",o,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=this._bitField|268435456},n.prototype._returnedNonUndefined=function(){return(this._bitField&268435456)!==0},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var j=this._settledValue();this._setUnhandledRejectionIsNotified(),ue("unhandledRejection",l,j,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|262144},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},n.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&262144)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|1048576},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(this._bitField&1048576)>0},n.prototype._warn=function(j,ee,se){return ne(j,ee,se||this)},n.onPossiblyUnhandledRejection=function(j){var ee=t();l=typeof j=="function"?ee===null?j:s.domainBind(ee,j):void 0},n.onUnhandledRejectionHandled=function(j){var ee=t();o=typeof j=="function"?ee===null?j:s.domainBind(ee,j):void 0};var x=function(){};n.longStackTraces=function(){if(r.haveItemsQueued()&&!te.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);if(!te.longStackTraces&&he()){var j=n.prototype._captureStackTrace,ee=n.prototype._attachExtraTrace;te.longStackTraces=!0,x=function(){if(r.haveItemsQueued()&&!te.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);n.prototype._captureStackTrace=j,n.prototype._attachExtraTrace=ee,e.deactivateLongStackTraces(),r.enableTrampoline(),te.longStackTraces=!1},n.prototype._captureStackTrace=Q,n.prototype._attachExtraTrace=R,e.activateLongStackTraces(),r.disableTrampolineIfNecessary()}},n.hasLongStackTraces=function(){return te.longStackTraces&&he()};var w=function(){try{if(typeof CustomEvent=="function"){var j=new CustomEvent("CustomEvent");return s.global.dispatchEvent(j),function(ee,se){var ve=new CustomEvent(ee.toLowerCase(),{detail:se,cancelable:!0});return!s.global.dispatchEvent(ve)}}else if(typeof Event=="function"){var j=new Event("CustomEvent");return s.global.dispatchEvent(j),function(se,ve){var ke=new Event(se.toLowerCase(),{cancelable:!0});return ke.detail=ve,!s.global.dispatchEvent(ke)}}else{var j=document.createEvent("CustomEvent");return j.initCustomEvent("testingtheevent",!1,!0,{}),s.global.dispatchEvent(j),function(se,ve){var ke=document.createEvent("CustomEvent");return ke.initCustomEvent(se.toLowerCase(),!1,!0,ve),!s.global.dispatchEvent(ke)}}}catch{}return function(){return!1}}(),T=function(){return s.isNode?function(){return process.emit.apply(process,arguments)}:s.global?function(j){var ee="on"+j.toLowerCase(),se=s.global[ee];return se?(se.apply(s.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}();function E(j,ee){return{promise:ee}}var A={promiseCreated:E,promiseFulfilled:E,promiseRejected:E,promiseResolved:E,promiseCancelled:E,promiseChained:function(j,ee,se){return{promise:ee,child:se}},warning:function(j,ee){return{warning:ee}},unhandledRejection:function(j,ee,se){return{reason:ee,promise:se}},rejectionHandled:E},M=function(j){var ee=!1;try{ee=T.apply(null,arguments)}catch(ve){r.throwLater(ve),ee=!0}var se=!1;try{se=w(j,A[j].apply(null,arguments))}catch(ve){r.throwLater(ve),se=!0}return se||ee};n.config=function(j){if(j=Object(j),"longStackTraces"in j&&(j.longStackTraces?n.longStackTraces():!j.longStackTraces&&n.hasLongStackTraces()&&x()),"warnings"in j){var ee=j.warnings;te.warnings=!!ee,v=te.warnings,s.isObject(ee)&&"wForgottenReturn"in ee&&(v=!!ee.wForgottenReturn)}if("cancellation"in j&&j.cancellation&&!te.cancellation){if(r.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=H,n.prototype._propagateFrom=B,n.prototype._onCancel=I,n.prototype._setOnCancel=C,n.prototype._attachCancellationCallback=S,n.prototype._execute=G,X=B,te.cancellation=!0}return"monitoring"in j&&(j.monitoring&&!te.monitoring?(te.monitoring=!0,n.prototype._fireEvent=M):!j.monitoring&&te.monitoring&&(te.monitoring=!1,n.prototype._fireEvent=F)),n};function F(){return!1}n.prototype._fireEvent=F,n.prototype._execute=function(j,ee,se){try{j(ee,se)}catch(ve){return ve}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(j){},n.prototype._attachCancellationCallback=function(j){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(j,ee){};function G(j,ee,se){var ve=this;try{j(ee,se,function(ke){if(typeof ke!="function")throw new TypeError("onCancel must be a function, got: "+s.toString(ke));ve._attachCancellationCallback(ke)})}catch(ke){return ke}}function S(j){if(!this._isCancellable())return this;var ee=this._onCancel();ee!==void 0?s.isArray(ee)?ee.push(j):this._setOnCancel([ee,j]):this._setOnCancel(j)}function I(){return this._onCancelField}function C(j){this._onCancelField=j}function H(){this._cancellationParent=void 0,this._onCancelField=void 0}function B(j,ee){if((ee&1)!==0){this._cancellationParent=j;var se=j._branchesRemainingToCancel;se===void 0&&(se=0),j._branchesRemainingToCancel=se+1}(ee&2)!==0&&j._isBound()&&this._setBoundTo(j._boundTo)}function $(j,ee){(ee&2)!==0&&j._isBound()&&this._setBoundTo(j._boundTo)}var X=$;function V(){var j=this._boundTo;return j!==void 0&&j instanceof n?j.isFulfilled()?j.value():void 0:j}function Q(){this._trace=new Ce(this._peekContext())}function R(j,ee){if(a(j)){var se=this._trace;if(se!==void 0&&ee&&(se=se._parent),se!==void 0)se.attachExtraTrace(j);else if(!j.__stackCleaned__){var ve=xe(j);s.notEnumerableProp(j,"stack",ve.message+`
`+ve.stack.join(`
`)),s.notEnumerableProp(j,"__stackCleaned__",!0)}}}function O(j,ee,se,ve,ke){if(j===void 0&&ee!==null&&v){if(ke!==void 0&&ke._returnedNonUndefined()||(ve._bitField&65535)===0)return;se&&(se=se+" ");var Re="",Oe="";if(ee._trace){for(var ze=ee._trace.stack.split(`
`),Te=Ee(ze),Be=Te.length-1;Be>=0;--Be){var qe=Te[Be];if(!u.test(qe)){var tt=qe.match(d);tt&&(Re="at "+tt[1]+":"+tt[2]+":"+tt[3]+" ");break}}if(Te.length>0){for(var xt=Te[0],Be=0;Be<ze.length;++Be)if(ze[Be]===xt){Be>0&&(Oe=`
`+ze[Be-1]);break}}}var ft="a promise was created in a "+se+"handler "+Re+"but was not returned from it, see http://goo.gl/rRqMUw"+Oe;ve._warn(ft,!0,ee)}}function L(j,ee){var se=j+" is deprecated and will be removed in a future version.";return ee&&(se+=" Use "+ee+" instead."),ne(se)}function ne(j,ee,se){if(te.warnings){var ve=new i(j),ke;if(ee)se._attachExtraTrace(ve);else if(te.longStackTraces&&(ke=n._peekContext()))ke.attachExtraTrace(ve);else{var Re=xe(ve);ve.stack=Re.message+`
`+Re.stack.join(`
`)}M("warning",ve)||ce(ve,"",!0)}}function de(j,ee){for(var se=0;se<ee.length-1;++se)ee[se].push("From previous event:"),ee[se]=ee[se].join(`
`);return se<ee.length&&(ee[se]=ee[se].join(`
`)),j+`
`+ee.join(`
`)}function we(j){for(var ee=0;ee<j.length;++ee)(j[ee].length===0||ee+1<j.length&&j[ee][0]===j[ee+1][0])&&(j.splice(ee,1),ee--)}function be(j){for(var ee=j[0],se=1;se<j.length;++se){for(var ve=j[se],ke=ee.length-1,Re=ee[ke],Oe=-1,ze=ve.length-1;ze>=0;--ze)if(ve[ze]===Re){Oe=ze;break}for(var ze=Oe;ze>=0;--ze){var Te=ve[ze];if(ee[ke]===Te)ee.pop(),ke--;else break}ee=ve}}function Ee(j){for(var ee=[],se=0;se<j.length;++se){var ve=j[se],ke=ve==="    (No stack trace)"||h.test(ve),Re=ke&&pe(ve);ke&&!Re&&(p&&ve.charAt(0)!==" "&&(ve="    "+ve),ee.push(ve))}return ee}function Fe(j){for(var ee=j.stack.replace(/\s+$/g,"").split(`
`),se=0;se<ee.length;++se){var ve=ee[se];if(ve==="    (No stack trace)"||h.test(ve))break}return se>0&&j.name!="SyntaxError"&&(ee=ee.slice(se)),ee}function xe(j){var ee=j.stack,se=j.toString();return ee=typeof ee=="string"&&ee.length>0?Fe(j):["    (No stack trace)"],{message:se,stack:j.name=="SyntaxError"?ee:Ee(ee)}}function ce(j,ee,se){if(typeof console<"u"){var ve;if(s.isObject(j)){var ke=j.stack;ve=ee+f(ke,j)}else ve=ee+String(j);typeof g=="function"?g(ve,se):(typeof console.log=="function"||typeof console.log=="object")&&console.log(ve)}}function ue(j,ee,se,ve){var ke=!1;try{typeof ee=="function"&&(ke=!0,j==="rejectionHandled"?ee(ve):ee(se,ve))}catch(Re){r.throwLater(Re)}j==="unhandledRejection"?!M(j,se,ve)&&!ke&&ce(se,"Unhandled rejection "):M(j,ve)}function Se(j){var ee;if(typeof j=="function")ee="[function "+(j.name||"anonymous")+"]";else{ee=j&&typeof j.toString=="function"?j.toString():s.toString(j);var se=/\[object [a-zA-Z0-9$_]+\]/;if(se.test(ee))try{var ve=JSON.stringify(j);ee=ve}catch{}ee.length===0&&(ee="(empty array)")}return"(<"+U(ee)+">, no stack trace)"}function U(j){var ee=41;return j.length<ee?j:j.substr(0,ee-3)+"..."}function he(){return typeof q=="function"}var pe=function(){return!1},ie=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function re(j){var ee=j.match(ie);if(ee)return{fileName:ee[1],line:parseInt(ee[2],10)}}function ge(j,ee){if(he()){for(var se=j.stack.split(`
`),ve=ee.stack.split(`
`),ke=-1,Re=-1,Oe,ze,Te=0;Te<se.length;++Te){var Be=re(se[Te]);if(Be){Oe=Be.fileName,ke=Be.line;break}}for(var Te=0;Te<ve.length;++Te){var Be=re(ve[Te]);if(Be){ze=Be.fileName,Re=Be.line;break}}ke<0||Re<0||!Oe||!ze||Oe!==ze||ke>=Re||(pe=function(qe){if(c.test(qe))return!0;var tt=re(qe);return!!(tt&&tt.fileName===Oe&&ke<=tt.line&&tt.line<=Re)})}}function Ce(j){this._parent=j,this._promisesCreated=0;var ee=this._length=1+(j===void 0?0:j._length);q(this,Ce),ee>32&&this.uncycle()}s.inherits(Ce,Error),e.CapturedTrace=Ce,Ce.prototype.uncycle=function(){var j=this._length;if(!(j<2)){for(var ee=[],se={},ve=0,ke=this;ke!==void 0;++ve)ee.push(ke),ke=ke._parent;j=this._length=ve;for(var ve=j-1;ve>=0;--ve){var Re=ee[ve].stack;se[Re]===void 0&&(se[Re]=ve)}for(var ve=0;ve<j;++ve){var Oe=ee[ve].stack,ze=se[Oe];if(ze!==void 0&&ze!==ve){ze>0&&(ee[ze-1]._parent=void 0,ee[ze-1]._length=1),ee[ve]._parent=void 0,ee[ve]._length=1;var Te=ve>0?ee[ve-1]:this;ze<j-1?(Te._parent=ee[ze+1],Te._parent.uncycle(),Te._length=Te._parent._length+1):(Te._parent=void 0,Te._length=1);for(var Be=Te._length+1,qe=ve-2;qe>=0;--qe)ee[qe]._length=Be,Be++;return}}}},Ce.prototype.attachExtraTrace=function(j){if(!j.__stackCleaned__){this.uncycle();for(var ee=xe(j),se=ee.message,ve=[ee.stack],ke=this;ke!==void 0;)ve.push(Ee(ke.stack.split(`
`))),ke=ke._parent;be(ve),we(ve),s.notEnumerableProp(j,"stack",de(se,ve)),s.notEnumerableProp(j,"__stackCleaned__",!0)}};var q=function(){var ee=/^\s*at\s*/,se=function(Oe,ze){return typeof Oe=="string"?Oe:ze.name!==void 0&&ze.message!==void 0?ze.toString():Se(ze)};if(typeof Error.stackTraceLimit=="number"&&typeof Error.captureStackTrace=="function"){Error.stackTraceLimit+=6,h=ee,f=se;var ve=Error.captureStackTrace;return pe=function(Oe){return c.test(Oe)},function(Oe,ze){Error.stackTraceLimit+=6,ve(Oe,ze),Error.stackTraceLimit-=6}}var ke=new Error;if(typeof ke.stack=="string"&&ke.stack.split(`
`)[0].indexOf("stackDetection@")>=0)return h=/@/,f=se,p=!0,function(ze){ze.stack=new Error().stack};var Re;try{throw new Error}catch(Oe){Re="stack"in Oe}return!("stack"in ke)&&Re&&typeof Error.stackTraceLimit=="number"?(h=ee,f=se,function(ze){Error.stackTraceLimit+=6;try{throw new Error}catch(Te){ze.stack=Te.stack}Error.stackTraceLimit-=6}):(f=function(Oe,ze){return typeof Oe=="string"?Oe:(typeof ze=="object"||typeof ze=="function")&&ze.name!==void 0&&ze.message!==void 0?ze.toString():Se(ze)},null)}();typeof console<"u"&&typeof console.warn<"u"&&(g=function(j){console.warn(j)},s.isNode&&process.stderr.isTTY?g=function(j,ee){var se=ee?"\x1B[33m":"\x1B[31m";console.warn(se+j+`\x1B[0m
`)}:!s.isNode&&typeof new Error().stack=="string"&&(g=function(j,ee){console.warn("%c"+j,ee?"color: darkorange":"color: red")}));var te={warnings:_,longStackTraces:!1,cancellation:!1,monitoring:!1};return m&&n.longStackTraces(),{longStackTraces:function(){return te.longStackTraces},warnings:function(){return te.warnings},cancellation:function(){return te.cancellation},monitoring:function(){return te.monitoring},propagateFromFunction:function(){return X},boundValueFunction:function(){return V},checkForgottenReturns:O,setBounds:ge,warn:ne,deprecated:L,CapturedTrace:Ce,fireDomEvent:w,fireGlobalEvent:T}}),V1}var G1,PS;function $z(){return PS||(PS=1,G1=function(n,e){var t=On(),r=n.CancellationError,i=t.errorObj;function s(d,h,f){this.promise=d,this.type=h,this.handler=f,this.called=!1,this.cancelPromise=null}s.prototype.isFinallyHandler=function(){return this.type===0};function a(d){this.finallyHandler=d}a.prototype._resultCancelled=function(){o(this.finallyHandler)};function o(d,h){return d.cancelPromise!=null?(arguments.length>1?d.cancelPromise._reject(h):d.cancelPromise._cancel(),d.cancelPromise=null,!0):!1}function l(){return u.call(this,this.promise._target()._settledValue())}function c(d){if(!o(this,d))return i.e=d,i}function u(d){var h=this.promise,f=this.handler;if(!this.called){this.called=!0;var p=this.isFinallyHandler()?f.call(h._boundValue()):f.call(h._boundValue(),d);if(p!==void 0){h._setReturnedNonUndefined();var g=e(p,h);if(g instanceof n){if(this.cancelPromise!=null)if(g._isCancelled()){var b=new r("late cancellation observer");return h._attachExtraTrace(b),i.e=b,i}else g.isPending()&&g._attachCancellationCallback(new a(this));return g._then(l,c,void 0,this,void 0)}}}return h.isRejected()?(o(this),i.e=d,i):(o(this),d)}return n.prototype._passThrough=function(d,h,f,p){return typeof d!="function"?this.then():this._then(f,p,void 0,new s(this,h,d),void 0)},n.prototype.lastly=n.prototype.finally=function(d){return this._passThrough(d,0,u,u)},n.prototype.tap=function(d){return this._passThrough(d,1,u)},s}),G1}var q1,kS;function Nz(){return kS||(kS=1,q1=function(n){var e=On(),t=vf().keys,r=e.tryCatch,i=e.errorObj;function s(a,o,l){return function(c){var u=l._boundValue();e:for(var d=0;d<a.length;++d){var h=a[d];if(h===Error||h!=null&&h.prototype instanceof Error){if(c instanceof h)return r(o).call(u,c)}else if(typeof h=="function"){var f=r(h).call(u,c);if(f===i)return f;if(f)return r(o).call(u,c)}else if(e.isObject(c)){for(var p=t(h),g=0;g<p.length;++g){var b=p[g];if(h[b]!=c[b])continue e}return r(o).call(u,c)}}return n}}return s}),q1}var H1,FS;function zL(){if(FS)return H1;FS=1;var n=On(),e=n.maybeWrapAsError,t=zl(),r=t.OperationalError,i=vf();function s(c){return c instanceof Error&&i.getPrototypeOf(c)===Error.prototype}var a=/^(?:name|message|stack|cause)$/;function o(c){var u;if(s(c)){u=new r(c),u.name=c.name,u.message=c.message,u.stack=c.stack;for(var d=i.keys(c),h=0;h<d.length;++h){var f=d[h];a.test(f)||(u[f]=c[f])}return u}return n.markAsOriginatingFromRejection(c),c}function l(c,u){return function(d,h){if(c!==null){if(d){var f=o(e(d));c._attachExtraTrace(f),c._reject(f)}else if(!u)c._fulfill(h);else{for(var p=arguments.length,g=new Array(Math.max(p-1,0)),b=1;b<p;++b)g[b-1]=arguments[b];c._fulfill(g)}c=null}}}return H1=l,H1}var K1,IS;function zz(){return IS||(IS=1,K1=function(n,e,t,r,i){var s=On(),a=s.tryCatch;n.method=function(o){if(typeof o!="function")throw new n.TypeError("expecting a function but got "+s.classString(o));return function(){var l=new n(e);l._captureStackTrace(),l._pushContext();var c=a(o).apply(this,arguments),u=l._popContext();return i.checkForgottenReturns(c,u,"Promise.method",l),l._resolveFromSyncValue(c),l}},n.attempt=n.try=function(o){if(typeof o!="function")return r("expecting a function but got "+s.classString(o));var l=new n(e);l._captureStackTrace(),l._pushContext();var c;if(arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],d=arguments[2];c=s.isArray(u)?a(o).apply(d,u):a(o).call(d,u)}else c=a(o)();var h=l._popContext();return i.checkForgottenReturns(c,h,"Promise.try",l),l._resolveFromSyncValue(c),l},n.prototype._resolveFromSyncValue=function(o){o===s.errorObj?this._rejectCallback(o.e,!1):this._resolveCallback(o,!0)}}),K1}var X1,OS;function Wz(){return OS||(OS=1,X1=function(n,e,t,r){var i=!1,s=function(c,u){this._reject(u)},a=function(c,u){u.promiseRejectionQueued=!0,u.bindingPromise._then(s,s,null,this,c)},o=function(c,u){(this._bitField&50397184)===0&&this._resolveCallback(u.target)},l=function(c,u){u.promiseRejectionQueued||this._reject(c)};n.prototype.bind=function(c){i||(i=!0,n.prototype._propagateFrom=r.propagateFromFunction(),n.prototype._boundValue=r.boundValueFunction());var u=t(c),d=new n(e);d._propagateFrom(this,1);var h=this._target();if(d._setBoundTo(u),u instanceof n){var f={promiseRejectionQueued:!1,promise:d,target:h,bindingPromise:u};h._then(e,a,void 0,d,f),u._then(o,l,void 0,d,f),d._setOnCancel(u)}else d._resolveCallback(h);return d},n.prototype._setBoundTo=function(c){c!==void 0?(this._bitField=this._bitField|2097152,this._boundTo=c):this._bitField=this._bitField&-2097153},n.prototype._isBound=function(){return(this._bitField&2097152)===2097152},n.bind=function(c,u){return n.resolve(u).bind(c)}}),X1}var Y1,US;function jz(){return US||(US=1,Y1=function(n,e,t,r){var i=On(),s=i.tryCatch,a=i.errorObj,o=n._async;n.prototype.break=n.prototype.cancel=function(){if(!r.cancellation())return this._warn("cancellation is disabled");for(var l=this,c=l;l._isCancellable();){if(!l._cancelBy(c)){c._isFollowing()?c._followee().cancel():c._cancelBranched();break}var u=l._cancellationParent;if(u==null||!u._isCancellable()){l._isFollowing()?l._followee().cancel():l._cancelBranched();break}else l._isFollowing()&&l._followee().cancel(),l._setWillBeCancelled(),c=l,l=u}},n.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},n.prototype._enoughBranchesHaveCancelled=function(){return this._branchesRemainingToCancel===void 0||this._branchesRemainingToCancel<=0},n.prototype._cancelBy=function(l){return l===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},n.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},n.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),o.invoke(this._cancelPromises,this,void 0))},n.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},n.prototype._unsetOnCancel=function(){this._onCancelField=void 0},n.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},n.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},n.prototype._doInvokeOnCancel=function(l,c){if(i.isArray(l))for(var u=0;u<l.length;++u)this._doInvokeOnCancel(l[u],c);else if(l!==void 0)if(typeof l=="function"){if(!c){var d=s(l).call(this._boundValue());d===a&&(this._attachExtraTrace(d.e),o.throwLater(d.e))}}else l._resultCancelled(this)},n.prototype._invokeOnCancel=function(){var l=this._onCancel();this._unsetOnCancel(),o.invoke(this._doInvokeOnCancel,this,l)},n.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},n.prototype._resultCancelled=function(){this.cancel()}}),Y1}var Q1,LS;function Vz(){return LS||(LS=1,Q1=function(n){function e(){return this.value}function t(){throw this.reason}n.prototype.return=n.prototype.thenReturn=function(r){return r instanceof n&&r.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:r},void 0)},n.prototype.throw=n.prototype.thenThrow=function(r){return this._then(t,void 0,void 0,{reason:r},void 0)},n.prototype.catchThrow=function(r){if(arguments.length<=1)return this._then(void 0,t,void 0,{reason:r},void 0);var i=arguments[1],s=function(){throw i};return this.caught(r,s)},n.prototype.catchReturn=function(r){if(arguments.length<=1)return r instanceof n&&r.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:r},void 0);var i=arguments[1];i instanceof n&&i.suppressUnhandledRejections();var s=function(){return i};return this.caught(r,s)}}),Q1}var Z1,RS;function Gz(){return RS||(RS=1,Z1=function(n){function e(l){l!==void 0?(l=l._target(),this._bitField=l._bitField,this._settledValueField=l._isFateSealed()?l._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var t=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError(`cannot get fulfillment value of a non-fulfilled promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError(`cannot get rejection reason of a non-rejected promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},i=e.prototype.isFulfilled=function(){return(this._bitField&33554432)!==0},s=e.prototype.isRejected=function(){return(this._bitField&16777216)!==0},a=e.prototype.isPending=function(){return(this._bitField&50397184)===0},o=e.prototype.isResolved=function(){return(this._bitField&50331648)!==0};e.prototype.isCancelled=function(){return(this._bitField&8454144)!==0},n.prototype.__isCancelled=function(){return(this._bitField&65536)===65536},n.prototype._isCancelled=function(){return this._target().__isCancelled()},n.prototype.isCancelled=function(){return(this._target()._bitField&8454144)!==0},n.prototype.isPending=function(){return a.call(this._target())},n.prototype.isRejected=function(){return s.call(this._target())},n.prototype.isFulfilled=function(){return i.call(this._target())},n.prototype.isResolved=function(){return o.call(this._target())},n.prototype.value=function(){return t.call(this._target())},n.prototype.reason=function(){var l=this._target();return l._unsetRejectionIsUnhandled(),r.call(l)},n.prototype._value=function(){return this._settledValue()},n.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},n.PromiseInspection=e}),Z1}var J1,BS;function qz(){return BS||(BS=1,J1=function(n,e,t,r,i,s){var a=On(),o=a.canEvaluate,l=a.tryCatch,c=a.errorObj,u;if(o){for(var d=function(m){return new Function("value","holder",`                             
	            'use strict';                                                    
	            holder.pIndex = value;                                           
	            holder.checkFulfillment(this);                                   
	            `.replace(/Index/g,m))},h=function(m){return new Function("promise","holder",`                           
	            'use strict';                                                    
	            holder.pIndex = promise;                                         
	            `.replace(/Index/g,m))},f=function(m){for(var v=new Array(m),x=0;x<v.length;++x)v[x]="this.p"+(x+1);var w=v.join(" = ")+" = null;",T=`var promise;
`+v.map(function(F){return`                                                         
	                promise = `+F+`;                                      
	                if (promise instanceof Promise) {                            
	                    promise.cancel();                                        
	                }                                                            
	            `}).join(`
`),E=v.join(", "),A="Holder$"+m,M=`return function(tryCatch, errorObj, Promise, async) {    
	            'use strict';                                                    
	            function [TheName](fn) {                                         
	                [TheProperties]                                              
	                this.fn = fn;                                                
	                this.asyncNeeded = true;                                     
	                this.now = 0;                                                
	            }                                                                
	                                                                             
	            [TheName].prototype._callFunction = function(promise) {          
	                promise._pushContext();                                      
	                var ret = tryCatch(this.fn)([ThePassedArguments]);           
	                promise._popContext();                                       
	                if (ret === errorObj) {                                      
	                    promise._rejectCallback(ret.e, false);                   
	                } else {                                                     
	                    promise._resolveCallback(ret);                           
	                }                                                            
	            };                                                               
	                                                                             
	            [TheName].prototype.checkFulfillment = function(promise) {       
	                var now = ++this.now;                                        
	                if (now === [TheTotal]) {                                    
	                    if (this.asyncNeeded) {                                  
	                        async.invoke(this._callFunction, this, promise);     
	                    } else {                                                 
	                        this._callFunction(promise);                         
	                    }                                                        
	                                                                             
	                }                                                            
	            };                                                               
	                                                                             
	            [TheName].prototype._resultCancelled = function() {              
	                [CancellationCode]                                           
	            };                                                               
	                                                                             
	            return [TheName];                                                
	        }(tryCatch, errorObj, Promise, async);                               
	        `;return M=M.replace(/\[TheName\]/g,A).replace(/\[TheTotal\]/g,m).replace(/\[ThePassedArguments\]/g,E).replace(/\[TheProperties\]/g,w).replace(/\[CancellationCode\]/g,T),new Function("tryCatch","errorObj","Promise","async",M)(l,c,n,i)},p=[],g=[],b=[],_=0;_<8;++_)p.push(f(_+1)),g.push(d(_+1)),b.push(h(_+1));u=function(m){this._reject(m)}}n.join=function(){var m=arguments.length-1,v;if(m>0&&typeof arguments[m]=="function"&&(v=arguments[m],m<=8&&o)){var C=new n(r);C._captureStackTrace();for(var x=p[m-1],w=new x(v),T=g,E=0;E<m;++E){var A=t(arguments[E],C);if(A instanceof n){A=A._target();var M=A._bitField;(M&50397184)===0?(A._then(T[E],u,void 0,C,w),b[E](A,w),w.asyncNeeded=!1):(M&33554432)!==0?T[E].call(C,A._value(),w):(M&16777216)!==0?C._reject(A._reason()):C._cancel()}else T[E].call(C,A,w)}if(!C._isFateSealed()){if(w.asyncNeeded){var F=s();F!==null&&(w.fn=a.domainBind(F,w.fn))}C._setAsyncGuaranteed(),C._setOnCancel(w)}return C}for(var G=arguments.length,S=new Array(G),I=0;I<G;++I)S[I]=arguments[I];v&&S.pop();var C=new e(S).promise();return v!==void 0?C.spread(v):C}}),J1}var ew,$S;function Hz(){return $S||($S=1,ew=function(n,e,t,r,i,s){var a=n._getDomain,o=On(),l=o.tryCatch,c=o.errorObj,u=n._async;function d(f,p,g,b){this.constructor$(f),this._promise._captureStackTrace();var _=a();this._callback=_===null?p:o.domainBind(_,p),this._preservedValues=b===i?new Array(this.length()):null,this._limit=g,this._inFlight=0,this._queue=[],u.invoke(this._asyncInit,this,void 0)}o.inherits(d,e),d.prototype._asyncInit=function(){this._init$(void 0,-2)},d.prototype._init=function(){},d.prototype._promiseFulfilled=function(f,p){var g=this._values,b=this.length(),_=this._preservedValues,m=this._limit;if(p<0){if(p=p*-1-1,g[p]=f,m>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(m>=1&&this._inFlight>=m)return g[p]=f,this._queue.push(p),!1;_!==null&&(_[p]=f);var v=this._promise,x=this._callback,w=v._boundValue();v._pushContext();var T=l(x).call(w,f,p,b),E=v._popContext();if(s.checkForgottenReturns(T,E,_!==null?"Promise.filter":"Promise.map",v),T===c)return this._reject(T.e),!0;var A=r(T,this._promise);if(A instanceof n){A=A._target();var M=A._bitField;if((M&50397184)===0)return m>=1&&this._inFlight++,g[p]=A,A._proxy(this,(p+1)*-1),!1;if((M&33554432)!==0)T=A._value();else return(M&16777216)!==0?(this._reject(A._reason()),!0):(this._cancel(),!0)}g[p]=T}var F=++this._totalResolved;return F>=b?(_!==null?this._filter(g,_):this._resolve(g),!0):!1},d.prototype._drainQueue=function(){for(var f=this._queue,p=this._limit,g=this._values;f.length>0&&this._inFlight<p;){if(this._isResolved())return;var b=f.pop();this._promiseFulfilled(g[b],b)}},d.prototype._filter=function(f,p){for(var g=p.length,b=new Array(g),_=0,m=0;m<g;++m)f[m]&&(b[_++]=p[m]);b.length=_,this._resolve(b)},d.prototype.preservedValues=function(){return this._preservedValues};function h(f,p,g,b){if(typeof p!="function")return t("expecting a function but got "+o.classString(p));var _=0;if(g!==void 0)if(typeof g=="object"&&g!==null){if(typeof g.concurrency!="number")return n.reject(new TypeError("'concurrency' must be a number but it is "+o.classString(g.concurrency)));_=g.concurrency}else return n.reject(new TypeError("options argument must be an object but it is "+o.classString(g)));return _=typeof _=="number"&&isFinite(_)&&_>=1?_:0,new d(f,p,_,b).promise()}n.prototype.map=function(f,p){return h(this,f,p,null)},n.map=function(f,p,g,b){return h(f,p,g,b)}}),ew}var tw,NS;function Kz(){if(NS)return tw;NS=1;var n=Object.create;if(n){var e=n(null),t=n(null);e[" size"]=t[" size"]=0}return tw=function(r){var i=On(),s=i.canEvaluate,a=i.isIdentifier,o,l;{var c=function(b){return new Function("ensureMethod",`                                    
	        return function(obj) {                                               
	            'use strict'                                                     
	            var len = this.length;                                           
	            ensureMethod(obj, 'methodName');                                 
	            switch(len) {                                                    
	                case 1: return obj.methodName(this[0]);                      
	                case 2: return obj.methodName(this[0], this[1]);             
	                case 3: return obj.methodName(this[0], this[1], this[2]);    
	                case 0: return obj.methodName();                             
	                default:                                                     
	                    return obj.methodName.apply(obj, this);                  
	            }                                                                
	        };                                                                   
	        `.replace(/methodName/g,b))(h)},u=function(b){return new Function("obj",`                                             
	        'use strict';                                                        
	        return obj.propertyName;                                             
	        `.replace("propertyName",b))},d=function(b,_,m){var v=m[b];if(typeof v!="function"){if(!a(b))return null;if(v=_(b),m[b]=v,m[" size"]++,m[" size"]>512){for(var x=Object.keys(m),w=0;w<256;++w)delete m[x[w]];m[" size"]=x.length-256}}return v};o=function(b){return d(b,c,e)},l=function(b){return d(b,u,t)}}function h(b,_){var m;if(b!=null&&(m=b[_]),typeof m!="function"){var v="Object "+i.classString(b)+" has no method '"+i.toString(_)+"'";throw new r.TypeError(v)}return m}function f(b){var _=this.pop(),m=h(b,_);return m.apply(b,this)}r.prototype.call=function(b){for(var _=arguments.length,m=new Array(Math.max(_-1,0)),v=1;v<_;++v)m[v-1]=arguments[v];if(s){var x=o(b);if(x!==null)return this._then(x,void 0,void 0,m,void 0)}return m.push(b),this._then(f,void 0,void 0,m,void 0)};function p(b){return b[this]}function g(b){var _=+this;return _<0&&(_=Math.max(0,_+b.length)),b[_]}r.prototype.get=function(b){var _=typeof b=="number",m;if(_)m=g;else if(s){var v=l(b);m=v!==null?v:p}else m=p;return this._then(m,void 0,void 0,b,void 0)}},tw}var nw,zS;function Xz(){return zS||(zS=1,nw=function(n,e,t,r,i,s){var a=On(),o=zl().TypeError,l=On().inherits,c=a.errorObj,u=a.tryCatch,d={};function h(v){setTimeout(function(){throw v},0)}function f(v){var x=t(v);return x!==v&&typeof v._isDisposable=="function"&&typeof v._getDisposer=="function"&&v._isDisposable()&&x._setDisposable(v._getDisposer()),x}function p(v,x){var w=0,T=v.length,E=new n(i);function A(){if(w>=T)return E._fulfill();var M=f(v[w++]);if(M instanceof n&&M._isDisposable()){try{M=t(M._getDisposer().tryDispose(x),v.promise)}catch(F){return h(F)}if(M instanceof n)return M._then(A,h,null,null,null)}A()}return A(),E}function g(v,x,w){this._data=v,this._promise=x,this._context=w}g.prototype.data=function(){return this._data},g.prototype.promise=function(){return this._promise},g.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():d},g.prototype.tryDispose=function(v){var x=this.resource(),w=this._context;w!==void 0&&w._pushContext();var T=x!==d?this.doDispose(x,v):null;return w!==void 0&&w._popContext(),this._promise._unsetDisposable(),this._data=null,T},g.isDisposer=function(v){return v!=null&&typeof v.resource=="function"&&typeof v.tryDispose=="function"};function b(v,x,w){this.constructor$(v,x,w)}l(b,g),b.prototype.doDispose=function(v,x){var w=this.data();return w.call(v,v,x)};function _(v){return g.isDisposer(v)?(this.resources[this.index]._setDisposable(v),v.promise()):v}function m(v){this.length=v,this.promise=null,this[v-1]=null}m.prototype._resultCancelled=function(){for(var v=this.length,x=0;x<v;++x){var w=this[x];w instanceof n&&w.cancel()}},n.using=function(){var v=arguments.length;if(v<2)return e("you must pass at least 2 arguments to Promise.using");var x=arguments[v-1];if(typeof x!="function")return e("expecting a function but got "+a.classString(x));var w,T=!0;v===2&&Array.isArray(arguments[0])?(w=arguments[0],v=w.length,T=!1):(w=arguments,v--);for(var E=new m(v),A=0;A<v;++A){var M=w[A];if(g.isDisposer(M)){var F=M;M=M.promise(),M._setDisposable(F)}else{var G=t(M);G instanceof n&&(M=G._then(_,null,null,{resources:E,index:A},void 0))}E[A]=M}for(var S=new Array(E.length),A=0;A<S.length;++A)S[A]=n.resolve(E[A]).reflect();var I=n.all(S).then(function(H){for(var B=0;B<H.length;++B){var $=H[B];if($.isRejected())return c.e=$.error(),c;if(!$.isFulfilled()){I.cancel();return}H[B]=$.value()}C._pushContext(),x=u(x);var X=T?x.apply(void 0,H):x(H),V=C._popContext();return s.checkForgottenReturns(X,V,"Promise.using",C),X}),C=I.lastly(function(){var H=new n.PromiseInspection(I);return p(E,H)});return E.promise=C,C._setOnCancel(E),C},n.prototype._setDisposable=function(v){this._bitField=this._bitField|131072,this._disposer=v},n.prototype._isDisposable=function(){return(this._bitField&131072)>0},n.prototype._getDisposer=function(){return this._disposer},n.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},n.prototype.disposer=function(v){if(typeof v=="function")return new b(v,this,r());throw new o}}),nw}var rw,WS;function Yz(){return WS||(WS=1,rw=function(n,e,t){var r=On(),i=n.TimeoutError;function s(d){this.handle=d}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(d){return o(+this).thenReturn(d)},o=n.delay=function(d,h){var f,p;return h!==void 0?(f=n.resolve(h)._then(a,null,null,d,void 0),t.cancellation()&&h instanceof n&&f._setOnCancel(h)):(f=new n(e),p=setTimeout(function(){f._fulfill()},+d),t.cancellation()&&f._setOnCancel(new s(p)),f._captureStackTrace()),f._setAsyncGuaranteed(),f};n.prototype.delay=function(d){return o(d,this)};var l=function(d,h,f){var p;typeof h!="string"?h instanceof Error?p=h:p=new i("operation timed out"):p=new i(h),r.markAsOriginatingFromRejection(p),d._attachExtraTrace(p),d._reject(p),f?.cancel()};function c(d){return clearTimeout(this.handle),d}function u(d){throw clearTimeout(this.handle),d}n.prototype.timeout=function(d,h){d=+d;var f,p,g=new s(setTimeout(function(){f.isPending()&&l(f,h,p)},d));return t.cancellation()?(p=this.then(),f=p._then(c,u,void 0,g,void 0),f._setOnCancel(g)):f=this._then(c,u,void 0,g,void 0),f}}),rw}var iw,jS;function Qz(){return jS||(jS=1,iw=function(n,e,t,r,i,s){var a=zl(),o=a.TypeError,l=On(),c=l.errorObj,u=l.tryCatch,d=[];function h(p,g,b){for(var _=0;_<g.length;++_){b._pushContext();var m=u(g[_])(p);if(b._popContext(),m===c){b._pushContext();var v=n.reject(c.e);return b._popContext(),v}var x=r(m,b);if(x instanceof n)return x}return null}function f(p,g,b,_){if(s.cancellation()){var m=new n(t),v=this._finallyPromise=new n(t);this._promise=m.lastly(function(){return v}),m._captureStackTrace(),m._setOnCancel(this)}else{var x=this._promise=new n(t);x._captureStackTrace()}this._stack=_,this._generatorFunction=p,this._receiver=g,this._generator=void 0,this._yieldHandlers=typeof b=="function"?[b].concat(d):d,this._yieldedPromise=null,this._cancellationPhase=!1}l.inherits(f,i),f.prototype._isResolved=function(){return this._promise===null},f.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&this._finallyPromise!==null&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},f.prototype._promiseCancelled=function(){if(!this._isResolved()){var p=typeof this._generator.return<"u",g;if(p)this._promise._pushContext(),g=u(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var b=new n.CancellationError("generator .return() sentinel");n.coroutine.returnSentinel=b,this._promise._attachExtraTrace(b),this._promise._pushContext(),g=u(this._generator.throw).call(this._generator,b),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(g)}},f.prototype._promiseFulfilled=function(p){this._yieldedPromise=null,this._promise._pushContext();var g=u(this._generator.next).call(this._generator,p);this._promise._popContext(),this._continue(g)},f.prototype._promiseRejected=function(p){this._yieldedPromise=null,this._promise._attachExtraTrace(p),this._promise._pushContext();var g=u(this._generator.throw).call(this._generator,p);this._promise._popContext(),this._continue(g)},f.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof n){var p=this._yieldedPromise;this._yieldedPromise=null,p.cancel()}},f.prototype.promise=function(){return this._promise},f.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},f.prototype._continue=function(p){var g=this._promise;if(p===c)return this._cleanup(),this._cancellationPhase?g.cancel():g._rejectCallback(p.e,!1);var b=p.value;if(p.done===!0)return this._cleanup(),this._cancellationPhase?g.cancel():g._resolveCallback(b);var _=r(b,this._promise);if(!(_ instanceof n)&&(_=h(_,this._yieldHandlers,this._promise),_===null)){this._promiseRejected(new o(`A value %s was yielded that could not be treated as a promise

    See http://goo.gl/MqrFmX

`.replace("%s",b)+`From coroutine:
`+this._stack.split(`
`).slice(1,-7).join(`
`)));return}_=_._target();var m=_._bitField;(m&50397184)===0?(this._yieldedPromise=_,_._proxy(this,null)):(m&33554432)!==0?n._async.invoke(this._promiseFulfilled,this,_._value()):(m&16777216)!==0?n._async.invoke(this._promiseRejected,this,_._reason()):this._promiseCancelled()},n.coroutine=function(p,g){if(typeof p!="function")throw new o(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var b=Object(g).yieldHandler,_=f,m=new Error().stack;return function(){var v=p.apply(this,arguments),x=new _(void 0,void 0,b,m),w=x.promise();return x._generator=v,x._promiseFulfilled(void 0),w}},n.coroutine.addYieldHandler=function(p){if(typeof p!="function")throw new o("expecting a function but got "+l.classString(p));d.push(p)},n.spawn=function(p){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),typeof p!="function")return e(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var g=new f(p,this),b=g.promise();return g._run(n.spawn),b}}),iw}var sw,VS;function Zz(){return VS||(VS=1,sw=function(n){var e=On(),t=n._async,r=e.tryCatch,i=e.errorObj;function s(l,c){var u=this;if(!e.isArray(l))return a.call(u,l,c);var d=r(c).apply(u._boundValue(),[null].concat(l));d===i&&t.throwLater(d.e)}function a(l,c){var u=this,d=u._boundValue(),h=l===void 0?r(c).call(d,null):r(c).call(d,null,l);h===i&&t.throwLater(h.e)}function o(l,c){var u=this;if(!l){var d=new Error(l+"");d.cause=l,l=d}var h=r(c).call(u._boundValue(),l);h===i&&t.throwLater(h.e)}n.prototype.asCallback=n.prototype.nodeify=function(l,c){if(typeof l=="function"){var u=a;c!==void 0&&Object(c).spread&&(u=s),this._then(u,o,void 0,this,l)}return this}}),sw}var aw,GS;function Jz(){return GS||(GS=1,aw=function(n,e){var t={},r=On(),i=zL(),s=r.withAppended,a=r.maybeWrapAsError,o=r.canEvaluate,l=zl().TypeError,c="Async",u={__isPromisified__:!0},d=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],h=new RegExp("^(?:"+d.join("|")+")$"),f=function(I){return r.isIdentifier(I)&&I.charAt(0)!=="_"&&I!=="constructor"};function p(I){return!h.test(I)}function g(I){try{return I.__isPromisified__===!0}catch{return!1}}function b(I,C,H){var B=r.getDataPropertyOrDefault(I,C+H,u);return B?g(B):!1}function _(I,C,H){for(var B=0;B<I.length;B+=2){var $=I[B];if(H.test($)){for(var X=$.replace(H,""),V=0;V<I.length;V+=2)if(I[V]===X)throw new l(`Cannot promisify an API that has normal methods with '%s'-suffix

    See http://goo.gl/MqrFmX
`.replace("%s",C))}}}function m(I,C,H,B){for(var $=r.inheritedDataKeys(I),X=[],V=0;V<$.length;++V){var Q=$[V],R=I[Q],O=B===f?!0:f(Q);typeof R=="function"&&!g(R)&&!b(I,Q,C)&&B(Q,R,I,O)&&X.push(Q,R)}return _(X,C,H),X}var v=function(I){return I.replace(/([$])/,"\\$")},x;{var w=function(I){for(var C=[I],H=Math.max(0,I-1-3),B=I-1;B>=H;--B)C.push(B);for(var B=I+1;B<=3;++B)C.push(B);return C},T=function(I){return r.filledRange(I,"_arg","")},E=function(I){return r.filledRange(Math.max(I,3),"_arg","")},A=function(I){return typeof I.length=="number"?Math.max(Math.min(I.length,1024),0):0};x=function(I,C,H,B,$,X){var V=Math.max(0,A(B)-1),Q=w(V),R=typeof I=="string"||C===t;function O(we){var be=T(we).join(", "),Ee=we>0?", ":"",Fe;return R?Fe=`ret = callback.call(this, {{args}}, nodeback); break;
`:Fe=C===void 0?`ret = callback({{args}}, nodeback); break;
`:`ret = callback.call(receiver, {{args}}, nodeback); break;
`,Fe.replace("{{args}}",be).replace(", ",Ee)}function L(){for(var we="",be=0;be<Q.length;++be)we+="case "+Q[be]+":"+O(Q[be]);return we+=`                                                             
	        default:                                                             
	            var args = new Array(len + 1);                                   
	            var i = 0;                                                       
	            for (var i = 0; i < len; ++i) {                                  
	               args[i] = arguments[i];                                       
	            }                                                                
	            args[i] = nodeback;                                              
	            [CodeForCall]                                                    
	            break;                                                           
	        `.replace("[CodeForCall]",R?`ret = callback.apply(this, args);
`:`ret = callback.apply(receiver, args);
`),we}var ne=typeof I=="string"?"this != null ? this['"+I+"'] : fn":"fn",de=`'use strict';                                                
	        var ret = function (Parameters) {                                    
	            'use strict';                                                    
	            var len = arguments.length;                                      
	            var promise = new Promise(INTERNAL);                             
	            promise._captureStackTrace();                                    
	            var nodeback = nodebackForPromise(promise, `+X+`);   
	            var ret;                                                         
	            var callback = tryCatch([GetFunctionCode]);                      
	            switch(len) {                                                    
	                [CodeForSwitchCase]                                          
	            }                                                                
	            if (ret === errorObj) {                                          
	                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);
	            }                                                                
	            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     
	            return promise;                                                  
	        };                                                                   
	        notEnumerableProp(ret, '__isPromisified__', true);                   
	        return ret;                                                          
	    `.replace("[CodeForSwitchCase]",L()).replace("[GetFunctionCode]",ne);return de=de.replace("Parameters",E(V)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",de)(n,B,C,s,a,i,r.tryCatch,r.errorObj,r.notEnumerableProp,e)}}function M(I,C,H,B,$,X){var V=function(){return this}(),Q=I;typeof Q=="string"&&(I=B);function R(){var O=C;C===t&&(O=this);var L=new n(e);L._captureStackTrace();var ne=typeof Q=="string"&&this!==V?this[Q]:I,de=i(L,X);try{ne.apply(O,s(arguments,de))}catch(we){L._rejectCallback(a(we),!0,!0)}return L._isFateSealed()||L._setAsyncGuaranteed(),L}return r.notEnumerableProp(R,"__isPromisified__",!0),R}var F=o?x:M;function G(I,C,H,B,$){for(var X=new RegExp(v(C)+"$"),V=m(I,C,X,H),Q=0,R=V.length;Q<R;Q+=2){var O=V[Q],L=V[Q+1],ne=O+C;if(B===F)I[ne]=F(O,t,O,L,C,$);else{var de=B(L,function(){return F(O,t,O,L,C,$)});r.notEnumerableProp(de,"__isPromisified__",!0),I[ne]=de}}return r.toFastProperties(I),I}function S(I,C,H){return F(I,C,void 0,I,null,H)}n.promisify=function(I,C){if(typeof I!="function")throw new l("expecting a function but got "+r.classString(I));if(g(I))return I;C=Object(C);var H=C.context===void 0?t:C.context,B=!!C.multiArgs,$=S(I,H,B);return r.copyDescriptors(I,$,p),$},n.promisifyAll=function(I,C){if(typeof I!="function"&&typeof I!="object")throw new l(`the target of promisifyAll must be an object or a function

    See http://goo.gl/MqrFmX
`);C=Object(C);var H=!!C.multiArgs,B=C.suffix;typeof B!="string"&&(B=c);var $=C.filter;typeof $!="function"&&($=f);var X=C.promisifier;if(typeof X!="function"&&(X=F),!r.isIdentifier(B))throw new RangeError(`suffix must be a valid identifier

    See http://goo.gl/MqrFmX
`);for(var V=r.inheritedDataKeys(I),Q=0;Q<V.length;++Q){var R=I[V[Q]];V[Q]!=="constructor"&&r.isClass(R)&&(G(R.prototype,B,$,X,H),G(R,B,$,X,H))}return G(I,B,$,X,H)}}),aw}var ow,qS;function e6(){return qS||(qS=1,ow=function(n,e,t,r){var i=On(),s=i.isObject,a=vf(),o;typeof Map=="function"&&(o=Map);var l=function(){var h=0,f=0;function p(g,b){this[h]=g,this[h+f]=b,h++}return function(b){f=b.size,h=0;var _=new Array(b.size*2);return b.forEach(p,_),_}}(),c=function(h){for(var f=new o,p=h.length/2|0,g=0;g<p;++g){var b=h[p+g],_=h[g];f.set(b,_)}return f};function u(h){var f=!1,p;if(o!==void 0&&h instanceof o)p=l(h),f=!0;else{var g=a.keys(h),b=g.length;p=new Array(b*2);for(var _=0;_<b;++_){var m=g[_];p[_]=h[m],p[_+b]=m}}this.constructor$(p),this._isMap=f,this._init$(void 0,-3)}i.inherits(u,e),u.prototype._init=function(){},u.prototype._promiseFulfilled=function(h,f){this._values[f]=h;var p=++this._totalResolved;if(p>=this._length){var g;if(this._isMap)g=c(this._values);else{g={};for(var b=this.length(),_=0,m=this.length();_<m;++_)g[this._values[_+b]]=this._values[_]}return this._resolve(g),!0}return!1},u.prototype.shouldCopyValues=function(){return!1},u.prototype.getActualLength=function(h){return h>>1};function d(h){var f,p=t(h);if(s(p))p instanceof n?f=p._then(n.props,void 0,void 0,void 0,void 0):f=new u(p).promise();else return r(`cannot await properties of a non-object

    See http://goo.gl/MqrFmX
`);return p instanceof n&&f._propagateFrom(p,2),f}n.prototype.props=function(){return d(this)},n.props=function(h){return d(h)}}),ow}var lw,HS;function t6(){return HS||(HS=1,lw=function(n,e,t,r){var i=On(),s=function(o){return o.then(function(l){return a(l,o)})};function a(o,l){var c=t(o);if(c instanceof n)return s(c);if(o=i.asArray(o),o===null)return r("expecting an array or an iterable object but got "+i.classString(o));var u=new n(e);l!==void 0&&u._propagateFrom(l,3);for(var d=u._fulfill,h=u._reject,f=0,p=o.length;f<p;++f){var g=o[f];g===void 0&&!(f in o)||n.cast(g)._then(d,h,void 0,u,null)}return u}n.race=function(o){return a(o,void 0)},n.prototype.race=function(){return a(this,void 0)}}),lw}var cw,KS;function n6(){return KS||(KS=1,cw=function(n,e,t,r,i,s){var a=n._getDomain,o=On(),l=o.tryCatch;function c(p,g,b,_){this.constructor$(p);var m=a();this._fn=m===null?g:o.domainBind(m,g),b!==void 0&&(b=n.resolve(b),b._attachCancellationCallback(this)),this._initialValue=b,this._currentCancellable=null,_===i?this._eachValues=Array(this._length):_===0?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}o.inherits(c,e),c.prototype._gotAccum=function(p){this._eachValues!==void 0&&this._eachValues!==null&&p!==i&&this._eachValues.push(p)},c.prototype._eachComplete=function(p){return this._eachValues!==null&&this._eachValues.push(p),this._eachValues},c.prototype._init=function(){},c.prototype._resolveEmptyArray=function(){this._resolve(this._eachValues!==void 0?this._eachValues:this._initialValue)},c.prototype.shouldCopyValues=function(){return!1},c.prototype._resolve=function(p){this._promise._resolveCallback(p),this._values=null},c.prototype._resultCancelled=function(p){if(p===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof n&&this._currentCancellable.cancel(),this._initialValue instanceof n&&this._initialValue.cancel())},c.prototype._iterate=function(p){this._values=p;var g,b,_=p.length;if(this._initialValue!==void 0?(g=this._initialValue,b=0):(g=n.resolve(p[0]),b=1),this._currentCancellable=g,!g.isRejected())for(;b<_;++b){var m={accum:null,value:p[b],index:b,length:_,array:this};g=g._then(h,void 0,void 0,m,void 0)}this._eachValues!==void 0&&(g=g._then(this._eachComplete,void 0,void 0,this,void 0)),g._then(u,u,void 0,g,this)},n.prototype.reduce=function(p,g){return d(this,p,g,null)},n.reduce=function(p,g,b,_){return d(p,g,b,_)};function u(p,g){this.isFulfilled()?g._resolve(p):g._reject(p)}function d(p,g,b,_){if(typeof g!="function")return t("expecting a function but got "+o.classString(g));var m=new c(p,g,b,_);return m.promise()}function h(p){this.accum=p,this.array._gotAccum(p);var g=r(this.value,this.array._promise);return g instanceof n?(this.array._currentCancellable=g,g._then(f,void 0,void 0,this,void 0)):f.call(this,g)}function f(p){var g=this.array,b=g._promise,_=l(g._fn);b._pushContext();var m;g._eachValues!==void 0?m=_.call(b._boundValue(),p,this.index,this.length):m=_.call(b._boundValue(),this.accum,p,this.index,this.length),m instanceof n&&(g._currentCancellable=m);var v=b._popContext();return s.checkForgottenReturns(m,v,g._eachValues!==void 0?"Promise.each":"Promise.reduce",b),m}}),cw}var uw,XS;function r6(){return XS||(XS=1,uw=function(n,e,t){var r=n.PromiseInspection,i=On();function s(a){this.constructor$(a)}i.inherits(s,e),s.prototype._promiseResolved=function(a,o){this._values[a]=o;var l=++this._totalResolved;return l>=this._length?(this._resolve(this._values),!0):!1},s.prototype._promiseFulfilled=function(a,o){var l=new r;return l._bitField=33554432,l._settledValueField=a,this._promiseResolved(o,l)},s.prototype._promiseRejected=function(a,o){var l=new r;return l._bitField=16777216,l._settledValueField=a,this._promiseResolved(o,l)},n.settle=function(a){return t.deprecated(".settle()",".reflect()"),new s(a).promise()},n.prototype.settle=function(){return n.settle(this)}}),uw}var dw,YS;function i6(){return YS||(YS=1,dw=function(n,e,t){var r=On(),i=zl().RangeError,s=zl().AggregateError,a=r.isArray,o={};function l(u){this.constructor$(u),this._howMany=0,this._unwrap=!1,this._initialized=!1}r.inherits(l,e),l.prototype._init=function(){if(this._initialized){if(this._howMany===0){this._resolve([]);return}this._init$(void 0,-5);var u=a(this._values);!this._isResolved()&&u&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},l.prototype.init=function(){this._initialized=!0,this._init()},l.prototype.setUnwrap=function(){this._unwrap=!0},l.prototype.howMany=function(){return this._howMany},l.prototype.setHowMany=function(u){this._howMany=u},l.prototype._promiseFulfilled=function(u){return this._addFulfilled(u),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},l.prototype._promiseRejected=function(u){return this._addRejected(u),this._checkOutcome()},l.prototype._promiseCancelled=function(){return this._values instanceof n||this._values==null?this._cancel():(this._addRejected(o),this._checkOutcome())},l.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var u=new s,d=this.length();d<this._values.length;++d)this._values[d]!==o&&u.push(this._values[d]);return u.length>0?this._reject(u):this._cancel(),!0}return!1},l.prototype._fulfilled=function(){return this._totalResolved},l.prototype._rejected=function(){return this._values.length-this.length()},l.prototype._addRejected=function(u){this._values.push(u)},l.prototype._addFulfilled=function(u){this._values[this._totalResolved++]=u},l.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},l.prototype._getRangeError=function(u){var d="Input array must contain at least "+this._howMany+" items but contains only "+u+" items";return new i(d)},l.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};function c(u,d){if((d|0)!==d||d<0)return t(`expecting a positive integer

    See http://goo.gl/MqrFmX
`);var h=new l(u),f=h.promise();return h.setHowMany(d),h.init(),f}n.some=function(u,d){return c(u,d)},n.prototype.some=function(u){return c(this,u)},n._SomePromiseArray=l}),dw}var hw,QS;function s6(){return QS||(QS=1,hw=function(n,e){var t=n.map;n.prototype.filter=function(r,i){return t(this,r,i,e)},n.filter=function(r,i,s){return t(r,i,s,e)}}),hw}var fw,ZS;function a6(){return ZS||(ZS=1,fw=function(n,e){var t=n.reduce,r=n.all;function i(){return r(this)}function s(a,o){return t(a,o,e,e)}n.prototype.each=function(a){return t(this,a,e,0)._then(i,void 0,void 0,this,void 0)},n.prototype.mapSeries=function(a){return t(this,a,e,e)},n.each=function(a,o){return t(a,o,e,0)._then(i,void 0,void 0,a,void 0)},n.mapSeries=s}),fw}var pw,JS;function o6(){return JS||(JS=1,pw=function(n){var e=n._SomePromiseArray;function t(r){var i=new e(r),s=i.promise();return i.setHowMany(1),i.setUnwrap(),i.init(),s}n.any=function(r){return t(r)},n.prototype.any=function(){return t(this)}}),pw}var eP;function l6(){return eP||(eP=1,function(n){n.exports=function(){var e=function(){return new h(`circular promise resolution chain

    See http://goo.gl/MqrFmX
`)},t=function(){return new S.PromiseInspection(this._target())},r=function(B){return S.reject(new h(B))};function i(){}var s={},a=On(),o;a.isNode?o=function(){var B=process.domain;return B===void 0&&(B=null),B}:o=function(){return null},a.notEnumerableProp(S,"_getDomain",o);var l=vf(),c=Oz(),u=new c;l.defineProperty(S,"_async",{value:u});var d=zl(),h=S.TypeError=d.TypeError;S.RangeError=d.RangeError;var f=S.CancellationError=d.CancellationError;S.TimeoutError=d.TimeoutError,S.OperationalError=d.OperationalError,S.RejectionError=d.OperationalError,S.AggregateError=d.AggregateError;var p=function(){},g={},b={},_=Uz()(S,p),m=Lz()(S,p,_,r,i),v=Rz()(S),x=v.create,w=Bz()(S,v);w.CapturedTrace;var T=$z()(S,_),E=Nz()(b),A=zL(),M=a.errorObj,F=a.tryCatch;function G(B,$){if(typeof $!="function")throw new h("expecting a function but got "+a.classString($));if(B.constructor!==S)throw new h(`the promise constructor cannot be invoked directly

    See http://goo.gl/MqrFmX
`)}function S(B){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,B!==p&&(G(this,B),this._resolveFromExecutor(B)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}S.prototype.toString=function(){return"[object Promise]"},S.prototype.caught=S.prototype.catch=function(B){var $=arguments.length;if($>1){var X=new Array($-1),V=0,Q;for(Q=0;Q<$-1;++Q){var R=arguments[Q];if(a.isObject(R))X[V++]=R;else return r("expecting an object but got A catch statement predicate "+a.classString(R))}return X.length=V,B=arguments[Q],this.then(void 0,E(X,B,this))}return this.then(void 0,B)},S.prototype.reflect=function(){return this._then(t,t,void 0,this,void 0)},S.prototype.then=function(B,$){if(w.warnings()&&arguments.length>0&&typeof B!="function"&&typeof $!="function"){var X=".then() only accepts functions but was passed: "+a.classString(B);arguments.length>1&&(X+=", "+a.classString($)),this._warn(X)}return this._then(B,$,void 0,void 0,void 0)},S.prototype.done=function(B,$){var X=this._then(B,$,void 0,void 0,void 0);X._setIsFinal()},S.prototype.spread=function(B){return typeof B!="function"?r("expecting a function but got "+a.classString(B)):this.all()._then(B,void 0,void 0,g,void 0)},S.prototype.toJSON=function(){var B={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(B.fulfillmentValue=this.value(),B.isFulfilled=!0):this.isRejected()&&(B.rejectionReason=this.reason(),B.isRejected=!0),B},S.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new m(this).promise()},S.prototype.error=function(B){return this.caught(a.originatesFromRejection,B)},S.getNewLibraryCopy=n.exports,S.is=function(B){return B instanceof S},S.fromNode=S.fromCallback=function(B){var $=new S(p);$._captureStackTrace();var X=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,V=F(B)(A($,X));return V===M&&$._rejectCallback(V.e,!0),$._isFateSealed()||$._setAsyncGuaranteed(),$},S.all=function(B){return new m(B).promise()},S.cast=function(B){var $=_(B);return $ instanceof S||($=new S(p),$._captureStackTrace(),$._setFulfilled(),$._rejectionHandler0=B),$},S.resolve=S.fulfilled=S.cast,S.reject=S.rejected=function(B){var $=new S(p);return $._captureStackTrace(),$._rejectCallback(B,!0),$},S.setScheduler=function(B){if(typeof B!="function")throw new h("expecting a function but got "+a.classString(B));return u.setScheduler(B)},S.prototype._then=function(B,$,X,V,Q){var R=Q!==void 0,O=R?Q:new S(p),L=this._target(),ne=L._bitField;R||(O._propagateFrom(this,3),O._captureStackTrace(),V===void 0&&(this._bitField&2097152)!==0&&((ne&50397184)!==0?V=this._boundValue():V=L===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,O));var de=o();if((ne&50397184)!==0){var we,be,Ee=L._settlePromiseCtx;(ne&33554432)!==0?(be=L._rejectionHandler0,we=B):(ne&16777216)!==0?(be=L._fulfillmentHandler0,we=$,L._unsetRejectionIsUnhandled()):(Ee=L._settlePromiseLateCancellationObserver,be=new f("late cancellation observer"),L._attachExtraTrace(be),we=$),u.invoke(Ee,L,{handler:de===null?we:typeof we=="function"&&a.domainBind(de,we),promise:O,receiver:V,value:be})}else L._addCallbacks(B,$,O,V,de);return O},S.prototype._length=function(){return this._bitField&65535},S.prototype._isFateSealed=function(){return(this._bitField&117506048)!==0},S.prototype._isFollowing=function(){return(this._bitField&67108864)===67108864},S.prototype._setLength=function(B){this._bitField=this._bitField&-65536|B&65535},S.prototype._setFulfilled=function(){this._bitField=this._bitField|33554432,this._fireEvent("promiseFulfilled",this)},S.prototype._setRejected=function(){this._bitField=this._bitField|16777216,this._fireEvent("promiseRejected",this)},S.prototype._setFollowing=function(){this._bitField=this._bitField|67108864,this._fireEvent("promiseResolved",this)},S.prototype._setIsFinal=function(){this._bitField=this._bitField|4194304},S.prototype._isFinal=function(){return(this._bitField&4194304)>0},S.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},S.prototype._setCancelled=function(){this._bitField=this._bitField|65536,this._fireEvent("promiseCancelled",this)},S.prototype._setWillBeCancelled=function(){this._bitField=this._bitField|8388608},S.prototype._setAsyncGuaranteed=function(){u.hasCustomScheduler()||(this._bitField=this._bitField|134217728)},S.prototype._receiverAt=function(B){var $=B===0?this._receiver0:this[B*4-4+3];if($!==s)return $===void 0&&this._isBound()?this._boundValue():$},S.prototype._promiseAt=function(B){return this[B*4-4+2]},S.prototype._fulfillmentHandlerAt=function(B){return this[B*4-4+0]},S.prototype._rejectionHandlerAt=function(B){return this[B*4-4+1]},S.prototype._boundValue=function(){},S.prototype._migrateCallback0=function(B){B._bitField;var $=B._fulfillmentHandler0,X=B._rejectionHandler0,V=B._promise0,Q=B._receiverAt(0);Q===void 0&&(Q=s),this._addCallbacks($,X,V,Q,null)},S.prototype._migrateCallbackAt=function(B,$){var X=B._fulfillmentHandlerAt($),V=B._rejectionHandlerAt($),Q=B._promiseAt($),R=B._receiverAt($);R===void 0&&(R=s),this._addCallbacks(X,V,Q,R,null)},S.prototype._addCallbacks=function(B,$,X,V,Q){var R=this._length();if(R>=65531&&(R=0,this._setLength(0)),R===0)this._promise0=X,this._receiver0=V,typeof B=="function"&&(this._fulfillmentHandler0=Q===null?B:a.domainBind(Q,B)),typeof $=="function"&&(this._rejectionHandler0=Q===null?$:a.domainBind(Q,$));else{var O=R*4-4;this[O+2]=X,this[O+3]=V,typeof B=="function"&&(this[O+0]=Q===null?B:a.domainBind(Q,B)),typeof $=="function"&&(this[O+1]=Q===null?$:a.domainBind(Q,$))}return this._setLength(R+1),R},S.prototype._proxy=function(B,$){this._addCallbacks(void 0,void 0,$,B,null)},S.prototype._resolveCallback=function(B,$){if((this._bitField&117506048)===0){if(B===this)return this._rejectCallback(e(),!1);var X=_(B,this);if(!(X instanceof S))return this._fulfill(B);$&&this._propagateFrom(X,2);var V=X._target();if(V===this){this._reject(e());return}var Q=V._bitField;if((Q&50397184)===0){var R=this._length();R>0&&V._migrateCallback0(this);for(var O=1;O<R;++O)V._migrateCallbackAt(this,O);this._setFollowing(),this._setLength(0),this._setFollowee(V)}else if((Q&33554432)!==0)this._fulfill(V._value());else if((Q&16777216)!==0)this._reject(V._reason());else{var L=new f("late cancellation observer");V._attachExtraTrace(L),this._reject(L)}}},S.prototype._rejectCallback=function(B,$,X){var V=a.ensureErrorObject(B),Q=V===B;if(!Q&&!X&&w.warnings()){var R="a promise was rejected with a non-error: "+a.classString(B);this._warn(R,!0)}this._attachExtraTrace(V,$?Q:!1),this._reject(B)},S.prototype._resolveFromExecutor=function(B){var $=this;this._captureStackTrace(),this._pushContext();var X=!0,V=this._execute(B,function(Q){$._resolveCallback(Q)},function(Q){$._rejectCallback(Q,X)});X=!1,this._popContext(),V!==void 0&&$._rejectCallback(V,!0)},S.prototype._settlePromiseFromHandler=function(B,$,X,V){var Q=V._bitField;if((Q&65536)===0){V._pushContext();var R;$===g?!X||typeof X.length!="number"?(R=M,R.e=new h("cannot .spread() a non-array: "+a.classString(X))):R=F(B).apply(this._boundValue(),X):R=F(B).call($,X);var O=V._popContext();Q=V._bitField,(Q&65536)===0&&(R===b?V._reject(X):R===M?V._rejectCallback(R.e,!1):(w.checkForgottenReturns(R,O,"",V,this),V._resolveCallback(R)))}},S.prototype._target=function(){for(var B=this;B._isFollowing();)B=B._followee();return B},S.prototype._followee=function(){return this._rejectionHandler0},S.prototype._setFollowee=function(B){this._rejectionHandler0=B},S.prototype._settlePromise=function(B,$,X,V){var Q=B instanceof S,R=this._bitField,O=(R&134217728)!==0;(R&65536)!==0?(Q&&B._invokeInternalOnCancel(),X instanceof T&&X.isFinallyHandler()?(X.cancelPromise=B,F($).call(X,V)===M&&B._reject(M.e)):$===t?B._fulfill(t.call(X)):X instanceof i?X._promiseCancelled(B):Q||B instanceof m?B._cancel():X.cancel()):typeof $=="function"?Q?(O&&B._setAsyncGuaranteed(),this._settlePromiseFromHandler($,X,V,B)):$.call(X,V,B):X instanceof i?X._isResolved()||((R&33554432)!==0?X._promiseFulfilled(V,B):X._promiseRejected(V,B)):Q&&(O&&B._setAsyncGuaranteed(),(R&33554432)!==0?B._fulfill(V):B._reject(V))},S.prototype._settlePromiseLateCancellationObserver=function(B){var $=B.handler,X=B.promise,V=B.receiver,Q=B.value;typeof $=="function"?X instanceof S?this._settlePromiseFromHandler($,V,Q,X):$.call(V,Q,X):X instanceof S&&X._reject(Q)},S.prototype._settlePromiseCtx=function(B){this._settlePromise(B.promise,B.handler,B.receiver,B.value)},S.prototype._settlePromise0=function(B,$,X){var V=this._promise0,Q=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(V,B,Q,$)},S.prototype._clearCallbackDataAtIndex=function(B){var $=B*4-4;this[$+2]=this[$+3]=this[$+0]=this[$+1]=void 0},S.prototype._fulfill=function(B){var $=this._bitField;if(!(($&117506048)>>>16)){if(B===this){var X=e();return this._attachExtraTrace(X),this._reject(X)}this._setFulfilled(),this._rejectionHandler0=B,($&65535)>0&&(($&134217728)!==0?this._settlePromises():u.settlePromises(this))}},S.prototype._reject=function(B){var $=this._bitField;if(!(($&117506048)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=B,this._isFinal())return u.fatalError(B,a.isNode);($&65535)>0?u.settlePromises(this):this._ensurePossibleRejectionHandled()}},S.prototype._fulfillPromises=function(B,$){for(var X=1;X<B;X++){var V=this._fulfillmentHandlerAt(X),Q=this._promiseAt(X),R=this._receiverAt(X);this._clearCallbackDataAtIndex(X),this._settlePromise(Q,V,R,$)}},S.prototype._rejectPromises=function(B,$){for(var X=1;X<B;X++){var V=this._rejectionHandlerAt(X),Q=this._promiseAt(X),R=this._receiverAt(X);this._clearCallbackDataAtIndex(X),this._settlePromise(Q,V,R,$)}},S.prototype._settlePromises=function(){var B=this._bitField,$=B&65535;if($>0){if((B&16842752)!==0){var X=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,X,B),this._rejectPromises($,X)}else{var V=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,V,B),this._fulfillPromises($,V)}this._setLength(0)}this._clearCancellationData()},S.prototype._settledValue=function(){var B=this._bitField;if((B&33554432)!==0)return this._rejectionHandler0;if((B&16777216)!==0)return this._fulfillmentHandler0};function I(B){this.promise._resolveCallback(B)}function C(B){this.promise._rejectCallback(B,!1)}S.defer=S.pending=function(){w.deprecated("Promise.defer","new Promise");var B=new S(p);return{promise:B,resolve:I,reject:C}},a.notEnumerableProp(S,"_makeSelfResolutionError",e),zz()(S,p,_,r,w),Wz()(S,p,_,w),jz()(S,m,r,w),Vz()(S),Gz()(S),qz()(S,m,_,p,u,o),S.Promise=S,S.version="3.4.7",Hz()(S,m,r,_,p,w),Kz()(S),Xz()(S,r,_,x,p,w),Yz()(S,p,w),Qz()(S,r,p,_,i,w),Zz()(S),Jz()(S,p),e6()(S,m,_,r),t6()(S,p,_,r),n6()(S,m,r,_,p,w),r6()(S,m,w),i6()(S,m,r),s6()(S,p),a6()(S,p),o6()(S),a.toFastProperties(S),a.toFastProperties(S.prototype);function H(B){var $=new S(p);$._fulfillmentHandler0=B,$._rejectionHandler0=B,$._promise0=B,$._receiver0=B}return H({a:1}),H({b:2}),H({c:3}),H(1),H(function(){}),H(void 0),H(!1),H(new S(p)),w.setBounds(c.firstLineError,a.lastLineError),S}}(R1)),R1.exports}var tP;function Xl(){if(tP)return ys;tP=1;var n=cr,e=l6()();ys.defer=t,ys.when=e.resolve,ys.resolve=e.resolve,ys.all=e.all,ys.props=e.props,ys.reject=e.reject,ys.promisify=e.promisify,ys.mapSeries=e.mapSeries,ys.attempt=e.attempt,ys.nfcall=function(r){var i=Array.prototype.slice.call(arguments,1),s=e.promisify(r);return s.apply(null,i)},e.prototype.fail=e.prototype.caught,e.prototype.also=function(r){return this.then(function(i){var s=n.extend({},i,r(i));return e.props(s)})};function t(){var r,i,s=new e.Promise(function(a,o){r=a,i=o});return{resolve:r,reject:i,promise:s}}return ys}var fn={},nP;function td(){if(nP)return fn;nP=1;var n=cr,e=fn.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",checkbox:"checkbox",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function t(T,E){return E=E||{},{type:e.document,children:T,notes:E.notes||new d({}),comments:E.comments||[]}}function r(T,E){E=E||{};var A=E.indent||{};return{type:e.paragraph,children:T,styleId:E.styleId||null,styleName:E.styleName||null,numbering:E.numbering||null,alignment:E.alignment||null,indent:{start:A.start||null,end:A.end||null,firstLine:A.firstLine||null,hanging:A.hanging||null}}}function i(T,E){return E=E||{},{type:e.run,children:T,styleId:E.styleId||null,styleName:E.styleName||null,isBold:!!E.isBold,isUnderline:!!E.isUnderline,isItalic:!!E.isItalic,isStrikethrough:!!E.isStrikethrough,isAllCaps:!!E.isAllCaps,isSmallCaps:!!E.isSmallCaps,verticalAlignment:E.verticalAlignment||s.baseline,font:E.font||null,fontSize:E.fontSize||null,highlight:E.highlight||null}}var s={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function a(T){return{type:e.text,value:T}}function o(){return{type:e.tab}}function l(T){return{type:e.checkbox,checked:T.checked}}function c(T,E){return{type:e.hyperlink,children:T,href:E.href,anchor:E.anchor,targetFrame:E.targetFrame}}function u(T){return{type:e.noteReference,noteType:T.noteType,noteId:T.noteId}}function d(T){this._notes=n.indexBy(T,function(E){return g(E.noteType,E.noteId)})}d.prototype.resolve=function(T){return this.findNoteByKey(g(T.noteType,T.noteId))},d.prototype.findNoteByKey=function(T){return this._notes[T]||null};function h(T){return{type:e.note,noteType:T.noteType,noteId:T.noteId,body:T.body}}function f(T){return{type:e.commentReference,commentId:T.commentId}}function p(T){return{type:e.comment,commentId:T.commentId,body:T.body,authorName:T.authorName,authorInitials:T.authorInitials}}function g(T,E){return T+"-"+E}function b(T){return{type:e.image,read:function(E){return E?T.readImage(E):T.readImage().then(function(A){return Buffer.from(A)})},readAsArrayBuffer:function(){return T.readImage()},readAsBase64String:function(){return T.readImage("base64")},readAsBuffer:function(){return T.readImage().then(function(E){return Buffer.from(E)})},altText:T.altText,contentType:T.contentType}}function _(T,E){return E=E||{},{type:e.table,children:T,styleId:E.styleId||null,styleName:E.styleName||null}}function m(T,E){return E=E||{},{type:e.tableRow,children:T,isHeader:E.isHeader||!1}}function v(T,E){return E=E||{},{type:e.tableCell,children:T,colSpan:E.colSpan==null?1:E.colSpan,rowSpan:E.rowSpan==null?1:E.rowSpan}}function x(T){return{type:e.break,breakType:T}}function w(T){return{type:e.bookmarkStart,name:T.name}}return fn.document=fn.Document=t,fn.paragraph=fn.Paragraph=r,fn.run=fn.Run=i,fn.text=fn.Text=a,fn.tab=fn.Tab=o,fn.checkbox=fn.Checkbox=l,fn.Hyperlink=c,fn.noteReference=fn.NoteReference=u,fn.Notes=d,fn.Note=h,fn.commentReference=f,fn.comment=p,fn.Image=b,fn.Table=_,fn.TableRow=m,fn.TableCell=v,fn.lineBreak=x("line"),fn.pageBreak=x("page"),fn.columnBreak=x("column"),fn.BookmarkStart=w,fn.verticalAlignment=s,fn}var Nd={},rP;function Fo(){if(rP)return Nd;rP=1;var n=cr;Nd.Result=e,Nd.success=t,Nd.warning=r,Nd.error=i;function e(l,c){this.value=l,this.messages=c||[]}e.prototype.map=function(l){return new e(l(this.value),this.messages)},e.prototype.flatMap=function(l){var c=l(this.value);return new e(c.value,s([this,c]))},e.prototype.flatMapThen=function(l){var c=this;return l(this.value).then(function(u){return new e(u.value,s([c,u]))})},e.combine=function(l){var c=n.flatten(n.pluck(l,"value")),u=s(l);return new e(c,u)};function t(l){return new e(l,[])}function r(l){return{type:"warning",message:l}}function i(l){return{type:"error",message:l.message,error:l}}function s(l){var c=[];return n.flatten(n.pluck(l,"messages"),!0).forEach(function(u){a(c,u)||c.push(u)}),c}function a(l,c){return n.find(l,o.bind(null,c))!==void 0}function o(l,c){return l.type===c.type&&l.message===c.message}return Nd}var Wp={},jp={},iP;function c6(){if(iP)return jp;iP=1,jp.byteLength=o,jp.toByteArray=c,jp.fromByteArray=h;for(var n=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,s=r.length;i<s;++i)n[i]=r[i],e[r.charCodeAt(i)]=i;e[45]=62,e[95]=63;function a(f){var p=f.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=f.indexOf("=");g===-1&&(g=p);var b=g===p?0:4-g%4;return[g,b]}function o(f){var p=a(f),g=p[0],b=p[1];return(g+b)*3/4-b}function l(f,p,g){return(p+g)*3/4-g}function c(f){var p,g=a(f),b=g[0],_=g[1],m=new t(l(f,b,_)),v=0,x=_>0?b-4:b,w;for(w=0;w<x;w+=4)p=e[f.charCodeAt(w)]<<18|e[f.charCodeAt(w+1)]<<12|e[f.charCodeAt(w+2)]<<6|e[f.charCodeAt(w+3)],m[v++]=p>>16&255,m[v++]=p>>8&255,m[v++]=p&255;return _===2&&(p=e[f.charCodeAt(w)]<<2|e[f.charCodeAt(w+1)]>>4,m[v++]=p&255),_===1&&(p=e[f.charCodeAt(w)]<<10|e[f.charCodeAt(w+1)]<<4|e[f.charCodeAt(w+2)]>>2,m[v++]=p>>8&255,m[v++]=p&255),m}function u(f){return n[f>>18&63]+n[f>>12&63]+n[f>>6&63]+n[f&63]}function d(f,p,g){for(var b,_=[],m=p;m<g;m+=3)b=(f[m]<<16&16711680)+(f[m+1]<<8&65280)+(f[m+2]&255),_.push(u(b));return _.join("")}function h(f){for(var p,g=f.length,b=g%3,_=[],m=16383,v=0,x=g-b;v<x;v+=m)_.push(d(f,v,v+m>x?x:v+m));return b===1?(p=f[g-1],_.push(n[p>>2]+n[p<<4&63]+"==")):b===2&&(p=(f[g-2]<<8)+f[g-1],_.push(n[p>>10]+n[p>>4&63]+n[p<<2&63]+"=")),_.join("")}return jp}function hm(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var mw={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var sP;function u6(){return sP||(sP=1,function(n,e){(function(t){n.exports=t()})(function(){return function t(r,i,s){function a(c,u){if(!i[c]){if(!r[c]){var d=typeof hm=="function"&&hm;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[c]={exports:{}};r[c][0].call(f.exports,function(p){var g=r[c][1][p];return a(g||p)},f,f.exports,t,r,i,s)}return i[c].exports}for(var o=typeof hm=="function"&&hm,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,r,i){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var c,u,d,h,f,p,g,b=[],_=0,m=l.length,v=m,x=s.getTypeOf(l)!=="string";_<l.length;)v=m-_,d=x?(c=l[_++],u=_<m?l[_++]:0,_<m?l[_++]:0):(c=l.charCodeAt(_++),u=_<m?l.charCodeAt(_++):0,_<m?l.charCodeAt(_++):0),h=c>>2,f=(3&c)<<4|u>>4,p=1<v?(15&u)<<2|d>>6:64,g=2<v?63&d:64,b.push(o.charAt(h)+o.charAt(f)+o.charAt(p)+o.charAt(g));return b.join("")},i.decode=function(l){var c,u,d,h,f,p,g=0,b=0,_="data:";if(l.substr(0,_.length)===_)throw new Error("Invalid base64 input, it looks like a data url.");var m,v=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&v--,l.charAt(l.length-2)===o.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");for(m=a.uint8array?new Uint8Array(0|v):new Array(0|v);g<l.length;)c=o.indexOf(l.charAt(g++))<<2|(h=o.indexOf(l.charAt(g++)))>>4,u=(15&h)<<4|(f=o.indexOf(l.charAt(g++)))>>2,d=(3&f)<<6|(p=o.indexOf(l.charAt(g++))),m[b++]=c,f!==64&&(m[b++]=u),p!==64&&(m[b++]=d);return m}},{"./support":30,"./utils":32}],2:[function(t,r,i){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function c(u,d,h,f,p){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=f,this.compressedContent=p}c.prototype={getContentWorker:function(){var u=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,i){var s=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,i){var s=t("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?s.getTypeOf(o)!=="string"?function(c,u,d,h){var f=a,p=h+d;c^=-1;for(var g=h;g<p;g++)c=c>>>8^f[255&(c^u[g])];return-1^c}(0|l,o,o.length,0):function(c,u,d,h){var f=a,p=h+d;c^=-1;for(var g=h;g<p;g++)c=c>>>8^f[255&(c^u.charCodeAt(g))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(t,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,r,i){var s=null;s=typeof Promise<"u"?Promise:t("lie"),r.exports={Promise:s}},{lie:37}],7:[function(t,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),c=s?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}i.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},i.compressWorker=function(d){return new u("Deflate",d)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,i){function s(f,p){var g,b="";for(g=0;g<p;g++)b+=String.fromCharCode(255&f),f>>>=8;return b}function a(f,p,g,b,_,m){var v,x,w=f.file,T=f.compression,E=m!==c.utf8encode,A=o.transformTo("string",m(w.name)),M=o.transformTo("string",c.utf8encode(w.name)),F=w.comment,G=o.transformTo("string",m(F)),S=o.transformTo("string",c.utf8encode(F)),I=M.length!==w.name.length,C=S.length!==F.length,H="",B="",$="",X=w.dir,V=w.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};p&&!g||(Q.crc32=f.crc32,Q.compressedSize=f.compressedSize,Q.uncompressedSize=f.uncompressedSize);var R=0;p&&(R|=8),E||!I&&!C||(R|=2048);var O=0,L=0;X&&(O|=16),_==="UNIX"?(L=798,O|=function(de,we){var be=de;return de||(be=we?16893:33204),(65535&be)<<16}(w.unixPermissions,X)):(L=20,O|=function(de){return 63&(de||0)}(w.dosPermissions)),v=V.getUTCHours(),v<<=6,v|=V.getUTCMinutes(),v<<=5,v|=V.getUTCSeconds()/2,x=V.getUTCFullYear()-1980,x<<=4,x|=V.getUTCMonth()+1,x<<=5,x|=V.getUTCDate(),I&&(B=s(1,1)+s(u(A),4)+M,H+="up"+s(B.length,2)+B),C&&($=s(1,1)+s(u(G),4)+S,H+="uc"+s($.length,2)+$);var ne="";return ne+=`
\0`,ne+=s(R,2),ne+=T.magic,ne+=s(v,2),ne+=s(x,2),ne+=s(Q.crc32,4),ne+=s(Q.compressedSize,4),ne+=s(Q.uncompressedSize,4),ne+=s(A.length,2),ne+=s(H.length,2),{fileRecord:d.LOCAL_FILE_HEADER+ne+A+H,dirRecord:d.CENTRAL_FILE_HEADER+s(L,2)+ne+s(G.length,2)+"\0\0\0\0"+s(O,4)+s(b,4)+A+H+G}}var o=t("../utils"),l=t("../stream/GenericWorker"),c=t("../utf8"),u=t("../crc32"),d=t("../signature");function h(f,p,g,b){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=g,this.encodeFileName=b,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(f){var p=f.meta.percent||0,g=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,l.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:g?(p+100*(g-b-1))/g:100}}))},h.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var p=this.streamFiles&&!f.file.dir;if(p){var g=a(f,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(f){this.accumulate=!1;var p=this.streamFiles&&!f.file.dir,g=a(f,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),p)this.push({data:function(b){return d.DATA_DESCRIPTOR+s(b.crc32,4)+s(b.compressedSize,4)+s(b.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var f=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var g=this.bytesWritten-f,b=function(_,m,v,x,w){var T=o.transformTo("string",w(x));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(_,2)+s(_,2)+s(m,4)+s(v,4)+s(T.length,2)+T}(this.dirRecords.length,g,f,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(f){this._sources.push(f);var p=this;return f.on("data",function(g){p.processChunk(g)}),f.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),f.on("error",function(g){p.error(g)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(f){var p=this._sources;if(!l.prototype.error.call(this,f))return!1;for(var g=0;g<p.length;g++)try{p[g].error(f)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var f=this._sources,p=0;p<f.length;p++)f[p].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,i){var s=t("../compressions"),a=t("./ZipFileWorker");i.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,f){d++;var p=function(m,v){var x=m||v,w=s[x];if(!w)throw new Error(x+" is not a valid compression method !");return w}(f.options.compression,l.compression),g=f.options.compressionOptions||l.compressionOptions||{},b=f.dir,_=f.date;f._compressWorker(p,g).withStreamInfo("file",{name:h,dir:b,date:_,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,i){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),c=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function d(h){return new a.Promise(function(f,p){var g=h.decompressed.getContentWorker().pipe(new c);g.on("error",function(b){p(b)}).on("end",function(){g.streamInfo.crc32!==h.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}r.exports=function(h,f){var p=this;return f=s.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",h,!0,f.optimizedBinaryString,f.base64).then(function(g){var b=new l(f);return b.load(g),b}).then(function(g){var b=[a.Promise.resolve(g)],_=g.files;if(f.checkCRC32)for(var m=0;m<_.length;m++)b.push(d(_[m]));return a.Promise.all(b)}).then(function(g){for(var b=g.shift(),_=b.files,m=0;m<_.length;m++){var v=_[m],x=v.fileNameStr,w=s.resolve(v.fileNameStr);p.file(w,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:f.createFolders}),v.dir||(p.file(w).unsafeOriginalName=x)}return b.zipComment.length&&(p.comment=b.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,i){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,i){var s=t("readable-stream").Readable;function a(o,l,c){s.call(this,l),this._helper=o;var u=this;o.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}t("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,r,i){function s(w,T,E){var A,M=o.getTypeOf(T),F=o.extend(E||{},u);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(w=_(w)),F.createFolders&&(A=b(w))&&m.call(this,A,!0);var G=M==="string"&&F.binary===!1&&F.base64===!1;E&&E.binary!==void 0||(F.binary=!G),(T instanceof d&&T.uncompressedSize===0||F.dir||!T||T.length===0)&&(F.base64=!1,F.binary=!0,T="",F.compression="STORE",M="string");var S=null;S=T instanceof d||T instanceof l?T:p.isNode&&p.isStream(T)?new g(w,T):o.prepareContent(w,T,F.binary,F.optimizedBinaryString,F.base64);var I=new h(w,S,F);this.files[w]=I}var a=t("./utf8"),o=t("./utils"),l=t("./stream/GenericWorker"),c=t("./stream/StreamHelper"),u=t("./defaults"),d=t("./compressedObject"),h=t("./zipObject"),f=t("./generate"),p=t("./nodejsUtils"),g=t("./nodejs/NodejsStreamInputAdapter"),b=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var T=w.lastIndexOf("/");return 0<T?w.substring(0,T):""},_=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},m=function(w,T){return T=T!==void 0?T:u.createFolders,w=_(w),this.files[w]||s.call(this,w,null,{dir:!0,createFolders:T}),this.files[w]};function v(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var T,E,A;for(T in this.files)A=this.files[T],(E=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&w(E,A)},filter:function(w){var T=[];return this.forEach(function(E,A){w(E,A)&&T.push(A)}),T},file:function(w,T,E){if(arguments.length!==1)return w=this.root+w,s.call(this,w,T,E),this;if(v(w)){var A=w;return this.filter(function(F,G){return!G.dir&&A.test(F)})}var M=this.files[this.root+w];return M&&!M.dir?M:null},folder:function(w){if(!w)return this;if(v(w))return this.filter(function(M,F){return F.dir&&w.test(M)});var T=this.root+w,E=m.call(this,T),A=this.clone();return A.root=E.name,A},remove:function(w){w=this.root+w;var T=this.files[w];if(T||(w.slice(-1)!=="/"&&(w+="/"),T=this.files[w]),T&&!T.dir)delete this.files[w];else for(var E=this.filter(function(M,F){return F.name.slice(0,w.length)===w}),A=0;A<E.length;A++)delete this.files[E[A].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var T,E={};try{if((E=o.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=E.type.toLowerCase(),E.compression=E.compression.toUpperCase(),E.type==="binarystring"&&(E.type="string"),!E.type)throw new Error("No output type specified.");o.checkSupport(E.type),E.platform!=="darwin"&&E.platform!=="freebsd"&&E.platform!=="linux"&&E.platform!=="sunos"||(E.platform="UNIX"),E.platform==="win32"&&(E.platform="DOS");var A=E.comment||this.comment||"";T=f.generateWorker(this,E,A)}catch(M){(T=new l("error")).error(M)}return new c(T,E.type||"string",E.mimeType)},generateAsync:function(w,T){return this.generateInternalStream(w).accumulate(T)},generateNodeStream:function(w,T){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(T)}};r.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,i){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,i){var s=t("./DataReader");function a(o){s.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,r,i){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(t,r,i){var s=t("./Uint8ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,i){var s=t("./DataReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,r,i){var s=t("./ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,i){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),c=t("./NodeBufferReader"),u=t("./Uint8ArrayReader");r.exports=function(d){var h=s.getTypeOf(d);return s.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new u(s.transformTo("uint8array",d)):new o(s.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,i){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,i){var s=t("./GenericWorker"),a=t("../crc32");function o(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,s),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=s.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}s.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=s},{}],29:[function(t,r,i){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),c=t("../support"),u=t("../external"),d=null;if(c.nodestream)try{d=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(p,g){return new u.Promise(function(b,_){var m=[],v=p._internalType,x=p._outputType,w=p._mimeType;p.on("data",function(T,E){m.push(T),g&&g(E)}).on("error",function(T){m=[],_(T)}).on("end",function(){try{var T=function(E,A,M){switch(E){case"blob":return s.newBlob(s.transformTo("arraybuffer",A),M);case"base64":return l.encode(A);default:return s.transformTo(E,A)}}(x,function(E,A){var M,F=0,G=null,S=0;for(M=0;M<A.length;M++)S+=A[M].length;switch(E){case"string":return A.join("");case"array":return Array.prototype.concat.apply([],A);case"uint8array":for(G=new Uint8Array(S),M=0;M<A.length;M++)G.set(A[M],F),F+=A[M].length;return G;case"nodebuffer":return Buffer.concat(A);default:throw new Error("concat : unsupported type '"+E+"'")}}(v,m),w);b(T)}catch(E){_(E)}m=[]}).resume()})}function f(p,g,b){var _=g;switch(g){case"blob":case"arraybuffer":_="uint8array";break;case"base64":_="string"}try{this._internalType=_,this._outputType=g,this._mimeType=b,s.checkSupport(_),this._worker=p.pipe(new a(_)),p.lock()}catch(m){this._worker=new o("error"),this._worker.error(m)}}f.prototype={accumulate:function(p){return h(this,p)},on:function(p,g){var b=this;return p==="data"?this._worker.on(p,function(_){g.call(b,_.data,_.meta)}):this._worker.on(p,function(){s.delay(g,arguments,b)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},p)}},r.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,i){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}i.utf8encode=function(f){return a.nodebuffer?o.newBufferFrom(f,"utf-8"):function(p){var g,b,_,m,v,x=p.length,w=0;for(m=0;m<x;m++)(64512&(b=p.charCodeAt(m)))==55296&&m+1<x&&(64512&(_=p.charCodeAt(m+1)))==56320&&(b=65536+(b-55296<<10)+(_-56320),m++),w+=b<128?1:b<2048?2:b<65536?3:4;for(g=a.uint8array?new Uint8Array(w):new Array(w),m=v=0;v<w;m++)(64512&(b=p.charCodeAt(m)))==55296&&m+1<x&&(64512&(_=p.charCodeAt(m+1)))==56320&&(b=65536+(b-55296<<10)+(_-56320),m++),b<128?g[v++]=b:(b<2048?g[v++]=192|b>>>6:(b<65536?g[v++]=224|b>>>12:(g[v++]=240|b>>>18,g[v++]=128|b>>>12&63),g[v++]=128|b>>>6&63),g[v++]=128|63&b);return g}(f)},i.utf8decode=function(f){return a.nodebuffer?s.transformTo("nodebuffer",f).toString("utf-8"):function(p){var g,b,_,m,v=p.length,x=new Array(2*v);for(g=b=0;g<v;)if((_=p[g++])<128)x[b++]=_;else if(4<(m=c[_]))x[b++]=65533,g+=m-1;else{for(_&=m===2?31:m===3?15:7;1<m&&g<v;)_=_<<6|63&p[g++],m--;1<m?x[b++]=65533:_<65536?x[b++]=_:(_-=65536,x[b++]=55296|_>>10&1023,x[b++]=56320|1023&_)}return x.length!==b&&(x.subarray?x=x.subarray(0,b):x.length=b),s.applyFromCharCode(x)}(f=s.transformTo(a.uint8array?"uint8array":"array",f))},s.inherits(d,l),d.prototype.processChunk=function(f){var p=s.transformTo(a.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var g=p;(p=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),p.set(g,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var b=function(m,v){var x;for((v=v||m.length)>m.length&&(v=m.length),x=v-1;0<=x&&(192&m[x])==128;)x--;return x<0||x===0?v:x+c[m[x]]>v?x:v}(p),_=p;b!==p.length&&(a.uint8array?(_=p.subarray(0,b),this.leftOver=p.subarray(b,p.length)):(_=p.slice(0,b),this.leftOver=p.slice(b,p.length))),this.push({data:i.utf8decode(_),meta:f.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=d,s.inherits(h,l),h.prototype.processChunk=function(f){this.push({data:i.utf8encode(f.data),meta:f.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,i){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");function c(g){return g}function u(g,b){for(var _=0;_<g.length;++_)b[_]=255&g.charCodeAt(_);return b}t("setimmediate"),i.newBlob=function(g,b){i.checkSupport("blob");try{return new Blob([g],{type:b})}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return _.append(g),_.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(g,b,_){var m=[],v=0,x=g.length;if(x<=_)return String.fromCharCode.apply(null,g);for(;v<x;)b==="array"||b==="nodebuffer"?m.push(String.fromCharCode.apply(null,g.slice(v,Math.min(v+_,x)))):m.push(String.fromCharCode.apply(null,g.subarray(v,Math.min(v+_,x)))),v+=_;return m.join("")},stringifyByChar:function(g){for(var b="",_=0;_<g.length;_++)b+=String.fromCharCode(g[_]);return b},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function h(g){var b=65536,_=i.getTypeOf(g),m=!0;if(_==="uint8array"?m=d.applyCanBeUsed.uint8array:_==="nodebuffer"&&(m=d.applyCanBeUsed.nodebuffer),m)for(;1<b;)try{return d.stringifyByChunk(g,_,b)}catch{b=Math.floor(b/2)}return d.stringifyByChar(g)}function f(g,b){for(var _=0;_<g.length;_++)b[_]=g[_];return b}i.applyFromCharCode=h;var p={};p.string={string:c,array:function(g){return u(g,new Array(g.length))},arraybuffer:function(g){return p.string.uint8array(g).buffer},uint8array:function(g){return u(g,new Uint8Array(g.length))},nodebuffer:function(g){return u(g,o.allocBuffer(g.length))}},p.array={string:h,array:c,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return o.newBufferFrom(g)}},p.arraybuffer={string:function(g){return h(new Uint8Array(g))},array:function(g){return f(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:c,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return o.newBufferFrom(new Uint8Array(g))}},p.uint8array={string:h,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:c,nodebuffer:function(g){return o.newBufferFrom(g)}},p.nodebuffer={string:h,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return p.nodebuffer.uint8array(g).buffer},uint8array:function(g){return f(g,new Uint8Array(g.length))},nodebuffer:c},i.transformTo=function(g,b){if(b=b||"",!g)return b;i.checkSupport(g);var _=i.getTypeOf(b);return p[_][g](b)},i.resolve=function(g){for(var b=g.split("/"),_=[],m=0;m<b.length;m++){var v=b[m];v==="."||v===""&&m!==0&&m!==b.length-1||(v===".."?_.pop():_.push(v))}return _.join("/")},i.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":s.nodebuffer&&o.isBuffer(g)?"nodebuffer":s.uint8array&&g instanceof Uint8Array?"uint8array":s.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(g){if(!s[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(g){var b,_,m="";for(_=0;_<(g||"").length;_++)m+="\\x"+((b=g.charCodeAt(_))<16?"0":"")+b.toString(16).toUpperCase();return m},i.delay=function(g,b,_){setImmediate(function(){g.apply(_||null,b||[])})},i.inherits=function(g,b){function _(){}_.prototype=b.prototype,g.prototype=new _},i.extend=function(){var g,b,_={};for(g=0;g<arguments.length;g++)for(b in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],b)&&_[b]===void 0&&(_[b]=arguments[g][b]);return _},i.prepareContent=function(g,b,_,m,v){return l.Promise.resolve(b).then(function(x){return s.blob&&(x instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x))!==-1)&&typeof FileReader<"u"?new l.Promise(function(w,T){var E=new FileReader;E.onload=function(A){w(A.target.result)},E.onerror=function(A){T(A.target.error)},E.readAsArrayBuffer(x)}):x}).then(function(x){var w=i.getTypeOf(x);return w?(w==="arraybuffer"?x=i.transformTo("uint8array",x):w==="string"&&(v?x=a.decode(x):_&&m!==!0&&(x=function(T){return u(T,s.uint8array?new Uint8Array(T.length):new Array(T.length))}(x))),x):l.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),c=t("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var f=this.reader.index;this.reader.setIndex(d);var p=this.reader.readString(4)===h;return this.reader.setIndex(f),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",f=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,f,p=this.zip64EndOfCentralSize-44;0<p;)d=this.reader.readInt(2),h=this.reader.readInt(4),f=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var p=h-f;if(0<p)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(d){this.reader=s(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),c=t("./utf8"),u=t("./compressions"),d=t("./support");function h(f,p){this.options=f,this.loadOptions=p}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var p,g;if(f.skip(22),this.fileNameLength=f.readInt(2),g=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(b){for(var _ in u)if(Object.prototype.hasOwnProperty.call(u,_)&&u[_].magic===b)return u[_];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,p,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var p=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(p),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var p,g,b,_=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<_;)p=f.readInt(2),g=f.readInt(2),b=f.readData(g),this.extraFields[p]={id:p,length:g,value:b};f.setIndex(_)},handleUTF8:function(){var f=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var g=a.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var _=a.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(_)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var p=s(f.value);return p.readInt(1)!==1||l(this.fileName)!==p.readInt(4)?null:c.utf8decode(p.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var p=s(f.value);return p.readInt(1)!==1||l(this.fileComment)!==p.readInt(4)?null:c.utf8decode(p.readData(f.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,i){function s(p,g,b){this.name=p,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=g,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),l=t("./utf8"),c=t("./compressedObject"),u=t("./stream/GenericWorker");s.prototype={internalStream:function(p){var g=null,b="string";try{if(!p)throw new Error("No output type specified.");var _=(b=p.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),g=this._decompressWorker();var m=!this._dataBinary;m&&!_&&(g=g.pipe(new l.Utf8EncodeWorker)),!m&&_&&(g=g.pipe(new l.Utf8DecodeWorker))}catch(v){(g=new u("error")).error(v)}return new a(g,b,"")},async:function(p,g){return this.internalStream(p).accumulate(g)},nodeStream:function(p,g){return this.internalStream(p||"nodebuffer").toNodejsStream(g)},_compressWorker:function(p,g){if(this._data instanceof c&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(b,p,g)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<d.length;f++)s.prototype[d[f]]=h;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,i){(function(s){var a,o,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,u=new l(p),d=s.document.createTextNode("");u.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var g=s.document.createElement("script");g.onreadystatechange=function(){p(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},s.document.documentElement.appendChild(g)}:function(){setTimeout(p,0)};else{var h=new s.MessageChannel;h.port1.onmessage=p,a=function(){h.port2.postMessage(0)}}var f=[];function p(){var g,b;o=!0;for(var _=f.length;_;){for(b=f,f=[],g=-1;++g<_;)b[g]();_=f.length}o=!1}r.exports=function(g){f.push(g)!==1||o||a()}}).call(this,typeof Bl<"u"?Bl:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,i){var s=t("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,_!==a&&g(this,_)}function h(_,m,v){this.promise=_,typeof m=="function"&&(this.onFulfilled=m,this.callFulfilled=this.otherCallFulfilled),typeof v=="function"&&(this.onRejected=v,this.callRejected=this.otherCallRejected)}function f(_,m,v){s(function(){var x;try{x=m(v)}catch(w){return o.reject(_,w)}x===_?o.reject(_,new TypeError("Cannot resolve promise with itself")):o.resolve(_,x)})}function p(_){var m=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof m=="function")return function(){m.apply(_,arguments)}}function g(_,m){var v=!1;function x(E){v||(v=!0,o.reject(_,E))}function w(E){v||(v=!0,o.resolve(_,E))}var T=b(function(){m(w,x)});T.status==="error"&&x(T.value)}function b(_,m){var v={};try{v.value=_(m),v.status="success"}catch(x){v.status="error",v.value=x}return v}(r.exports=d).prototype.finally=function(_){if(typeof _!="function")return this;var m=this.constructor;return this.then(function(v){return m.resolve(_()).then(function(){return v})},function(v){return m.resolve(_()).then(function(){throw v})})},d.prototype.catch=function(_){return this.then(null,_)},d.prototype.then=function(_,m){if(typeof _!="function"&&this.state===c||typeof m!="function"&&this.state===l)return this;var v=new this.constructor(a);return this.state!==u?f(v,this.state===c?_:m,this.outcome):this.queue.push(new h(v,_,m)),v},h.prototype.callFulfilled=function(_){o.resolve(this.promise,_)},h.prototype.otherCallFulfilled=function(_){f(this.promise,this.onFulfilled,_)},h.prototype.callRejected=function(_){o.reject(this.promise,_)},h.prototype.otherCallRejected=function(_){f(this.promise,this.onRejected,_)},o.resolve=function(_,m){var v=b(p,m);if(v.status==="error")return o.reject(_,v.value);var x=v.value;if(x)g(_,x);else{_.state=c,_.outcome=m;for(var w=-1,T=_.queue.length;++w<T;)_.queue[w].callFulfilled(m)}return _},o.reject=function(_,m){_.state=l,_.outcome=m;for(var v=-1,x=_.queue.length;++v<x;)_.queue[v].callRejected(m);return _},d.resolve=function(_){return _ instanceof this?_:o.resolve(new this(a),_)},d.reject=function(_){var m=new this(a);return o.reject(m,_)},d.all=function(_){var m=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=_.length,x=!1;if(!v)return this.resolve([]);for(var w=new Array(v),T=0,E=-1,A=new this(a);++E<v;)M(_[E],E);return A;function M(F,G){m.resolve(F).then(function(S){w[G]=S,++T!==v||x||(x=!0,o.resolve(A,w))},function(S){x||(x=!0,o.reject(A,S))})}},d.race=function(_){var m=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=_.length,x=!1;if(!v)return this.resolve([]);for(var w=-1,T=new this(a);++w<v;)E=_[w],m.resolve(E).then(function(A){x||(x=!0,o.resolve(T,A))},function(A){x||(x=!0,o.reject(T,A))});var E;return T}},{immediate:36}],38:[function(t,r,i){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,i){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),c=t("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,f=0,p=8;function g(_){if(!(this instanceof g))return new g(_);this.options=a.assign({level:h,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},_||{});var m=this.options;m.raw&&0<m.windowBits?m.windowBits=-m.windowBits:m.gzip&&0<m.windowBits&&m.windowBits<16&&(m.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var v=s.deflateInit2(this.strm,m.level,m.method,m.windowBits,m.memLevel,m.strategy);if(v!==d)throw new Error(l[v]);if(m.header&&s.deflateSetHeader(this.strm,m.header),m.dictionary){var x;if(x=typeof m.dictionary=="string"?o.string2buf(m.dictionary):u.call(m.dictionary)==="[object ArrayBuffer]"?new Uint8Array(m.dictionary):m.dictionary,(v=s.deflateSetDictionary(this.strm,x))!==d)throw new Error(l[v]);this._dict_set=!0}}function b(_,m){var v=new g(m);if(v.push(_,!0),v.err)throw v.msg||l[v.err];return v.result}g.prototype.push=function(_,m){var v,x,w=this.strm,T=this.options.chunkSize;if(this.ended)return!1;x=m===~~m?m:m===!0?4:0,typeof _=="string"?w.input=o.string2buf(_):u.call(_)==="[object ArrayBuffer]"?w.input=new Uint8Array(_):w.input=_,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new a.Buf8(T),w.next_out=0,w.avail_out=T),(v=s.deflate(w,x))!==1&&v!==d)return this.onEnd(v),!(this.ended=!0);w.avail_out!==0&&(w.avail_in!==0||x!==4&&x!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(w.output,w.next_out))):this.onData(a.shrinkBuf(w.output,w.next_out)))}while((0<w.avail_in||w.avail_out===0)&&v!==1);return x===4?(v=s.deflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===d):x!==2||(this.onEnd(d),!(w.avail_out=0))},g.prototype.onData=function(_){this.chunks.push(_)},g.prototype.onEnd=function(_){_===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},i.Deflate=g,i.deflate=b,i.deflateRaw=function(_,m){return(m=m||{}).raw=!0,b(_,m)},i.gzip=function(_,m){return(m=m||{}).gzip=!0,b(_,m)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,i){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),c=t("./zlib/messages"),u=t("./zlib/zstream"),d=t("./zlib/gzheader"),h=Object.prototype.toString;function f(g){if(!(this instanceof f))return new f(g);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},g||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||g&&g.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&(15&b.windowBits)==0&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var _=s.inflateInit2(this.strm,b.windowBits);if(_!==l.Z_OK)throw new Error(c[_]);this.header=new d,s.inflateGetHeader(this.strm,this.header)}function p(g,b){var _=new f(b);if(_.push(g,!0),_.err)throw _.msg||c[_.err];return _.result}f.prototype.push=function(g,b){var _,m,v,x,w,T,E=this.strm,A=this.options.chunkSize,M=this.options.dictionary,F=!1;if(this.ended)return!1;m=b===~~b?b:b===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof g=="string"?E.input=o.binstring2buf(g):h.call(g)==="[object ArrayBuffer]"?E.input=new Uint8Array(g):E.input=g,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new a.Buf8(A),E.next_out=0,E.avail_out=A),(_=s.inflate(E,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&M&&(T=typeof M=="string"?o.string2buf(M):h.call(M)==="[object ArrayBuffer]"?new Uint8Array(M):M,_=s.inflateSetDictionary(this.strm,T)),_===l.Z_BUF_ERROR&&F===!0&&(_=l.Z_OK,F=!1),_!==l.Z_STREAM_END&&_!==l.Z_OK)return this.onEnd(_),!(this.ended=!0);E.next_out&&(E.avail_out!==0&&_!==l.Z_STREAM_END&&(E.avail_in!==0||m!==l.Z_FINISH&&m!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=o.utf8border(E.output,E.next_out),x=E.next_out-v,w=o.buf2string(E.output,v),E.next_out=x,E.avail_out=A-x,x&&a.arraySet(E.output,E.output,v,x,0),this.onData(w)):this.onData(a.shrinkBuf(E.output,E.next_out)))),E.avail_in===0&&E.avail_out===0&&(F=!0)}while((0<E.avail_in||E.avail_out===0)&&_!==l.Z_STREAM_END);return _===l.Z_STREAM_END&&(m=l.Z_FINISH),m===l.Z_FINISH?(_=s.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===l.Z_OK):m!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(E.avail_out=0))},f.prototype.onData=function(g){this.chunks.push(g)},f.prototype.onEnd=function(g){g===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},i.Inflate=f,i.inflate=p,i.inflateRaw=function(g,b){return(b=b||{}).raw=!0,p(g,b)},i.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},i.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var f=0;f<d;f++)l[h+f]=c[u+f]},flattenChunks:function(l){var c,u,d,h,f,p;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(p=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)f=l[c],p.set(f,h),h+=f.length;return p}},o={arraySet:function(l,c,u,d,h){for(var f=0;f<d;f++)l[h+f]=c[u+f]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(s)},{}],42:[function(t,r,i){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(d,h));for(var f="",p=0;p<h;p++)f+=String.fromCharCode(d[p]);return f}l[254]=l[254]=1,i.string2buf=function(d){var h,f,p,g,b,_=d.length,m=0;for(g=0;g<_;g++)(64512&(f=d.charCodeAt(g)))==55296&&g+1<_&&(64512&(p=d.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),g++),m+=f<128?1:f<2048?2:f<65536?3:4;for(h=new s.Buf8(m),g=b=0;b<m;g++)(64512&(f=d.charCodeAt(g)))==55296&&g+1<_&&(64512&(p=d.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),g++),f<128?h[b++]=f:(f<2048?h[b++]=192|f>>>6:(f<65536?h[b++]=224|f>>>12:(h[b++]=240|f>>>18,h[b++]=128|f>>>12&63),h[b++]=128|f>>>6&63),h[b++]=128|63&f);return h},i.buf2binstring=function(d){return u(d,d.length)},i.binstring2buf=function(d){for(var h=new s.Buf8(d.length),f=0,p=h.length;f<p;f++)h[f]=d.charCodeAt(f);return h},i.buf2string=function(d,h){var f,p,g,b,_=h||d.length,m=new Array(2*_);for(f=p=0;f<_;)if((g=d[f++])<128)m[p++]=g;else if(4<(b=l[g]))m[p++]=65533,f+=b-1;else{for(g&=b===2?31:b===3?15:7;1<b&&f<_;)g=g<<6|63&d[f++],b--;1<b?m[p++]=65533:g<65536?m[p++]=g:(g-=65536,m[p++]=55296|g>>10&1023,m[p++]=56320|1023&g)}return u(m,p)},i.utf8border=function(d,h){var f;for((h=h||d.length)>d.length&&(h=d.length),f=h-1;0<=f&&(192&d[f])==128;)f--;return f<0||f===0?h:f+l[d[f]]>h?f:h}},{"./common":41}],43:[function(t,r,i){r.exports=function(s,a,o,l){for(var c=65535&s|0,u=s>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(t,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,i){var s=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=s,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(t,r,i){var s,a=t("../utils/common"),o=t("./trees"),l=t("./adler32"),c=t("./crc32"),u=t("./messages"),d=0,h=4,f=0,p=-2,g=-1,b=4,_=2,m=8,v=9,x=286,w=30,T=19,E=2*x+1,A=15,M=3,F=258,G=F+M+1,S=42,I=113,C=1,H=2,B=3,$=4;function X(U,he){return U.msg=u[he],he}function V(U){return(U<<1)-(4<U?9:0)}function Q(U){for(var he=U.length;0<=--he;)U[he]=0}function R(U){var he=U.state,pe=he.pending;pe>U.avail_out&&(pe=U.avail_out),pe!==0&&(a.arraySet(U.output,he.pending_buf,he.pending_out,pe,U.next_out),U.next_out+=pe,he.pending_out+=pe,U.total_out+=pe,U.avail_out-=pe,he.pending-=pe,he.pending===0&&(he.pending_out=0))}function O(U,he){o._tr_flush_block(U,0<=U.block_start?U.block_start:-1,U.strstart-U.block_start,he),U.block_start=U.strstart,R(U.strm)}function L(U,he){U.pending_buf[U.pending++]=he}function ne(U,he){U.pending_buf[U.pending++]=he>>>8&255,U.pending_buf[U.pending++]=255&he}function de(U,he){var pe,ie,re=U.max_chain_length,ge=U.strstart,Ce=U.prev_length,q=U.nice_match,te=U.strstart>U.w_size-G?U.strstart-(U.w_size-G):0,j=U.window,ee=U.w_mask,se=U.prev,ve=U.strstart+F,ke=j[ge+Ce-1],Re=j[ge+Ce];U.prev_length>=U.good_match&&(re>>=2),q>U.lookahead&&(q=U.lookahead);do if(j[(pe=he)+Ce]===Re&&j[pe+Ce-1]===ke&&j[pe]===j[ge]&&j[++pe]===j[ge+1]){ge+=2,pe++;do;while(j[++ge]===j[++pe]&&j[++ge]===j[++pe]&&j[++ge]===j[++pe]&&j[++ge]===j[++pe]&&j[++ge]===j[++pe]&&j[++ge]===j[++pe]&&j[++ge]===j[++pe]&&j[++ge]===j[++pe]&&ge<ve);if(ie=F-(ve-ge),ge=ve-F,Ce<ie){if(U.match_start=he,q<=(Ce=ie))break;ke=j[ge+Ce-1],Re=j[ge+Ce]}}while((he=se[he&ee])>te&&--re!=0);return Ce<=U.lookahead?Ce:U.lookahead}function we(U){var he,pe,ie,re,ge,Ce,q,te,j,ee,se=U.w_size;do{if(re=U.window_size-U.lookahead-U.strstart,U.strstart>=se+(se-G)){for(a.arraySet(U.window,U.window,se,se,0),U.match_start-=se,U.strstart-=se,U.block_start-=se,he=pe=U.hash_size;ie=U.head[--he],U.head[he]=se<=ie?ie-se:0,--pe;);for(he=pe=se;ie=U.prev[--he],U.prev[he]=se<=ie?ie-se:0,--pe;);re+=se}if(U.strm.avail_in===0)break;if(Ce=U.strm,q=U.window,te=U.strstart+U.lookahead,j=re,ee=void 0,ee=Ce.avail_in,j<ee&&(ee=j),pe=ee===0?0:(Ce.avail_in-=ee,a.arraySet(q,Ce.input,Ce.next_in,ee,te),Ce.state.wrap===1?Ce.adler=l(Ce.adler,q,ee,te):Ce.state.wrap===2&&(Ce.adler=c(Ce.adler,q,ee,te)),Ce.next_in+=ee,Ce.total_in+=ee,ee),U.lookahead+=pe,U.lookahead+U.insert>=M)for(ge=U.strstart-U.insert,U.ins_h=U.window[ge],U.ins_h=(U.ins_h<<U.hash_shift^U.window[ge+1])&U.hash_mask;U.insert&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[ge+M-1])&U.hash_mask,U.prev[ge&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=ge,ge++,U.insert--,!(U.lookahead+U.insert<M)););}while(U.lookahead<G&&U.strm.avail_in!==0)}function be(U,he){for(var pe,ie;;){if(U.lookahead<G){if(we(U),U.lookahead<G&&he===d)return C;if(U.lookahead===0)break}if(pe=0,U.lookahead>=M&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+M-1])&U.hash_mask,pe=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),pe!==0&&U.strstart-pe<=U.w_size-G&&(U.match_length=de(U,pe)),U.match_length>=M)if(ie=o._tr_tally(U,U.strstart-U.match_start,U.match_length-M),U.lookahead-=U.match_length,U.match_length<=U.max_lazy_match&&U.lookahead>=M){for(U.match_length--;U.strstart++,U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+M-1])&U.hash_mask,pe=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart,--U.match_length!=0;);U.strstart++}else U.strstart+=U.match_length,U.match_length=0,U.ins_h=U.window[U.strstart],U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+1])&U.hash_mask;else ie=o._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++;if(ie&&(O(U,!1),U.strm.avail_out===0))return C}return U.insert=U.strstart<M-1?U.strstart:M-1,he===h?(O(U,!0),U.strm.avail_out===0?B:$):U.last_lit&&(O(U,!1),U.strm.avail_out===0)?C:H}function Ee(U,he){for(var pe,ie,re;;){if(U.lookahead<G){if(we(U),U.lookahead<G&&he===d)return C;if(U.lookahead===0)break}if(pe=0,U.lookahead>=M&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+M-1])&U.hash_mask,pe=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),U.prev_length=U.match_length,U.prev_match=U.match_start,U.match_length=M-1,pe!==0&&U.prev_length<U.max_lazy_match&&U.strstart-pe<=U.w_size-G&&(U.match_length=de(U,pe),U.match_length<=5&&(U.strategy===1||U.match_length===M&&4096<U.strstart-U.match_start)&&(U.match_length=M-1)),U.prev_length>=M&&U.match_length<=U.prev_length){for(re=U.strstart+U.lookahead-M,ie=o._tr_tally(U,U.strstart-1-U.prev_match,U.prev_length-M),U.lookahead-=U.prev_length-1,U.prev_length-=2;++U.strstart<=re&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+M-1])&U.hash_mask,pe=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),--U.prev_length!=0;);if(U.match_available=0,U.match_length=M-1,U.strstart++,ie&&(O(U,!1),U.strm.avail_out===0))return C}else if(U.match_available){if((ie=o._tr_tally(U,0,U.window[U.strstart-1]))&&O(U,!1),U.strstart++,U.lookahead--,U.strm.avail_out===0)return C}else U.match_available=1,U.strstart++,U.lookahead--}return U.match_available&&(ie=o._tr_tally(U,0,U.window[U.strstart-1]),U.match_available=0),U.insert=U.strstart<M-1?U.strstart:M-1,he===h?(O(U,!0),U.strm.avail_out===0?B:$):U.last_lit&&(O(U,!1),U.strm.avail_out===0)?C:H}function Fe(U,he,pe,ie,re){this.good_length=U,this.max_lazy=he,this.nice_length=pe,this.max_chain=ie,this.func=re}function xe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*E),this.dyn_dtree=new a.Buf16(2*(2*w+1)),this.bl_tree=new a.Buf16(2*(2*T+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(A+1),this.heap=new a.Buf16(2*x+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*x+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ce(U){var he;return U&&U.state?(U.total_in=U.total_out=0,U.data_type=_,(he=U.state).pending=0,he.pending_out=0,he.wrap<0&&(he.wrap=-he.wrap),he.status=he.wrap?S:I,U.adler=he.wrap===2?0:1,he.last_flush=d,o._tr_init(he),f):X(U,p)}function ue(U){var he=ce(U);return he===f&&function(pe){pe.window_size=2*pe.w_size,Q(pe.head),pe.max_lazy_match=s[pe.level].max_lazy,pe.good_match=s[pe.level].good_length,pe.nice_match=s[pe.level].nice_length,pe.max_chain_length=s[pe.level].max_chain,pe.strstart=0,pe.block_start=0,pe.lookahead=0,pe.insert=0,pe.match_length=pe.prev_length=M-1,pe.match_available=0,pe.ins_h=0}(U.state),he}function Se(U,he,pe,ie,re,ge){if(!U)return p;var Ce=1;if(he===g&&(he=6),ie<0?(Ce=0,ie=-ie):15<ie&&(Ce=2,ie-=16),re<1||v<re||pe!==m||ie<8||15<ie||he<0||9<he||ge<0||b<ge)return X(U,p);ie===8&&(ie=9);var q=new xe;return(U.state=q).strm=U,q.wrap=Ce,q.gzhead=null,q.w_bits=ie,q.w_size=1<<q.w_bits,q.w_mask=q.w_size-1,q.hash_bits=re+7,q.hash_size=1<<q.hash_bits,q.hash_mask=q.hash_size-1,q.hash_shift=~~((q.hash_bits+M-1)/M),q.window=new a.Buf8(2*q.w_size),q.head=new a.Buf16(q.hash_size),q.prev=new a.Buf16(q.w_size),q.lit_bufsize=1<<re+6,q.pending_buf_size=4*q.lit_bufsize,q.pending_buf=new a.Buf8(q.pending_buf_size),q.d_buf=1*q.lit_bufsize,q.l_buf=3*q.lit_bufsize,q.level=he,q.strategy=ge,q.method=pe,ue(U)}s=[new Fe(0,0,0,0,function(U,he){var pe=65535;for(pe>U.pending_buf_size-5&&(pe=U.pending_buf_size-5);;){if(U.lookahead<=1){if(we(U),U.lookahead===0&&he===d)return C;if(U.lookahead===0)break}U.strstart+=U.lookahead,U.lookahead=0;var ie=U.block_start+pe;if((U.strstart===0||U.strstart>=ie)&&(U.lookahead=U.strstart-ie,U.strstart=ie,O(U,!1),U.strm.avail_out===0)||U.strstart-U.block_start>=U.w_size-G&&(O(U,!1),U.strm.avail_out===0))return C}return U.insert=0,he===h?(O(U,!0),U.strm.avail_out===0?B:$):(U.strstart>U.block_start&&(O(U,!1),U.strm.avail_out),C)}),new Fe(4,4,8,4,be),new Fe(4,5,16,8,be),new Fe(4,6,32,32,be),new Fe(4,4,16,16,Ee),new Fe(8,16,32,32,Ee),new Fe(8,16,128,128,Ee),new Fe(8,32,128,256,Ee),new Fe(32,128,258,1024,Ee),new Fe(32,258,258,4096,Ee)],i.deflateInit=function(U,he){return Se(U,he,m,15,8,0)},i.deflateInit2=Se,i.deflateReset=ue,i.deflateResetKeep=ce,i.deflateSetHeader=function(U,he){return U&&U.state?U.state.wrap!==2?p:(U.state.gzhead=he,f):p},i.deflate=function(U,he){var pe,ie,re,ge;if(!U||!U.state||5<he||he<0)return U?X(U,p):p;if(ie=U.state,!U.output||!U.input&&U.avail_in!==0||ie.status===666&&he!==h)return X(U,U.avail_out===0?-5:p);if(ie.strm=U,pe=ie.last_flush,ie.last_flush=he,ie.status===S)if(ie.wrap===2)U.adler=0,L(ie,31),L(ie,139),L(ie,8),ie.gzhead?(L(ie,(ie.gzhead.text?1:0)+(ie.gzhead.hcrc?2:0)+(ie.gzhead.extra?4:0)+(ie.gzhead.name?8:0)+(ie.gzhead.comment?16:0)),L(ie,255&ie.gzhead.time),L(ie,ie.gzhead.time>>8&255),L(ie,ie.gzhead.time>>16&255),L(ie,ie.gzhead.time>>24&255),L(ie,ie.level===9?2:2<=ie.strategy||ie.level<2?4:0),L(ie,255&ie.gzhead.os),ie.gzhead.extra&&ie.gzhead.extra.length&&(L(ie,255&ie.gzhead.extra.length),L(ie,ie.gzhead.extra.length>>8&255)),ie.gzhead.hcrc&&(U.adler=c(U.adler,ie.pending_buf,ie.pending,0)),ie.gzindex=0,ie.status=69):(L(ie,0),L(ie,0),L(ie,0),L(ie,0),L(ie,0),L(ie,ie.level===9?2:2<=ie.strategy||ie.level<2?4:0),L(ie,3),ie.status=I);else{var Ce=m+(ie.w_bits-8<<4)<<8;Ce|=(2<=ie.strategy||ie.level<2?0:ie.level<6?1:ie.level===6?2:3)<<6,ie.strstart!==0&&(Ce|=32),Ce+=31-Ce%31,ie.status=I,ne(ie,Ce),ie.strstart!==0&&(ne(ie,U.adler>>>16),ne(ie,65535&U.adler)),U.adler=1}if(ie.status===69)if(ie.gzhead.extra){for(re=ie.pending;ie.gzindex<(65535&ie.gzhead.extra.length)&&(ie.pending!==ie.pending_buf_size||(ie.gzhead.hcrc&&ie.pending>re&&(U.adler=c(U.adler,ie.pending_buf,ie.pending-re,re)),R(U),re=ie.pending,ie.pending!==ie.pending_buf_size));)L(ie,255&ie.gzhead.extra[ie.gzindex]),ie.gzindex++;ie.gzhead.hcrc&&ie.pending>re&&(U.adler=c(U.adler,ie.pending_buf,ie.pending-re,re)),ie.gzindex===ie.gzhead.extra.length&&(ie.gzindex=0,ie.status=73)}else ie.status=73;if(ie.status===73)if(ie.gzhead.name){re=ie.pending;do{if(ie.pending===ie.pending_buf_size&&(ie.gzhead.hcrc&&ie.pending>re&&(U.adler=c(U.adler,ie.pending_buf,ie.pending-re,re)),R(U),re=ie.pending,ie.pending===ie.pending_buf_size)){ge=1;break}ge=ie.gzindex<ie.gzhead.name.length?255&ie.gzhead.name.charCodeAt(ie.gzindex++):0,L(ie,ge)}while(ge!==0);ie.gzhead.hcrc&&ie.pending>re&&(U.adler=c(U.adler,ie.pending_buf,ie.pending-re,re)),ge===0&&(ie.gzindex=0,ie.status=91)}else ie.status=91;if(ie.status===91)if(ie.gzhead.comment){re=ie.pending;do{if(ie.pending===ie.pending_buf_size&&(ie.gzhead.hcrc&&ie.pending>re&&(U.adler=c(U.adler,ie.pending_buf,ie.pending-re,re)),R(U),re=ie.pending,ie.pending===ie.pending_buf_size)){ge=1;break}ge=ie.gzindex<ie.gzhead.comment.length?255&ie.gzhead.comment.charCodeAt(ie.gzindex++):0,L(ie,ge)}while(ge!==0);ie.gzhead.hcrc&&ie.pending>re&&(U.adler=c(U.adler,ie.pending_buf,ie.pending-re,re)),ge===0&&(ie.status=103)}else ie.status=103;if(ie.status===103&&(ie.gzhead.hcrc?(ie.pending+2>ie.pending_buf_size&&R(U),ie.pending+2<=ie.pending_buf_size&&(L(ie,255&U.adler),L(ie,U.adler>>8&255),U.adler=0,ie.status=I)):ie.status=I),ie.pending!==0){if(R(U),U.avail_out===0)return ie.last_flush=-1,f}else if(U.avail_in===0&&V(he)<=V(pe)&&he!==h)return X(U,-5);if(ie.status===666&&U.avail_in!==0)return X(U,-5);if(U.avail_in!==0||ie.lookahead!==0||he!==d&&ie.status!==666){var q=ie.strategy===2?function(te,j){for(var ee;;){if(te.lookahead===0&&(we(te),te.lookahead===0)){if(j===d)return C;break}if(te.match_length=0,ee=o._tr_tally(te,0,te.window[te.strstart]),te.lookahead--,te.strstart++,ee&&(O(te,!1),te.strm.avail_out===0))return C}return te.insert=0,j===h?(O(te,!0),te.strm.avail_out===0?B:$):te.last_lit&&(O(te,!1),te.strm.avail_out===0)?C:H}(ie,he):ie.strategy===3?function(te,j){for(var ee,se,ve,ke,Re=te.window;;){if(te.lookahead<=F){if(we(te),te.lookahead<=F&&j===d)return C;if(te.lookahead===0)break}if(te.match_length=0,te.lookahead>=M&&0<te.strstart&&(se=Re[ve=te.strstart-1])===Re[++ve]&&se===Re[++ve]&&se===Re[++ve]){ke=te.strstart+F;do;while(se===Re[++ve]&&se===Re[++ve]&&se===Re[++ve]&&se===Re[++ve]&&se===Re[++ve]&&se===Re[++ve]&&se===Re[++ve]&&se===Re[++ve]&&ve<ke);te.match_length=F-(ke-ve),te.match_length>te.lookahead&&(te.match_length=te.lookahead)}if(te.match_length>=M?(ee=o._tr_tally(te,1,te.match_length-M),te.lookahead-=te.match_length,te.strstart+=te.match_length,te.match_length=0):(ee=o._tr_tally(te,0,te.window[te.strstart]),te.lookahead--,te.strstart++),ee&&(O(te,!1),te.strm.avail_out===0))return C}return te.insert=0,j===h?(O(te,!0),te.strm.avail_out===0?B:$):te.last_lit&&(O(te,!1),te.strm.avail_out===0)?C:H}(ie,he):s[ie.level].func(ie,he);if(q!==B&&q!==$||(ie.status=666),q===C||q===B)return U.avail_out===0&&(ie.last_flush=-1),f;if(q===H&&(he===1?o._tr_align(ie):he!==5&&(o._tr_stored_block(ie,0,0,!1),he===3&&(Q(ie.head),ie.lookahead===0&&(ie.strstart=0,ie.block_start=0,ie.insert=0))),R(U),U.avail_out===0))return ie.last_flush=-1,f}return he!==h?f:ie.wrap<=0?1:(ie.wrap===2?(L(ie,255&U.adler),L(ie,U.adler>>8&255),L(ie,U.adler>>16&255),L(ie,U.adler>>24&255),L(ie,255&U.total_in),L(ie,U.total_in>>8&255),L(ie,U.total_in>>16&255),L(ie,U.total_in>>24&255)):(ne(ie,U.adler>>>16),ne(ie,65535&U.adler)),R(U),0<ie.wrap&&(ie.wrap=-ie.wrap),ie.pending!==0?f:1)},i.deflateEnd=function(U){var he;return U&&U.state?(he=U.state.status)!==S&&he!==69&&he!==73&&he!==91&&he!==103&&he!==I&&he!==666?X(U,p):(U.state=null,he===I?X(U,-3):f):p},i.deflateSetDictionary=function(U,he){var pe,ie,re,ge,Ce,q,te,j,ee=he.length;if(!U||!U.state||(ge=(pe=U.state).wrap)===2||ge===1&&pe.status!==S||pe.lookahead)return p;for(ge===1&&(U.adler=l(U.adler,he,ee,0)),pe.wrap=0,ee>=pe.w_size&&(ge===0&&(Q(pe.head),pe.strstart=0,pe.block_start=0,pe.insert=0),j=new a.Buf8(pe.w_size),a.arraySet(j,he,ee-pe.w_size,pe.w_size,0),he=j,ee=pe.w_size),Ce=U.avail_in,q=U.next_in,te=U.input,U.avail_in=ee,U.next_in=0,U.input=he,we(pe);pe.lookahead>=M;){for(ie=pe.strstart,re=pe.lookahead-(M-1);pe.ins_h=(pe.ins_h<<pe.hash_shift^pe.window[ie+M-1])&pe.hash_mask,pe.prev[ie&pe.w_mask]=pe.head[pe.ins_h],pe.head[pe.ins_h]=ie,ie++,--re;);pe.strstart=ie,pe.lookahead=M-1,we(pe)}return pe.strstart+=pe.lookahead,pe.block_start=pe.strstart,pe.insert=pe.lookahead,pe.lookahead=0,pe.match_length=pe.prev_length=M-1,pe.match_available=0,U.next_in=q,U.input=te,U.avail_in=Ce,pe.wrap=ge,f},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,r,i){r.exports=function(s,a){var o,l,c,u,d,h,f,p,g,b,_,m,v,x,w,T,E,A,M,F,G,S,I,C,H;o=s.state,l=s.next_in,C=s.input,c=l+(s.avail_in-5),u=s.next_out,H=s.output,d=u-(a-s.avail_out),h=u+(s.avail_out-257),f=o.dmax,p=o.wsize,g=o.whave,b=o.wnext,_=o.window,m=o.hold,v=o.bits,x=o.lencode,w=o.distcode,T=(1<<o.lenbits)-1,E=(1<<o.distbits)-1;e:do{v<15&&(m+=C[l++]<<v,v+=8,m+=C[l++]<<v,v+=8),A=x[m&T];t:for(;;){if(m>>>=M=A>>>24,v-=M,(M=A>>>16&255)===0)H[u++]=65535&A;else{if(!(16&M)){if((64&M)==0){A=x[(65535&A)+(m&(1<<M)-1)];continue t}if(32&M){o.mode=12;break e}s.msg="invalid literal/length code",o.mode=30;break e}F=65535&A,(M&=15)&&(v<M&&(m+=C[l++]<<v,v+=8),F+=m&(1<<M)-1,m>>>=M,v-=M),v<15&&(m+=C[l++]<<v,v+=8,m+=C[l++]<<v,v+=8),A=w[m&E];n:for(;;){if(m>>>=M=A>>>24,v-=M,!(16&(M=A>>>16&255))){if((64&M)==0){A=w[(65535&A)+(m&(1<<M)-1)];continue n}s.msg="invalid distance code",o.mode=30;break e}if(G=65535&A,v<(M&=15)&&(m+=C[l++]<<v,(v+=8)<M&&(m+=C[l++]<<v,v+=8)),f<(G+=m&(1<<M)-1)){s.msg="invalid distance too far back",o.mode=30;break e}if(m>>>=M,v-=M,(M=u-d)<G){if(g<(M=G-M)&&o.sane){s.msg="invalid distance too far back",o.mode=30;break e}if(I=_,(S=0)===b){if(S+=p-M,M<F){for(F-=M;H[u++]=_[S++],--M;);S=u-G,I=H}}else if(b<M){if(S+=p+b-M,(M-=b)<F){for(F-=M;H[u++]=_[S++],--M;);if(S=0,b<F){for(F-=M=b;H[u++]=_[S++],--M;);S=u-G,I=H}}}else if(S+=b-M,M<F){for(F-=M;H[u++]=_[S++],--M;);S=u-G,I=H}for(;2<F;)H[u++]=I[S++],H[u++]=I[S++],H[u++]=I[S++],F-=3;F&&(H[u++]=I[S++],1<F&&(H[u++]=I[S++]))}else{for(S=u-G;H[u++]=H[S++],H[u++]=H[S++],H[u++]=H[S++],2<(F-=3););F&&(H[u++]=H[S++],1<F&&(H[u++]=H[S++]))}break}}break}}while(l<c&&u<h);l-=F=v>>3,m&=(1<<(v-=F<<3))-1,s.next_in=l,s.next_out=u,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=u<h?h-u+257:257-(u-h),o.hold=m,o.bits=v}},{}],49:[function(t,r,i){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),c=t("./inftrees"),u=1,d=2,h=0,f=-2,p=1,g=852,b=592;function _(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function m(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(S){var I;return S&&S.state?(I=S.state,S.total_in=S.total_out=I.total=0,S.msg="",I.wrap&&(S.adler=1&I.wrap),I.mode=p,I.last=0,I.havedict=0,I.dmax=32768,I.head=null,I.hold=0,I.bits=0,I.lencode=I.lendyn=new s.Buf32(g),I.distcode=I.distdyn=new s.Buf32(b),I.sane=1,I.back=-1,h):f}function x(S){var I;return S&&S.state?((I=S.state).wsize=0,I.whave=0,I.wnext=0,v(S)):f}function w(S,I){var C,H;return S&&S.state?(H=S.state,I<0?(C=0,I=-I):(C=1+(I>>4),I<48&&(I&=15)),I&&(I<8||15<I)?f:(H.window!==null&&H.wbits!==I&&(H.window=null),H.wrap=C,H.wbits=I,x(S))):f}function T(S,I){var C,H;return S?(H=new m,(S.state=H).window=null,(C=w(S,I))!==h&&(S.state=null),C):f}var E,A,M=!0;function F(S){if(M){var I;for(E=new s.Buf32(512),A=new s.Buf32(32),I=0;I<144;)S.lens[I++]=8;for(;I<256;)S.lens[I++]=9;for(;I<280;)S.lens[I++]=7;for(;I<288;)S.lens[I++]=8;for(c(u,S.lens,0,288,E,0,S.work,{bits:9}),I=0;I<32;)S.lens[I++]=5;c(d,S.lens,0,32,A,0,S.work,{bits:5}),M=!1}S.lencode=E,S.lenbits=9,S.distcode=A,S.distbits=5}function G(S,I,C,H){var B,$=S.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new s.Buf8($.wsize)),H>=$.wsize?(s.arraySet($.window,I,C-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(H<(B=$.wsize-$.wnext)&&(B=H),s.arraySet($.window,I,C-H,B,$.wnext),(H-=B)?(s.arraySet($.window,I,C-H,H,0),$.wnext=H,$.whave=$.wsize):($.wnext+=B,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=B))),0}i.inflateReset=x,i.inflateReset2=w,i.inflateResetKeep=v,i.inflateInit=function(S){return T(S,15)},i.inflateInit2=T,i.inflate=function(S,I){var C,H,B,$,X,V,Q,R,O,L,ne,de,we,be,Ee,Fe,xe,ce,ue,Se,U,he,pe,ie,re=0,ge=new s.Buf8(4),Ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return f;(C=S.state).mode===12&&(C.mode=13),X=S.next_out,B=S.output,Q=S.avail_out,$=S.next_in,H=S.input,V=S.avail_in,R=C.hold,O=C.bits,L=V,ne=Q,he=h;e:for(;;)switch(C.mode){case p:if(C.wrap===0){C.mode=13;break}for(;O<16;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if(2&C.wrap&&R===35615){ge[C.check=0]=255&R,ge[1]=R>>>8&255,C.check=o(C.check,ge,2,0),O=R=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&R)<<8)+(R>>8))%31){S.msg="incorrect header check",C.mode=30;break}if((15&R)!=8){S.msg="unknown compression method",C.mode=30;break}if(O-=4,U=8+(15&(R>>>=4)),C.wbits===0)C.wbits=U;else if(U>C.wbits){S.msg="invalid window size",C.mode=30;break}C.dmax=1<<U,S.adler=C.check=1,C.mode=512&R?10:12,O=R=0;break;case 2:for(;O<16;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if(C.flags=R,(255&C.flags)!=8){S.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){S.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=R>>8&1),512&C.flags&&(ge[0]=255&R,ge[1]=R>>>8&255,C.check=o(C.check,ge,2,0)),O=R=0,C.mode=3;case 3:for(;O<32;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}C.head&&(C.head.time=R),512&C.flags&&(ge[0]=255&R,ge[1]=R>>>8&255,ge[2]=R>>>16&255,ge[3]=R>>>24&255,C.check=o(C.check,ge,4,0)),O=R=0,C.mode=4;case 4:for(;O<16;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}C.head&&(C.head.xflags=255&R,C.head.os=R>>8),512&C.flags&&(ge[0]=255&R,ge[1]=R>>>8&255,C.check=o(C.check,ge,2,0)),O=R=0,C.mode=5;case 5:if(1024&C.flags){for(;O<16;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}C.length=R,C.head&&(C.head.extra_len=R),512&C.flags&&(ge[0]=255&R,ge[1]=R>>>8&255,C.check=o(C.check,ge,2,0)),O=R=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(V<(de=C.length)&&(de=V),de&&(C.head&&(U=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),s.arraySet(C.head.extra,H,$,de,U)),512&C.flags&&(C.check=o(C.check,H,de,$)),V-=de,$+=de,C.length-=de),C.length))break e;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(V===0)break e;for(de=0;U=H[$+de++],C.head&&U&&C.length<65536&&(C.head.name+=String.fromCharCode(U)),U&&de<V;);if(512&C.flags&&(C.check=o(C.check,H,de,$)),V-=de,$+=de,U)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(V===0)break e;for(de=0;U=H[$+de++],C.head&&U&&C.length<65536&&(C.head.comment+=String.fromCharCode(U)),U&&de<V;);if(512&C.flags&&(C.check=o(C.check,H,de,$)),V-=de,$+=de,U)break e}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;O<16;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if(R!==(65535&C.check)){S.msg="header crc mismatch",C.mode=30;break}O=R=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),S.adler=C.check=0,C.mode=12;break;case 10:for(;O<32;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}S.adler=C.check=_(R),O=R=0,C.mode=11;case 11:if(C.havedict===0)return S.next_out=X,S.avail_out=Q,S.next_in=$,S.avail_in=V,C.hold=R,C.bits=O,2;S.adler=C.check=1,C.mode=12;case 12:if(I===5||I===6)break e;case 13:if(C.last){R>>>=7&O,O-=7&O,C.mode=27;break}for(;O<3;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}switch(C.last=1&R,O-=1,3&(R>>>=1)){case 0:C.mode=14;break;case 1:if(F(C),C.mode=20,I!==6)break;R>>>=2,O-=2;break e;case 2:C.mode=17;break;case 3:S.msg="invalid block type",C.mode=30}R>>>=2,O-=2;break;case 14:for(R>>>=7&O,O-=7&O;O<32;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if((65535&R)!=(R>>>16^65535)){S.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&R,O=R=0,C.mode=15,I===6)break e;case 15:C.mode=16;case 16:if(de=C.length){if(V<de&&(de=V),Q<de&&(de=Q),de===0)break e;s.arraySet(B,H,$,de,X),V-=de,$+=de,Q-=de,X+=de,C.length-=de;break}C.mode=12;break;case 17:for(;O<14;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if(C.nlen=257+(31&R),R>>>=5,O-=5,C.ndist=1+(31&R),R>>>=5,O-=5,C.ncode=4+(15&R),R>>>=4,O-=4,286<C.nlen||30<C.ndist){S.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;O<3;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}C.lens[Ce[C.have++]]=7&R,R>>>=3,O-=3}for(;C.have<19;)C.lens[Ce[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,pe={bits:C.lenbits},he=c(0,C.lens,0,19,C.lencode,0,C.work,pe),C.lenbits=pe.bits,he){S.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;Fe=(re=C.lencode[R&(1<<C.lenbits)-1])>>>16&255,xe=65535&re,!((Ee=re>>>24)<=O);){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if(xe<16)R>>>=Ee,O-=Ee,C.lens[C.have++]=xe;else{if(xe===16){for(ie=Ee+2;O<ie;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if(R>>>=Ee,O-=Ee,C.have===0){S.msg="invalid bit length repeat",C.mode=30;break}U=C.lens[C.have-1],de=3+(3&R),R>>>=2,O-=2}else if(xe===17){for(ie=Ee+3;O<ie;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}O-=Ee,U=0,de=3+(7&(R>>>=Ee)),R>>>=3,O-=3}else{for(ie=Ee+7;O<ie;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}O-=Ee,U=0,de=11+(127&(R>>>=Ee)),R>>>=7,O-=7}if(C.have+de>C.nlen+C.ndist){S.msg="invalid bit length repeat",C.mode=30;break}for(;de--;)C.lens[C.have++]=U}}if(C.mode===30)break;if(C.lens[256]===0){S.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,pe={bits:C.lenbits},he=c(u,C.lens,0,C.nlen,C.lencode,0,C.work,pe),C.lenbits=pe.bits,he){S.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,pe={bits:C.distbits},he=c(d,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,pe),C.distbits=pe.bits,he){S.msg="invalid distances set",C.mode=30;break}if(C.mode=20,I===6)break e;case 20:C.mode=21;case 21:if(6<=V&&258<=Q){S.next_out=X,S.avail_out=Q,S.next_in=$,S.avail_in=V,C.hold=R,C.bits=O,l(S,ne),X=S.next_out,B=S.output,Q=S.avail_out,$=S.next_in,H=S.input,V=S.avail_in,R=C.hold,O=C.bits,C.mode===12&&(C.back=-1);break}for(C.back=0;Fe=(re=C.lencode[R&(1<<C.lenbits)-1])>>>16&255,xe=65535&re,!((Ee=re>>>24)<=O);){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if(Fe&&(240&Fe)==0){for(ce=Ee,ue=Fe,Se=xe;Fe=(re=C.lencode[Se+((R&(1<<ce+ue)-1)>>ce)])>>>16&255,xe=65535&re,!(ce+(Ee=re>>>24)<=O);){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}R>>>=ce,O-=ce,C.back+=ce}if(R>>>=Ee,O-=Ee,C.back+=Ee,C.length=xe,Fe===0){C.mode=26;break}if(32&Fe){C.back=-1,C.mode=12;break}if(64&Fe){S.msg="invalid literal/length code",C.mode=30;break}C.extra=15&Fe,C.mode=22;case 22:if(C.extra){for(ie=C.extra;O<ie;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}C.length+=R&(1<<C.extra)-1,R>>>=C.extra,O-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;Fe=(re=C.distcode[R&(1<<C.distbits)-1])>>>16&255,xe=65535&re,!((Ee=re>>>24)<=O);){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if((240&Fe)==0){for(ce=Ee,ue=Fe,Se=xe;Fe=(re=C.distcode[Se+((R&(1<<ce+ue)-1)>>ce)])>>>16&255,xe=65535&re,!(ce+(Ee=re>>>24)<=O);){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}R>>>=ce,O-=ce,C.back+=ce}if(R>>>=Ee,O-=Ee,C.back+=Ee,64&Fe){S.msg="invalid distance code",C.mode=30;break}C.offset=xe,C.extra=15&Fe,C.mode=24;case 24:if(C.extra){for(ie=C.extra;O<ie;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}C.offset+=R&(1<<C.extra)-1,R>>>=C.extra,O-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){S.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(Q===0)break e;if(de=ne-Q,C.offset>de){if((de=C.offset-de)>C.whave&&C.sane){S.msg="invalid distance too far back",C.mode=30;break}we=de>C.wnext?(de-=C.wnext,C.wsize-de):C.wnext-de,de>C.length&&(de=C.length),be=C.window}else be=B,we=X-C.offset,de=C.length;for(Q<de&&(de=Q),Q-=de,C.length-=de;B[X++]=be[we++],--de;);C.length===0&&(C.mode=21);break;case 26:if(Q===0)break e;B[X++]=C.length,Q--,C.mode=21;break;case 27:if(C.wrap){for(;O<32;){if(V===0)break e;V--,R|=H[$++]<<O,O+=8}if(ne-=Q,S.total_out+=ne,C.total+=ne,ne&&(S.adler=C.check=C.flags?o(C.check,B,ne,X-ne):a(C.check,B,ne,X-ne)),ne=Q,(C.flags?R:_(R))!==C.check){S.msg="incorrect data check",C.mode=30;break}O=R=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;O<32;){if(V===0)break e;V--,R+=H[$++]<<O,O+=8}if(R!==(4294967295&C.total)){S.msg="incorrect length check",C.mode=30;break}O=R=0}C.mode=29;case 29:he=1;break e;case 30:he=-3;break e;case 31:return-4;case 32:default:return f}return S.next_out=X,S.avail_out=Q,S.next_in=$,S.avail_in=V,C.hold=R,C.bits=O,(C.wsize||ne!==S.avail_out&&C.mode<30&&(C.mode<27||I!==4))&&G(S,S.output,S.next_out,ne-S.avail_out)?(C.mode=31,-4):(L-=S.avail_in,ne-=S.avail_out,S.total_in+=L,S.total_out+=ne,C.total+=ne,C.wrap&&ne&&(S.adler=C.check=C.flags?o(C.check,B,ne,S.next_out-ne):a(C.check,B,ne,S.next_out-ne)),S.data_type=C.bits+(C.last?64:0)+(C.mode===12?128:0)+(C.mode===20||C.mode===15?256:0),(L==0&&ne===0||I===4)&&he===h&&(he=-5),he)},i.inflateEnd=function(S){if(!S||!S.state)return f;var I=S.state;return I.window&&(I.window=null),S.state=null,h},i.inflateGetHeader=function(S,I){var C;return S&&S.state?(2&(C=S.state).wrap)==0?f:((C.head=I).done=!1,h):f},i.inflateSetDictionary=function(S,I){var C,H=I.length;return S&&S.state?(C=S.state).wrap!==0&&C.mode!==11?f:C.mode===11&&a(1,I,H,0)!==C.check?-3:G(S,I,H,H)?(C.mode=31,-4):(C.havedict=1,h):f},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,i){var s=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,f,p,g,b,_){var m,v,x,w,T,E,A,M,F,G=_.bits,S=0,I=0,C=0,H=0,B=0,$=0,X=0,V=0,Q=0,R=0,O=null,L=0,ne=new s.Buf16(16),de=new s.Buf16(16),we=null,be=0;for(S=0;S<=15;S++)ne[S]=0;for(I=0;I<f;I++)ne[d[h+I]]++;for(B=G,H=15;1<=H&&ne[H]===0;H--);if(H<B&&(B=H),H===0)return p[g++]=20971520,p[g++]=20971520,_.bits=1,0;for(C=1;C<H&&ne[C]===0;C++);for(B<C&&(B=C),S=V=1;S<=15;S++)if(V<<=1,(V-=ne[S])<0)return-1;if(0<V&&(u===0||H!==1))return-1;for(de[1]=0,S=1;S<15;S++)de[S+1]=de[S]+ne[S];for(I=0;I<f;I++)d[h+I]!==0&&(b[de[d[h+I]]++]=I);if(E=u===0?(O=we=b,19):u===1?(O=a,L-=257,we=o,be-=257,256):(O=l,we=c,-1),S=C,T=g,X=I=R=0,x=-1,w=(Q=1<<($=B))-1,u===1&&852<Q||u===2&&592<Q)return 1;for(;;){for(A=S-X,F=b[I]<E?(M=0,b[I]):b[I]>E?(M=we[be+b[I]],O[L+b[I]]):(M=96,0),m=1<<S-X,C=v=1<<$;p[T+(R>>X)+(v-=m)]=A<<24|M<<16|F|0,v!==0;);for(m=1<<S-1;R&m;)m>>=1;if(m!==0?(R&=m-1,R+=m):R=0,I++,--ne[S]==0){if(S===H)break;S=d[h+b[I]]}if(B<S&&(R&w)!==x){for(X===0&&(X=B),T+=C,V=1<<($=S-X);$+X<H&&!((V-=ne[$+X])<=0);)$++,V<<=1;if(Q+=1<<$,u===1&&852<Q||u===2&&592<Q)return 1;p[x=R&w]=B<<24|$<<16|T-g|0}}return R!==0&&(p[T+R]=S-X<<24|64<<16|0),_.bits=B,0}},{"../utils/common":41}],51:[function(t,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,i){var s=t("../utils/common"),a=0,o=1;function l(re){for(var ge=re.length;0<=--ge;)re[ge]=0}var c=0,u=29,d=256,h=d+1+u,f=30,p=19,g=2*h+1,b=15,_=16,m=7,v=256,x=16,w=17,T=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(h+2));l(G);var S=new Array(2*f);l(S);var I=new Array(512);l(I);var C=new Array(256);l(C);var H=new Array(u);l(H);var B,$,X,V=new Array(f);function Q(re,ge,Ce,q,te){this.static_tree=re,this.extra_bits=ge,this.extra_base=Ce,this.elems=q,this.max_length=te,this.has_stree=re&&re.length}function R(re,ge){this.dyn_tree=re,this.max_code=0,this.stat_desc=ge}function O(re){return re<256?I[re]:I[256+(re>>>7)]}function L(re,ge){re.pending_buf[re.pending++]=255&ge,re.pending_buf[re.pending++]=ge>>>8&255}function ne(re,ge,Ce){re.bi_valid>_-Ce?(re.bi_buf|=ge<<re.bi_valid&65535,L(re,re.bi_buf),re.bi_buf=ge>>_-re.bi_valid,re.bi_valid+=Ce-_):(re.bi_buf|=ge<<re.bi_valid&65535,re.bi_valid+=Ce)}function de(re,ge,Ce){ne(re,Ce[2*ge],Ce[2*ge+1])}function we(re,ge){for(var Ce=0;Ce|=1&re,re>>>=1,Ce<<=1,0<--ge;);return Ce>>>1}function be(re,ge,Ce){var q,te,j=new Array(b+1),ee=0;for(q=1;q<=b;q++)j[q]=ee=ee+Ce[q-1]<<1;for(te=0;te<=ge;te++){var se=re[2*te+1];se!==0&&(re[2*te]=we(j[se]++,se))}}function Ee(re){var ge;for(ge=0;ge<h;ge++)re.dyn_ltree[2*ge]=0;for(ge=0;ge<f;ge++)re.dyn_dtree[2*ge]=0;for(ge=0;ge<p;ge++)re.bl_tree[2*ge]=0;re.dyn_ltree[2*v]=1,re.opt_len=re.static_len=0,re.last_lit=re.matches=0}function Fe(re){8<re.bi_valid?L(re,re.bi_buf):0<re.bi_valid&&(re.pending_buf[re.pending++]=re.bi_buf),re.bi_buf=0,re.bi_valid=0}function xe(re,ge,Ce,q){var te=2*ge,j=2*Ce;return re[te]<re[j]||re[te]===re[j]&&q[ge]<=q[Ce]}function ce(re,ge,Ce){for(var q=re.heap[Ce],te=Ce<<1;te<=re.heap_len&&(te<re.heap_len&&xe(ge,re.heap[te+1],re.heap[te],re.depth)&&te++,!xe(ge,q,re.heap[te],re.depth));)re.heap[Ce]=re.heap[te],Ce=te,te<<=1;re.heap[Ce]=q}function ue(re,ge,Ce){var q,te,j,ee,se=0;if(re.last_lit!==0)for(;q=re.pending_buf[re.d_buf+2*se]<<8|re.pending_buf[re.d_buf+2*se+1],te=re.pending_buf[re.l_buf+se],se++,q===0?de(re,te,ge):(de(re,(j=C[te])+d+1,ge),(ee=E[j])!==0&&ne(re,te-=H[j],ee),de(re,j=O(--q),Ce),(ee=A[j])!==0&&ne(re,q-=V[j],ee)),se<re.last_lit;);de(re,v,ge)}function Se(re,ge){var Ce,q,te,j=ge.dyn_tree,ee=ge.stat_desc.static_tree,se=ge.stat_desc.has_stree,ve=ge.stat_desc.elems,ke=-1;for(re.heap_len=0,re.heap_max=g,Ce=0;Ce<ve;Ce++)j[2*Ce]!==0?(re.heap[++re.heap_len]=ke=Ce,re.depth[Ce]=0):j[2*Ce+1]=0;for(;re.heap_len<2;)j[2*(te=re.heap[++re.heap_len]=ke<2?++ke:0)]=1,re.depth[te]=0,re.opt_len--,se&&(re.static_len-=ee[2*te+1]);for(ge.max_code=ke,Ce=re.heap_len>>1;1<=Ce;Ce--)ce(re,j,Ce);for(te=ve;Ce=re.heap[1],re.heap[1]=re.heap[re.heap_len--],ce(re,j,1),q=re.heap[1],re.heap[--re.heap_max]=Ce,re.heap[--re.heap_max]=q,j[2*te]=j[2*Ce]+j[2*q],re.depth[te]=(re.depth[Ce]>=re.depth[q]?re.depth[Ce]:re.depth[q])+1,j[2*Ce+1]=j[2*q+1]=te,re.heap[1]=te++,ce(re,j,1),2<=re.heap_len;);re.heap[--re.heap_max]=re.heap[1],function(Re,Oe){var ze,Te,Be,qe,tt,xt,ft=Oe.dyn_tree,Wt=Oe.max_code,Jn=Oe.stat_desc.static_tree,rr=Oe.stat_desc.has_stree,yr=Oe.stat_desc.extra_bits,ae=Oe.stat_desc.extra_base,fe=Oe.stat_desc.max_length,Me=0;for(qe=0;qe<=b;qe++)Re.bl_count[qe]=0;for(ft[2*Re.heap[Re.heap_max]+1]=0,ze=Re.heap_max+1;ze<g;ze++)fe<(qe=ft[2*ft[2*(Te=Re.heap[ze])+1]+1]+1)&&(qe=fe,Me++),ft[2*Te+1]=qe,Wt<Te||(Re.bl_count[qe]++,tt=0,ae<=Te&&(tt=yr[Te-ae]),xt=ft[2*Te],Re.opt_len+=xt*(qe+tt),rr&&(Re.static_len+=xt*(Jn[2*Te+1]+tt)));if(Me!==0){do{for(qe=fe-1;Re.bl_count[qe]===0;)qe--;Re.bl_count[qe]--,Re.bl_count[qe+1]+=2,Re.bl_count[fe]--,Me-=2}while(0<Me);for(qe=fe;qe!==0;qe--)for(Te=Re.bl_count[qe];Te!==0;)Wt<(Be=Re.heap[--ze])||(ft[2*Be+1]!==qe&&(Re.opt_len+=(qe-ft[2*Be+1])*ft[2*Be],ft[2*Be+1]=qe),Te--)}}(re,ge),be(j,ke,re.bl_count)}function U(re,ge,Ce){var q,te,j=-1,ee=ge[1],se=0,ve=7,ke=4;for(ee===0&&(ve=138,ke=3),ge[2*(Ce+1)+1]=65535,q=0;q<=Ce;q++)te=ee,ee=ge[2*(q+1)+1],++se<ve&&te===ee||(se<ke?re.bl_tree[2*te]+=se:te!==0?(te!==j&&re.bl_tree[2*te]++,re.bl_tree[2*x]++):se<=10?re.bl_tree[2*w]++:re.bl_tree[2*T]++,j=te,ke=(se=0)===ee?(ve=138,3):te===ee?(ve=6,3):(ve=7,4))}function he(re,ge,Ce){var q,te,j=-1,ee=ge[1],se=0,ve=7,ke=4;for(ee===0&&(ve=138,ke=3),q=0;q<=Ce;q++)if(te=ee,ee=ge[2*(q+1)+1],!(++se<ve&&te===ee)){if(se<ke)for(;de(re,te,re.bl_tree),--se!=0;);else te!==0?(te!==j&&(de(re,te,re.bl_tree),se--),de(re,x,re.bl_tree),ne(re,se-3,2)):se<=10?(de(re,w,re.bl_tree),ne(re,se-3,3)):(de(re,T,re.bl_tree),ne(re,se-11,7));j=te,ke=(se=0)===ee?(ve=138,3):te===ee?(ve=6,3):(ve=7,4)}}l(V);var pe=!1;function ie(re,ge,Ce,q){ne(re,(c<<1)+(q?1:0),3),function(te,j,ee,se){Fe(te),L(te,ee),L(te,~ee),s.arraySet(te.pending_buf,te.window,j,ee,te.pending),te.pending+=ee}(re,ge,Ce)}i._tr_init=function(re){pe||(function(){var ge,Ce,q,te,j,ee=new Array(b+1);for(te=q=0;te<u-1;te++)for(H[te]=q,ge=0;ge<1<<E[te];ge++)C[q++]=te;for(C[q-1]=te,te=j=0;te<16;te++)for(V[te]=j,ge=0;ge<1<<A[te];ge++)I[j++]=te;for(j>>=7;te<f;te++)for(V[te]=j<<7,ge=0;ge<1<<A[te]-7;ge++)I[256+j++]=te;for(Ce=0;Ce<=b;Ce++)ee[Ce]=0;for(ge=0;ge<=143;)G[2*ge+1]=8,ge++,ee[8]++;for(;ge<=255;)G[2*ge+1]=9,ge++,ee[9]++;for(;ge<=279;)G[2*ge+1]=7,ge++,ee[7]++;for(;ge<=287;)G[2*ge+1]=8,ge++,ee[8]++;for(be(G,h+1,ee),ge=0;ge<f;ge++)S[2*ge+1]=5,S[2*ge]=we(ge,5);B=new Q(G,E,d+1,h,b),$=new Q(S,A,0,f,b),X=new Q(new Array(0),M,0,p,m)}(),pe=!0),re.l_desc=new R(re.dyn_ltree,B),re.d_desc=new R(re.dyn_dtree,$),re.bl_desc=new R(re.bl_tree,X),re.bi_buf=0,re.bi_valid=0,Ee(re)},i._tr_stored_block=ie,i._tr_flush_block=function(re,ge,Ce,q){var te,j,ee=0;0<re.level?(re.strm.data_type===2&&(re.strm.data_type=function(se){var ve,ke=4093624447;for(ve=0;ve<=31;ve++,ke>>>=1)if(1&ke&&se.dyn_ltree[2*ve]!==0)return a;if(se.dyn_ltree[18]!==0||se.dyn_ltree[20]!==0||se.dyn_ltree[26]!==0)return o;for(ve=32;ve<d;ve++)if(se.dyn_ltree[2*ve]!==0)return o;return a}(re)),Se(re,re.l_desc),Se(re,re.d_desc),ee=function(se){var ve;for(U(se,se.dyn_ltree,se.l_desc.max_code),U(se,se.dyn_dtree,se.d_desc.max_code),Se(se,se.bl_desc),ve=p-1;3<=ve&&se.bl_tree[2*F[ve]+1]===0;ve--);return se.opt_len+=3*(ve+1)+5+5+4,ve}(re),te=re.opt_len+3+7>>>3,(j=re.static_len+3+7>>>3)<=te&&(te=j)):te=j=Ce+5,Ce+4<=te&&ge!==-1?ie(re,ge,Ce,q):re.strategy===4||j===te?(ne(re,2+(q?1:0),3),ue(re,G,S)):(ne(re,4+(q?1:0),3),function(se,ve,ke,Re){var Oe;for(ne(se,ve-257,5),ne(se,ke-1,5),ne(se,Re-4,4),Oe=0;Oe<Re;Oe++)ne(se,se.bl_tree[2*F[Oe]+1],3);he(se,se.dyn_ltree,ve-1),he(se,se.dyn_dtree,ke-1)}(re,re.l_desc.max_code+1,re.d_desc.max_code+1,ee+1),ue(re,re.dyn_ltree,re.dyn_dtree)),Ee(re),q&&Fe(re)},i._tr_tally=function(re,ge,Ce){return re.pending_buf[re.d_buf+2*re.last_lit]=ge>>>8&255,re.pending_buf[re.d_buf+2*re.last_lit+1]=255&ge,re.pending_buf[re.l_buf+re.last_lit]=255&Ce,re.last_lit++,ge===0?re.dyn_ltree[2*Ce]++:(re.matches++,ge--,re.dyn_ltree[2*(C[Ce]+d+1)]++,re.dyn_dtree[2*O(ge)]++),re.last_lit===re.lit_bufsize-1},i._tr_align=function(re){ne(re,2,3),de(re,v,G),function(ge){ge.bi_valid===16?(L(ge,ge.bi_buf),ge.bi_buf=0,ge.bi_valid=0):8<=ge.bi_valid&&(ge.pending_buf[ge.pending++]=255&ge.bi_buf,ge.bi_buf>>=8,ge.bi_valid-=8)}(re)}},{"../utils/common":41}],53:[function(t,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,r,i){(function(s){(function(a,o){if(!a.setImmediate){var l,c,u,d,h=1,f={},p=!1,g=a.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(a);b=b&&b.setTimeout?b:a,l={}.toString.call(a.process)==="[object process]"?function(x){process.nextTick(function(){m(x)})}:function(){if(a.postMessage&&!a.importScripts){var x=!0,w=a.onmessage;return a.onmessage=function(){x=!1},a.postMessage("","*"),a.onmessage=w,x}}()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",v,!1):a.attachEvent("onmessage",v),function(x){a.postMessage(d+x,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(x){m(x.data)},function(x){u.port2.postMessage(x)}):g&&"onreadystatechange"in g.createElement("script")?(c=g.documentElement,function(x){var w=g.createElement("script");w.onreadystatechange=function(){m(x),w.onreadystatechange=null,c.removeChild(w),w=null},c.appendChild(w)}):function(x){setTimeout(m,0,x)},b.setImmediate=function(x){typeof x!="function"&&(x=new Function(""+x));for(var w=new Array(arguments.length-1),T=0;T<w.length;T++)w[T]=arguments[T+1];var E={callback:x,args:w};return f[h]=E,l(h),h++},b.clearImmediate=_}function _(x){delete f[x]}function m(x){if(p)setTimeout(m,0,x);else{var w=f[x];if(w){p=!0;try{(function(T){var E=T.callback,A=T.args;switch(A.length){case 0:E();break;case 1:E(A[0]);break;case 2:E(A[0],A[1]);break;case 3:E(A[0],A[1],A[2]);break;default:E.apply(o,A)}})(w)}finally{_(x),p=!1}}}}function v(x){x.source===a&&typeof x.data=="string"&&x.data.indexOf(d)===0&&m(+x.data.slice(d.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Bl<"u"?Bl:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(mw)),mw.exports}var aP;function WL(){if(aP)return Wp;aP=1;var n=c6(),e=u6();Wp.openArrayBuffer=t,Wp.splitPath=r,Wp.joinPath=i;function t(s){return e.loadAsync(s).then(function(a){function o(d){return a.file(d)!==null}function l(d,h){return a.file(d).async("uint8array").then(function(f){if(h==="base64")return n.fromByteArray(f);if(h){var p=new TextDecoder(h);return p.decode(f)}else return f})}function c(d,h){a.file(d,h)}function u(){return a.generateAsync({type:"arraybuffer"})}return{exists:o,read:l,write:c,toArrayBuffer:u}})}function r(s){var a=s.lastIndexOf("/");return a===-1?{dirname:"",basename:s}:{dirname:s.substring(0,a),basename:s.substring(a+1)}}function i(){var s=Array.prototype.filter.call(arguments,function(o){return o}),a=[];return s.forEach(function(o){/^\//.test(o)?a=[o]:a.push(o)}),a.join("/")}return Wp}var iy={},Jo={},zd={},oP;function jL(){if(oP)return zd;oP=1;var n=cr;zd.Element=t,zd.element=function(s,a,o){return new t(s,a,o)},zd.text=function(s){return{type:"text",value:s}};var e=zd.emptyElement={first:function(){return null},firstOrEmpty:function(){return e},attributes:{},children:[]};function t(s,a,o){this.type="element",this.name=s,this.attributes=a||{},this.children=o||[]}t.prototype.first=function(s){return n.find(this.children,function(a){return a.name===s})},t.prototype.firstOrEmpty=function(s){return this.first(s)||e},t.prototype.getElementsByTagName=function(s){var a=n.filter(this.children,function(o){return o.name===s});return i(a)},t.prototype.text=function(){if(this.children.length===0)return"";if(this.children.length!==1||this.children[0].type!=="text")throw new Error("Not implemented");return this.children[0].value};var r={getElementsByTagName:function(s){return i(n.flatten(this.map(function(a){return a.getElementsByTagName(s)},!0)))}};function i(s){return n.extend(s,r)}return zd}var gw={},sy={},Vp={},Xa={},yc={},lP;function Pv(){if(lP)return yc;lP=1;function n(s,a,o){if(o===void 0&&(o=Array.prototype),s&&typeof o.find=="function")return o.find.call(s,a);for(var l=0;l<s.length;l++)if(Object.prototype.hasOwnProperty.call(s,l)){var c=s[l];if(a.call(void 0,c,l,s))return c}}function e(s,a){return a===void 0&&(a=Object),a&&typeof a.freeze=="function"?a.freeze(s):s}function t(s,a){if(s===null||typeof s!="object")throw new TypeError("target is not an object");for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(s[o]=a[o]);return s}var r=e({HTML:"text/html",isHTML:function(s){return s===r.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),i=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(s){return s===i.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return yc.assign=t,yc.find=n,yc.freeze=e,yc.MIME_TYPE=r,yc.NAMESPACE=i,yc}var cP;function $E(){if(cP)return Xa;cP=1;var n=Pv(),e=n.find,t=n.NAMESPACE;function r(ae){return ae!==""}function i(ae){return ae?ae.split(/[\t\n\f\r ]+/).filter(r):[]}function s(ae,fe){return ae.hasOwnProperty(fe)||(ae[fe]=!0),ae}function a(ae){if(!ae)return[];var fe=i(ae);return Object.keys(fe.reduce(s,{}))}function o(ae){return function(fe){return ae&&ae.indexOf(fe)!==-1}}function l(ae,fe){for(var Me in ae)Object.prototype.hasOwnProperty.call(ae,Me)&&(fe[Me]=ae[Me])}function c(ae,fe){var Me=ae.prototype;if(!(Me instanceof fe)){let Ie=function(){};Ie.prototype=fe.prototype,Ie=new Ie,l(Me,Ie),ae.prototype=Me=Ie}Me.constructor!=ae&&(typeof ae!="function"&&console.error("unknown Class:"+ae),Me.constructor=ae)}var u={},d=u.ELEMENT_NODE=1,h=u.ATTRIBUTE_NODE=2,f=u.TEXT_NODE=3,p=u.CDATA_SECTION_NODE=4,g=u.ENTITY_REFERENCE_NODE=5,b=u.ENTITY_NODE=6,_=u.PROCESSING_INSTRUCTION_NODE=7,m=u.COMMENT_NODE=8,v=u.DOCUMENT_NODE=9,x=u.DOCUMENT_TYPE_NODE=10,w=u.DOCUMENT_FRAGMENT_NODE=11,T=u.NOTATION_NODE=12,E={},A={};E.INDEX_SIZE_ERR=(A[1]="Index size error",1),E.DOMSTRING_SIZE_ERR=(A[2]="DOMString size error",2);var M=E.HIERARCHY_REQUEST_ERR=(A[3]="Hierarchy request error",3);E.WRONG_DOCUMENT_ERR=(A[4]="Wrong document",4),E.INVALID_CHARACTER_ERR=(A[5]="Invalid character",5),E.NO_DATA_ALLOWED_ERR=(A[6]="No data allowed",6),E.NO_MODIFICATION_ALLOWED_ERR=(A[7]="No modification allowed",7);var F=E.NOT_FOUND_ERR=(A[8]="Not found",8);E.NOT_SUPPORTED_ERR=(A[9]="Not supported",9);var G=E.INUSE_ATTRIBUTE_ERR=(A[10]="Attribute in use",10);E.INVALID_STATE_ERR=(A[11]="Invalid state",11),E.SYNTAX_ERR=(A[12]="Syntax error",12),E.INVALID_MODIFICATION_ERR=(A[13]="Invalid modification",13),E.NAMESPACE_ERR=(A[14]="Invalid namespace",14),E.INVALID_ACCESS_ERR=(A[15]="Invalid access",15);function S(ae,fe){if(fe instanceof Error)var Me=fe;else Me=this,Error.call(this,A[ae]),this.message=A[ae],Error.captureStackTrace&&Error.captureStackTrace(this,S);return Me.code=ae,fe&&(this.message=this.message+": "+fe),Me}S.prototype=Error.prototype,l(E,S);function I(){}I.prototype={length:0,item:function(ae){return ae>=0&&ae<this.length?this[ae]:null},toString:function(ae,fe){for(var Me=[],Ie=0;Ie<this.length;Ie++)Wt(this[Ie],Me,ae,fe);return Me.join("")},filter:function(ae){return Array.prototype.filter.call(this,ae)},indexOf:function(ae){return Array.prototype.indexOf.call(this,ae)}};function C(ae,fe){this._node=ae,this._refresh=fe,H(this)}function H(ae){var fe=ae._node._inc||ae._node.ownerDocument._inc;if(ae._inc!==fe){var Me=ae._refresh(ae._node);if(yr(ae,"length",Me.length),!ae.$$length||Me.length<ae.$$length)for(var Ie=Me.length;Ie in ae;Ie++)Object.prototype.hasOwnProperty.call(ae,Ie)&&delete ae[Ie];l(Me,ae),ae._inc=fe}}C.prototype.item=function(ae){return H(this),this[ae]||null},c(C,I);function B(){}function $(ae,fe){for(var Me=ae.length;Me--;)if(ae[Me]===fe)return Me}function X(ae,fe,Me,Ie){if(Ie?fe[$(fe,Ie)]=Me:fe[fe.length++]=Me,ae){Me.ownerElement=ae;var it=ae.ownerDocument;it&&(Ie&&we(it,ae,Ie),de(it,ae,Me))}}function V(ae,fe,Me){var Ie=$(fe,Me);if(Ie>=0){for(var it=fe.length-1;Ie<it;)fe[Ie]=fe[++Ie];if(fe.length=it,ae){var Tt=ae.ownerDocument;Tt&&(we(Tt,ae,Me),Me.ownerElement=null)}}else throw new S(F,new Error(ae.tagName+"@"+Me))}B.prototype={length:0,item:I.prototype.item,getNamedItem:function(ae){for(var fe=this.length;fe--;){var Me=this[fe];if(Me.nodeName==ae)return Me}},setNamedItem:function(ae){var fe=ae.ownerElement;if(fe&&fe!=this._ownerElement)throw new S(G);var Me=this.getNamedItem(ae.nodeName);return X(this._ownerElement,this,ae,Me),Me},setNamedItemNS:function(ae){var fe=ae.ownerElement,Me;if(fe&&fe!=this._ownerElement)throw new S(G);return Me=this.getNamedItemNS(ae.namespaceURI,ae.localName),X(this._ownerElement,this,ae,Me),Me},removeNamedItem:function(ae){var fe=this.getNamedItem(ae);return V(this._ownerElement,this,fe),fe},removeNamedItemNS:function(ae,fe){var Me=this.getNamedItemNS(ae,fe);return V(this._ownerElement,this,Me),Me},getNamedItemNS:function(ae,fe){for(var Me=this.length;Me--;){var Ie=this[Me];if(Ie.localName==fe&&Ie.namespaceURI==ae)return Ie}return null}};function Q(){}Q.prototype={hasFeature:function(ae,fe){return!0},createDocument:function(ae,fe,Me){var Ie=new ne;if(Ie.implementation=this,Ie.childNodes=new I,Ie.doctype=Me||null,Me&&Ie.appendChild(Me),fe){var it=Ie.createElementNS(ae,fe);Ie.appendChild(it)}return Ie},createDocumentType:function(ae,fe,Me){var Ie=new ke;return Ie.name=ae,Ie.nodeName=ae,Ie.publicId=fe||"",Ie.systemId=Me||"",Ie}};function R(){}R.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(ae,fe){return ge(this,ae,fe)},replaceChild:function(ae,fe){ge(this,ae,fe,re),fe&&this.removeChild(fe)},removeChild:function(ae){return Ee(this,ae)},appendChild:function(ae){return this.insertBefore(ae,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(ae){return rr(this.ownerDocument||this,this,ae)},normalize:function(){for(var ae=this.firstChild;ae;){var fe=ae.nextSibling;fe&&fe.nodeType==f&&ae.nodeType==f?(this.removeChild(fe),ae.appendData(fe.data)):(ae.normalize(),ae=fe)}},isSupported:function(ae,fe){return this.ownerDocument.implementation.hasFeature(ae,fe)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(ae){for(var fe=this;fe;){var Me=fe._nsMap;if(Me){for(var Ie in Me)if(Object.prototype.hasOwnProperty.call(Me,Ie)&&Me[Ie]===ae)return Ie}fe=fe.nodeType==h?fe.ownerDocument:fe.parentNode}return null},lookupNamespaceURI:function(ae){for(var fe=this;fe;){var Me=fe._nsMap;if(Me&&Object.prototype.hasOwnProperty.call(Me,ae))return Me[ae];fe=fe.nodeType==h?fe.ownerDocument:fe.parentNode}return null},isDefaultNamespace:function(ae){var fe=this.lookupPrefix(ae);return fe==null}};function O(ae){return ae=="<"&&"&lt;"||ae==">"&&"&gt;"||ae=="&"&&"&amp;"||ae=='"'&&"&quot;"||"&#"+ae.charCodeAt()+";"}l(u,R),l(u,R.prototype);function L(ae,fe){if(fe(ae))return!0;if(ae=ae.firstChild)do if(L(ae,fe))return!0;while(ae=ae.nextSibling)}function ne(){this.ownerDocument=this}function de(ae,fe,Me){ae&&ae._inc++;var Ie=Me.namespaceURI;Ie===t.XMLNS&&(fe._nsMap[Me.prefix?Me.localName:""]=Me.value)}function we(ae,fe,Me,Ie){ae&&ae._inc++;var it=Me.namespaceURI;it===t.XMLNS&&delete fe._nsMap[Me.prefix?Me.localName:""]}function be(ae,fe,Me){if(ae&&ae._inc){ae._inc++;var Ie=fe.childNodes;if(Me)Ie[Ie.length++]=Me;else{for(var it=fe.firstChild,Tt=0;it;)Ie[Tt++]=it,it=it.nextSibling;Ie.length=Tt,delete Ie[Ie.length]}}}function Ee(ae,fe){var Me=fe.previousSibling,Ie=fe.nextSibling;return Me?Me.nextSibling=Ie:ae.firstChild=Ie,Ie?Ie.previousSibling=Me:ae.lastChild=Me,fe.parentNode=null,fe.previousSibling=null,fe.nextSibling=null,be(ae.ownerDocument,ae),fe}function Fe(ae){return ae&&(ae.nodeType===R.DOCUMENT_NODE||ae.nodeType===R.DOCUMENT_FRAGMENT_NODE||ae.nodeType===R.ELEMENT_NODE)}function xe(ae){return ae&&(ue(ae)||Se(ae)||ce(ae)||ae.nodeType===R.DOCUMENT_FRAGMENT_NODE||ae.nodeType===R.COMMENT_NODE||ae.nodeType===R.PROCESSING_INSTRUCTION_NODE)}function ce(ae){return ae&&ae.nodeType===R.DOCUMENT_TYPE_NODE}function ue(ae){return ae&&ae.nodeType===R.ELEMENT_NODE}function Se(ae){return ae&&ae.nodeType===R.TEXT_NODE}function U(ae,fe){var Me=ae.childNodes||[];if(e(Me,ue)||ce(fe))return!1;var Ie=e(Me,ce);return!(fe&&Ie&&Me.indexOf(Ie)>Me.indexOf(fe))}function he(ae,fe){var Me=ae.childNodes||[];function Ie(Tt){return ue(Tt)&&Tt!==fe}if(e(Me,Ie))return!1;var it=e(Me,ce);return!(fe&&it&&Me.indexOf(it)>Me.indexOf(fe))}function pe(ae,fe,Me){if(!Fe(ae))throw new S(M,"Unexpected parent node type "+ae.nodeType);if(Me&&Me.parentNode!==ae)throw new S(F,"child not in parent");if(!xe(fe)||ce(fe)&&ae.nodeType!==R.DOCUMENT_NODE)throw new S(M,"Unexpected node type "+fe.nodeType+" for parent node type "+ae.nodeType)}function ie(ae,fe,Me){var Ie=ae.childNodes||[],it=fe.childNodes||[];if(fe.nodeType===R.DOCUMENT_FRAGMENT_NODE){var Tt=it.filter(ue);if(Tt.length>1||e(it,Se))throw new S(M,"More than one element or text in fragment");if(Tt.length===1&&!U(ae,Me))throw new S(M,"Element in fragment can not be inserted before doctype")}if(ue(fe)&&!U(ae,Me))throw new S(M,"Only one element can be added and only after doctype");if(ce(fe)){if(e(Ie,ce))throw new S(M,"Only one doctype is allowed");var rn=e(Ie,ue);if(Me&&Ie.indexOf(rn)<Ie.indexOf(Me))throw new S(M,"Doctype can only be inserted before an element");if(!Me&&rn)throw new S(M,"Doctype can not be appended since element is present")}}function re(ae,fe,Me){var Ie=ae.childNodes||[],it=fe.childNodes||[];if(fe.nodeType===R.DOCUMENT_FRAGMENT_NODE){var Tt=it.filter(ue);if(Tt.length>1||e(it,Se))throw new S(M,"More than one element or text in fragment");if(Tt.length===1&&!he(ae,Me))throw new S(M,"Element in fragment can not be inserted before doctype")}if(ue(fe)&&!he(ae,Me))throw new S(M,"Only one element can be added and only after doctype");if(ce(fe)){if(e(Ie,function(ur){return ce(ur)&&ur!==Me}))throw new S(M,"Only one doctype is allowed");var rn=e(Ie,ue);if(Me&&Ie.indexOf(rn)<Ie.indexOf(Me))throw new S(M,"Doctype can only be inserted before an element")}}function ge(ae,fe,Me,Ie){pe(ae,fe,Me),ae.nodeType===R.DOCUMENT_NODE&&(Ie||ie)(ae,fe,Me);var it=fe.parentNode;if(it&&it.removeChild(fe),fe.nodeType===w){var Tt=fe.firstChild;if(Tt==null)return fe;var rn=fe.lastChild}else Tt=rn=fe;var Un=Me?Me.previousSibling:ae.lastChild;Tt.previousSibling=Un,rn.nextSibling=Me,Un?Un.nextSibling=Tt:ae.firstChild=Tt,Me==null?ae.lastChild=rn:Me.previousSibling=rn;do Tt.parentNode=ae;while(Tt!==rn&&(Tt=Tt.nextSibling));return be(ae.ownerDocument||ae,ae),fe.nodeType==w&&(fe.firstChild=fe.lastChild=null),fe}function Ce(ae,fe){return fe.parentNode&&fe.parentNode.removeChild(fe),fe.parentNode=ae,fe.previousSibling=ae.lastChild,fe.nextSibling=null,fe.previousSibling?fe.previousSibling.nextSibling=fe:ae.firstChild=fe,ae.lastChild=fe,be(ae.ownerDocument,ae,fe),fe}ne.prototype={nodeName:"#document",nodeType:v,doctype:null,documentElement:null,_inc:1,insertBefore:function(ae,fe){if(ae.nodeType==w){for(var Me=ae.firstChild;Me;){var Ie=Me.nextSibling;this.insertBefore(Me,fe),Me=Ie}return ae}return ge(this,ae,fe),ae.ownerDocument=this,this.documentElement===null&&ae.nodeType===d&&(this.documentElement=ae),ae},removeChild:function(ae){return this.documentElement==ae&&(this.documentElement=null),Ee(this,ae)},replaceChild:function(ae,fe){ge(this,ae,fe,re),ae.ownerDocument=this,fe&&this.removeChild(fe),ue(ae)&&(this.documentElement=ae)},importNode:function(ae,fe){return Jn(this,ae,fe)},getElementById:function(ae){var fe=null;return L(this.documentElement,function(Me){if(Me.nodeType==d&&Me.getAttribute("id")==ae)return fe=Me,!0}),fe},getElementsByClassName:function(ae){var fe=a(ae);return new C(this,function(Me){var Ie=[];return fe.length>0&&L(Me.documentElement,function(it){if(it!==Me&&it.nodeType===d){var Tt=it.getAttribute("class");if(Tt){var rn=ae===Tt;if(!rn){var Un=a(Tt);rn=fe.every(o(Un))}rn&&Ie.push(it)}}}),Ie})},createElement:function(ae){var fe=new q;fe.ownerDocument=this,fe.nodeName=ae,fe.tagName=ae,fe.localName=ae,fe.childNodes=new I;var Me=fe.attributes=new B;return Me._ownerElement=fe,fe},createDocumentFragment:function(){var ae=new Te;return ae.ownerDocument=this,ae.childNodes=new I,ae},createTextNode:function(ae){var fe=new ee;return fe.ownerDocument=this,fe.appendData(ae),fe},createComment:function(ae){var fe=new se;return fe.ownerDocument=this,fe.appendData(ae),fe},createCDATASection:function(ae){var fe=new ve;return fe.ownerDocument=this,fe.appendData(ae),fe},createProcessingInstruction:function(ae,fe){var Me=new Be;return Me.ownerDocument=this,Me.tagName=Me.nodeName=Me.target=ae,Me.nodeValue=Me.data=fe,Me},createAttribute:function(ae){var fe=new te;return fe.ownerDocument=this,fe.name=ae,fe.nodeName=ae,fe.localName=ae,fe.specified=!0,fe},createEntityReference:function(ae){var fe=new ze;return fe.ownerDocument=this,fe.nodeName=ae,fe},createElementNS:function(ae,fe){var Me=new q,Ie=fe.split(":"),it=Me.attributes=new B;return Me.childNodes=new I,Me.ownerDocument=this,Me.nodeName=fe,Me.tagName=fe,Me.namespaceURI=ae,Ie.length==2?(Me.prefix=Ie[0],Me.localName=Ie[1]):Me.localName=fe,it._ownerElement=Me,Me},createAttributeNS:function(ae,fe){var Me=new te,Ie=fe.split(":");return Me.ownerDocument=this,Me.nodeName=fe,Me.name=fe,Me.namespaceURI=ae,Me.specified=!0,Ie.length==2?(Me.prefix=Ie[0],Me.localName=Ie[1]):Me.localName=fe,Me}},c(ne,R);function q(){this._nsMap={}}q.prototype={nodeType:d,hasAttribute:function(ae){return this.getAttributeNode(ae)!=null},getAttribute:function(ae){var fe=this.getAttributeNode(ae);return fe&&fe.value||""},getAttributeNode:function(ae){return this.attributes.getNamedItem(ae)},setAttribute:function(ae,fe){var Me=this.ownerDocument.createAttribute(ae);Me.value=Me.nodeValue=""+fe,this.setAttributeNode(Me)},removeAttribute:function(ae){var fe=this.getAttributeNode(ae);fe&&this.removeAttributeNode(fe)},appendChild:function(ae){return ae.nodeType===w?this.insertBefore(ae,null):Ce(this,ae)},setAttributeNode:function(ae){return this.attributes.setNamedItem(ae)},setAttributeNodeNS:function(ae){return this.attributes.setNamedItemNS(ae)},removeAttributeNode:function(ae){return this.attributes.removeNamedItem(ae.nodeName)},removeAttributeNS:function(ae,fe){var Me=this.getAttributeNodeNS(ae,fe);Me&&this.removeAttributeNode(Me)},hasAttributeNS:function(ae,fe){return this.getAttributeNodeNS(ae,fe)!=null},getAttributeNS:function(ae,fe){var Me=this.getAttributeNodeNS(ae,fe);return Me&&Me.value||""},setAttributeNS:function(ae,fe,Me){var Ie=this.ownerDocument.createAttributeNS(ae,fe);Ie.value=Ie.nodeValue=""+Me,this.setAttributeNode(Ie)},getAttributeNodeNS:function(ae,fe){return this.attributes.getNamedItemNS(ae,fe)},getElementsByTagName:function(ae){return new C(this,function(fe){var Me=[];return L(fe,function(Ie){Ie!==fe&&Ie.nodeType==d&&(ae==="*"||Ie.tagName==ae)&&Me.push(Ie)}),Me})},getElementsByTagNameNS:function(ae,fe){return new C(this,function(Me){var Ie=[];return L(Me,function(it){it!==Me&&it.nodeType===d&&(ae==="*"||it.namespaceURI===ae)&&(fe==="*"||it.localName==fe)&&Ie.push(it)}),Ie})}},ne.prototype.getElementsByTagName=q.prototype.getElementsByTagName,ne.prototype.getElementsByTagNameNS=q.prototype.getElementsByTagNameNS,c(q,R);function te(){}te.prototype.nodeType=h,c(te,R);function j(){}j.prototype={data:"",substringData:function(ae,fe){return this.data.substring(ae,ae+fe)},appendData:function(ae){ae=this.data+ae,this.nodeValue=this.data=ae,this.length=ae.length},insertData:function(ae,fe){this.replaceData(ae,0,fe)},appendChild:function(ae){throw new Error(A[M])},deleteData:function(ae,fe){this.replaceData(ae,fe,"")},replaceData:function(ae,fe,Me){var Ie=this.data.substring(0,ae),it=this.data.substring(ae+fe);Me=Ie+Me+it,this.nodeValue=this.data=Me,this.length=Me.length}},c(j,R);function ee(){}ee.prototype={nodeName:"#text",nodeType:f,splitText:function(ae){var fe=this.data,Me=fe.substring(ae);fe=fe.substring(0,ae),this.data=this.nodeValue=fe,this.length=fe.length;var Ie=this.ownerDocument.createTextNode(Me);return this.parentNode&&this.parentNode.insertBefore(Ie,this.nextSibling),Ie}},c(ee,j);function se(){}se.prototype={nodeName:"#comment",nodeType:m},c(se,j);function ve(){}ve.prototype={nodeName:"#cdata-section",nodeType:p},c(ve,j);function ke(){}ke.prototype.nodeType=x,c(ke,R);function Re(){}Re.prototype.nodeType=T,c(Re,R);function Oe(){}Oe.prototype.nodeType=b,c(Oe,R);function ze(){}ze.prototype.nodeType=g,c(ze,R);function Te(){}Te.prototype.nodeName="#document-fragment",Te.prototype.nodeType=w,c(Te,R);function Be(){}Be.prototype.nodeType=_,c(Be,R);function qe(){}qe.prototype.serializeToString=function(ae,fe,Me){return tt.call(ae,fe,Me)},R.prototype.toString=tt;function tt(ae,fe){var Me=[],Ie=this.nodeType==9&&this.documentElement||this,it=Ie.prefix,Tt=Ie.namespaceURI;if(Tt&&it==null){var it=Ie.lookupPrefix(Tt);if(it==null)var rn=[{namespace:Tt,prefix:null}]}return Wt(this,Me,ae,fe,rn),Me.join("")}function xt(ae,fe,Me){var Ie=ae.prefix||"",it=ae.namespaceURI;if(!it||Ie==="xml"&&it===t.XML||it===t.XMLNS)return!1;for(var Tt=Me.length;Tt--;){var rn=Me[Tt];if(rn.prefix===Ie)return rn.namespace!==it}return!0}function ft(ae,fe,Me){ae.push(" ",fe,'="',Me.replace(/[<>&"\t\n\r]/g,O),'"')}function Wt(ae,fe,Me,Ie,it){if(it||(it=[]),Ie)if(ae=Ie(ae),ae){if(typeof ae=="string"){fe.push(ae);return}}else return;switch(ae.nodeType){case d:var Tt=ae.attributes,rn=Tt.length,bn=ae.firstChild,Un=ae.tagName;Me=t.isHTML(ae.namespaceURI)||Me;var ur=Un;if(!Me&&!ae.prefix&&ae.namespaceURI){for(var vr,dr=0;dr<Tt.length;dr++)if(Tt.item(dr).name==="xmlns"){vr=Tt.item(dr).value;break}if(!vr)for(var Dn=it.length-1;Dn>=0;Dn--){var Ze=it[Dn];if(Ze.prefix===""&&Ze.namespace===ae.namespaceURI){vr=Ze.namespace;break}}if(vr!==ae.namespaceURI)for(var Dn=it.length-1;Dn>=0;Dn--){var Ze=it[Dn];if(Ze.namespace===ae.namespaceURI){Ze.prefix&&(ur=Ze.prefix+":"+Un);break}}}fe.push("<",ur);for(var ct=0;ct<rn;ct++){var rt=Tt.item(ct);rt.prefix=="xmlns"?it.push({prefix:rt.localName,namespace:rt.value}):rt.nodeName=="xmlns"&&it.push({prefix:"",namespace:rt.value})}for(var ct=0;ct<rn;ct++){var rt=Tt.item(ct);if(xt(rt,Me,it)){var Mn=rt.prefix||"",ki=rt.namespaceURI;ft(fe,Mn?"xmlns:"+Mn:"xmlns",ki),it.push({prefix:Mn,namespace:ki})}Wt(rt,fe,Me,Ie,it)}if(Un===ur&&xt(ae,Me,it)){var Mn=ae.prefix||"",ki=ae.namespaceURI;ft(fe,Mn?"xmlns:"+Mn:"xmlns",ki),it.push({prefix:Mn,namespace:ki})}if(bn||Me&&!/^(?:meta|link|img|br|hr|input)$/i.test(Un)){if(fe.push(">"),Me&&/^script$/i.test(Un))for(;bn;)bn.data?fe.push(bn.data):Wt(bn,fe,Me,Ie,it.slice()),bn=bn.nextSibling;else for(;bn;)Wt(bn,fe,Me,Ie,it.slice()),bn=bn.nextSibling;fe.push("</",ur,">")}else fe.push("/>");return;case v:case w:for(var bn=ae.firstChild;bn;)Wt(bn,fe,Me,Ie,it.slice()),bn=bn.nextSibling;return;case h:return ft(fe,ae.name,ae.value);case f:return fe.push(ae.data.replace(/[<&>]/g,O));case p:return fe.push("<![CDATA[",ae.data,"]]>");case m:return fe.push("<!--",ae.data,"-->");case x:var mi=ae.publicId,gi=ae.systemId;if(fe.push("<!DOCTYPE ",ae.name),mi)fe.push(" PUBLIC ",mi),gi&&gi!="."&&fe.push(" ",gi),fe.push(">");else if(gi&&gi!=".")fe.push(" SYSTEM ",gi,">");else{var ms=ae.internalSubset;ms&&fe.push(" [",ms,"]"),fe.push(">")}return;case _:return fe.push("<?",ae.target," ",ae.data,"?>");case g:return fe.push("&",ae.nodeName,";");default:fe.push("??",ae.nodeName)}}function Jn(ae,fe,Me){var Ie;switch(fe.nodeType){case d:Ie=fe.cloneNode(!1),Ie.ownerDocument=ae;case w:break;case h:Me=!0;break}if(Ie||(Ie=fe.cloneNode(!1)),Ie.ownerDocument=ae,Ie.parentNode=null,Me)for(var it=fe.firstChild;it;)Ie.appendChild(Jn(ae,it,Me)),it=it.nextSibling;return Ie}function rr(ae,fe,Me){var Ie=new fe.constructor;for(var it in fe)if(Object.prototype.hasOwnProperty.call(fe,it)){var Tt=fe[it];typeof Tt!="object"&&Tt!=Ie[it]&&(Ie[it]=Tt)}switch(fe.childNodes&&(Ie.childNodes=new I),Ie.ownerDocument=ae,Ie.nodeType){case d:var rn=fe.attributes,Un=Ie.attributes=new B,ur=rn.length;Un._ownerElement=Ie;for(var vr=0;vr<ur;vr++)Ie.setAttributeNode(rr(ae,rn.item(vr),!0));break;case h:Me=!0}if(Me)for(var dr=fe.firstChild;dr;)Ie.appendChild(rr(ae,dr,Me)),dr=dr.nextSibling;return Ie}function yr(ae,fe,Me){ae[fe]=Me}try{if(Object.defineProperty){let ae=function(fe){switch(fe.nodeType){case d:case w:var Me=[];for(fe=fe.firstChild;fe;)fe.nodeType!==7&&fe.nodeType!==8&&Me.push(ae(fe)),fe=fe.nextSibling;return Me.join("");default:return fe.nodeValue}};Object.defineProperty(C.prototype,"length",{get:function(){return H(this),this.$$length}}),Object.defineProperty(R.prototype,"textContent",{get:function(){return ae(this)},set:function(fe){switch(this.nodeType){case d:case w:for(;this.firstChild;)this.removeChild(this.firstChild);(fe||String(fe))&&this.appendChild(this.ownerDocument.createTextNode(fe));break;default:this.data=fe,this.value=fe,this.nodeValue=fe}}}),yr=function(fe,Me,Ie){fe["$$"+Me]=Ie}}}catch{}return Xa.DocumentType=ke,Xa.DOMException=S,Xa.DOMImplementation=Q,Xa.Element=q,Xa.Node=R,Xa.NodeList=I,Xa.XMLSerializer=qe,Xa}var Gp={},_w={},uP;function d6(){return uP||(uP=1,function(n){var e=Pv().freeze;n.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),n.entityMap=n.HTML_ENTITIES}(_w)),_w}var ay={},dP;function h6(){if(dP)return ay;dP=1;var n=Pv().NAMESPACE,e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),r=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),i=0,s=1,a=2,o=3,l=4,c=5,u=6,d=7;function h(M,F){this.message=M,this.locator=F,Error.captureStackTrace&&Error.captureStackTrace(this,h)}h.prototype=new Error,h.prototype.name=h.name;function f(){}f.prototype={parse:function(M,F,G){var S=this.domBuilder;S.startDocument(),x(F,F={}),p(M,F,G,S,this.errorHandler),S.endDocument()}};function p(M,F,G,S,I){function C(q){if(q>65535){q-=65536;var te=55296+(q>>10),j=56320+(q&1023);return String.fromCharCode(te,j)}else return String.fromCharCode(q)}function H(q){var te=q.slice(1,-1);return Object.hasOwnProperty.call(G,te)?G[te]:te.charAt(0)==="#"?C(parseInt(te.substr(1).replace("x","0x"))):(I.error("entity not found:"+q),q)}function B(q){if(q>ne){var te=M.substring(ne,q).replace(/&#?\w+;/g,H);R&&$(ne),S.characters(te,0,q-ne),ne=q}}function $(q,te){for(;q>=V&&(te=Q.exec(M));)X=te.index,V=X+te[0].length,R.lineNumber++;R.columnNumber=q-X+1}for(var X=0,V=0,Q=/.*(?:\r\n?|\n)|.*$/g,R=S.locator,O=[{currentNSMap:F}],L={},ne=0;;){try{var de=M.indexOf("<",ne);if(de<0){if(!M.substr(ne).match(/^\s*$/)){var we=S.doc,be=we.createTextNode(M.substr(ne));we.appendChild(be),S.currentElement=be}return}switch(de>ne&&B(de),M.charAt(de+1)){case"/":var pe=M.indexOf(">",de+3),Ee=M.substring(de+2,pe).replace(/[ \t\n\r]+$/g,""),Fe=O.pop();pe<0?(Ee=M.substring(de+2).replace(/[\s<].*/,""),I.error("end tag name: "+Ee+" is not complete:"+Fe.tagName),pe=de+1+Ee.length):Ee.match(/\s</)&&(Ee=Ee.replace(/[\s<].*/,""),I.error("end tag name: "+Ee+" maybe not complete"),pe=de+1+Ee.length);var xe=Fe.localNSMap,ce=Fe.tagName==Ee,ue=ce||Fe.tagName&&Fe.tagName.toLowerCase()==Ee.toLowerCase();if(ue){if(S.endElement(Fe.uri,Fe.localName,Ee),xe)for(var Se in xe)Object.prototype.hasOwnProperty.call(xe,Se)&&S.endPrefixMapping(Se);ce||I.fatalError("end tag name: "+Ee+" is not match the current start tagName:"+Fe.tagName)}else O.push(Fe);pe++;break;case"?":R&&$(de),pe=T(M,de,S);break;case"!":R&&$(de),pe=w(M,de,S,I);break;default:R&&$(de);var U=new E,he=O[O.length-1].currentNSMap,pe=b(M,de,U,he,H,I),ie=U.length;if(!U.closed&&v(M,pe,U.tagName,L)&&(U.closed=!0,G.nbsp||I.warning("unclosed xml attribute")),R&&ie){for(var re=g(R,{}),ge=0;ge<ie;ge++){var Ce=U[ge];$(Ce.offset),Ce.locator=g(R,{})}S.locator=re,_(U,S,he)&&O.push(U),S.locator=R}else _(U,S,he)&&O.push(U);n.isHTML(U.uri)&&!U.closed?pe=m(M,pe,U.tagName,H,S):pe++}}catch(q){if(q instanceof h)throw q;I.error("element parse error: "+q),pe=-1}pe>ne?ne=pe:B(Math.max(de,ne)+1)}}function g(M,F){return F.lineNumber=M.lineNumber,F.columnNumber=M.columnNumber,F}function b(M,F,G,S,I,C){function H(R,O,L){G.attributeNames.hasOwnProperty(R)&&C.fatalError("Attribute "+R+" redefined"),G.addValue(R,O.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,I),L)}for(var B,$,X=++F,V=i;;){var Q=M.charAt(X);switch(Q){case"=":if(V===s)B=M.slice(F,X),V=o;else if(V===a)V=o;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(V===o||V===s)if(V===s&&(C.warning('attribute value must after "="'),B=M.slice(F,X)),F=X+1,X=M.indexOf(Q,F),X>0)$=M.slice(F,X),H(B,$,F-1),V=c;else throw new Error("attribute value no end '"+Q+"' match");else if(V==l)$=M.slice(F,X),H(B,$,F),C.warning('attribute "'+B+'" missed start quot('+Q+")!!"),F=X+1,V=c;else throw new Error('attribute value must after "="');break;case"/":switch(V){case i:G.setTagName(M.slice(F,X));case c:case u:case d:V=d,G.closed=!0;case l:case s:break;case a:G.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return C.error("unexpected end of input"),V==i&&G.setTagName(M.slice(F,X)),X;case">":switch(V){case i:G.setTagName(M.slice(F,X));case c:case u:case d:break;case l:case s:$=M.slice(F,X),$.slice(-1)==="/"&&(G.closed=!0,$=$.slice(0,-1));case a:V===a&&($=B),V==l?(C.warning('attribute "'+$+'" missed quot(")!'),H(B,$,F)):((!n.isHTML(S[""])||!$.match(/^(?:disabled|checked|selected)$/i))&&C.warning('attribute "'+$+'" missed value!! "'+$+'" instead!!'),H($,$,F));break;case o:throw new Error("attribute value missed!!")}return X;case"":Q=" ";default:if(Q<=" ")switch(V){case i:G.setTagName(M.slice(F,X)),V=u;break;case s:B=M.slice(F,X),V=a;break;case l:var $=M.slice(F,X);C.warning('attribute "'+$+'" missed quot(")!!'),H(B,$,F);case c:V=u;break}else switch(V){case a:G.tagName,(!n.isHTML(S[""])||!B.match(/^(?:disabled|checked|selected)$/i))&&C.warning('attribute "'+B+'" missed value!! "'+B+'" instead2!!'),H(B,B,F),F=X,V=s;break;case c:C.warning('attribute space is required"'+B+'"!!');case u:V=s,F=X;break;case o:V=l,F=X;break;case d:throw new Error("elements closed character '/' and '>' must be connected to")}}X++}}function _(M,F,G){for(var S=M.tagName,I=null,Q=M.length;Q--;){var C=M[Q],H=C.qName,B=C.value,R=H.indexOf(":");if(R>0)var $=C.prefix=H.slice(0,R),X=H.slice(R+1),V=$==="xmlns"&&X;else X=H,$=null,V=H==="xmlns"&&"";C.localName=X,V!==!1&&(I==null&&(I={},x(G,G={})),G[V]=I[V]=B,C.uri=n.XMLNS,F.startPrefixMapping(V,B))}for(var Q=M.length;Q--;){C=M[Q];var $=C.prefix;$&&($==="xml"&&(C.uri=n.XML),$!=="xmlns"&&(C.uri=G[$||""]))}var R=S.indexOf(":");R>0?($=M.prefix=S.slice(0,R),X=M.localName=S.slice(R+1)):($=null,X=M.localName=S);var O=M.uri=G[$||""];if(F.startElement(O,X,S,M),M.closed){if(F.endElement(O,X,S),I)for($ in I)Object.prototype.hasOwnProperty.call(I,$)&&F.endPrefixMapping($)}else return M.currentNSMap=G,M.localNSMap=I,!0}function m(M,F,G,S,I){if(/^(?:script|textarea)$/i.test(G)){var C=M.indexOf("</"+G+">",F),H=M.substring(F+1,C);if(/[&<]/.test(H))return/^script$/i.test(G)?(I.characters(H,0,H.length),C):(H=H.replace(/&#?\w+;/g,S),I.characters(H,0,H.length),C)}return F+1}function v(M,F,G,S){var I=S[G];return I==null&&(I=M.lastIndexOf("</"+G+">"),I<F&&(I=M.lastIndexOf("</"+G)),S[G]=I),I<F}function x(M,F){for(var G in M)Object.prototype.hasOwnProperty.call(M,G)&&(F[G]=M[G])}function w(M,F,G,S){var I=M.charAt(F+2);switch(I){case"-":if(M.charAt(F+3)==="-"){var C=M.indexOf("-->",F+4);return C>F?(G.comment(M,F+4,C-F-4),C+3):(S.error("Unclosed comment"),-1)}else return-1;default:if(M.substr(F+3,6)=="CDATA["){var C=M.indexOf("]]>",F+9);return G.startCDATA(),G.characters(M,F+9,C-F-9),G.endCDATA(),C+3}var H=A(M,F),B=H.length;if(B>1&&/!doctype/i.test(H[0][0])){var $=H[1][0],X=!1,V=!1;B>3&&(/^public$/i.test(H[2][0])?(X=H[3][0],V=B>4&&H[4][0]):/^system$/i.test(H[2][0])&&(V=H[3][0]));var Q=H[B-1];return G.startDTD($,X,V),G.endDTD(),Q.index+Q[0].length}}return-1}function T(M,F,G){var S=M.indexOf("?>",F);if(S){var I=M.substring(F,S).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return I?(I[0].length,G.processingInstruction(I[1],I[2]),S+2):-1}return-1}function E(){this.attributeNames={}}E.prototype={setTagName:function(M){if(!r.test(M))throw new Error("invalid tagName:"+M);this.tagName=M},addValue:function(M,F,G){if(!r.test(M))throw new Error("invalid attribute:"+M);this.attributeNames[M]=this.length,this[this.length++]={qName:M,value:F,offset:G}},length:0,getLocalName:function(M){return this[M].localName},getLocator:function(M){return this[M].locator},getQName:function(M){return this[M].qName},getURI:function(M){return this[M].uri},getValue:function(M){return this[M].value}};function A(M,F){var G,S=[],I=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(I.lastIndex=F,I.exec(M);G=I.exec(M);)if(S.push(G),G[1])return S}return ay.XMLReader=f,ay.ParseError=h,ay}var hP;function f6(){if(hP)return Gp;hP=1;var n=Pv(),e=$E(),t=d6(),r=h6(),i=e.DOMImplementation,s=n.NAMESPACE,a=r.ParseError,o=r.XMLReader;function l(b){return b.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function c(b){this.options=b||{locator:{}}}c.prototype.parseFromString=function(b,_){var m=this.options,v=new o,x=m.domBuilder||new d,w=m.errorHandler,T=m.locator,E=m.xmlns||{},A=/\/x?html?$/.test(_),M=A?t.HTML_ENTITIES:t.XML_ENTITIES;T&&x.setDocumentLocator(T),v.errorHandler=u(w,x,T),v.domBuilder=m.domBuilder||x,A&&(E[""]=s.HTML),E.xml=E.xml||s.XML;var F=m.normalizeLineEndings||l;return b&&typeof b=="string"?v.parse(F(b),E,M):v.errorHandler.error("invalid doc source"),x.doc};function u(b,_,m){if(!b){if(_ instanceof d)return _;b=_}var v={},x=b instanceof Function;m=m||{};function w(T){var E=b[T];!E&&x&&(E=b.length==2?function(A){b(T,A)}:b),v[T]=E&&function(A){E("[xmldom "+T+"]	"+A+f(m))}||function(){}}return w("warning"),w("error"),w("fatalError"),v}function d(){this.cdata=!1}function h(b,_){_.lineNumber=b.lineNumber,_.columnNumber=b.columnNumber}d.prototype={startDocument:function(){this.doc=new i().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(b,_,m,v){var x=this.doc,w=x.createElementNS(b,m||_),T=v.length;g(this,w),this.currentElement=w,this.locator&&h(this.locator,w);for(var E=0;E<T;E++){var b=v.getURI(E),A=v.getValue(E),m=v.getQName(E),M=x.createAttributeNS(b,m);this.locator&&h(v.getLocator(E),M),M.value=M.nodeValue=A,w.setAttributeNode(M)}},endElement:function(b,_,m){var v=this.currentElement;v.tagName,this.currentElement=v.parentNode},startPrefixMapping:function(b,_){},endPrefixMapping:function(b){},processingInstruction:function(b,_){var m=this.doc.createProcessingInstruction(b,_);this.locator&&h(this.locator,m),g(this,m)},ignorableWhitespace:function(b,_,m){},characters:function(b,_,m){if(b=p.apply(this,arguments),b){if(this.cdata)var v=this.doc.createCDATASection(b);else var v=this.doc.createTextNode(b);this.currentElement?this.currentElement.appendChild(v):/^\s*$/.test(b)&&this.doc.appendChild(v),this.locator&&h(this.locator,v)}},skippedEntity:function(b){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(b){(this.locator=b)&&(b.lineNumber=0)},comment:function(b,_,m){b=p.apply(this,arguments);var v=this.doc.createComment(b);this.locator&&h(this.locator,v),g(this,v)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(b,_,m){var v=this.doc.implementation;if(v&&v.createDocumentType){var x=v.createDocumentType(b,_,m);this.locator&&h(this.locator,x),g(this,x),this.doc.doctype=x}},warning:function(b){console.warn("[xmldom warning]	"+b,f(this.locator))},error:function(b){console.error("[xmldom error]	"+b,f(this.locator))},fatalError:function(b){throw new a(b,this.locator)}};function f(b){if(b)return`
@`+(b.systemId||"")+"#[line:"+b.lineNumber+",col:"+b.columnNumber+"]"}function p(b,_,m){return typeof b=="string"?b.substr(_,m):b.length>=_+m||_?new java.lang.String(b,_,m)+"":b}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(b){d.prototype[b]=function(){return null}});function g(b,_){b.currentElement?b.currentElement.appendChild(_):b.doc.appendChild(_)}return Gp.__DOMHandler=d,Gp.normalizeLineEndings=l,Gp.DOMParser=c,Gp}var fP;function p6(){if(fP)return Vp;fP=1;var n=$E();return Vp.DOMImplementation=n.DOMImplementation,Vp.XMLSerializer=n.XMLSerializer,Vp.DOMParser=f6().DOMParser,Vp}var pP;function m6(){if(pP)return sy;pP=1;var n=p6(),e=$E();function t(r){var i=null,s=new n.DOMParser({errorHandler:function(o,l){i={level:o,message:l}}}),a=s.parseFromString(r);if(i===null)return a;throw new Error(i.level+": "+i.message)}return sy.parseFromString=t,sy.Node=e.Node,sy}var mP;function g6(){if(mP)return gw;mP=1;var n=Xl(),e=cr,t=m6(),r=jL(),i=r.Element;gw.readString=a;var s=t.Node;function a(o,l){l=l||{};try{var c=t.parseFromString(o,"text/xml")}catch(f){return n.reject(f)}if(c.documentElement.tagName==="parsererror")return n.resolve(new Error(c.documentElement.textContent));function u(f){switch(f.nodeType){case s.ELEMENT_NODE:return d(f);case s.TEXT_NODE:return r.text(f.nodeValue)}}function d(f){var p=h(f),g=[];e.forEach(f.childNodes,function(_){var m=u(_);m&&g.push(m)});var b={};return e.forEach(f.attributes,function(_){b[h(_)]=_.value}),new i(p,b,g)}function h(f){if(f.namespaceURI){var p=l[f.namespaceURI],g;return p?g=p+":":g="{"+f.namespaceURI+"}",g+f.localName}else return f.localName}return n.resolve(u(c.documentElement))}return gw}var bw={},vc={},ba={},gP;function Yl(){return gP||(gP=1,(function(){var n,e,t,r,i,s,a,o=[].slice,l={}.hasOwnProperty;n=function(){var c,u,d,h,f,p;if(p=arguments[0],f=2<=arguments.length?o.call(arguments,1):[],i(Object.assign))Object.assign.apply(null,arguments);else for(c=0,d=f.length;c<d;c++)if(h=f[c],h!=null)for(u in h)l.call(h,u)&&(p[u]=h[u]);return p},i=function(c){return!!c&&Object.prototype.toString.call(c)==="[object Function]"},s=function(c){var u;return!!c&&((u=typeof c)=="function"||u==="object")},t=function(c){return i(Array.isArray)?Array.isArray(c):Object.prototype.toString.call(c)==="[object Array]"},r=function(c){var u;if(t(c))return!c.length;for(u in c)if(l.call(c,u))return!1;return!0},a=function(c){var u,d;return s(c)&&(d=Object.getPrototypeOf(c))&&(u=d.constructor)&&typeof u=="function"&&u instanceof u&&Function.prototype.toString.call(u)===Function.prototype.toString.call(Object)},e=function(c){return i(c.valueOf)?c.valueOf():c},ba.assign=n,ba.isFunction=i,ba.isObject=s,ba.isArray=t,ba.isEmpty=r,ba.isPlainObject=a,ba.getValue=e}).call(ba)),ba}var ky={exports:{}},Fy={exports:{}},Iy={exports:{}},Oy={exports:{}},_6=Oy.exports,_P;function VL(){return _P||(_P=1,(function(){Oy.exports=function(){function n(e,t,r){if(this.options=e.options,this.stringify=e.stringify,this.parent=e,t==null)throw new Error("Missing attribute name. "+this.debugInfo(t));if(r==null)throw new Error("Missing attribute value. "+this.debugInfo(t));this.name=this.stringify.attName(t),this.value=this.stringify.attValue(r)}return n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.set(e).attribute(this)},n.prototype.debugInfo=function(e){return e=e||this.name,e==null?"parent: <"+this.parent.name+">":"attribute: {"+e+"}, parent: <"+this.parent.name+">"},n}()}).call(_6)),Oy.exports}var b6=Iy.exports,bP;function kv(){return bP||(bP=1,(function(){var n,e,t,r,i,s,a=function(l,c){for(var u in c)o.call(c,u)&&(l[u]=c[u]);function d(){this.constructor=l}return d.prototype=c.prototype,l.prototype=new d,l.__super__=c.prototype,l},o={}.hasOwnProperty;s=Yl(),i=s.isObject,r=s.isFunction,t=s.getValue,e=Gi(),n=VL(),Iy.exports=function(l){a(c,l);function c(u,d,h){if(c.__super__.constructor.call(this,u),d==null)throw new Error("Missing element name. "+this.debugInfo());this.name=this.stringify.eleName(d),this.attributes={},h!=null&&this.attribute(h),u.isDocument&&(this.isRoot=!0,this.documentObject=u,u.rootObject=this)}return c.prototype.clone=function(){var u,d,h,f;h=Object.create(this),h.isRoot&&(h.documentObject=null),h.attributes={},f=this.attributes;for(d in f)o.call(f,d)&&(u=f[d],h.attributes[d]=u.clone());return h.children=[],this.children.forEach(function(p){var g;return g=p.clone(),g.parent=h,h.children.push(g)}),h},c.prototype.attribute=function(u,d){var h,f;if(u!=null&&(u=t(u)),i(u))for(h in u)o.call(u,h)&&(f=u[h],this.attribute(h,f));else r(d)&&(d=d.apply()),(!this.options.skipNullAttributes||d!=null)&&(this.attributes[u]=new n(this,u,d));return this},c.prototype.removeAttribute=function(u){var d,h,f;if(u==null)throw new Error("Missing attribute name. "+this.debugInfo());if(u=t(u),Array.isArray(u))for(h=0,f=u.length;h<f;h++)d=u[h],delete this.attributes[d];else delete this.attributes[u];return this},c.prototype.toString=function(u){return this.options.writer.set(u).element(this)},c.prototype.att=function(u,d){return this.attribute(u,d)},c.prototype.a=function(u,d){return this.attribute(u,d)},c}(e)}).call(b6)),Iy.exports}var Uy={exports:{}},y6=Uy.exports,yP;function Fv(){return yP||(yP=1,(function(){var n,e=function(r,i){for(var s in i)t.call(i,s)&&(r[s]=i[s]);function a(){this.constructor=r}return a.prototype=i.prototype,r.prototype=new a,r.__super__=i.prototype,r},t={}.hasOwnProperty;n=Gi(),Uy.exports=function(r){e(i,r);function i(s,a){if(i.__super__.constructor.call(this,s),a==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.text=this.stringify.cdata(a)}return i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(s){return this.options.writer.set(s).cdata(this)},i}(n)}).call(y6)),Uy.exports}var Ly={exports:{}},v6=Ly.exports,vP;function Iv(){return vP||(vP=1,(function(){var n,e=function(r,i){for(var s in i)t.call(i,s)&&(r[s]=i[s]);function a(){this.constructor=r}return a.prototype=i.prototype,r.prototype=new a,r.__super__=i.prototype,r},t={}.hasOwnProperty;n=Gi(),Ly.exports=function(r){e(i,r);function i(s,a){if(i.__super__.constructor.call(this,s),a==null)throw new Error("Missing comment text. "+this.debugInfo());this.text=this.stringify.comment(a)}return i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(s){return this.options.writer.set(s).comment(this)},i}(n)}).call(v6)),Ly.exports}var Ry={exports:{}},w6=Ry.exports,wP;function Ov(){return wP||(wP=1,(function(){var n,e,t=function(i,s){for(var a in s)r.call(s,a)&&(i[a]=s[a]);function o(){this.constructor=i}return o.prototype=s.prototype,i.prototype=new o,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=Yl().isObject,n=Gi(),Ry.exports=function(i){t(s,i);function s(a,o,l,c){var u;s.__super__.constructor.call(this,a),e(o)&&(u=o,o=u.version,l=u.encoding,c=u.standalone),o||(o="1.0"),this.version=this.stringify.xmlVersion(o),l!=null&&(this.encoding=this.stringify.xmlEncoding(l)),c!=null&&(this.standalone=this.stringify.xmlStandalone(c))}return s.prototype.toString=function(a){return this.options.writer.set(a).declaration(this)},s}(n)}).call(w6)),Ry.exports}var By={exports:{}},$y={exports:{}},x6=$y.exports,xP;function Uv(){return xP||(xP=1,(function(){var n,e=function(r,i){for(var s in i)t.call(i,s)&&(r[s]=i[s]);function a(){this.constructor=r}return a.prototype=i.prototype,r.prototype=new a,r.__super__=i.prototype,r},t={}.hasOwnProperty;n=Gi(),$y.exports=function(r){e(i,r);function i(s,a,o,l,c,u){if(i.__super__.constructor.call(this,s),a==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(o==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(a));if(!l)throw new Error("Missing DTD attribute type. "+this.debugInfo(a));if(!c)throw new Error("Missing DTD attribute default. "+this.debugInfo(a));if(c.indexOf("#")!==0&&(c="#"+c),!c.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(a));if(u&&!c.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(a));this.elementName=this.stringify.eleName(a),this.attributeName=this.stringify.attName(o),this.attributeType=this.stringify.dtdAttType(l),this.defaultValue=this.stringify.dtdAttDefault(u),this.defaultValueType=c}return i.prototype.toString=function(s){return this.options.writer.set(s).dtdAttList(this)},i}(n)}).call(x6)),$y.exports}var Ny={exports:{}},T6=Ny.exports,TP;function Lv(){return TP||(TP=1,(function(){var n,e,t=function(i,s){for(var a in s)r.call(s,a)&&(i[a]=s[a]);function o(){this.constructor=i}return o.prototype=s.prototype,i.prototype=new o,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=Yl().isObject,n=Gi(),Ny.exports=function(i){t(s,i);function s(a,o,l,c){if(s.__super__.constructor.call(this,a),l==null)throw new Error("Missing DTD entity name. "+this.debugInfo(l));if(c==null)throw new Error("Missing DTD entity value. "+this.debugInfo(l));if(this.pe=!!o,this.name=this.stringify.eleName(l),!e(c))this.value=this.stringify.dtdEntityValue(c);else{if(!c.pubID&&!c.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(l));if(c.pubID&&!c.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(l));if(c.pubID!=null&&(this.pubID=this.stringify.dtdPubID(c.pubID)),c.sysID!=null&&(this.sysID=this.stringify.dtdSysID(c.sysID)),c.nData!=null&&(this.nData=this.stringify.dtdNData(c.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(l))}}return s.prototype.toString=function(a){return this.options.writer.set(a).dtdEntity(this)},s}(n)}).call(T6)),Ny.exports}var zy={exports:{}},E6=zy.exports,EP;function Rv(){return EP||(EP=1,(function(){var n,e=function(r,i){for(var s in i)t.call(i,s)&&(r[s]=i[s]);function a(){this.constructor=r}return a.prototype=i.prototype,r.prototype=new a,r.__super__=i.prototype,r},t={}.hasOwnProperty;n=Gi(),zy.exports=function(r){e(i,r);function i(s,a,o){if(i.__super__.constructor.call(this,s),a==null)throw new Error("Missing DTD element name. "+this.debugInfo());o||(o="(#PCDATA)"),Array.isArray(o)&&(o="("+o.join(",")+")"),this.name=this.stringify.eleName(a),this.value=this.stringify.dtdElementValue(o)}return i.prototype.toString=function(s){return this.options.writer.set(s).dtdElement(this)},i}(n)}).call(E6)),zy.exports}var Wy={exports:{}},D6=Wy.exports,DP;function Bv(){return DP||(DP=1,(function(){var n,e=function(r,i){for(var s in i)t.call(i,s)&&(r[s]=i[s]);function a(){this.constructor=r}return a.prototype=i.prototype,r.prototype=new a,r.__super__=i.prototype,r},t={}.hasOwnProperty;n=Gi(),Wy.exports=function(r){e(i,r);function i(s,a,o){if(i.__super__.constructor.call(this,s),a==null)throw new Error("Missing DTD notation name. "+this.debugInfo(a));if(!o.pubID&&!o.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(a));this.name=this.stringify.eleName(a),o.pubID!=null&&(this.pubID=this.stringify.dtdPubID(o.pubID)),o.sysID!=null&&(this.sysID=this.stringify.dtdSysID(o.sysID))}return i.prototype.toString=function(s){return this.options.writer.set(s).dtdNotation(this)},i}(n)}).call(D6)),Wy.exports}var M6=By.exports,MP;function $v(){return MP||(MP=1,(function(){var n,e,t,r,i,s,a=function(l,c){for(var u in c)o.call(c,u)&&(l[u]=c[u]);function d(){this.constructor=l}return d.prototype=c.prototype,l.prototype=new d,l.__super__=c.prototype,l},o={}.hasOwnProperty;s=Yl().isObject,i=Gi(),n=Uv(),t=Lv(),e=Rv(),r=Bv(),By.exports=function(l){a(c,l);function c(u,d,h){var f,p;c.__super__.constructor.call(this,u),this.name="!DOCTYPE",this.documentObject=u,s(d)&&(f=d,d=f.pubID,h=f.sysID),h==null&&(p=[d,h],h=p[0],d=p[1]),d!=null&&(this.pubID=this.stringify.dtdPubID(d)),h!=null&&(this.sysID=this.stringify.dtdSysID(h))}return c.prototype.element=function(u,d){var h;return h=new e(this,u,d),this.children.push(h),this},c.prototype.attList=function(u,d,h,f,p){var g;return g=new n(this,u,d,h,f,p),this.children.push(g),this},c.prototype.entity=function(u,d){var h;return h=new t(this,!1,u,d),this.children.push(h),this},c.prototype.pEntity=function(u,d){var h;return h=new t(this,!0,u,d),this.children.push(h),this},c.prototype.notation=function(u,d){var h;return h=new r(this,u,d),this.children.push(h),this},c.prototype.toString=function(u){return this.options.writer.set(u).docType(this)},c.prototype.ele=function(u,d){return this.element(u,d)},c.prototype.att=function(u,d,h,f,p){return this.attList(u,d,h,f,p)},c.prototype.ent=function(u,d){return this.entity(u,d)},c.prototype.pent=function(u,d){return this.pEntity(u,d)},c.prototype.not=function(u,d){return this.notation(u,d)},c.prototype.up=function(){return this.root()||this.documentObject},c}(i)}).call(M6)),By.exports}var jy={exports:{}},A6=jy.exports,AP;function Nv(){return AP||(AP=1,(function(){var n,e=function(r,i){for(var s in i)t.call(i,s)&&(r[s]=i[s]);function a(){this.constructor=r}return a.prototype=i.prototype,r.prototype=new a,r.__super__=i.prototype,r},t={}.hasOwnProperty;n=Gi(),jy.exports=function(r){e(i,r);function i(s,a){if(i.__super__.constructor.call(this,s),a==null)throw new Error("Missing raw text. "+this.debugInfo());this.value=this.stringify.raw(a)}return i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(s){return this.options.writer.set(s).raw(this)},i}(n)}).call(A6)),jy.exports}var Vy={exports:{}},C6=Vy.exports,CP;function zv(){return CP||(CP=1,(function(){var n,e=function(r,i){for(var s in i)t.call(i,s)&&(r[s]=i[s]);function a(){this.constructor=r}return a.prototype=i.prototype,r.prototype=new a,r.__super__=i.prototype,r},t={}.hasOwnProperty;n=Gi(),Vy.exports=function(r){e(i,r);function i(s,a){if(i.__super__.constructor.call(this,s),a==null)throw new Error("Missing element text. "+this.debugInfo());this.value=this.stringify.eleText(a)}return i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(s){return this.options.writer.set(s).text(this)},i}(n)}).call(C6)),Vy.exports}var Gy={exports:{}},S6=Gy.exports,SP;function Wv(){return SP||(SP=1,(function(){var n,e=function(r,i){for(var s in i)t.call(i,s)&&(r[s]=i[s]);function a(){this.constructor=r}return a.prototype=i.prototype,r.prototype=new a,r.__super__=i.prototype,r},t={}.hasOwnProperty;n=Gi(),Gy.exports=function(r){e(i,r);function i(s,a,o){if(i.__super__.constructor.call(this,s),a==null)throw new Error("Missing instruction target. "+this.debugInfo());this.target=this.stringify.insTarget(a),o&&(this.value=this.stringify.insValue(o))}return i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(s){return this.options.writer.set(s).processingInstruction(this)},i}(n)}).call(S6)),Gy.exports}var qy={exports:{}},P6=qy.exports,PP;function NE(){return PP||(PP=1,(function(){var n,e=function(r,i){for(var s in i)t.call(i,s)&&(r[s]=i[s]);function a(){this.constructor=r}return a.prototype=i.prototype,r.prototype=new a,r.__super__=i.prototype,r},t={}.hasOwnProperty;n=Gi(),qy.exports=function(r){e(i,r);function i(s){i.__super__.constructor.call(this,s),this.isDummy=!0}return i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(s){return""},i}(n)}).call(P6)),qy.exports}var k6=Fy.exports,kP;function Gi(){return kP||(kP=1,(function(){var n,e,t,r,i,s,a,o,l,c,u,d,h,f,p={}.hasOwnProperty;f=Yl(),h=f.isObject,d=f.isFunction,u=f.isEmpty,c=f.getValue,s=null,n=null,e=null,t=null,r=null,o=null,l=null,a=null,i=null,Fy.exports=function(){function g(b){this.parent=b,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.children=[],s||(s=kv(),n=Fv(),e=Iv(),t=Ov(),r=$v(),o=Nv(),l=zv(),a=Wv(),i=NE())}return g.prototype.element=function(b,_,m){var v,x,w,T,E,A,M,F,G,S,I;if(A=null,_===null&&m==null&&(G=[{},null],_=G[0],m=G[1]),_==null&&(_={}),_=c(_),h(_)||(S=[_,m],m=S[0],_=S[1]),b!=null&&(b=c(b)),Array.isArray(b))for(w=0,M=b.length;w<M;w++)x=b[w],A=this.element(x);else if(d(b))A=this.element(b.apply());else if(h(b)){for(E in b)if(p.call(b,E))if(I=b[E],d(I)&&(I=I.apply()),h(I)&&u(I)&&(I=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&E.indexOf(this.stringify.convertAttKey)===0)A=this.attribute(E.substr(this.stringify.convertAttKey.length),I);else if(!this.options.separateArrayItems&&Array.isArray(I))for(T=0,F=I.length;T<F;T++)x=I[T],v={},v[E]=x,A=this.element(v);else h(I)?(A=this.element(E),A.element(I)):A=this.element(E,I)}else this.options.skipNullNodes&&m===null?A=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&b.indexOf(this.stringify.convertTextKey)===0?A=this.text(m):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&b.indexOf(this.stringify.convertCDataKey)===0?A=this.cdata(m):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&b.indexOf(this.stringify.convertCommentKey)===0?A=this.comment(m):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&b.indexOf(this.stringify.convertRawKey)===0?A=this.raw(m):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&b.indexOf(this.stringify.convertPIKey)===0?A=this.instruction(b.substr(this.stringify.convertPIKey.length),m):A=this.node(b,_,m);if(A==null)throw new Error("Could not create any elements with: "+b+". "+this.debugInfo());return A},g.prototype.insertBefore=function(b,_,m){var v,x,w;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(b));return x=this.parent.children.indexOf(this),w=this.parent.children.splice(x),v=this.parent.element(b,_,m),Array.prototype.push.apply(this.parent.children,w),v},g.prototype.insertAfter=function(b,_,m){var v,x,w;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(b));return x=this.parent.children.indexOf(this),w=this.parent.children.splice(x+1),v=this.parent.element(b,_,m),Array.prototype.push.apply(this.parent.children,w),v},g.prototype.remove=function(){var b;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return b=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[b,b-b+1].concat([])),this.parent},g.prototype.node=function(b,_,m){var v,x;return b!=null&&(b=c(b)),_||(_={}),_=c(_),h(_)||(x=[_,m],m=x[0],_=x[1]),v=new s(this,b,_),m!=null&&v.text(m),this.children.push(v),v},g.prototype.text=function(b){var _;return _=new l(this,b),this.children.push(_),this},g.prototype.cdata=function(b){var _;return _=new n(this,b),this.children.push(_),this},g.prototype.comment=function(b){var _;return _=new e(this,b),this.children.push(_),this},g.prototype.commentBefore=function(b){var _,m;return _=this.parent.children.indexOf(this),m=this.parent.children.splice(_),this.parent.comment(b),Array.prototype.push.apply(this.parent.children,m),this},g.prototype.commentAfter=function(b){var _,m;return _=this.parent.children.indexOf(this),m=this.parent.children.splice(_+1),this.parent.comment(b),Array.prototype.push.apply(this.parent.children,m),this},g.prototype.raw=function(b){var _;return _=new o(this,b),this.children.push(_),this},g.prototype.dummy=function(){var b;return b=new i(this),this.children.push(b),b},g.prototype.instruction=function(b,_){var m,v,x,w,T;if(b!=null&&(b=c(b)),_!=null&&(_=c(_)),Array.isArray(b))for(w=0,T=b.length;w<T;w++)m=b[w],this.instruction(m);else if(h(b))for(m in b)p.call(b,m)&&(v=b[m],this.instruction(m,v));else d(_)&&(_=_.apply()),x=new a(this,b,_),this.children.push(x);return this},g.prototype.instructionBefore=function(b,_){var m,v;return m=this.parent.children.indexOf(this),v=this.parent.children.splice(m),this.parent.instruction(b,_),Array.prototype.push.apply(this.parent.children,v),this},g.prototype.instructionAfter=function(b,_){var m,v;return m=this.parent.children.indexOf(this),v=this.parent.children.splice(m+1),this.parent.instruction(b,_),Array.prototype.push.apply(this.parent.children,v),this},g.prototype.declaration=function(b,_,m){var v,x;return v=this.document(),x=new t(v,b,_,m),v.children[0]instanceof t?v.children[0]=x:v.children.unshift(x),v.root()||v},g.prototype.doctype=function(b,_){var m,v,x,w,T,E,A,M,F,G;for(v=this.document(),x=new r(v,b,_),F=v.children,w=T=0,A=F.length;T<A;w=++T)if(m=F[w],m instanceof r)return v.children[w]=x,x;for(G=v.children,w=E=0,M=G.length;E<M;w=++E)if(m=G[w],m.isRoot)return v.children.splice(w,0,x),x;return v.children.push(x),x},g.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},g.prototype.root=function(){var b;for(b=this;b;){if(b.isDocument)return b.rootObject;if(b.isRoot)return b;b=b.parent}},g.prototype.document=function(){var b;for(b=this;b;){if(b.isDocument)return b;b=b.parent}},g.prototype.end=function(b){return this.document().end(b)},g.prototype.prev=function(){var b;for(b=this.parent.children.indexOf(this);b>0&&this.parent.children[b-1].isDummy;)b=b-1;if(b<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[b-1]},g.prototype.next=function(){var b;for(b=this.parent.children.indexOf(this);b<this.parent.children.length-1&&this.parent.children[b+1].isDummy;)b=b+1;if(b===-1||b===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[b+1]},g.prototype.importDocument=function(b){var _;return _=b.root().clone(),_.parent=this,_.isRoot=!1,this.children.push(_),this},g.prototype.debugInfo=function(b){var _,m;return b=b||this.name,b==null&&!((_=this.parent)!=null&&_.name)?"":b==null?"parent: <"+this.parent.name+">":(m=this.parent)!=null&&m.name?"node: <"+b+">, parent: <"+this.parent.name+">":"node: <"+b+">"},g.prototype.ele=function(b,_,m){return this.element(b,_,m)},g.prototype.nod=function(b,_,m){return this.node(b,_,m)},g.prototype.txt=function(b){return this.text(b)},g.prototype.dat=function(b){return this.cdata(b)},g.prototype.com=function(b){return this.comment(b)},g.prototype.ins=function(b,_){return this.instruction(b,_)},g.prototype.doc=function(){return this.document()},g.prototype.dec=function(b,_,m){return this.declaration(b,_,m)},g.prototype.dtd=function(b,_){return this.doctype(b,_)},g.prototype.e=function(b,_,m){return this.element(b,_,m)},g.prototype.n=function(b,_,m){return this.node(b,_,m)},g.prototype.t=function(b){return this.text(b)},g.prototype.d=function(b){return this.cdata(b)},g.prototype.c=function(b){return this.comment(b)},g.prototype.r=function(b){return this.raw(b)},g.prototype.i=function(b,_){return this.instruction(b,_)},g.prototype.u=function(){return this.up()},g.prototype.importXMLBuilder=function(b){return this.importDocument(b)},g}()}).call(k6)),Fy.exports}var Hy={exports:{}},F6=Hy.exports,FP;function GL(){return FP||(FP=1,(function(){var n=function(t,r){return function(){return t.apply(r,arguments)}},e={}.hasOwnProperty;Hy.exports=function(){function t(r){this.assertLegalChar=n(this.assertLegalChar,this);var i,s,a;r||(r={}),this.noDoubleEncoding=r.noDoubleEncoding,s=r.stringify||{};for(i in s)e.call(s,i)&&(a=s[i],this[i]=a)}return t.prototype.eleName=function(r){return r=""+r||"",this.assertLegalChar(r)},t.prototype.eleText=function(r){return r=""+r||"",this.assertLegalChar(this.elEscape(r))},t.prototype.cdata=function(r){return r=""+r||"",r=r.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(r)},t.prototype.comment=function(r){if(r=""+r||"",r.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+r);return this.assertLegalChar(r)},t.prototype.raw=function(r){return""+r||""},t.prototype.attName=function(r){return r=""+r||""},t.prototype.attValue=function(r){return r=""+r||"",this.attEscape(r)},t.prototype.insTarget=function(r){return""+r||""},t.prototype.insValue=function(r){if(r=""+r||"",r.match(/\?>/))throw new Error("Invalid processing instruction value: "+r);return r},t.prototype.xmlVersion=function(r){if(r=""+r||"",!r.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+r);return r},t.prototype.xmlEncoding=function(r){if(r=""+r||"",!r.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+r);return r},t.prototype.xmlStandalone=function(r){return r?"yes":"no"},t.prototype.dtdPubID=function(r){return""+r||""},t.prototype.dtdSysID=function(r){return""+r||""},t.prototype.dtdElementValue=function(r){return""+r||""},t.prototype.dtdAttType=function(r){return""+r||""},t.prototype.dtdAttDefault=function(r){return r!=null?""+r||"":r},t.prototype.dtdEntityValue=function(r){return""+r||""},t.prototype.dtdNData=function(r){return""+r||""},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(r){var i;if(i=r.match(/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/),i)throw new Error("Invalid character in string: "+r+" at index "+i.index);return r},t.prototype.elEscape=function(r){var i;return i=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,r.replace(i,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},t.prototype.attEscape=function(r){var i;return i=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,r.replace(i,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},t}()}).call(F6)),Hy.exports}var Ky={exports:{}},Xy={exports:{}},I6=Xy.exports,IP;function qL(){return IP||(IP=1,(function(){var n={}.hasOwnProperty;Xy.exports=function(){function e(t){var r,i,s,a,o,l,c,u,d;t||(t={}),this.pretty=t.pretty||!1,this.allowEmpty=(i=t.allowEmpty)!=null?i:!1,this.pretty?(this.indent=(s=t.indent)!=null?s:"  ",this.newline=(a=t.newline)!=null?a:`
`,this.offset=(o=t.offset)!=null?o:0,this.dontprettytextnodes=(l=t.dontprettytextnodes)!=null?l:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash=(c=t.spacebeforeslash)!=null?c:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,u=t.writer||{};for(r in u)n.call(u,r)&&(d=u[r],this[r]=d)}return e.prototype.set=function(t){var r,i,s;t||(t={}),"pretty"in t&&(this.pretty=t.pretty),"allowEmpty"in t&&(this.allowEmpty=t.allowEmpty),this.pretty?(this.indent="indent"in t?t.indent:"  ",this.newline="newline"in t?t.newline:`
`,this.offset="offset"in t?t.offset:0,this.dontprettytextnodes="dontprettytextnodes"in t?t.dontprettytextnodes:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash="spacebeforeslash"in t?t.spacebeforeslash:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,i=t.writer||{};for(r in i)n.call(i,r)&&(s=i[r],this[r]=s);return this},e.prototype.space=function(t){var r;return this.pretty?(r=(t||0)+this.offset+1,r>0?new Array(r).join(this.indent):""):""},e}()}).call(I6)),Xy.exports}var O6=Ky.exports,OP;function zE(){return OP||(OP=1,(function(){var n,e,t,r,i,s,a,o,l,c,u,d,h,f,p=function(b,_){for(var m in _)g.call(_,m)&&(b[m]=_[m]);function v(){this.constructor=b}return v.prototype=_.prototype,b.prototype=new v,b.__super__=_.prototype,b},g={}.hasOwnProperty;a=Ov(),o=$v(),n=Fv(),e=Iv(),c=kv(),d=Nv(),h=zv(),u=Wv(),l=NE(),t=Uv(),r=Rv(),i=Lv(),s=Bv(),f=qL(),Ky.exports=function(b){p(_,b);function _(m){_.__super__.constructor.call(this,m)}return _.prototype.document=function(m){var v,x,w,T,E;for(this.textispresent=!1,T="",E=m.children,x=0,w=E.length;x<w;x++)v=E[x],!(v instanceof l)&&(T+=(function(){switch(!1){case!(v instanceof a):return this.declaration(v);case!(v instanceof o):return this.docType(v);case!(v instanceof e):return this.comment(v);case!(v instanceof u):return this.processingInstruction(v);default:return this.element(v,0)}}).call(this));return this.pretty&&T.slice(-this.newline.length)===this.newline&&(T=T.slice(0,-this.newline.length)),T},_.prototype.attribute=function(m){return" "+m.name+'="'+m.value+'"'},_.prototype.cdata=function(m,v){return this.space(v)+"<![CDATA["+m.text+"]]>"+this.newline},_.prototype.comment=function(m,v){return this.space(v)+"<!-- "+m.text+" -->"+this.newline},_.prototype.declaration=function(m,v){var x;return x=this.space(v),x+='<?xml version="'+m.version+'"',m.encoding!=null&&(x+=' encoding="'+m.encoding+'"'),m.standalone!=null&&(x+=' standalone="'+m.standalone+'"'),x+=this.spacebeforeslash+"?>",x+=this.newline,x},_.prototype.docType=function(m,v){var x,w,T,E,A;if(v||(v=0),E=this.space(v),E+="<!DOCTYPE "+m.root().name,m.pubID&&m.sysID?E+=' PUBLIC "'+m.pubID+'" "'+m.sysID+'"':m.sysID&&(E+=' SYSTEM "'+m.sysID+'"'),m.children.length>0){for(E+=" [",E+=this.newline,A=m.children,w=0,T=A.length;w<T;w++)x=A[w],E+=(function(){switch(!1){case!(x instanceof t):return this.dtdAttList(x,v+1);case!(x instanceof r):return this.dtdElement(x,v+1);case!(x instanceof i):return this.dtdEntity(x,v+1);case!(x instanceof s):return this.dtdNotation(x,v+1);case!(x instanceof n):return this.cdata(x,v+1);case!(x instanceof e):return this.comment(x,v+1);case!(x instanceof u):return this.processingInstruction(x,v+1);default:throw new Error("Unknown DTD node type: "+x.constructor.name)}}).call(this);E+="]"}return E+=this.spacebeforeslash+">",E+=this.newline,E},_.prototype.element=function(m,v){var x,w,T,E,A,M,F,G,S,I,C,H,B;v||(v=0),B=!1,this.textispresent?(this.newline="",this.pretty=!1):(this.newline=this.newlinedefault,this.pretty=this.prettydefault),H=this.space(v),G="",G+=H+"<"+m.name,S=m.attributes;for(F in S)g.call(S,F)&&(x=S[F],G+=this.attribute(x));if(m.children.length===0||m.children.every(function($){return $.value===""}))this.allowEmpty?G+="></"+m.name+">"+this.newline:G+=this.spacebeforeslash+"/>"+this.newline;else if(this.pretty&&m.children.length===1&&m.children[0].value!=null)G+=">",G+=m.children[0].value,G+="</"+m.name+">"+this.newline;else{if(this.dontprettytextnodes){for(I=m.children,T=0,A=I.length;T<A;T++)if(w=I[T],w.value!=null){this.textispresent++,B=!0;break}}for(this.textispresent&&(this.newline="",this.pretty=!1,H=this.space(v)),G+=">"+this.newline,C=m.children,E=0,M=C.length;E<M;E++)w=C[E],G+=(function(){switch(!1){case!(w instanceof n):return this.cdata(w,v+1);case!(w instanceof e):return this.comment(w,v+1);case!(w instanceof c):return this.element(w,v+1);case!(w instanceof d):return this.raw(w,v+1);case!(w instanceof h):return this.text(w,v+1);case!(w instanceof u):return this.processingInstruction(w,v+1);case!(w instanceof l):return"";default:throw new Error("Unknown XML node type: "+w.constructor.name)}}).call(this);B&&this.textispresent--,this.textispresent||(this.newline=this.newlinedefault,this.pretty=this.prettydefault),G+=H+"</"+m.name+">"+this.newline}return G},_.prototype.processingInstruction=function(m,v){var x;return x=this.space(v)+"<?"+m.target,m.value&&(x+=" "+m.value),x+=this.spacebeforeslash+"?>"+this.newline,x},_.prototype.raw=function(m,v){return this.space(v)+m.value+this.newline},_.prototype.text=function(m,v){return this.space(v)+m.value+this.newline},_.prototype.dtdAttList=function(m,v){var x;return x=this.space(v)+"<!ATTLIST "+m.elementName+" "+m.attributeName+" "+m.attributeType,m.defaultValueType!=="#DEFAULT"&&(x+=" "+m.defaultValueType),m.defaultValue&&(x+=' "'+m.defaultValue+'"'),x+=this.spacebeforeslash+">"+this.newline,x},_.prototype.dtdElement=function(m,v){return this.space(v)+"<!ELEMENT "+m.name+" "+m.value+this.spacebeforeslash+">"+this.newline},_.prototype.dtdEntity=function(m,v){var x;return x=this.space(v)+"<!ENTITY",m.pe&&(x+=" %"),x+=" "+m.name,m.value?x+=' "'+m.value+'"':(m.pubID&&m.sysID?x+=' PUBLIC "'+m.pubID+'" "'+m.sysID+'"':m.sysID&&(x+=' SYSTEM "'+m.sysID+'"'),m.nData&&(x+=" NDATA "+m.nData)),x+=this.spacebeforeslash+">"+this.newline,x},_.prototype.dtdNotation=function(m,v){var x;return x=this.space(v)+"<!NOTATION "+m.name,m.pubID&&m.sysID?x+=' PUBLIC "'+m.pubID+'" "'+m.sysID+'"':m.pubID?x+=' PUBLIC "'+m.pubID+'"':m.sysID&&(x+=' SYSTEM "'+m.sysID+'"'),x+=this.spacebeforeslash+">"+this.newline,x},_.prototype.openNode=function(m,v){var x,w,T,E;if(v||(v=0),m instanceof c){T=this.space(v)+"<"+m.name,E=m.attributes;for(w in E)g.call(E,w)&&(x=E[w],T+=this.attribute(x));return T+=(m.children?">":"/>")+this.newline,T}else return T=this.space(v)+"<!DOCTYPE "+m.rootNodeName,m.pubID&&m.sysID?T+=' PUBLIC "'+m.pubID+'" "'+m.sysID+'"':m.sysID&&(T+=' SYSTEM "'+m.sysID+'"'),T+=(m.children?" [":">")+this.newline,T},_.prototype.closeNode=function(m,v){switch(v||(v=0),!1){case!(m instanceof c):return this.space(v)+"</"+m.name+">"+this.newline;case!(m instanceof o):return this.space(v)+"]>"+this.newline}},_}(f)}).call(O6)),Ky.exports}var U6=ky.exports,UP;function L6(){return UP||(UP=1,(function(){var n,e,t,r,i=function(a,o){for(var l in o)s.call(o,l)&&(a[l]=o[l]);function c(){this.constructor=a}return c.prototype=o.prototype,a.prototype=new c,a.__super__=o.prototype,a},s={}.hasOwnProperty;r=Yl().isPlainObject,n=Gi(),t=GL(),e=zE(),ky.exports=function(a){i(o,a);function o(l){o.__super__.constructor.call(this,null),this.name="?xml",l||(l={}),l.writer||(l.writer=new e),this.options=l,this.stringify=new t(l),this.isDocument=!0}return o.prototype.end=function(l){var c;return l?r(l)&&(c=l,l=this.options.writer.set(c)):l=this.options.writer,l.document(this)},o.prototype.toString=function(l){return this.options.writer.set(l).document(this)},o}(n)}).call(U6)),ky.exports}var Yy={exports:{}},R6=Yy.exports,LP;function B6(){return LP||(LP=1,(function(){var n,e,t,r,i,s,a,o,l,c,u,d,h,f,p,g,b,_,m,v,x={}.hasOwnProperty;v=Yl(),_=v.isObject,b=v.isFunction,m=v.isPlainObject,g=v.getValue,c=kv(),e=Fv(),t=Iv(),d=Nv(),p=zv(),u=Wv(),o=Ov(),l=$v(),r=Uv(),s=Lv(),i=Rv(),a=Bv(),n=VL(),f=GL(),h=zE(),Yy.exports=function(){function w(T,E,A){var M;this.name="?xml",T||(T={}),T.writer?m(T.writer)&&(M=T.writer,T.writer=new h(M)):T.writer=new h(T),this.options=T,this.writer=T.writer,this.stringify=new f(T),this.onDataCallback=E||function(){},this.onEndCallback=A||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return w.prototype.node=function(T,E,A){var M,F;if(T==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(T));return this.openCurrent(),T=g(T),E===null&&A==null&&(M=[{},null],E=M[0],A=M[1]),E==null&&(E={}),E=g(E),_(E)||(F=[E,A],A=F[0],E=F[1]),this.currentNode=new c(this,T,E),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,A!=null&&this.text(A),this},w.prototype.element=function(T,E,A){return this.currentNode&&this.currentNode instanceof l?this.dtdElement.apply(this,arguments):this.node(T,E,A)},w.prototype.attribute=function(T,E){var A,M;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(T));if(T!=null&&(T=g(T)),_(T))for(A in T)x.call(T,A)&&(M=T[A],this.attribute(A,M));else b(E)&&(E=E.apply()),(!this.options.skipNullAttributes||E!=null)&&(this.currentNode.attributes[T]=new n(this,T,E));return this},w.prototype.text=function(T){var E;return this.openCurrent(),E=new p(this,T),this.onData(this.writer.text(E,this.currentLevel+1),this.currentLevel+1),this},w.prototype.cdata=function(T){var E;return this.openCurrent(),E=new e(this,T),this.onData(this.writer.cdata(E,this.currentLevel+1),this.currentLevel+1),this},w.prototype.comment=function(T){var E;return this.openCurrent(),E=new t(this,T),this.onData(this.writer.comment(E,this.currentLevel+1),this.currentLevel+1),this},w.prototype.raw=function(T){var E;return this.openCurrent(),E=new d(this,T),this.onData(this.writer.raw(E,this.currentLevel+1),this.currentLevel+1),this},w.prototype.instruction=function(T,E){var A,M,F,G,S;if(this.openCurrent(),T!=null&&(T=g(T)),E!=null&&(E=g(E)),Array.isArray(T))for(A=0,G=T.length;A<G;A++)M=T[A],this.instruction(M);else if(_(T))for(M in T)x.call(T,M)&&(F=T[M],this.instruction(M,F));else b(E)&&(E=E.apply()),S=new u(this,T,E),this.onData(this.writer.processingInstruction(S,this.currentLevel+1),this.currentLevel+1);return this},w.prototype.declaration=function(T,E,A){var M;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return M=new o(this,T,E,A),this.onData(this.writer.declaration(M,this.currentLevel+1),this.currentLevel+1),this},w.prototype.doctype=function(T,E,A){if(this.openCurrent(),T==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new l(this,E,A),this.currentNode.rootNodeName=T,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},w.prototype.dtdElement=function(T,E){var A;return this.openCurrent(),A=new i(this,T,E),this.onData(this.writer.dtdElement(A,this.currentLevel+1),this.currentLevel+1),this},w.prototype.attList=function(T,E,A,M,F){var G;return this.openCurrent(),G=new r(this,T,E,A,M,F),this.onData(this.writer.dtdAttList(G,this.currentLevel+1),this.currentLevel+1),this},w.prototype.entity=function(T,E){var A;return this.openCurrent(),A=new s(this,!1,T,E),this.onData(this.writer.dtdEntity(A,this.currentLevel+1),this.currentLevel+1),this},w.prototype.pEntity=function(T,E){var A;return this.openCurrent(),A=new s(this,!0,T,E),this.onData(this.writer.dtdEntity(A,this.currentLevel+1),this.currentLevel+1),this},w.prototype.notation=function(T,E){var A;return this.openCurrent(),A=new a(this,T,E),this.onData(this.writer.dtdNotation(A,this.currentLevel+1),this.currentLevel+1),this},w.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},w.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},w.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},w.prototype.openNode=function(T){if(!T.isOpen)return!this.root&&this.currentLevel===0&&T instanceof c&&(this.root=T),this.onData(this.writer.openNode(T,this.currentLevel),this.currentLevel),T.isOpen=!0},w.prototype.closeNode=function(T){if(!T.isClosed)return this.onData(this.writer.closeNode(T,this.currentLevel),this.currentLevel),T.isClosed=!0},w.prototype.onData=function(T,E){return this.documentStarted=!0,this.onDataCallback(T,E+1)},w.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},w.prototype.debugInfo=function(T){return T==null?"":"node: <"+T+">"},w.prototype.ele=function(){return this.element.apply(this,arguments)},w.prototype.nod=function(T,E,A){return this.node(T,E,A)},w.prototype.txt=function(T){return this.text(T)},w.prototype.dat=function(T){return this.cdata(T)},w.prototype.com=function(T){return this.comment(T)},w.prototype.ins=function(T,E){return this.instruction(T,E)},w.prototype.dec=function(T,E,A){return this.declaration(T,E,A)},w.prototype.dtd=function(T,E,A){return this.doctype(T,E,A)},w.prototype.e=function(T,E,A){return this.element(T,E,A)},w.prototype.n=function(T,E,A){return this.node(T,E,A)},w.prototype.t=function(T){return this.text(T)},w.prototype.d=function(T){return this.cdata(T)},w.prototype.c=function(T){return this.comment(T)},w.prototype.r=function(T){return this.raw(T)},w.prototype.i=function(T,E){return this.instruction(T,E)},w.prototype.att=function(){return this.currentNode&&this.currentNode instanceof l?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},w.prototype.a=function(){return this.currentNode&&this.currentNode instanceof l?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},w.prototype.ent=function(T,E){return this.entity(T,E)},w.prototype.pent=function(T,E){return this.pEntity(T,E)},w.prototype.not=function(T,E){return this.notation(T,E)},w}()}).call(R6)),Yy.exports}var Qy={exports:{}},$6=Qy.exports,RP;function N6(){return RP||(RP=1,(function(){var n,e,t,r,i,s,a,o,l,c,u,d,h,f,p=function(b,_){for(var m in _)g.call(_,m)&&(b[m]=_[m]);function v(){this.constructor=b}return v.prototype=_.prototype,b.prototype=new v,b.__super__=_.prototype,b},g={}.hasOwnProperty;a=Ov(),o=$v(),n=Fv(),e=Iv(),c=kv(),d=Nv(),h=zv(),u=Wv(),l=NE(),t=Uv(),r=Rv(),i=Lv(),s=Bv(),f=qL(),Qy.exports=function(b){p(_,b);function _(m,v){_.__super__.constructor.call(this,v),this.stream=m}return _.prototype.document=function(m){var v,x,w,T,E,A,M,F;for(A=m.children,x=0,T=A.length;x<T;x++)v=A[x],v.isLastRootNode=!1;for(m.children[m.children.length-1].isLastRootNode=!0,M=m.children,F=[],w=0,E=M.length;w<E;w++)if(v=M[w],!(v instanceof l))switch(!1){case!(v instanceof a):F.push(this.declaration(v));break;case!(v instanceof o):F.push(this.docType(v));break;case!(v instanceof e):F.push(this.comment(v));break;case!(v instanceof u):F.push(this.processingInstruction(v));break;default:F.push(this.element(v))}return F},_.prototype.attribute=function(m){return this.stream.write(" "+m.name+'="'+m.value+'"')},_.prototype.cdata=function(m,v){return this.stream.write(this.space(v)+"<![CDATA["+m.text+"]]>"+this.endline(m))},_.prototype.comment=function(m,v){return this.stream.write(this.space(v)+"<!-- "+m.text+" -->"+this.endline(m))},_.prototype.declaration=function(m,v){return this.stream.write(this.space(v)),this.stream.write('<?xml version="'+m.version+'"'),m.encoding!=null&&this.stream.write(' encoding="'+m.encoding+'"'),m.standalone!=null&&this.stream.write(' standalone="'+m.standalone+'"'),this.stream.write(this.spacebeforeslash+"?>"),this.stream.write(this.endline(m))},_.prototype.docType=function(m,v){var x,w,T,E;if(v||(v=0),this.stream.write(this.space(v)),this.stream.write("<!DOCTYPE "+m.root().name),m.pubID&&m.sysID?this.stream.write(' PUBLIC "'+m.pubID+'" "'+m.sysID+'"'):m.sysID&&this.stream.write(' SYSTEM "'+m.sysID+'"'),m.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(m)),E=m.children,w=0,T=E.length;w<T;w++)switch(x=E[w],!1){case!(x instanceof t):this.dtdAttList(x,v+1);break;case!(x instanceof r):this.dtdElement(x,v+1);break;case!(x instanceof i):this.dtdEntity(x,v+1);break;case!(x instanceof s):this.dtdNotation(x,v+1);break;case!(x instanceof n):this.cdata(x,v+1);break;case!(x instanceof e):this.comment(x,v+1);break;case!(x instanceof u):this.processingInstruction(x,v+1);break;default:throw new Error("Unknown DTD node type: "+x.constructor.name)}this.stream.write("]")}return this.stream.write(this.spacebeforeslash+">"),this.stream.write(this.endline(m))},_.prototype.element=function(m,v){var x,w,T,E,A,M,F,G;v||(v=0),G=this.space(v),this.stream.write(G+"<"+m.name),M=m.attributes;for(A in M)g.call(M,A)&&(x=M[A],this.attribute(x));if(m.children.length===0||m.children.every(function(S){return S.value===""}))this.allowEmpty?this.stream.write("></"+m.name+">"):this.stream.write(this.spacebeforeslash+"/>");else if(this.pretty&&m.children.length===1&&m.children[0].value!=null)this.stream.write(">"),this.stream.write(m.children[0].value),this.stream.write("</"+m.name+">");else{for(this.stream.write(">"+this.newline),F=m.children,T=0,E=F.length;T<E;T++)switch(w=F[T],!1){case!(w instanceof n):this.cdata(w,v+1);break;case!(w instanceof e):this.comment(w,v+1);break;case!(w instanceof c):this.element(w,v+1);break;case!(w instanceof d):this.raw(w,v+1);break;case!(w instanceof h):this.text(w,v+1);break;case!(w instanceof u):this.processingInstruction(w,v+1);break;case!(w instanceof l):break;default:throw new Error("Unknown XML node type: "+w.constructor.name)}this.stream.write(G+"</"+m.name+">")}return this.stream.write(this.endline(m))},_.prototype.processingInstruction=function(m,v){return this.stream.write(this.space(v)+"<?"+m.target),m.value&&this.stream.write(" "+m.value),this.stream.write(this.spacebeforeslash+"?>"+this.endline(m))},_.prototype.raw=function(m,v){return this.stream.write(this.space(v)+m.value+this.endline(m))},_.prototype.text=function(m,v){return this.stream.write(this.space(v)+m.value+this.endline(m))},_.prototype.dtdAttList=function(m,v){return this.stream.write(this.space(v)+"<!ATTLIST "+m.elementName+" "+m.attributeName+" "+m.attributeType),m.defaultValueType!=="#DEFAULT"&&this.stream.write(" "+m.defaultValueType),m.defaultValue&&this.stream.write(' "'+m.defaultValue+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(m))},_.prototype.dtdElement=function(m,v){return this.stream.write(this.space(v)+"<!ELEMENT "+m.name+" "+m.value),this.stream.write(this.spacebeforeslash+">"+this.endline(m))},_.prototype.dtdEntity=function(m,v){return this.stream.write(this.space(v)+"<!ENTITY"),m.pe&&this.stream.write(" %"),this.stream.write(" "+m.name),m.value?this.stream.write(' "'+m.value+'"'):(m.pubID&&m.sysID?this.stream.write(' PUBLIC "'+m.pubID+'" "'+m.sysID+'"'):m.sysID&&this.stream.write(' SYSTEM "'+m.sysID+'"'),m.nData&&this.stream.write(" NDATA "+m.nData)),this.stream.write(this.spacebeforeslash+">"+this.endline(m))},_.prototype.dtdNotation=function(m,v){return this.stream.write(this.space(v)+"<!NOTATION "+m.name),m.pubID&&m.sysID?this.stream.write(' PUBLIC "'+m.pubID+'" "'+m.sysID+'"'):m.pubID?this.stream.write(' PUBLIC "'+m.pubID+'"'):m.sysID&&this.stream.write(' SYSTEM "'+m.sysID+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(m))},_.prototype.endline=function(m){return m.isLastRootNode?"":this.newline},_}(f)}).call($6)),Qy.exports}var BP;function z6(){return BP||(BP=1,(function(){var n,e,t,r,i,s,a;a=Yl(),i=a.assign,s=a.isFunction,n=L6(),e=B6(),r=zE(),t=N6(),vc.create=function(o,l,c,u){var d,h;if(o==null)throw new Error("Root element needs a name.");return u=i({},l,c,u),d=new n(u),h=d.element(o),u.headless||(d.declaration(u),(u.pubID!=null||u.sysID!=null)&&d.doctype(u)),h},vc.begin=function(o,l,c){var u;return s(o)&&(u=[o,l],l=u[0],c=u[1],o={}),l?new e(o,l,c):new n(o)},vc.stringWriter=function(o){return new r(o)},vc.streamWriter=function(o,l){return new t(o,l)}}).call(vc)),vc}var $P;function W6(){if($P)return bw;$P=1;var n=cr,e=z6();bw.writeString=t;function t(i,s){var a=n.invert(s),o={element:c,text:r};function l(h,f){return o[f.type](h,f)}function c(h,f){var p=h.element(u(f.name),f.attributes);f.children.forEach(function(g){l(p,g)})}function u(h){var f=/^\{(.*)\}(.*)$/.exec(h);if(f){var p=a[f[1]];return p+(p===""?"":":")+f[2]}else return h}function d(h){var f=e.create(u(h.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return n.forEach(s,function(p,g){var b="xmlns"+(g===""?"":":"+g);f.attribute(b,p)}),h.children.forEach(function(p){l(f,p)}),f.end()}return d(i)}function r(i,s){i.text(s.value)}return bw}var NP;function WE(){if(NP)return Jo;NP=1;var n=jL();return Jo.Element=n.Element,Jo.element=n.element,Jo.emptyElement=n.emptyElement,Jo.text=n.text,Jo.readString=g6().readString,Jo.writeString=W6().writeString,Jo}var zP;function j6(){if(zP)return iy;zP=1;var n=cr,e=Xl(),t=WE();iy.read=i,iy.readXmlFromZipFile=s;var r={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word","http://schemas.microsoft.com/office/word/2010/wordml":"wordml"};function i(l){return t.readString(l,r).then(function(c){return o(c)[0]})}function s(l,c){return l.exists(c)?l.read(c,"utf-8").then(a).then(i):e.resolve(null)}function a(l){return l.replace(/^\uFEFF/g,"")}function o(l){return l.type==="element"?l.name==="mc:AlternateContent"?l.first("mc:Fallback").children:(l.children=n.flatten(l.children.map(o,!0)),[l]):[l]}return iy}var oy={},$s={},ly={},WP;function V6(){if(WP)return ly;WP=1,Object.defineProperty(ly,"__esModule",{value:!0});var n=[{"Typeface name":"Symbol","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Symbol","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"33","Unicode hex":"21"},{"Typeface name":"Symbol","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"8704","Unicode hex":"2200"},{"Typeface name":"Symbol","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"35","Unicode hex":"23"},{"Typeface name":"Symbol","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"8707","Unicode hex":"2203"},{"Typeface name":"Symbol","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"37","Unicode hex":"25"},{"Typeface name":"Symbol","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"38","Unicode hex":"26"},{"Typeface name":"Symbol","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"8717","Unicode hex":"220D"},{"Typeface name":"Symbol","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"40","Unicode hex":"28"},{"Typeface name":"Symbol","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"41","Unicode hex":"29"},{"Typeface name":"Symbol","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"42","Unicode hex":"2A"},{"Typeface name":"Symbol","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"43","Unicode hex":"2B"},{"Typeface name":"Symbol","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"44","Unicode hex":"2C"},{"Typeface name":"Symbol","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"8722","Unicode hex":"2212"},{"Typeface name":"Symbol","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"46","Unicode hex":"2E"},{"Typeface name":"Symbol","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"47","Unicode hex":"2F"},{"Typeface name":"Symbol","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"48","Unicode hex":"30"},{"Typeface name":"Symbol","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"49","Unicode hex":"31"},{"Typeface name":"Symbol","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"50","Unicode hex":"32"},{"Typeface name":"Symbol","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"51","Unicode hex":"33"},{"Typeface name":"Symbol","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"52","Unicode hex":"34"},{"Typeface name":"Symbol","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"53","Unicode hex":"35"},{"Typeface name":"Symbol","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"54","Unicode hex":"36"},{"Typeface name":"Symbol","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"55","Unicode hex":"37"},{"Typeface name":"Symbol","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"56","Unicode hex":"38"},{"Typeface name":"Symbol","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"57","Unicode hex":"39"},{"Typeface name":"Symbol","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"58","Unicode hex":"3A"},{"Typeface name":"Symbol","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"59","Unicode hex":"3B"},{"Typeface name":"Symbol","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"60","Unicode hex":"3C"},{"Typeface name":"Symbol","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"61","Unicode hex":"3D"},{"Typeface name":"Symbol","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"62","Unicode hex":"3E"},{"Typeface name":"Symbol","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"63","Unicode hex":"3F"},{"Typeface name":"Symbol","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"8773","Unicode hex":"2245"},{"Typeface name":"Symbol","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"913","Unicode hex":"391"},{"Typeface name":"Symbol","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"914","Unicode hex":"392"},{"Typeface name":"Symbol","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"935","Unicode hex":"3A7"},{"Typeface name":"Symbol","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"916","Unicode hex":"394"},{"Typeface name":"Symbol","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"917","Unicode hex":"395"},{"Typeface name":"Symbol","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"934","Unicode hex":"3A6"},{"Typeface name":"Symbol","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"915","Unicode hex":"393"},{"Typeface name":"Symbol","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"919","Unicode hex":"397"},{"Typeface name":"Symbol","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"921","Unicode hex":"399"},{"Typeface name":"Symbol","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"977","Unicode hex":"3D1"},{"Typeface name":"Symbol","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"922","Unicode hex":"39A"},{"Typeface name":"Symbol","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"923","Unicode hex":"39B"},{"Typeface name":"Symbol","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"924","Unicode hex":"39C"},{"Typeface name":"Symbol","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"925","Unicode hex":"39D"},{"Typeface name":"Symbol","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"927","Unicode hex":"39F"},{"Typeface name":"Symbol","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"928","Unicode hex":"3A0"},{"Typeface name":"Symbol","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"920","Unicode hex":"398"},{"Typeface name":"Symbol","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"929","Unicode hex":"3A1"},{"Typeface name":"Symbol","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"931","Unicode hex":"3A3"},{"Typeface name":"Symbol","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"932","Unicode hex":"3A4"},{"Typeface name":"Symbol","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"933","Unicode hex":"3A5"},{"Typeface name":"Symbol","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"962","Unicode hex":"3C2"},{"Typeface name":"Symbol","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"937","Unicode hex":"3A9"},{"Typeface name":"Symbol","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"926","Unicode hex":"39E"},{"Typeface name":"Symbol","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"936","Unicode hex":"3A8"},{"Typeface name":"Symbol","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"918","Unicode hex":"396"},{"Typeface name":"Symbol","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"91","Unicode hex":"5B"},{"Typeface name":"Symbol","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"8756","Unicode hex":"2234"},{"Typeface name":"Symbol","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"93","Unicode hex":"5D"},{"Typeface name":"Symbol","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"8869","Unicode hex":"22A5"},{"Typeface name":"Symbol","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"95","Unicode hex":"5F"},{"Typeface name":"Symbol","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"8254","Unicode hex":"203E"},{"Typeface name":"Symbol","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"945","Unicode hex":"3B1"},{"Typeface name":"Symbol","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"946","Unicode hex":"3B2"},{"Typeface name":"Symbol","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"967","Unicode hex":"3C7"},{"Typeface name":"Symbol","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"948","Unicode hex":"3B4"},{"Typeface name":"Symbol","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"949","Unicode hex":"3B5"},{"Typeface name":"Symbol","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"966","Unicode hex":"3C6"},{"Typeface name":"Symbol","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"947","Unicode hex":"3B3"},{"Typeface name":"Symbol","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"951","Unicode hex":"3B7"},{"Typeface name":"Symbol","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"953","Unicode hex":"3B9"},{"Typeface name":"Symbol","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"981","Unicode hex":"3D5"},{"Typeface name":"Symbol","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"954","Unicode hex":"3BA"},{"Typeface name":"Symbol","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"955","Unicode hex":"3BB"},{"Typeface name":"Symbol","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"956","Unicode hex":"3BC"},{"Typeface name":"Symbol","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"957","Unicode hex":"3BD"},{"Typeface name":"Symbol","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"959","Unicode hex":"3BF"},{"Typeface name":"Symbol","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"960","Unicode hex":"3C0"},{"Typeface name":"Symbol","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"952","Unicode hex":"3B8"},{"Typeface name":"Symbol","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"961","Unicode hex":"3C1"},{"Typeface name":"Symbol","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"963","Unicode hex":"3C3"},{"Typeface name":"Symbol","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"964","Unicode hex":"3C4"},{"Typeface name":"Symbol","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"965","Unicode hex":"3C5"},{"Typeface name":"Symbol","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"982","Unicode hex":"3D6"},{"Typeface name":"Symbol","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"969","Unicode hex":"3C9"},{"Typeface name":"Symbol","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"958","Unicode hex":"3BE"},{"Typeface name":"Symbol","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"968","Unicode hex":"3C8"},{"Typeface name":"Symbol","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"950","Unicode hex":"3B6"},{"Typeface name":"Symbol","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"123","Unicode hex":"7B"},{"Typeface name":"Symbol","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"124","Unicode hex":"7C"},{"Typeface name":"Symbol","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"125","Unicode hex":"7D"},{"Typeface name":"Symbol","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"126","Unicode hex":"7E"},{"Typeface name":"Symbol","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"8364","Unicode hex":"20AC"},{"Typeface name":"Symbol","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"978","Unicode hex":"3D2"},{"Typeface name":"Symbol","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"8242","Unicode hex":"2032"},{"Typeface name":"Symbol","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"8804","Unicode hex":"2264"},{"Typeface name":"Symbol","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"8260","Unicode hex":"2044"},{"Typeface name":"Symbol","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"8734","Unicode hex":"221E"},{"Typeface name":"Symbol","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"402","Unicode hex":"192"},{"Typeface name":"Symbol","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"9827","Unicode hex":"2663"},{"Typeface name":"Symbol","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"9830","Unicode hex":"2666"},{"Typeface name":"Symbol","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"9829","Unicode hex":"2665"},{"Typeface name":"Symbol","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"9824","Unicode hex":"2660"},{"Typeface name":"Symbol","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"8596","Unicode hex":"2194"},{"Typeface name":"Symbol","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"8592","Unicode hex":"2190"},{"Typeface name":"Symbol","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"8593","Unicode hex":"2191"},{"Typeface name":"Symbol","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"8594","Unicode hex":"2192"},{"Typeface name":"Symbol","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"8595","Unicode hex":"2193"},{"Typeface name":"Symbol","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"176","Unicode hex":"B0"},{"Typeface name":"Symbol","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"177","Unicode hex":"B1"},{"Typeface name":"Symbol","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"8243","Unicode hex":"2033"},{"Typeface name":"Symbol","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"8805","Unicode hex":"2265"},{"Typeface name":"Symbol","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"215","Unicode hex":"D7"},{"Typeface name":"Symbol","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"8733","Unicode hex":"221D"},{"Typeface name":"Symbol","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"8706","Unicode hex":"2202"},{"Typeface name":"Symbol","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"8226","Unicode hex":"2022"},{"Typeface name":"Symbol","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"247","Unicode hex":"F7"},{"Typeface name":"Symbol","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"8800","Unicode hex":"2260"},{"Typeface name":"Symbol","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"8801","Unicode hex":"2261"},{"Typeface name":"Symbol","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"8776","Unicode hex":"2248"},{"Typeface name":"Symbol","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"8230","Unicode hex":"2026"},{"Typeface name":"Symbol","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"9168","Unicode hex":"23D0"},{"Typeface name":"Symbol","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"9135","Unicode hex":"23AF"},{"Typeface name":"Symbol","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"8629","Unicode hex":"21B5"},{"Typeface name":"Symbol","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"8501","Unicode hex":"2135"},{"Typeface name":"Symbol","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"8465","Unicode hex":"2111"},{"Typeface name":"Symbol","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"8476","Unicode hex":"211C"},{"Typeface name":"Symbol","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"8472","Unicode hex":"2118"},{"Typeface name":"Symbol","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"8855","Unicode hex":"2297"},{"Typeface name":"Symbol","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"8853","Unicode hex":"2295"},{"Typeface name":"Symbol","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"8709","Unicode hex":"2205"},{"Typeface name":"Symbol","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"8745","Unicode hex":"2229"},{"Typeface name":"Symbol","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"8746","Unicode hex":"222A"},{"Typeface name":"Symbol","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"8835","Unicode hex":"2283"},{"Typeface name":"Symbol","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"8839","Unicode hex":"2287"},{"Typeface name":"Symbol","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"8836","Unicode hex":"2284"},{"Typeface name":"Symbol","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"8834","Unicode hex":"2282"},{"Typeface name":"Symbol","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"8838","Unicode hex":"2286"},{"Typeface name":"Symbol","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"8712","Unicode hex":"2208"},{"Typeface name":"Symbol","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"8713","Unicode hex":"2209"},{"Typeface name":"Symbol","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"8736","Unicode hex":"2220"},{"Typeface name":"Symbol","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"8711","Unicode hex":"2207"},{"Typeface name":"Symbol","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"174","Unicode hex":"AE"},{"Typeface name":"Symbol","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"169","Unicode hex":"A9"},{"Typeface name":"Symbol","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"8482","Unicode hex":"2122"},{"Typeface name":"Symbol","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"8719","Unicode hex":"220F"},{"Typeface name":"Symbol","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"8730","Unicode hex":"221A"},{"Typeface name":"Symbol","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"8901","Unicode hex":"22C5"},{"Typeface name":"Symbol","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"172","Unicode hex":"AC"},{"Typeface name":"Symbol","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"8743","Unicode hex":"2227"},{"Typeface name":"Symbol","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"8744","Unicode hex":"2228"},{"Typeface name":"Symbol","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"8660","Unicode hex":"21D4"},{"Typeface name":"Symbol","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"8656","Unicode hex":"21D0"},{"Typeface name":"Symbol","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"8657","Unicode hex":"21D1"},{"Typeface name":"Symbol","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"8658","Unicode hex":"21D2"},{"Typeface name":"Symbol","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"8659","Unicode hex":"21D3"},{"Typeface name":"Symbol","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"9674","Unicode hex":"25CA"},{"Typeface name":"Symbol","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"12296","Unicode hex":"3008"},{"Typeface name":"Symbol","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"174","Unicode hex":"AE"},{"Typeface name":"Symbol","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"169","Unicode hex":"A9"},{"Typeface name":"Symbol","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"8482","Unicode hex":"2122"},{"Typeface name":"Symbol","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"8721","Unicode hex":"2211"},{"Typeface name":"Symbol","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"9115","Unicode hex":"239B"},{"Typeface name":"Symbol","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"9116","Unicode hex":"239C"},{"Typeface name":"Symbol","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"9117","Unicode hex":"239D"},{"Typeface name":"Symbol","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"9121","Unicode hex":"23A1"},{"Typeface name":"Symbol","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"9122","Unicode hex":"23A2"},{"Typeface name":"Symbol","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"9123","Unicode hex":"23A3"},{"Typeface name":"Symbol","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"9127","Unicode hex":"23A7"},{"Typeface name":"Symbol","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"9128","Unicode hex":"23A8"},{"Typeface name":"Symbol","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"9129","Unicode hex":"23A9"},{"Typeface name":"Symbol","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"9130","Unicode hex":"23AA"},{"Typeface name":"Symbol","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"63743","Unicode hex":"F8FF"},{"Typeface name":"Symbol","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"12297","Unicode hex":"3009"},{"Typeface name":"Symbol","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"8747","Unicode hex":"222B"},{"Typeface name":"Symbol","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"8992","Unicode hex":"2320"},{"Typeface name":"Symbol","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"9134","Unicode hex":"23AE"},{"Typeface name":"Symbol","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"8993","Unicode hex":"2321"},{"Typeface name":"Symbol","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"9118","Unicode hex":"239E"},{"Typeface name":"Symbol","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"9119","Unicode hex":"239F"},{"Typeface name":"Symbol","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"9120","Unicode hex":"23A0"},{"Typeface name":"Symbol","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"9124","Unicode hex":"23A4"},{"Typeface name":"Symbol","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"9125","Unicode hex":"23A5"},{"Typeface name":"Symbol","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"9126","Unicode hex":"23A6"},{"Typeface name":"Symbol","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"9131","Unicode hex":"23AB"},{"Typeface name":"Symbol","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"9132","Unicode hex":"23AC"},{"Typeface name":"Symbol","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"9133","Unicode hex":"23AD"},{"Typeface name":"Webdings","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Webdings","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128375","Unicode hex":"1F577"},{"Typeface name":"Webdings","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"128376","Unicode hex":"1F578"},{"Typeface name":"Webdings","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"128370","Unicode hex":"1F572"},{"Typeface name":"Webdings","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128374","Unicode hex":"1F576"},{"Typeface name":"Webdings","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"127942","Unicode hex":"1F3C6"},{"Typeface name":"Webdings","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"127894","Unicode hex":"1F396"},{"Typeface name":"Webdings","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128391","Unicode hex":"1F587"},{"Typeface name":"Webdings","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128488","Unicode hex":"1F5E8"},{"Typeface name":"Webdings","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"128489","Unicode hex":"1F5E9"},{"Typeface name":"Webdings","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128496","Unicode hex":"1F5F0"},{"Typeface name":"Webdings","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128497","Unicode hex":"1F5F1"},{"Typeface name":"Webdings","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"127798","Unicode hex":"1F336"},{"Typeface name":"Webdings","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"127895","Unicode hex":"1F397"},{"Typeface name":"Webdings","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128638","Unicode hex":"1F67E"},{"Typeface name":"Webdings","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128636","Unicode hex":"1F67C"},{"Typeface name":"Webdings","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128469","Unicode hex":"1F5D5"},{"Typeface name":"Webdings","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128470","Unicode hex":"1F5D6"},{"Typeface name":"Webdings","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128471","Unicode hex":"1F5D7"},{"Typeface name":"Webdings","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"9204","Unicode hex":"23F4"},{"Typeface name":"Webdings","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"9205","Unicode hex":"23F5"},{"Typeface name":"Webdings","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"9206","Unicode hex":"23F6"},{"Typeface name":"Webdings","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"9207","Unicode hex":"23F7"},{"Typeface name":"Webdings","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"9194","Unicode hex":"23EA"},{"Typeface name":"Webdings","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"9193","Unicode hex":"23E9"},{"Typeface name":"Webdings","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"9198","Unicode hex":"23EE"},{"Typeface name":"Webdings","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"9197","Unicode hex":"23ED"},{"Typeface name":"Webdings","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"9208","Unicode hex":"23F8"},{"Typeface name":"Webdings","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"9209","Unicode hex":"23F9"},{"Typeface name":"Webdings","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"9210","Unicode hex":"23FA"},{"Typeface name":"Webdings","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"128474","Unicode hex":"1F5DA"},{"Typeface name":"Webdings","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"128499","Unicode hex":"1F5F3"},{"Typeface name":"Webdings","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128736","Unicode hex":"1F6E0"},{"Typeface name":"Webdings","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"127959","Unicode hex":"1F3D7"},{"Typeface name":"Webdings","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"127960","Unicode hex":"1F3D8"},{"Typeface name":"Webdings","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"127961","Unicode hex":"1F3D9"},{"Typeface name":"Webdings","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"127962","Unicode hex":"1F3DA"},{"Typeface name":"Webdings","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"127964","Unicode hex":"1F3DC"},{"Typeface name":"Webdings","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"127981","Unicode hex":"1F3ED"},{"Typeface name":"Webdings","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"127963","Unicode hex":"1F3DB"},{"Typeface name":"Webdings","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"127968","Unicode hex":"1F3E0"},{"Typeface name":"Webdings","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"127958","Unicode hex":"1F3D6"},{"Typeface name":"Webdings","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"127965","Unicode hex":"1F3DD"},{"Typeface name":"Webdings","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128739","Unicode hex":"1F6E3"},{"Typeface name":"Webdings","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"128269","Unicode hex":"1F50D"},{"Typeface name":"Webdings","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"127956","Unicode hex":"1F3D4"},{"Typeface name":"Webdings","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128065","Unicode hex":"1F441"},{"Typeface name":"Webdings","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"128066","Unicode hex":"1F442"},{"Typeface name":"Webdings","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"127966","Unicode hex":"1F3DE"},{"Typeface name":"Webdings","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"127957","Unicode hex":"1F3D5"},{"Typeface name":"Webdings","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"128740","Unicode hex":"1F6E4"},{"Typeface name":"Webdings","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"127967","Unicode hex":"1F3DF"},{"Typeface name":"Webdings","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"128755","Unicode hex":"1F6F3"},{"Typeface name":"Webdings","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"128364","Unicode hex":"1F56C"},{"Typeface name":"Webdings","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"128363","Unicode hex":"1F56B"},{"Typeface name":"Webdings","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128360","Unicode hex":"1F568"},{"Typeface name":"Webdings","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"128264","Unicode hex":"1F508"},{"Typeface name":"Webdings","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"127892","Unicode hex":"1F394"},{"Typeface name":"Webdings","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"127893","Unicode hex":"1F395"},{"Typeface name":"Webdings","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"128492","Unicode hex":"1F5EC"},{"Typeface name":"Webdings","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128637","Unicode hex":"1F67D"},{"Typeface name":"Webdings","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"128493","Unicode hex":"1F5ED"},{"Typeface name":"Webdings","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"128490","Unicode hex":"1F5EA"},{"Typeface name":"Webdings","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"128491","Unicode hex":"1F5EB"},{"Typeface name":"Webdings","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"11156","Unicode hex":"2B94"},{"Typeface name":"Webdings","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"10004","Unicode hex":"2714"},{"Typeface name":"Webdings","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"128690","Unicode hex":"1F6B2"},{"Typeface name":"Webdings","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"11036","Unicode hex":"2B1C"},{"Typeface name":"Webdings","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"128737","Unicode hex":"1F6E1"},{"Typeface name":"Webdings","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"128230","Unicode hex":"1F4E6"},{"Typeface name":"Webdings","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"128753","Unicode hex":"1F6F1"},{"Typeface name":"Webdings","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"11035","Unicode hex":"2B1B"},{"Typeface name":"Webdings","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"128657","Unicode hex":"1F691"},{"Typeface name":"Webdings","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"128712","Unicode hex":"1F6C8"},{"Typeface name":"Webdings","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"128745","Unicode hex":"1F6E9"},{"Typeface name":"Webdings","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"128752","Unicode hex":"1F6F0"},{"Typeface name":"Webdings","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"128968","Unicode hex":"1F7C8"},{"Typeface name":"Webdings","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"128372","Unicode hex":"1F574"},{"Typeface name":"Webdings","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"11044","Unicode hex":"2B24"},{"Typeface name":"Webdings","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"128741","Unicode hex":"1F6E5"},{"Typeface name":"Webdings","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"128660","Unicode hex":"1F694"},{"Typeface name":"Webdings","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"128472","Unicode hex":"1F5D8"},{"Typeface name":"Webdings","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"128473","Unicode hex":"1F5D9"},{"Typeface name":"Webdings","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"10067","Unicode hex":"2753"},{"Typeface name":"Webdings","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"128754","Unicode hex":"1F6F2"},{"Typeface name":"Webdings","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"128647","Unicode hex":"1F687"},{"Typeface name":"Webdings","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"128653","Unicode hex":"1F68D"},{"Typeface name":"Webdings","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"9971","Unicode hex":"26F3"},{"Typeface name":"Webdings","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"10680","Unicode hex":"29B8"},{"Typeface name":"Webdings","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"8854","Unicode hex":"2296"},{"Typeface name":"Webdings","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"128685","Unicode hex":"1F6AD"},{"Typeface name":"Webdings","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"128494","Unicode hex":"1F5EE"},{"Typeface name":"Webdings","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"9168","Unicode hex":"23D0"},{"Typeface name":"Webdings","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128495","Unicode hex":"1F5EF"},{"Typeface name":"Webdings","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128498","Unicode hex":"1F5F2"},{"Typeface name":"Webdings","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"128697","Unicode hex":"1F6B9"},{"Typeface name":"Webdings","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"128698","Unicode hex":"1F6BA"},{"Typeface name":"Webdings","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"128713","Unicode hex":"1F6C9"},{"Typeface name":"Webdings","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"128714","Unicode hex":"1F6CA"},{"Typeface name":"Webdings","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"128700","Unicode hex":"1F6BC"},{"Typeface name":"Webdings","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"128125","Unicode hex":"1F47D"},{"Typeface name":"Webdings","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"127947","Unicode hex":"1F3CB"},{"Typeface name":"Webdings","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"9975","Unicode hex":"26F7"},{"Typeface name":"Webdings","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"127938","Unicode hex":"1F3C2"},{"Typeface name":"Webdings","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"127948","Unicode hex":"1F3CC"},{"Typeface name":"Webdings","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"127946","Unicode hex":"1F3CA"},{"Typeface name":"Webdings","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"127940","Unicode hex":"1F3C4"},{"Typeface name":"Webdings","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"127949","Unicode hex":"1F3CD"},{"Typeface name":"Webdings","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"127950","Unicode hex":"1F3CE"},{"Typeface name":"Webdings","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"128664","Unicode hex":"1F698"},{"Typeface name":"Webdings","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"128480","Unicode hex":"1F5E0"},{"Typeface name":"Webdings","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"128738","Unicode hex":"1F6E2"},{"Typeface name":"Webdings","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"128176","Unicode hex":"1F4B0"},{"Typeface name":"Webdings","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"127991","Unicode hex":"1F3F7"},{"Typeface name":"Webdings","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"128179","Unicode hex":"1F4B3"},{"Typeface name":"Webdings","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"128106","Unicode hex":"1F46A"},{"Typeface name":"Webdings","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"128481","Unicode hex":"1F5E1"},{"Typeface name":"Webdings","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128482","Unicode hex":"1F5E2"},{"Typeface name":"Webdings","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"128483","Unicode hex":"1F5E3"},{"Typeface name":"Webdings","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"10031","Unicode hex":"272F"},{"Typeface name":"Webdings","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"128388","Unicode hex":"1F584"},{"Typeface name":"Webdings","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128389","Unicode hex":"1F585"},{"Typeface name":"Webdings","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128387","Unicode hex":"1F583"},{"Typeface name":"Webdings","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128390","Unicode hex":"1F586"},{"Typeface name":"Webdings","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"128441","Unicode hex":"1F5B9"},{"Typeface name":"Webdings","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"128442","Unicode hex":"1F5BA"},{"Typeface name":"Webdings","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"128443","Unicode hex":"1F5BB"},{"Typeface name":"Webdings","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"128373","Unicode hex":"1F575"},{"Typeface name":"Webdings","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"128368","Unicode hex":"1F570"},{"Typeface name":"Webdings","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"128445","Unicode hex":"1F5BD"},{"Typeface name":"Webdings","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"128446","Unicode hex":"1F5BE"},{"Typeface name":"Webdings","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128203","Unicode hex":"1F4CB"},{"Typeface name":"Webdings","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128466","Unicode hex":"1F5D2"},{"Typeface name":"Webdings","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128467","Unicode hex":"1F5D3"},{"Typeface name":"Webdings","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"128366","Unicode hex":"1F56E"},{"Typeface name":"Webdings","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"128218","Unicode hex":"1F4DA"},{"Typeface name":"Webdings","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128478","Unicode hex":"1F5DE"},{"Typeface name":"Webdings","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128479","Unicode hex":"1F5DF"},{"Typeface name":"Webdings","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"128451","Unicode hex":"1F5C3"},{"Typeface name":"Webdings","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128450","Unicode hex":"1F5C2"},{"Typeface name":"Webdings","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"128444","Unicode hex":"1F5BC"},{"Typeface name":"Webdings","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"127917","Unicode hex":"1F3AD"},{"Typeface name":"Webdings","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"127900","Unicode hex":"1F39C"},{"Typeface name":"Webdings","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"127896","Unicode hex":"1F398"},{"Typeface name":"Webdings","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"127897","Unicode hex":"1F399"},{"Typeface name":"Webdings","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"127911","Unicode hex":"1F3A7"},{"Typeface name":"Webdings","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"128191","Unicode hex":"1F4BF"},{"Typeface name":"Webdings","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"127902","Unicode hex":"1F39E"},{"Typeface name":"Webdings","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"128247","Unicode hex":"1F4F7"},{"Typeface name":"Webdings","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"127903","Unicode hex":"1F39F"},{"Typeface name":"Webdings","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"127916","Unicode hex":"1F3AC"},{"Typeface name":"Webdings","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"128253","Unicode hex":"1F4FD"},{"Typeface name":"Webdings","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128249","Unicode hex":"1F4F9"},{"Typeface name":"Webdings","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"128254","Unicode hex":"1F4FE"},{"Typeface name":"Webdings","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"128251","Unicode hex":"1F4FB"},{"Typeface name":"Webdings","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"127898","Unicode hex":"1F39A"},{"Typeface name":"Webdings","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"127899","Unicode hex":"1F39B"},{"Typeface name":"Webdings","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"128250","Unicode hex":"1F4FA"},{"Typeface name":"Webdings","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"128187","Unicode hex":"1F4BB"},{"Typeface name":"Webdings","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"128421","Unicode hex":"1F5A5"},{"Typeface name":"Webdings","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"128422","Unicode hex":"1F5A6"},{"Typeface name":"Webdings","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"128423","Unicode hex":"1F5A7"},{"Typeface name":"Webdings","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"128377","Unicode hex":"1F579"},{"Typeface name":"Webdings","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"127918","Unicode hex":"1F3AE"},{"Typeface name":"Webdings","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"128379","Unicode hex":"1F57B"},{"Typeface name":"Webdings","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"128380","Unicode hex":"1F57C"},{"Typeface name":"Webdings","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"128223","Unicode hex":"1F4DF"},{"Typeface name":"Webdings","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"128385","Unicode hex":"1F581"},{"Typeface name":"Webdings","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"128384","Unicode hex":"1F580"},{"Typeface name":"Webdings","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"128424","Unicode hex":"1F5A8"},{"Typeface name":"Webdings","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128425","Unicode hex":"1F5A9"},{"Typeface name":"Webdings","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128447","Unicode hex":"1F5BF"},{"Typeface name":"Webdings","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128426","Unicode hex":"1F5AA"},{"Typeface name":"Webdings","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128476","Unicode hex":"1F5DC"},{"Typeface name":"Webdings","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128274","Unicode hex":"1F512"},{"Typeface name":"Webdings","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128275","Unicode hex":"1F513"},{"Typeface name":"Webdings","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128477","Unicode hex":"1F5DD"},{"Typeface name":"Webdings","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128229","Unicode hex":"1F4E5"},{"Typeface name":"Webdings","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128228","Unicode hex":"1F4E4"},{"Typeface name":"Webdings","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128371","Unicode hex":"1F573"},{"Typeface name":"Webdings","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"127779","Unicode hex":"1F323"},{"Typeface name":"Webdings","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"127780","Unicode hex":"1F324"},{"Typeface name":"Webdings","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"127781","Unicode hex":"1F325"},{"Typeface name":"Webdings","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"127782","Unicode hex":"1F326"},{"Typeface name":"Webdings","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"9729","Unicode hex":"2601"},{"Typeface name":"Webdings","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"127784","Unicode hex":"1F328"},{"Typeface name":"Webdings","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"127783","Unicode hex":"1F327"},{"Typeface name":"Webdings","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"127785","Unicode hex":"1F329"},{"Typeface name":"Webdings","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"127786","Unicode hex":"1F32A"},{"Typeface name":"Webdings","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"127788","Unicode hex":"1F32C"},{"Typeface name":"Webdings","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"127787","Unicode hex":"1F32B"},{"Typeface name":"Webdings","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"127772","Unicode hex":"1F31C"},{"Typeface name":"Webdings","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"127777","Unicode hex":"1F321"},{"Typeface name":"Webdings","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"128715","Unicode hex":"1F6CB"},{"Typeface name":"Webdings","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"128719","Unicode hex":"1F6CF"},{"Typeface name":"Webdings","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"127869","Unicode hex":"1F37D"},{"Typeface name":"Webdings","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"127864","Unicode hex":"1F378"},{"Typeface name":"Webdings","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"128718","Unicode hex":"1F6CE"},{"Typeface name":"Webdings","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"128717","Unicode hex":"1F6CD"},{"Typeface name":"Webdings","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"9413","Unicode hex":"24C5"},{"Typeface name":"Webdings","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"9855","Unicode hex":"267F"},{"Typeface name":"Webdings","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"128710","Unicode hex":"1F6C6"},{"Typeface name":"Webdings","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"128392","Unicode hex":"1F588"},{"Typeface name":"Webdings","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"127891","Unicode hex":"1F393"},{"Typeface name":"Webdings","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"128484","Unicode hex":"1F5E4"},{"Typeface name":"Webdings","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"128485","Unicode hex":"1F5E5"},{"Typeface name":"Webdings","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"128486","Unicode hex":"1F5E6"},{"Typeface name":"Webdings","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"128487","Unicode hex":"1F5E7"},{"Typeface name":"Webdings","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"128746","Unicode hex":"1F6EA"},{"Typeface name":"Webdings","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"128063","Unicode hex":"1F43F"},{"Typeface name":"Webdings","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"128038","Unicode hex":"1F426"},{"Typeface name":"Webdings","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"128031","Unicode hex":"1F41F"},{"Typeface name":"Webdings","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"128021","Unicode hex":"1F415"},{"Typeface name":"Webdings","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"128008","Unicode hex":"1F408"},{"Typeface name":"Webdings","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"128620","Unicode hex":"1F66C"},{"Typeface name":"Webdings","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"128622","Unicode hex":"1F66E"},{"Typeface name":"Webdings","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"128621","Unicode hex":"1F66D"},{"Typeface name":"Webdings","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"128623","Unicode hex":"1F66F"},{"Typeface name":"Webdings","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"128506","Unicode hex":"1F5FA"},{"Typeface name":"Webdings","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"127757","Unicode hex":"1F30D"},{"Typeface name":"Webdings","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"127759","Unicode hex":"1F30F"},{"Typeface name":"Webdings","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"127758","Unicode hex":"1F30E"},{"Typeface name":"Webdings","Dingbat dec":"255","Dingbat hex":"FF","Unicode dec":"128330","Unicode hex":"1F54A"},{"Typeface name":"Wingdings","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128393","Unicode hex":"1F589"},{"Typeface name":"Wingdings","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"9986","Unicode hex":"2702"},{"Typeface name":"Wingdings","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"9985","Unicode hex":"2701"},{"Typeface name":"Wingdings","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128083","Unicode hex":"1F453"},{"Typeface name":"Wingdings","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"128365","Unicode hex":"1F56D"},{"Typeface name":"Wingdings","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"128366","Unicode hex":"1F56E"},{"Typeface name":"Wingdings","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128367","Unicode hex":"1F56F"},{"Typeface name":"Wingdings","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128383","Unicode hex":"1F57F"},{"Typeface name":"Wingdings","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"9990","Unicode hex":"2706"},{"Typeface name":"Wingdings","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128386","Unicode hex":"1F582"},{"Typeface name":"Wingdings","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128387","Unicode hex":"1F583"},{"Typeface name":"Wingdings","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"128234","Unicode hex":"1F4EA"},{"Typeface name":"Wingdings","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"128235","Unicode hex":"1F4EB"},{"Typeface name":"Wingdings","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128236","Unicode hex":"1F4EC"},{"Typeface name":"Wingdings","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128237","Unicode hex":"1F4ED"},{"Typeface name":"Wingdings","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128448","Unicode hex":"1F5C0"},{"Typeface name":"Wingdings","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128449","Unicode hex":"1F5C1"},{"Typeface name":"Wingdings","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128462","Unicode hex":"1F5CE"},{"Typeface name":"Wingdings","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"128463","Unicode hex":"1F5CF"},{"Typeface name":"Wingdings","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"128464","Unicode hex":"1F5D0"},{"Typeface name":"Wingdings","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"128452","Unicode hex":"1F5C4"},{"Typeface name":"Wingdings","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"8987","Unicode hex":"231B"},{"Typeface name":"Wingdings","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"128430","Unicode hex":"1F5AE"},{"Typeface name":"Wingdings","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"128432","Unicode hex":"1F5B0"},{"Typeface name":"Wingdings","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"128434","Unicode hex":"1F5B2"},{"Typeface name":"Wingdings","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"128435","Unicode hex":"1F5B3"},{"Typeface name":"Wingdings","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"128436","Unicode hex":"1F5B4"},{"Typeface name":"Wingdings","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"128427","Unicode hex":"1F5AB"},{"Typeface name":"Wingdings","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"128428","Unicode hex":"1F5AC"},{"Typeface name":"Wingdings","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"9991","Unicode hex":"2707"},{"Typeface name":"Wingdings","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"9997","Unicode hex":"270D"},{"Typeface name":"Wingdings","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128398","Unicode hex":"1F58E"},{"Typeface name":"Wingdings","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"9996","Unicode hex":"270C"},{"Typeface name":"Wingdings","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"128399","Unicode hex":"1F58F"},{"Typeface name":"Wingdings","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"128077","Unicode hex":"1F44D"},{"Typeface name":"Wingdings","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"128078","Unicode hex":"1F44E"},{"Typeface name":"Wingdings","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"9756","Unicode hex":"261C"},{"Typeface name":"Wingdings","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"9758","Unicode hex":"261E"},{"Typeface name":"Wingdings","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"9757","Unicode hex":"261D"},{"Typeface name":"Wingdings","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"9759","Unicode hex":"261F"},{"Typeface name":"Wingdings","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"128400","Unicode hex":"1F590"},{"Typeface name":"Wingdings","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"9786","Unicode hex":"263A"},{"Typeface name":"Wingdings","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128528","Unicode hex":"1F610"},{"Typeface name":"Wingdings","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"9785","Unicode hex":"2639"},{"Typeface name":"Wingdings","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"128163","Unicode hex":"1F4A3"},{"Typeface name":"Wingdings","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128369","Unicode hex":"1F571"},{"Typeface name":"Wingdings","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"127987","Unicode hex":"1F3F3"},{"Typeface name":"Wingdings","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"127985","Unicode hex":"1F3F1"},{"Typeface name":"Wingdings","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"9992","Unicode hex":"2708"},{"Typeface name":"Wingdings","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9788","Unicode hex":"263C"},{"Typeface name":"Wingdings","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"127778","Unicode hex":"1F322"},{"Typeface name":"Wingdings","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"10052","Unicode hex":"2744"},{"Typeface name":"Wingdings","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"128326","Unicode hex":"1F546"},{"Typeface name":"Wingdings","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"10014","Unicode hex":"271E"},{"Typeface name":"Wingdings","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128328","Unicode hex":"1F548"},{"Typeface name":"Wingdings","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"10016","Unicode hex":"2720"},{"Typeface name":"Wingdings","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"10017","Unicode hex":"2721"},{"Typeface name":"Wingdings","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"9770","Unicode hex":"262A"},{"Typeface name":"Wingdings","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"9775","Unicode hex":"262F"},{"Typeface name":"Wingdings","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128329","Unicode hex":"1F549"},{"Typeface name":"Wingdings","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"9784","Unicode hex":"2638"},{"Typeface name":"Wingdings","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"9800","Unicode hex":"2648"},{"Typeface name":"Wingdings","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"9801","Unicode hex":"2649"},{"Typeface name":"Wingdings","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"9802","Unicode hex":"264A"},{"Typeface name":"Wingdings","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"9803","Unicode hex":"264B"},{"Typeface name":"Wingdings","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"9804","Unicode hex":"264C"},{"Typeface name":"Wingdings","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"9805","Unicode hex":"264D"},{"Typeface name":"Wingdings","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"9806","Unicode hex":"264E"},{"Typeface name":"Wingdings","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"9807","Unicode hex":"264F"},{"Typeface name":"Wingdings","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"9808","Unicode hex":"2650"},{"Typeface name":"Wingdings","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"9809","Unicode hex":"2651"},{"Typeface name":"Wingdings","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"9810","Unicode hex":"2652"},{"Typeface name":"Wingdings","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"9811","Unicode hex":"2653"},{"Typeface name":"Wingdings","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"128624","Unicode hex":"1F670"},{"Typeface name":"Wingdings","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"128629","Unicode hex":"1F675"},{"Typeface name":"Wingdings","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"9899","Unicode hex":"26AB"},{"Typeface name":"Wingdings","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"128318","Unicode hex":"1F53E"},{"Typeface name":"Wingdings","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"9724","Unicode hex":"25FC"},{"Typeface name":"Wingdings","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"128911","Unicode hex":"1F78F"},{"Typeface name":"Wingdings","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"128912","Unicode hex":"1F790"},{"Typeface name":"Wingdings","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"10065","Unicode hex":"2751"},{"Typeface name":"Wingdings","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"10066","Unicode hex":"2752"},{"Typeface name":"Wingdings","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"128927","Unicode hex":"1F79F"},{"Typeface name":"Wingdings","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"10731","Unicode hex":"29EB"},{"Typeface name":"Wingdings","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"9670","Unicode hex":"25C6"},{"Typeface name":"Wingdings","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"10070","Unicode hex":"2756"},{"Typeface name":"Wingdings","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"11049","Unicode hex":"2B29"},{"Typeface name":"Wingdings","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"8999","Unicode hex":"2327"},{"Typeface name":"Wingdings","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"11193","Unicode hex":"2BB9"},{"Typeface name":"Wingdings","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"8984","Unicode hex":"2318"},{"Typeface name":"Wingdings","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"127989","Unicode hex":"1F3F5"},{"Typeface name":"Wingdings","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"127990","Unicode hex":"1F3F6"},{"Typeface name":"Wingdings","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128630","Unicode hex":"1F676"},{"Typeface name":"Wingdings","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128631","Unicode hex":"1F677"},{"Typeface name":"Wingdings","Dingbat dec":"127","Dingbat hex":"7F","Unicode dec":"9647","Unicode hex":"25AF"},{"Typeface name":"Wingdings","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"127243","Unicode hex":"1F10B"},{"Typeface name":"Wingdings","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"10112","Unicode hex":"2780"},{"Typeface name":"Wingdings","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"10113","Unicode hex":"2781"},{"Typeface name":"Wingdings","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"10114","Unicode hex":"2782"},{"Typeface name":"Wingdings","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"10115","Unicode hex":"2783"},{"Typeface name":"Wingdings","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"10116","Unicode hex":"2784"},{"Typeface name":"Wingdings","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"10117","Unicode hex":"2785"},{"Typeface name":"Wingdings","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"10118","Unicode hex":"2786"},{"Typeface name":"Wingdings","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"10119","Unicode hex":"2787"},{"Typeface name":"Wingdings","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"10120","Unicode hex":"2788"},{"Typeface name":"Wingdings","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"10121","Unicode hex":"2789"},{"Typeface name":"Wingdings","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"127244","Unicode hex":"1F10C"},{"Typeface name":"Wingdings","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"10122","Unicode hex":"278A"},{"Typeface name":"Wingdings","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"10123","Unicode hex":"278B"},{"Typeface name":"Wingdings","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"10124","Unicode hex":"278C"},{"Typeface name":"Wingdings","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"10125","Unicode hex":"278D"},{"Typeface name":"Wingdings","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"10126","Unicode hex":"278E"},{"Typeface name":"Wingdings","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"10127","Unicode hex":"278F"},{"Typeface name":"Wingdings","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"10128","Unicode hex":"2790"},{"Typeface name":"Wingdings","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"10129","Unicode hex":"2791"},{"Typeface name":"Wingdings","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"10130","Unicode hex":"2792"},{"Typeface name":"Wingdings","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"10131","Unicode hex":"2793"},{"Typeface name":"Wingdings","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128610","Unicode hex":"1F662"},{"Typeface name":"Wingdings","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"128608","Unicode hex":"1F660"},{"Typeface name":"Wingdings","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"128609","Unicode hex":"1F661"},{"Typeface name":"Wingdings","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"128611","Unicode hex":"1F663"},{"Typeface name":"Wingdings","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128606","Unicode hex":"1F65E"},{"Typeface name":"Wingdings","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128604","Unicode hex":"1F65C"},{"Typeface name":"Wingdings","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128605","Unicode hex":"1F65D"},{"Typeface name":"Wingdings","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"128607","Unicode hex":"1F65F"},{"Typeface name":"Wingdings","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"8729","Unicode hex":"2219"},{"Typeface name":"Wingdings","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"8226","Unicode hex":"2022"},{"Typeface name":"Wingdings","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"11037","Unicode hex":"2B1D"},{"Typeface name":"Wingdings","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"11096","Unicode hex":"2B58"},{"Typeface name":"Wingdings","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"128902","Unicode hex":"1F786"},{"Typeface name":"Wingdings","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"128904","Unicode hex":"1F788"},{"Typeface name":"Wingdings","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128906","Unicode hex":"1F78A"},{"Typeface name":"Wingdings","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128907","Unicode hex":"1F78B"},{"Typeface name":"Wingdings","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128319","Unicode hex":"1F53F"},{"Typeface name":"Wingdings","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"9642","Unicode hex":"25AA"},{"Typeface name":"Wingdings","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"128910","Unicode hex":"1F78E"},{"Typeface name":"Wingdings","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128961","Unicode hex":"1F7C1"},{"Typeface name":"Wingdings","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128965","Unicode hex":"1F7C5"},{"Typeface name":"Wingdings","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"9733","Unicode hex":"2605"},{"Typeface name":"Wingdings","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128971","Unicode hex":"1F7CB"},{"Typeface name":"Wingdings","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"128975","Unicode hex":"1F7CF"},{"Typeface name":"Wingdings","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"128979","Unicode hex":"1F7D3"},{"Typeface name":"Wingdings","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"128977","Unicode hex":"1F7D1"},{"Typeface name":"Wingdings","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"11216","Unicode hex":"2BD0"},{"Typeface name":"Wingdings","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"8982","Unicode hex":"2316"},{"Typeface name":"Wingdings","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"11214","Unicode hex":"2BCE"},{"Typeface name":"Wingdings","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"11215","Unicode hex":"2BCF"},{"Typeface name":"Wingdings","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"11217","Unicode hex":"2BD1"},{"Typeface name":"Wingdings","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"10026","Unicode hex":"272A"},{"Typeface name":"Wingdings","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"10032","Unicode hex":"2730"},{"Typeface name":"Wingdings","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"128336","Unicode hex":"1F550"},{"Typeface name":"Wingdings","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"128337","Unicode hex":"1F551"},{"Typeface name":"Wingdings","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128338","Unicode hex":"1F552"},{"Typeface name":"Wingdings","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"128339","Unicode hex":"1F553"},{"Typeface name":"Wingdings","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"128340","Unicode hex":"1F554"},{"Typeface name":"Wingdings","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"128341","Unicode hex":"1F555"},{"Typeface name":"Wingdings","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"128342","Unicode hex":"1F556"},{"Typeface name":"Wingdings","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"128343","Unicode hex":"1F557"},{"Typeface name":"Wingdings","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"128344","Unicode hex":"1F558"},{"Typeface name":"Wingdings","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"128345","Unicode hex":"1F559"},{"Typeface name":"Wingdings","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"128346","Unicode hex":"1F55A"},{"Typeface name":"Wingdings","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"128347","Unicode hex":"1F55B"},{"Typeface name":"Wingdings","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"11184","Unicode hex":"2BB0"},{"Typeface name":"Wingdings","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"11185","Unicode hex":"2BB1"},{"Typeface name":"Wingdings","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"11186","Unicode hex":"2BB2"},{"Typeface name":"Wingdings","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"11187","Unicode hex":"2BB3"},{"Typeface name":"Wingdings","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"11188","Unicode hex":"2BB4"},{"Typeface name":"Wingdings","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"11189","Unicode hex":"2BB5"},{"Typeface name":"Wingdings","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"11190","Unicode hex":"2BB6"},{"Typeface name":"Wingdings","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"11191","Unicode hex":"2BB7"},{"Typeface name":"Wingdings","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128618","Unicode hex":"1F66A"},{"Typeface name":"Wingdings","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128619","Unicode hex":"1F66B"},{"Typeface name":"Wingdings","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128597","Unicode hex":"1F655"},{"Typeface name":"Wingdings","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128596","Unicode hex":"1F654"},{"Typeface name":"Wingdings","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128599","Unicode hex":"1F657"},{"Typeface name":"Wingdings","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128598","Unicode hex":"1F656"},{"Typeface name":"Wingdings","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128592","Unicode hex":"1F650"},{"Typeface name":"Wingdings","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128593","Unicode hex":"1F651"},{"Typeface name":"Wingdings","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128594","Unicode hex":"1F652"},{"Typeface name":"Wingdings","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128595","Unicode hex":"1F653"},{"Typeface name":"Wingdings","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"9003","Unicode hex":"232B"},{"Typeface name":"Wingdings","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"8998","Unicode hex":"2326"},{"Typeface name":"Wingdings","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"11160","Unicode hex":"2B98"},{"Typeface name":"Wingdings","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"11162","Unicode hex":"2B9A"},{"Typeface name":"Wingdings","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"11161","Unicode hex":"2B99"},{"Typeface name":"Wingdings","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"11163","Unicode hex":"2B9B"},{"Typeface name":"Wingdings","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"11144","Unicode hex":"2B88"},{"Typeface name":"Wingdings","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"11146","Unicode hex":"2B8A"},{"Typeface name":"Wingdings","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"11145","Unicode hex":"2B89"},{"Typeface name":"Wingdings","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"11147","Unicode hex":"2B8B"},{"Typeface name":"Wingdings","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"129128","Unicode hex":"1F868"},{"Typeface name":"Wingdings","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"129130","Unicode hex":"1F86A"},{"Typeface name":"Wingdings","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"129129","Unicode hex":"1F869"},{"Typeface name":"Wingdings","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"129131","Unicode hex":"1F86B"},{"Typeface name":"Wingdings","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"129132","Unicode hex":"1F86C"},{"Typeface name":"Wingdings","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"129133","Unicode hex":"1F86D"},{"Typeface name":"Wingdings","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"129135","Unicode hex":"1F86F"},{"Typeface name":"Wingdings","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"129134","Unicode hex":"1F86E"},{"Typeface name":"Wingdings","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"129144","Unicode hex":"1F878"},{"Typeface name":"Wingdings","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"129146","Unicode hex":"1F87A"},{"Typeface name":"Wingdings","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"129145","Unicode hex":"1F879"},{"Typeface name":"Wingdings","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"129147","Unicode hex":"1F87B"},{"Typeface name":"Wingdings","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"129148","Unicode hex":"1F87C"},{"Typeface name":"Wingdings","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"129149","Unicode hex":"1F87D"},{"Typeface name":"Wingdings","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"129151","Unicode hex":"1F87F"},{"Typeface name":"Wingdings","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"129150","Unicode hex":"1F87E"},{"Typeface name":"Wingdings","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"8678","Unicode hex":"21E6"},{"Typeface name":"Wingdings","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"8680","Unicode hex":"21E8"},{"Typeface name":"Wingdings","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"8679","Unicode hex":"21E7"},{"Typeface name":"Wingdings","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"8681","Unicode hex":"21E9"},{"Typeface name":"Wingdings","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"11012","Unicode hex":"2B04"},{"Typeface name":"Wingdings","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"8691","Unicode hex":"21F3"},{"Typeface name":"Wingdings","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"11009","Unicode hex":"2B01"},{"Typeface name":"Wingdings","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"11008","Unicode hex":"2B00"},{"Typeface name":"Wingdings","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"11011","Unicode hex":"2B03"},{"Typeface name":"Wingdings","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"11010","Unicode hex":"2B02"},{"Typeface name":"Wingdings","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"129196","Unicode hex":"1F8AC"},{"Typeface name":"Wingdings","Dingbat dec":"250","Dingbat hex":"FA","Unicode dec":"129197","Unicode hex":"1F8AD"},{"Typeface name":"Wingdings","Dingbat dec":"251","Dingbat hex":"FB","Unicode dec":"128502","Unicode hex":"1F5F6"},{"Typeface name":"Wingdings","Dingbat dec":"252","Dingbat hex":"FC","Unicode dec":"10003","Unicode hex":"2713"},{"Typeface name":"Wingdings","Dingbat dec":"253","Dingbat hex":"FD","Unicode dec":"128503","Unicode hex":"1F5F7"},{"Typeface name":"Wingdings","Dingbat dec":"254","Dingbat hex":"FE","Unicode dec":"128505","Unicode hex":"1F5F9"},{"Typeface name":"Wingdings 2","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings 2","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"128394","Unicode hex":"1F58A"},{"Typeface name":"Wingdings 2","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"128395","Unicode hex":"1F58B"},{"Typeface name":"Wingdings 2","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"128396","Unicode hex":"1F58C"},{"Typeface name":"Wingdings 2","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"128397","Unicode hex":"1F58D"},{"Typeface name":"Wingdings 2","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"9988","Unicode hex":"2704"},{"Typeface name":"Wingdings 2","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"9984","Unicode hex":"2700"},{"Typeface name":"Wingdings 2","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"128382","Unicode hex":"1F57E"},{"Typeface name":"Wingdings 2","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"128381","Unicode hex":"1F57D"},{"Typeface name":"Wingdings 2","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"128453","Unicode hex":"1F5C5"},{"Typeface name":"Wingdings 2","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"128454","Unicode hex":"1F5C6"},{"Typeface name":"Wingdings 2","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"128455","Unicode hex":"1F5C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"128456","Unicode hex":"1F5C8"},{"Typeface name":"Wingdings 2","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"128457","Unicode hex":"1F5C9"},{"Typeface name":"Wingdings 2","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"128458","Unicode hex":"1F5CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"128459","Unicode hex":"1F5CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"128460","Unicode hex":"1F5CC"},{"Typeface name":"Wingdings 2","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"128461","Unicode hex":"1F5CD"},{"Typeface name":"Wingdings 2","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"128203","Unicode hex":"1F4CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"128465","Unicode hex":"1F5D1"},{"Typeface name":"Wingdings 2","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"128468","Unicode hex":"1F5D4"},{"Typeface name":"Wingdings 2","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"128437","Unicode hex":"1F5B5"},{"Typeface name":"Wingdings 2","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"128438","Unicode hex":"1F5B6"},{"Typeface name":"Wingdings 2","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"128439","Unicode hex":"1F5B7"},{"Typeface name":"Wingdings 2","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"128440","Unicode hex":"1F5B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"128429","Unicode hex":"1F5AD"},{"Typeface name":"Wingdings 2","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"128431","Unicode hex":"1F5AF"},{"Typeface name":"Wingdings 2","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"128433","Unicode hex":"1F5B1"},{"Typeface name":"Wingdings 2","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"128402","Unicode hex":"1F592"},{"Typeface name":"Wingdings 2","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"128403","Unicode hex":"1F593"},{"Typeface name":"Wingdings 2","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"128408","Unicode hex":"1F598"},{"Typeface name":"Wingdings 2","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"128409","Unicode hex":"1F599"},{"Typeface name":"Wingdings 2","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"128410","Unicode hex":"1F59A"},{"Typeface name":"Wingdings 2","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"128411","Unicode hex":"1F59B"},{"Typeface name":"Wingdings 2","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"128072","Unicode hex":"1F448"},{"Typeface name":"Wingdings 2","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"128073","Unicode hex":"1F449"},{"Typeface name":"Wingdings 2","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"128412","Unicode hex":"1F59C"},{"Typeface name":"Wingdings 2","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"128413","Unicode hex":"1F59D"},{"Typeface name":"Wingdings 2","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"128414","Unicode hex":"1F59E"},{"Typeface name":"Wingdings 2","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"128415","Unicode hex":"1F59F"},{"Typeface name":"Wingdings 2","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"128416","Unicode hex":"1F5A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"128417","Unicode hex":"1F5A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"128070","Unicode hex":"1F446"},{"Typeface name":"Wingdings 2","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"128071","Unicode hex":"1F447"},{"Typeface name":"Wingdings 2","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"128418","Unicode hex":"1F5A2"},{"Typeface name":"Wingdings 2","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"128419","Unicode hex":"1F5A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"128401","Unicode hex":"1F591"},{"Typeface name":"Wingdings 2","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"128500","Unicode hex":"1F5F4"},{"Typeface name":"Wingdings 2","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"128504","Unicode hex":"1F5F8"},{"Typeface name":"Wingdings 2","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"128501","Unicode hex":"1F5F5"},{"Typeface name":"Wingdings 2","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9745","Unicode hex":"2611"},{"Typeface name":"Wingdings 2","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"11197","Unicode hex":"2BBD"},{"Typeface name":"Wingdings 2","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"9746","Unicode hex":"2612"},{"Typeface name":"Wingdings 2","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"11198","Unicode hex":"2BBE"},{"Typeface name":"Wingdings 2","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"11199","Unicode hex":"2BBF"},{"Typeface name":"Wingdings 2","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"128711","Unicode hex":"1F6C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"10680","Unicode hex":"29B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"128625","Unicode hex":"1F671"},{"Typeface name":"Wingdings 2","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"128628","Unicode hex":"1F674"},{"Typeface name":"Wingdings 2","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"128626","Unicode hex":"1F672"},{"Typeface name":"Wingdings 2","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"128627","Unicode hex":"1F673"},{"Typeface name":"Wingdings 2","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"8253","Unicode hex":"203D"},{"Typeface name":"Wingdings 2","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"128633","Unicode hex":"1F679"},{"Typeface name":"Wingdings 2","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"128634","Unicode hex":"1F67A"},{"Typeface name":"Wingdings 2","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"128635","Unicode hex":"1F67B"},{"Typeface name":"Wingdings 2","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"128614","Unicode hex":"1F666"},{"Typeface name":"Wingdings 2","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"128612","Unicode hex":"1F664"},{"Typeface name":"Wingdings 2","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"128613","Unicode hex":"1F665"},{"Typeface name":"Wingdings 2","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"128615","Unicode hex":"1F667"},{"Typeface name":"Wingdings 2","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"128602","Unicode hex":"1F65A"},{"Typeface name":"Wingdings 2","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"128600","Unicode hex":"1F658"},{"Typeface name":"Wingdings 2","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"128601","Unicode hex":"1F659"},{"Typeface name":"Wingdings 2","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"128603","Unicode hex":"1F65B"},{"Typeface name":"Wingdings 2","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"9450","Unicode hex":"24EA"},{"Typeface name":"Wingdings 2","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"9312","Unicode hex":"2460"},{"Typeface name":"Wingdings 2","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"9313","Unicode hex":"2461"},{"Typeface name":"Wingdings 2","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"9314","Unicode hex":"2462"},{"Typeface name":"Wingdings 2","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"9315","Unicode hex":"2463"},{"Typeface name":"Wingdings 2","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"9316","Unicode hex":"2464"},{"Typeface name":"Wingdings 2","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"9317","Unicode hex":"2465"},{"Typeface name":"Wingdings 2","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"9318","Unicode hex":"2466"},{"Typeface name":"Wingdings 2","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"9319","Unicode hex":"2467"},{"Typeface name":"Wingdings 2","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"9320","Unicode hex":"2468"},{"Typeface name":"Wingdings 2","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"9321","Unicode hex":"2469"},{"Typeface name":"Wingdings 2","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"9471","Unicode hex":"24FF"},{"Typeface name":"Wingdings 2","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"10102","Unicode hex":"2776"},{"Typeface name":"Wingdings 2","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"10103","Unicode hex":"2777"},{"Typeface name":"Wingdings 2","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"10104","Unicode hex":"2778"},{"Typeface name":"Wingdings 2","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"10105","Unicode hex":"2779"},{"Typeface name":"Wingdings 2","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"10106","Unicode hex":"277A"},{"Typeface name":"Wingdings 2","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"10107","Unicode hex":"277B"},{"Typeface name":"Wingdings 2","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"10108","Unicode hex":"277C"},{"Typeface name":"Wingdings 2","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"10109","Unicode hex":"277D"},{"Typeface name":"Wingdings 2","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"10110","Unicode hex":"277E"},{"Typeface name":"Wingdings 2","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"10111","Unicode hex":"277F"},{"Typeface name":"Wingdings 2","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"9737","Unicode hex":"2609"},{"Typeface name":"Wingdings 2","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"127765","Unicode hex":"1F315"},{"Typeface name":"Wingdings 2","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"9789","Unicode hex":"263D"},{"Typeface name":"Wingdings 2","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"9790","Unicode hex":"263E"},{"Typeface name":"Wingdings 2","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"11839","Unicode hex":"2E3F"},{"Typeface name":"Wingdings 2","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"10013","Unicode hex":"271D"},{"Typeface name":"Wingdings 2","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"128327","Unicode hex":"1F547"},{"Typeface name":"Wingdings 2","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"128348","Unicode hex":"1F55C"},{"Typeface name":"Wingdings 2","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"128349","Unicode hex":"1F55D"},{"Typeface name":"Wingdings 2","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"128350","Unicode hex":"1F55E"},{"Typeface name":"Wingdings 2","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"128351","Unicode hex":"1F55F"},{"Typeface name":"Wingdings 2","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"128352","Unicode hex":"1F560"},{"Typeface name":"Wingdings 2","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"128353","Unicode hex":"1F561"},{"Typeface name":"Wingdings 2","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"128354","Unicode hex":"1F562"},{"Typeface name":"Wingdings 2","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"128355","Unicode hex":"1F563"},{"Typeface name":"Wingdings 2","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"128356","Unicode hex":"1F564"},{"Typeface name":"Wingdings 2","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"128357","Unicode hex":"1F565"},{"Typeface name":"Wingdings 2","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"128358","Unicode hex":"1F566"},{"Typeface name":"Wingdings 2","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"128359","Unicode hex":"1F567"},{"Typeface name":"Wingdings 2","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"128616","Unicode hex":"1F668"},{"Typeface name":"Wingdings 2","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"128617","Unicode hex":"1F669"},{"Typeface name":"Wingdings 2","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"8901","Unicode hex":"22C5"},{"Typeface name":"Wingdings 2","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"128900","Unicode hex":"1F784"},{"Typeface name":"Wingdings 2","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"10625","Unicode hex":"2981"},{"Typeface name":"Wingdings 2","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"9679","Unicode hex":"25CF"},{"Typeface name":"Wingdings 2","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"9675","Unicode hex":"25CB"},{"Typeface name":"Wingdings 2","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"128901","Unicode hex":"1F785"},{"Typeface name":"Wingdings 2","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"128903","Unicode hex":"1F787"},{"Typeface name":"Wingdings 2","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"128905","Unicode hex":"1F789"},{"Typeface name":"Wingdings 2","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"8857","Unicode hex":"2299"},{"Typeface name":"Wingdings 2","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"10687","Unicode hex":"29BF"},{"Typeface name":"Wingdings 2","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"128908","Unicode hex":"1F78C"},{"Typeface name":"Wingdings 2","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"128909","Unicode hex":"1F78D"},{"Typeface name":"Wingdings 2","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"9726","Unicode hex":"25FE"},{"Typeface name":"Wingdings 2","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"9632","Unicode hex":"25A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"9633","Unicode hex":"25A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"128913","Unicode hex":"1F791"},{"Typeface name":"Wingdings 2","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"128914","Unicode hex":"1F792"},{"Typeface name":"Wingdings 2","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"128915","Unicode hex":"1F793"},{"Typeface name":"Wingdings 2","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"128916","Unicode hex":"1F794"},{"Typeface name":"Wingdings 2","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"9635","Unicode hex":"25A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"128917","Unicode hex":"1F795"},{"Typeface name":"Wingdings 2","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"128918","Unicode hex":"1F796"},{"Typeface name":"Wingdings 2","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"128919","Unicode hex":"1F797"},{"Typeface name":"Wingdings 2","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"128920","Unicode hex":"1F798"},{"Typeface name":"Wingdings 2","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"11049","Unicode hex":"2B29"},{"Typeface name":"Wingdings 2","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"11045","Unicode hex":"2B25"},{"Typeface name":"Wingdings 2","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"9671","Unicode hex":"25C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"128922","Unicode hex":"1F79A"},{"Typeface name":"Wingdings 2","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"9672","Unicode hex":"25C8"},{"Typeface name":"Wingdings 2","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"128923","Unicode hex":"1F79B"},{"Typeface name":"Wingdings 2","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"128924","Unicode hex":"1F79C"},{"Typeface name":"Wingdings 2","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"128925","Unicode hex":"1F79D"},{"Typeface name":"Wingdings 2","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"128926","Unicode hex":"1F79E"},{"Typeface name":"Wingdings 2","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"11050","Unicode hex":"2B2A"},{"Typeface name":"Wingdings 2","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"11047","Unicode hex":"2B27"},{"Typeface name":"Wingdings 2","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"9674","Unicode hex":"25CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"128928","Unicode hex":"1F7A0"},{"Typeface name":"Wingdings 2","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"9686","Unicode hex":"25D6"},{"Typeface name":"Wingdings 2","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"9687","Unicode hex":"25D7"},{"Typeface name":"Wingdings 2","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"11210","Unicode hex":"2BCA"},{"Typeface name":"Wingdings 2","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"11211","Unicode hex":"2BCB"},{"Typeface name":"Wingdings 2","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"11200","Unicode hex":"2BC0"},{"Typeface name":"Wingdings 2","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"11201","Unicode hex":"2BC1"},{"Typeface name":"Wingdings 2","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"11039","Unicode hex":"2B1F"},{"Typeface name":"Wingdings 2","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"11202","Unicode hex":"2BC2"},{"Typeface name":"Wingdings 2","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"11043","Unicode hex":"2B23"},{"Typeface name":"Wingdings 2","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"11042","Unicode hex":"2B22"},{"Typeface name":"Wingdings 2","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"11203","Unicode hex":"2BC3"},{"Typeface name":"Wingdings 2","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"11204","Unicode hex":"2BC4"},{"Typeface name":"Wingdings 2","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"128929","Unicode hex":"1F7A1"},{"Typeface name":"Wingdings 2","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"128930","Unicode hex":"1F7A2"},{"Typeface name":"Wingdings 2","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"128931","Unicode hex":"1F7A3"},{"Typeface name":"Wingdings 2","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"128932","Unicode hex":"1F7A4"},{"Typeface name":"Wingdings 2","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"128933","Unicode hex":"1F7A5"},{"Typeface name":"Wingdings 2","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"128934","Unicode hex":"1F7A6"},{"Typeface name":"Wingdings 2","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"128935","Unicode hex":"1F7A7"},{"Typeface name":"Wingdings 2","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"128936","Unicode hex":"1F7A8"},{"Typeface name":"Wingdings 2","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"128937","Unicode hex":"1F7A9"},{"Typeface name":"Wingdings 2","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"128938","Unicode hex":"1F7AA"},{"Typeface name":"Wingdings 2","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"128939","Unicode hex":"1F7AB"},{"Typeface name":"Wingdings 2","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"128940","Unicode hex":"1F7AC"},{"Typeface name":"Wingdings 2","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"128941","Unicode hex":"1F7AD"},{"Typeface name":"Wingdings 2","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"128942","Unicode hex":"1F7AE"},{"Typeface name":"Wingdings 2","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"128943","Unicode hex":"1F7AF"},{"Typeface name":"Wingdings 2","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"128944","Unicode hex":"1F7B0"},{"Typeface name":"Wingdings 2","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"128945","Unicode hex":"1F7B1"},{"Typeface name":"Wingdings 2","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"128946","Unicode hex":"1F7B2"},{"Typeface name":"Wingdings 2","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"128947","Unicode hex":"1F7B3"},{"Typeface name":"Wingdings 2","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"128948","Unicode hex":"1F7B4"},{"Typeface name":"Wingdings 2","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"128949","Unicode hex":"1F7B5"},{"Typeface name":"Wingdings 2","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"128950","Unicode hex":"1F7B6"},{"Typeface name":"Wingdings 2","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"128951","Unicode hex":"1F7B7"},{"Typeface name":"Wingdings 2","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"128952","Unicode hex":"1F7B8"},{"Typeface name":"Wingdings 2","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"128953","Unicode hex":"1F7B9"},{"Typeface name":"Wingdings 2","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"128954","Unicode hex":"1F7BA"},{"Typeface name":"Wingdings 2","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"128955","Unicode hex":"1F7BB"},{"Typeface name":"Wingdings 2","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"128956","Unicode hex":"1F7BC"},{"Typeface name":"Wingdings 2","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"128957","Unicode hex":"1F7BD"},{"Typeface name":"Wingdings 2","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"128958","Unicode hex":"1F7BE"},{"Typeface name":"Wingdings 2","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"128959","Unicode hex":"1F7BF"},{"Typeface name":"Wingdings 2","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"128960","Unicode hex":"1F7C0"},{"Typeface name":"Wingdings 2","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"128962","Unicode hex":"1F7C2"},{"Typeface name":"Wingdings 2","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"128964","Unicode hex":"1F7C4"},{"Typeface name":"Wingdings 2","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"128966","Unicode hex":"1F7C6"},{"Typeface name":"Wingdings 2","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"128969","Unicode hex":"1F7C9"},{"Typeface name":"Wingdings 2","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"128970","Unicode hex":"1F7CA"},{"Typeface name":"Wingdings 2","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"10038","Unicode hex":"2736"},{"Typeface name":"Wingdings 2","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"128972","Unicode hex":"1F7CC"},{"Typeface name":"Wingdings 2","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"128974","Unicode hex":"1F7CE"},{"Typeface name":"Wingdings 2","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"128976","Unicode hex":"1F7D0"},{"Typeface name":"Wingdings 2","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"128978","Unicode hex":"1F7D2"},{"Typeface name":"Wingdings 2","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"10041","Unicode hex":"2739"},{"Typeface name":"Wingdings 2","Dingbat dec":"241","Dingbat hex":"F1","Unicode dec":"128963","Unicode hex":"1F7C3"},{"Typeface name":"Wingdings 2","Dingbat dec":"242","Dingbat hex":"F2","Unicode dec":"128967","Unicode hex":"1F7C7"},{"Typeface name":"Wingdings 2","Dingbat dec":"243","Dingbat hex":"F3","Unicode dec":"10031","Unicode hex":"272F"},{"Typeface name":"Wingdings 2","Dingbat dec":"244","Dingbat hex":"F4","Unicode dec":"128973","Unicode hex":"1F7CD"},{"Typeface name":"Wingdings 2","Dingbat dec":"245","Dingbat hex":"F5","Unicode dec":"128980","Unicode hex":"1F7D4"},{"Typeface name":"Wingdings 2","Dingbat dec":"246","Dingbat hex":"F6","Unicode dec":"11212","Unicode hex":"2BCC"},{"Typeface name":"Wingdings 2","Dingbat dec":"247","Dingbat hex":"F7","Unicode dec":"11213","Unicode hex":"2BCD"},{"Typeface name":"Wingdings 2","Dingbat dec":"248","Dingbat hex":"F8","Unicode dec":"8251","Unicode hex":"203B"},{"Typeface name":"Wingdings 2","Dingbat dec":"249","Dingbat hex":"F9","Unicode dec":"8258","Unicode hex":"2042"},{"Typeface name":"Wingdings 3","Dingbat dec":"32","Dingbat hex":"20","Unicode dec":"32","Unicode hex":"20"},{"Typeface name":"Wingdings 3","Dingbat dec":"33","Dingbat hex":"21","Unicode dec":"11104","Unicode hex":"2B60"},{"Typeface name":"Wingdings 3","Dingbat dec":"34","Dingbat hex":"22","Unicode dec":"11106","Unicode hex":"2B62"},{"Typeface name":"Wingdings 3","Dingbat dec":"35","Dingbat hex":"23","Unicode dec":"11105","Unicode hex":"2B61"},{"Typeface name":"Wingdings 3","Dingbat dec":"36","Dingbat hex":"24","Unicode dec":"11107","Unicode hex":"2B63"},{"Typeface name":"Wingdings 3","Dingbat dec":"37","Dingbat hex":"25","Unicode dec":"11110","Unicode hex":"2B66"},{"Typeface name":"Wingdings 3","Dingbat dec":"38","Dingbat hex":"26","Unicode dec":"11111","Unicode hex":"2B67"},{"Typeface name":"Wingdings 3","Dingbat dec":"39","Dingbat hex":"27","Unicode dec":"11113","Unicode hex":"2B69"},{"Typeface name":"Wingdings 3","Dingbat dec":"40","Dingbat hex":"28","Unicode dec":"11112","Unicode hex":"2B68"},{"Typeface name":"Wingdings 3","Dingbat dec":"41","Dingbat hex":"29","Unicode dec":"11120","Unicode hex":"2B70"},{"Typeface name":"Wingdings 3","Dingbat dec":"42","Dingbat hex":"2A","Unicode dec":"11122","Unicode hex":"2B72"},{"Typeface name":"Wingdings 3","Dingbat dec":"43","Dingbat hex":"2B","Unicode dec":"11121","Unicode hex":"2B71"},{"Typeface name":"Wingdings 3","Dingbat dec":"44","Dingbat hex":"2C","Unicode dec":"11123","Unicode hex":"2B73"},{"Typeface name":"Wingdings 3","Dingbat dec":"45","Dingbat hex":"2D","Unicode dec":"11126","Unicode hex":"2B76"},{"Typeface name":"Wingdings 3","Dingbat dec":"46","Dingbat hex":"2E","Unicode dec":"11128","Unicode hex":"2B78"},{"Typeface name":"Wingdings 3","Dingbat dec":"47","Dingbat hex":"2F","Unicode dec":"11131","Unicode hex":"2B7B"},{"Typeface name":"Wingdings 3","Dingbat dec":"48","Dingbat hex":"30","Unicode dec":"11133","Unicode hex":"2B7D"},{"Typeface name":"Wingdings 3","Dingbat dec":"49","Dingbat hex":"31","Unicode dec":"11108","Unicode hex":"2B64"},{"Typeface name":"Wingdings 3","Dingbat dec":"50","Dingbat hex":"32","Unicode dec":"11109","Unicode hex":"2B65"},{"Typeface name":"Wingdings 3","Dingbat dec":"51","Dingbat hex":"33","Unicode dec":"11114","Unicode hex":"2B6A"},{"Typeface name":"Wingdings 3","Dingbat dec":"52","Dingbat hex":"34","Unicode dec":"11116","Unicode hex":"2B6C"},{"Typeface name":"Wingdings 3","Dingbat dec":"53","Dingbat hex":"35","Unicode dec":"11115","Unicode hex":"2B6B"},{"Typeface name":"Wingdings 3","Dingbat dec":"54","Dingbat hex":"36","Unicode dec":"11117","Unicode hex":"2B6D"},{"Typeface name":"Wingdings 3","Dingbat dec":"55","Dingbat hex":"37","Unicode dec":"11085","Unicode hex":"2B4D"},{"Typeface name":"Wingdings 3","Dingbat dec":"56","Dingbat hex":"38","Unicode dec":"11168","Unicode hex":"2BA0"},{"Typeface name":"Wingdings 3","Dingbat dec":"57","Dingbat hex":"39","Unicode dec":"11169","Unicode hex":"2BA1"},{"Typeface name":"Wingdings 3","Dingbat dec":"58","Dingbat hex":"3A","Unicode dec":"11170","Unicode hex":"2BA2"},{"Typeface name":"Wingdings 3","Dingbat dec":"59","Dingbat hex":"3B","Unicode dec":"11171","Unicode hex":"2BA3"},{"Typeface name":"Wingdings 3","Dingbat dec":"60","Dingbat hex":"3C","Unicode dec":"11172","Unicode hex":"2BA4"},{"Typeface name":"Wingdings 3","Dingbat dec":"61","Dingbat hex":"3D","Unicode dec":"11173","Unicode hex":"2BA5"},{"Typeface name":"Wingdings 3","Dingbat dec":"62","Dingbat hex":"3E","Unicode dec":"11174","Unicode hex":"2BA6"},{"Typeface name":"Wingdings 3","Dingbat dec":"63","Dingbat hex":"3F","Unicode dec":"11175","Unicode hex":"2BA7"},{"Typeface name":"Wingdings 3","Dingbat dec":"64","Dingbat hex":"40","Unicode dec":"11152","Unicode hex":"2B90"},{"Typeface name":"Wingdings 3","Dingbat dec":"65","Dingbat hex":"41","Unicode dec":"11153","Unicode hex":"2B91"},{"Typeface name":"Wingdings 3","Dingbat dec":"66","Dingbat hex":"42","Unicode dec":"11154","Unicode hex":"2B92"},{"Typeface name":"Wingdings 3","Dingbat dec":"67","Dingbat hex":"43","Unicode dec":"11155","Unicode hex":"2B93"},{"Typeface name":"Wingdings 3","Dingbat dec":"68","Dingbat hex":"44","Unicode dec":"11136","Unicode hex":"2B80"},{"Typeface name":"Wingdings 3","Dingbat dec":"69","Dingbat hex":"45","Unicode dec":"11139","Unicode hex":"2B83"},{"Typeface name":"Wingdings 3","Dingbat dec":"70","Dingbat hex":"46","Unicode dec":"11134","Unicode hex":"2B7E"},{"Typeface name":"Wingdings 3","Dingbat dec":"71","Dingbat hex":"47","Unicode dec":"11135","Unicode hex":"2B7F"},{"Typeface name":"Wingdings 3","Dingbat dec":"72","Dingbat hex":"48","Unicode dec":"11140","Unicode hex":"2B84"},{"Typeface name":"Wingdings 3","Dingbat dec":"73","Dingbat hex":"49","Unicode dec":"11142","Unicode hex":"2B86"},{"Typeface name":"Wingdings 3","Dingbat dec":"74","Dingbat hex":"4A","Unicode dec":"11141","Unicode hex":"2B85"},{"Typeface name":"Wingdings 3","Dingbat dec":"75","Dingbat hex":"4B","Unicode dec":"11143","Unicode hex":"2B87"},{"Typeface name":"Wingdings 3","Dingbat dec":"76","Dingbat hex":"4C","Unicode dec":"11151","Unicode hex":"2B8F"},{"Typeface name":"Wingdings 3","Dingbat dec":"77","Dingbat hex":"4D","Unicode dec":"11149","Unicode hex":"2B8D"},{"Typeface name":"Wingdings 3","Dingbat dec":"78","Dingbat hex":"4E","Unicode dec":"11150","Unicode hex":"2B8E"},{"Typeface name":"Wingdings 3","Dingbat dec":"79","Dingbat hex":"4F","Unicode dec":"11148","Unicode hex":"2B8C"},{"Typeface name":"Wingdings 3","Dingbat dec":"80","Dingbat hex":"50","Unicode dec":"11118","Unicode hex":"2B6E"},{"Typeface name":"Wingdings 3","Dingbat dec":"81","Dingbat hex":"51","Unicode dec":"11119","Unicode hex":"2B6F"},{"Typeface name":"Wingdings 3","Dingbat dec":"82","Dingbat hex":"52","Unicode dec":"9099","Unicode hex":"238B"},{"Typeface name":"Wingdings 3","Dingbat dec":"83","Dingbat hex":"53","Unicode dec":"8996","Unicode hex":"2324"},{"Typeface name":"Wingdings 3","Dingbat dec":"84","Dingbat hex":"54","Unicode dec":"8963","Unicode hex":"2303"},{"Typeface name":"Wingdings 3","Dingbat dec":"85","Dingbat hex":"55","Unicode dec":"8997","Unicode hex":"2325"},{"Typeface name":"Wingdings 3","Dingbat dec":"86","Dingbat hex":"56","Unicode dec":"9251","Unicode hex":"2423"},{"Typeface name":"Wingdings 3","Dingbat dec":"87","Dingbat hex":"57","Unicode dec":"9085","Unicode hex":"237D"},{"Typeface name":"Wingdings 3","Dingbat dec":"88","Dingbat hex":"58","Unicode dec":"8682","Unicode hex":"21EA"},{"Typeface name":"Wingdings 3","Dingbat dec":"89","Dingbat hex":"59","Unicode dec":"11192","Unicode hex":"2BB8"},{"Typeface name":"Wingdings 3","Dingbat dec":"90","Dingbat hex":"5A","Unicode dec":"129184","Unicode hex":"1F8A0"},{"Typeface name":"Wingdings 3","Dingbat dec":"91","Dingbat hex":"5B","Unicode dec":"129185","Unicode hex":"1F8A1"},{"Typeface name":"Wingdings 3","Dingbat dec":"92","Dingbat hex":"5C","Unicode dec":"129186","Unicode hex":"1F8A2"},{"Typeface name":"Wingdings 3","Dingbat dec":"93","Dingbat hex":"5D","Unicode dec":"129187","Unicode hex":"1F8A3"},{"Typeface name":"Wingdings 3","Dingbat dec":"94","Dingbat hex":"5E","Unicode dec":"129188","Unicode hex":"1F8A4"},{"Typeface name":"Wingdings 3","Dingbat dec":"95","Dingbat hex":"5F","Unicode dec":"129189","Unicode hex":"1F8A5"},{"Typeface name":"Wingdings 3","Dingbat dec":"96","Dingbat hex":"60","Unicode dec":"129190","Unicode hex":"1F8A6"},{"Typeface name":"Wingdings 3","Dingbat dec":"97","Dingbat hex":"61","Unicode dec":"129191","Unicode hex":"1F8A7"},{"Typeface name":"Wingdings 3","Dingbat dec":"98","Dingbat hex":"62","Unicode dec":"129192","Unicode hex":"1F8A8"},{"Typeface name":"Wingdings 3","Dingbat dec":"99","Dingbat hex":"63","Unicode dec":"129193","Unicode hex":"1F8A9"},{"Typeface name":"Wingdings 3","Dingbat dec":"100","Dingbat hex":"64","Unicode dec":"129194","Unicode hex":"1F8AA"},{"Typeface name":"Wingdings 3","Dingbat dec":"101","Dingbat hex":"65","Unicode dec":"129195","Unicode hex":"1F8AB"},{"Typeface name":"Wingdings 3","Dingbat dec":"102","Dingbat hex":"66","Unicode dec":"129104","Unicode hex":"1F850"},{"Typeface name":"Wingdings 3","Dingbat dec":"103","Dingbat hex":"67","Unicode dec":"129106","Unicode hex":"1F852"},{"Typeface name":"Wingdings 3","Dingbat dec":"104","Dingbat hex":"68","Unicode dec":"129105","Unicode hex":"1F851"},{"Typeface name":"Wingdings 3","Dingbat dec":"105","Dingbat hex":"69","Unicode dec":"129107","Unicode hex":"1F853"},{"Typeface name":"Wingdings 3","Dingbat dec":"106","Dingbat hex":"6A","Unicode dec":"129108","Unicode hex":"1F854"},{"Typeface name":"Wingdings 3","Dingbat dec":"107","Dingbat hex":"6B","Unicode dec":"129109","Unicode hex":"1F855"},{"Typeface name":"Wingdings 3","Dingbat dec":"108","Dingbat hex":"6C","Unicode dec":"129111","Unicode hex":"1F857"},{"Typeface name":"Wingdings 3","Dingbat dec":"109","Dingbat hex":"6D","Unicode dec":"129110","Unicode hex":"1F856"},{"Typeface name":"Wingdings 3","Dingbat dec":"110","Dingbat hex":"6E","Unicode dec":"129112","Unicode hex":"1F858"},{"Typeface name":"Wingdings 3","Dingbat dec":"111","Dingbat hex":"6F","Unicode dec":"129113","Unicode hex":"1F859"},{"Typeface name":"Wingdings 3","Dingbat dec":"112","Dingbat hex":"70","Unicode dec":"9650","Unicode hex":"25B2"},{"Typeface name":"Wingdings 3","Dingbat dec":"113","Dingbat hex":"71","Unicode dec":"9660","Unicode hex":"25BC"},{"Typeface name":"Wingdings 3","Dingbat dec":"114","Dingbat hex":"72","Unicode dec":"9651","Unicode hex":"25B3"},{"Typeface name":"Wingdings 3","Dingbat dec":"115","Dingbat hex":"73","Unicode dec":"9661","Unicode hex":"25BD"},{"Typeface name":"Wingdings 3","Dingbat dec":"116","Dingbat hex":"74","Unicode dec":"9664","Unicode hex":"25C0"},{"Typeface name":"Wingdings 3","Dingbat dec":"117","Dingbat hex":"75","Unicode dec":"9654","Unicode hex":"25B6"},{"Typeface name":"Wingdings 3","Dingbat dec":"118","Dingbat hex":"76","Unicode dec":"9665","Unicode hex":"25C1"},{"Typeface name":"Wingdings 3","Dingbat dec":"119","Dingbat hex":"77","Unicode dec":"9655","Unicode hex":"25B7"},{"Typeface name":"Wingdings 3","Dingbat dec":"120","Dingbat hex":"78","Unicode dec":"9699","Unicode hex":"25E3"},{"Typeface name":"Wingdings 3","Dingbat dec":"121","Dingbat hex":"79","Unicode dec":"9698","Unicode hex":"25E2"},{"Typeface name":"Wingdings 3","Dingbat dec":"122","Dingbat hex":"7A","Unicode dec":"9700","Unicode hex":"25E4"},{"Typeface name":"Wingdings 3","Dingbat dec":"123","Dingbat hex":"7B","Unicode dec":"9701","Unicode hex":"25E5"},{"Typeface name":"Wingdings 3","Dingbat dec":"124","Dingbat hex":"7C","Unicode dec":"128896","Unicode hex":"1F780"},{"Typeface name":"Wingdings 3","Dingbat dec":"125","Dingbat hex":"7D","Unicode dec":"128898","Unicode hex":"1F782"},{"Typeface name":"Wingdings 3","Dingbat dec":"126","Dingbat hex":"7E","Unicode dec":"128897","Unicode hex":"1F781"},{"Typeface name":"Wingdings 3","Dingbat dec":"128","Dingbat hex":"80","Unicode dec":"128899","Unicode hex":"1F783"},{"Typeface name":"Wingdings 3","Dingbat dec":"129","Dingbat hex":"81","Unicode dec":"11205","Unicode hex":"2BC5"},{"Typeface name":"Wingdings 3","Dingbat dec":"130","Dingbat hex":"82","Unicode dec":"11206","Unicode hex":"2BC6"},{"Typeface name":"Wingdings 3","Dingbat dec":"131","Dingbat hex":"83","Unicode dec":"11207","Unicode hex":"2BC7"},{"Typeface name":"Wingdings 3","Dingbat dec":"132","Dingbat hex":"84","Unicode dec":"11208","Unicode hex":"2BC8"},{"Typeface name":"Wingdings 3","Dingbat dec":"133","Dingbat hex":"85","Unicode dec":"11164","Unicode hex":"2B9C"},{"Typeface name":"Wingdings 3","Dingbat dec":"134","Dingbat hex":"86","Unicode dec":"11166","Unicode hex":"2B9E"},{"Typeface name":"Wingdings 3","Dingbat dec":"135","Dingbat hex":"87","Unicode dec":"11165","Unicode hex":"2B9D"},{"Typeface name":"Wingdings 3","Dingbat dec":"136","Dingbat hex":"88","Unicode dec":"11167","Unicode hex":"2B9F"},{"Typeface name":"Wingdings 3","Dingbat dec":"137","Dingbat hex":"89","Unicode dec":"129040","Unicode hex":"1F810"},{"Typeface name":"Wingdings 3","Dingbat dec":"138","Dingbat hex":"8A","Unicode dec":"129042","Unicode hex":"1F812"},{"Typeface name":"Wingdings 3","Dingbat dec":"139","Dingbat hex":"8B","Unicode dec":"129041","Unicode hex":"1F811"},{"Typeface name":"Wingdings 3","Dingbat dec":"140","Dingbat hex":"8C","Unicode dec":"129043","Unicode hex":"1F813"},{"Typeface name":"Wingdings 3","Dingbat dec":"141","Dingbat hex":"8D","Unicode dec":"129044","Unicode hex":"1F814"},{"Typeface name":"Wingdings 3","Dingbat dec":"142","Dingbat hex":"8E","Unicode dec":"129046","Unicode hex":"1F816"},{"Typeface name":"Wingdings 3","Dingbat dec":"143","Dingbat hex":"8F","Unicode dec":"129045","Unicode hex":"1F815"},{"Typeface name":"Wingdings 3","Dingbat dec":"144","Dingbat hex":"90","Unicode dec":"129047","Unicode hex":"1F817"},{"Typeface name":"Wingdings 3","Dingbat dec":"145","Dingbat hex":"91","Unicode dec":"129048","Unicode hex":"1F818"},{"Typeface name":"Wingdings 3","Dingbat dec":"146","Dingbat hex":"92","Unicode dec":"129050","Unicode hex":"1F81A"},{"Typeface name":"Wingdings 3","Dingbat dec":"147","Dingbat hex":"93","Unicode dec":"129049","Unicode hex":"1F819"},{"Typeface name":"Wingdings 3","Dingbat dec":"148","Dingbat hex":"94","Unicode dec":"129051","Unicode hex":"1F81B"},{"Typeface name":"Wingdings 3","Dingbat dec":"149","Dingbat hex":"95","Unicode dec":"129052","Unicode hex":"1F81C"},{"Typeface name":"Wingdings 3","Dingbat dec":"150","Dingbat hex":"96","Unicode dec":"129054","Unicode hex":"1F81E"},{"Typeface name":"Wingdings 3","Dingbat dec":"151","Dingbat hex":"97","Unicode dec":"129053","Unicode hex":"1F81D"},{"Typeface name":"Wingdings 3","Dingbat dec":"152","Dingbat hex":"98","Unicode dec":"129055","Unicode hex":"1F81F"},{"Typeface name":"Wingdings 3","Dingbat dec":"153","Dingbat hex":"99","Unicode dec":"129024","Unicode hex":"1F800"},{"Typeface name":"Wingdings 3","Dingbat dec":"154","Dingbat hex":"9A","Unicode dec":"129026","Unicode hex":"1F802"},{"Typeface name":"Wingdings 3","Dingbat dec":"155","Dingbat hex":"9B","Unicode dec":"129025","Unicode hex":"1F801"},{"Typeface name":"Wingdings 3","Dingbat dec":"156","Dingbat hex":"9C","Unicode dec":"129027","Unicode hex":"1F803"},{"Typeface name":"Wingdings 3","Dingbat dec":"157","Dingbat hex":"9D","Unicode dec":"129028","Unicode hex":"1F804"},{"Typeface name":"Wingdings 3","Dingbat dec":"158","Dingbat hex":"9E","Unicode dec":"129030","Unicode hex":"1F806"},{"Typeface name":"Wingdings 3","Dingbat dec":"159","Dingbat hex":"9F","Unicode dec":"129029","Unicode hex":"1F805"},{"Typeface name":"Wingdings 3","Dingbat dec":"160","Dingbat hex":"A0","Unicode dec":"129031","Unicode hex":"1F807"},{"Typeface name":"Wingdings 3","Dingbat dec":"161","Dingbat hex":"A1","Unicode dec":"129032","Unicode hex":"1F808"},{"Typeface name":"Wingdings 3","Dingbat dec":"162","Dingbat hex":"A2","Unicode dec":"129034","Unicode hex":"1F80A"},{"Typeface name":"Wingdings 3","Dingbat dec":"163","Dingbat hex":"A3","Unicode dec":"129033","Unicode hex":"1F809"},{"Typeface name":"Wingdings 3","Dingbat dec":"164","Dingbat hex":"A4","Unicode dec":"129035","Unicode hex":"1F80B"},{"Typeface name":"Wingdings 3","Dingbat dec":"165","Dingbat hex":"A5","Unicode dec":"129056","Unicode hex":"1F820"},{"Typeface name":"Wingdings 3","Dingbat dec":"166","Dingbat hex":"A6","Unicode dec":"129058","Unicode hex":"1F822"},{"Typeface name":"Wingdings 3","Dingbat dec":"167","Dingbat hex":"A7","Unicode dec":"129060","Unicode hex":"1F824"},{"Typeface name":"Wingdings 3","Dingbat dec":"168","Dingbat hex":"A8","Unicode dec":"129062","Unicode hex":"1F826"},{"Typeface name":"Wingdings 3","Dingbat dec":"169","Dingbat hex":"A9","Unicode dec":"129064","Unicode hex":"1F828"},{"Typeface name":"Wingdings 3","Dingbat dec":"170","Dingbat hex":"AA","Unicode dec":"129066","Unicode hex":"1F82A"},{"Typeface name":"Wingdings 3","Dingbat dec":"171","Dingbat hex":"AB","Unicode dec":"129068","Unicode hex":"1F82C"},{"Typeface name":"Wingdings 3","Dingbat dec":"172","Dingbat hex":"AC","Unicode dec":"129180","Unicode hex":"1F89C"},{"Typeface name":"Wingdings 3","Dingbat dec":"173","Dingbat hex":"AD","Unicode dec":"129181","Unicode hex":"1F89D"},{"Typeface name":"Wingdings 3","Dingbat dec":"174","Dingbat hex":"AE","Unicode dec":"129182","Unicode hex":"1F89E"},{"Typeface name":"Wingdings 3","Dingbat dec":"175","Dingbat hex":"AF","Unicode dec":"129183","Unicode hex":"1F89F"},{"Typeface name":"Wingdings 3","Dingbat dec":"176","Dingbat hex":"B0","Unicode dec":"129070","Unicode hex":"1F82E"},{"Typeface name":"Wingdings 3","Dingbat dec":"177","Dingbat hex":"B1","Unicode dec":"129072","Unicode hex":"1F830"},{"Typeface name":"Wingdings 3","Dingbat dec":"178","Dingbat hex":"B2","Unicode dec":"129074","Unicode hex":"1F832"},{"Typeface name":"Wingdings 3","Dingbat dec":"179","Dingbat hex":"B3","Unicode dec":"129076","Unicode hex":"1F834"},{"Typeface name":"Wingdings 3","Dingbat dec":"180","Dingbat hex":"B4","Unicode dec":"129078","Unicode hex":"1F836"},{"Typeface name":"Wingdings 3","Dingbat dec":"181","Dingbat hex":"B5","Unicode dec":"129080","Unicode hex":"1F838"},{"Typeface name":"Wingdings 3","Dingbat dec":"182","Dingbat hex":"B6","Unicode dec":"129082","Unicode hex":"1F83A"},{"Typeface name":"Wingdings 3","Dingbat dec":"183","Dingbat hex":"B7","Unicode dec":"129081","Unicode hex":"1F839"},{"Typeface name":"Wingdings 3","Dingbat dec":"184","Dingbat hex":"B8","Unicode dec":"129083","Unicode hex":"1F83B"},{"Typeface name":"Wingdings 3","Dingbat dec":"185","Dingbat hex":"B9","Unicode dec":"129176","Unicode hex":"1F898"},{"Typeface name":"Wingdings 3","Dingbat dec":"186","Dingbat hex":"BA","Unicode dec":"129178","Unicode hex":"1F89A"},{"Typeface name":"Wingdings 3","Dingbat dec":"187","Dingbat hex":"BB","Unicode dec":"129177","Unicode hex":"1F899"},{"Typeface name":"Wingdings 3","Dingbat dec":"188","Dingbat hex":"BC","Unicode dec":"129179","Unicode hex":"1F89B"},{"Typeface name":"Wingdings 3","Dingbat dec":"189","Dingbat hex":"BD","Unicode dec":"129084","Unicode hex":"1F83C"},{"Typeface name":"Wingdings 3","Dingbat dec":"190","Dingbat hex":"BE","Unicode dec":"129086","Unicode hex":"1F83E"},{"Typeface name":"Wingdings 3","Dingbat dec":"191","Dingbat hex":"BF","Unicode dec":"129085","Unicode hex":"1F83D"},{"Typeface name":"Wingdings 3","Dingbat dec":"192","Dingbat hex":"C0","Unicode dec":"129087","Unicode hex":"1F83F"},{"Typeface name":"Wingdings 3","Dingbat dec":"193","Dingbat hex":"C1","Unicode dec":"129088","Unicode hex":"1F840"},{"Typeface name":"Wingdings 3","Dingbat dec":"194","Dingbat hex":"C2","Unicode dec":"129090","Unicode hex":"1F842"},{"Typeface name":"Wingdings 3","Dingbat dec":"195","Dingbat hex":"C3","Unicode dec":"129089","Unicode hex":"1F841"},{"Typeface name":"Wingdings 3","Dingbat dec":"196","Dingbat hex":"C4","Unicode dec":"129091","Unicode hex":"1F843"},{"Typeface name":"Wingdings 3","Dingbat dec":"197","Dingbat hex":"C5","Unicode dec":"129092","Unicode hex":"1F844"},{"Typeface name":"Wingdings 3","Dingbat dec":"198","Dingbat hex":"C6","Unicode dec":"129094","Unicode hex":"1F846"},{"Typeface name":"Wingdings 3","Dingbat dec":"199","Dingbat hex":"C7","Unicode dec":"129093","Unicode hex":"1F845"},{"Typeface name":"Wingdings 3","Dingbat dec":"200","Dingbat hex":"C8","Unicode dec":"129095","Unicode hex":"1F847"},{"Typeface name":"Wingdings 3","Dingbat dec":"201","Dingbat hex":"C9","Unicode dec":"11176","Unicode hex":"2BA8"},{"Typeface name":"Wingdings 3","Dingbat dec":"202","Dingbat hex":"CA","Unicode dec":"11177","Unicode hex":"2BA9"},{"Typeface name":"Wingdings 3","Dingbat dec":"203","Dingbat hex":"CB","Unicode dec":"11178","Unicode hex":"2BAA"},{"Typeface name":"Wingdings 3","Dingbat dec":"204","Dingbat hex":"CC","Unicode dec":"11179","Unicode hex":"2BAB"},{"Typeface name":"Wingdings 3","Dingbat dec":"205","Dingbat hex":"CD","Unicode dec":"11180","Unicode hex":"2BAC"},{"Typeface name":"Wingdings 3","Dingbat dec":"206","Dingbat hex":"CE","Unicode dec":"11181","Unicode hex":"2BAD"},{"Typeface name":"Wingdings 3","Dingbat dec":"207","Dingbat hex":"CF","Unicode dec":"11182","Unicode hex":"2BAE"},{"Typeface name":"Wingdings 3","Dingbat dec":"208","Dingbat hex":"D0","Unicode dec":"11183","Unicode hex":"2BAF"},{"Typeface name":"Wingdings 3","Dingbat dec":"209","Dingbat hex":"D1","Unicode dec":"129120","Unicode hex":"1F860"},{"Typeface name":"Wingdings 3","Dingbat dec":"210","Dingbat hex":"D2","Unicode dec":"129122","Unicode hex":"1F862"},{"Typeface name":"Wingdings 3","Dingbat dec":"211","Dingbat hex":"D3","Unicode dec":"129121","Unicode hex":"1F861"},{"Typeface name":"Wingdings 3","Dingbat dec":"212","Dingbat hex":"D4","Unicode dec":"129123","Unicode hex":"1F863"},{"Typeface name":"Wingdings 3","Dingbat dec":"213","Dingbat hex":"D5","Unicode dec":"129124","Unicode hex":"1F864"},{"Typeface name":"Wingdings 3","Dingbat dec":"214","Dingbat hex":"D6","Unicode dec":"129125","Unicode hex":"1F865"},{"Typeface name":"Wingdings 3","Dingbat dec":"215","Dingbat hex":"D7","Unicode dec":"129127","Unicode hex":"1F867"},{"Typeface name":"Wingdings 3","Dingbat dec":"216","Dingbat hex":"D8","Unicode dec":"129126","Unicode hex":"1F866"},{"Typeface name":"Wingdings 3","Dingbat dec":"217","Dingbat hex":"D9","Unicode dec":"129136","Unicode hex":"1F870"},{"Typeface name":"Wingdings 3","Dingbat dec":"218","Dingbat hex":"DA","Unicode dec":"129138","Unicode hex":"1F872"},{"Typeface name":"Wingdings 3","Dingbat dec":"219","Dingbat hex":"DB","Unicode dec":"129137","Unicode hex":"1F871"},{"Typeface name":"Wingdings 3","Dingbat dec":"220","Dingbat hex":"DC","Unicode dec":"129139","Unicode hex":"1F873"},{"Typeface name":"Wingdings 3","Dingbat dec":"221","Dingbat hex":"DD","Unicode dec":"129140","Unicode hex":"1F874"},{"Typeface name":"Wingdings 3","Dingbat dec":"222","Dingbat hex":"DE","Unicode dec":"129141","Unicode hex":"1F875"},{"Typeface name":"Wingdings 3","Dingbat dec":"223","Dingbat hex":"DF","Unicode dec":"129143","Unicode hex":"1F877"},{"Typeface name":"Wingdings 3","Dingbat dec":"224","Dingbat hex":"E0","Unicode dec":"129142","Unicode hex":"1F876"},{"Typeface name":"Wingdings 3","Dingbat dec":"225","Dingbat hex":"E1","Unicode dec":"129152","Unicode hex":"1F880"},{"Typeface name":"Wingdings 3","Dingbat dec":"226","Dingbat hex":"E2","Unicode dec":"129154","Unicode hex":"1F882"},{"Typeface name":"Wingdings 3","Dingbat dec":"227","Dingbat hex":"E3","Unicode dec":"129153","Unicode hex":"1F881"},{"Typeface name":"Wingdings 3","Dingbat dec":"228","Dingbat hex":"E4","Unicode dec":"129155","Unicode hex":"1F883"},{"Typeface name":"Wingdings 3","Dingbat dec":"229","Dingbat hex":"E5","Unicode dec":"129156","Unicode hex":"1F884"},{"Typeface name":"Wingdings 3","Dingbat dec":"230","Dingbat hex":"E6","Unicode dec":"129157","Unicode hex":"1F885"},{"Typeface name":"Wingdings 3","Dingbat dec":"231","Dingbat hex":"E7","Unicode dec":"129159","Unicode hex":"1F887"},{"Typeface name":"Wingdings 3","Dingbat dec":"232","Dingbat hex":"E8","Unicode dec":"129158","Unicode hex":"1F886"},{"Typeface name":"Wingdings 3","Dingbat dec":"233","Dingbat hex":"E9","Unicode dec":"129168","Unicode hex":"1F890"},{"Typeface name":"Wingdings 3","Dingbat dec":"234","Dingbat hex":"EA","Unicode dec":"129170","Unicode hex":"1F892"},{"Typeface name":"Wingdings 3","Dingbat dec":"235","Dingbat hex":"EB","Unicode dec":"129169","Unicode hex":"1F891"},{"Typeface name":"Wingdings 3","Dingbat dec":"236","Dingbat hex":"EC","Unicode dec":"129171","Unicode hex":"1F893"},{"Typeface name":"Wingdings 3","Dingbat dec":"237","Dingbat hex":"ED","Unicode dec":"129172","Unicode hex":"1F894"},{"Typeface name":"Wingdings 3","Dingbat dec":"238","Dingbat hex":"EE","Unicode dec":"129174","Unicode hex":"1F896"},{"Typeface name":"Wingdings 3","Dingbat dec":"239","Dingbat hex":"EF","Unicode dec":"129173","Unicode hex":"1F895"},{"Typeface name":"Wingdings 3","Dingbat dec":"240","Dingbat hex":"F0","Unicode dec":"129175","Unicode hex":"1F897"}];return ly.default=n,ly}var jP;function G6(){if(jP)return $s;jP=1;var n=$s&&$s.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty($s,"__esModule",{value:!0}),$s.hex=$s.dec=$s.codePoint=void 0;for(var e=n(V6()),t={},r=String.fromCodePoint?String.fromCodePoint:h,i=0,s=e.default;i<s.length;i++){var a=s[i],o=parseInt(a["Unicode dec"],10),l={codePoint:o,string:r(o)};t[a["Typeface name"].toUpperCase()+"_"+a["Dingbat dec"]]=l}function c(f,p){return t[f.toUpperCase()+"_"+p]}$s.codePoint=c;function u(f,p){return c(f,parseInt(p,10))}$s.dec=u;function d(f,p){return c(f,parseInt(p,16))}$s.hex=d;function h(f){if(f<=65535)return String.fromCharCode(f);var p=Math.floor((f-65536)/1024)+55296,g=(f-65536)%1024+56320;return String.fromCharCode(p,g)}return $s}var cy={},VP;function q6(){if(VP)return cy;VP=1,cy.uriToZipEntryName=n,cy.replaceFragment=e;function n(t,r){return r.charAt(0)==="/"?r.substr(1):t+"/"+r}function e(t,r){var i=t.indexOf("#");return i!==-1&&(t=t.substring(0,i)),t+"#"+r}return cy}var GP;function H6(){if(GP)return oy;GP=1,oy.createBodyReader=o,oy._readNumberingProperties=c;var n=G6(),e=cr,t=td(),r=Fo().Result,i=Fo().warning,s=WE(),a=q6();function o(x){return{readXmlElement:function(w){return new l(x).readXmlElement(w)},readXmlElements:function(w){return new l(x).readXmlElements(w)}}}function l(x){var w=[],T=[],E=[],A=x.relationships,M=x.contentTypes,F=x.docxFile,G=x.files,S=x.numbering,I=x.styles;function C(Te){var Be=Te.map(H);return _(Be)}function H(Te){if(Te.type==="element"){var Be=pe[Te.name];if(Be)return Be(Te);if(!Object.prototype.hasOwnProperty.call(d,Te.name)){var qe=i("An unrecognised element was ignored: "+Te.name);return h([qe])}}return f()}function B(Te){return L(Te).map(function(Be){return{type:"paragraphProperties",styleId:Be.styleId,styleName:Be.name,alignment:Te.firstOrEmpty("w:jc").attributes["w:val"],numbering:c(Be.styleId,Te.firstOrEmpty("w:numPr"),S),indent:$(Te.firstOrEmpty("w:ind"))}})}function $(Te){return{start:Te.attributes["w:start"]||Te.attributes["w:left"],end:Te.attributes["w:end"]||Te.attributes["w:right"],firstLine:Te.attributes["w:firstLine"],hanging:Te.attributes["w:hanging"]}}function X(Te){return ne(Te).map(function(Be){var qe=Te.firstOrEmpty("w:sz").attributes["w:val"],tt=/^[0-9]+$/.test(qe)?parseInt(qe,10)/2:null;return{type:"runProperties",styleId:Be.styleId,styleName:Be.name,verticalAlignment:Te.firstOrEmpty("w:vertAlign").attributes["w:val"],font:Te.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:tt,isBold:Q(Te.first("w:b")),isUnderline:V(Te.first("w:u")),isItalic:Q(Te.first("w:i")),isStrikethrough:Q(Te.first("w:strike")),isAllCaps:Q(Te.first("w:caps")),isSmallCaps:Q(Te.first("w:smallCaps")),highlight:O(Te.firstOrEmpty("w:highlight").attributes["w:val"])}})}function V(Te){if(Te){var Be=Te.attributes["w:val"];return Be!==void 0&&Be!=="false"&&Be!=="0"&&Be!=="none"}else return!1}function Q(Te){if(Te){var Be=Te.attributes["w:val"];return Be!=="false"&&Be!=="0"}else return!1}function R(Te){return Te!=="false"&&Te!=="0"}function O(Te){return!Te||Te==="none"?null:Te}function L(Te){return we(Te,"w:pStyle","Paragraph",I.findParagraphStyleById)}function ne(Te){return we(Te,"w:rStyle","Run",I.findCharacterStyleById)}function de(Te){return we(Te,"w:tblStyle","Table",I.findTableStyleById)}function we(Te,Be,qe,tt){var xt=[],ft=Te.first(Be),Wt=null,Jn=null;if(ft&&(Wt=ft.attributes["w:val"],Wt)){var rr=tt(Wt);rr?Jn=rr.name:xt.push(ze(qe,Wt))}return g({styleId:Wt,name:Jn},xt)}function be(Te){var Be=Te.attributes["w:fldCharType"];if(Be==="begin")w.push({type:"begin",fldChar:Te}),T=[];else if(Be==="end"){var qe=w.pop();if(qe.type==="begin"&&(qe=Fe(qe)),qe.type==="checkbox")return p(t.checkbox({checked:qe.checked}))}else if(Be==="separate"){var tt=w.pop(),xt=Fe(tt);w.push(xt)}return f()}function Ee(){var Te=e.last(w.filter(function(Be){return Be.type==="hyperlink"}));return Te?Te.options:null}function Fe(Te){return xe(T.join(""),Te.type==="begin"?Te.fldChar:s.emptyElement)}function xe(Te,Be){var qe=/\s*HYPERLINK "(.*)"/.exec(Te);if(qe)return{type:"hyperlink",options:{href:qe[1]}};var tt=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(Te);if(tt)return{type:"hyperlink",options:{anchor:tt[1]}};var xt=/\s*FORMCHECKBOX\s*/.exec(Te);if(xt){var ft=Be.firstOrEmpty("w:ffData").firstOrEmpty("w:checkBox"),Wt=ft.first("w:checked"),Jn=Wt==null?Q(ft.first("w:default")):Q(Wt);return{type:"checkbox",checked:Jn}}return{type:"unknown"}}function ce(Te){return T.push(Te.text()),f()}function ue(Te){var Be=Te.attributes["w:font"],qe=Te.attributes["w:char"],tt=n.hex(Be,qe);return tt==null&&/^F0..$/.test(qe)&&(tt=n.hex(Be,qe.substring(2))),tt==null?h([i("A w:sym element with an unsupported character was ignored: char "+qe+" in font "+Be)]):p(new t.Text(tt.string))}function Se(Te){return function(Be){var qe=Be.attributes["w:id"];return p(new t.NoteReference({noteType:Te,noteId:qe}))}}function U(Te){return p(t.commentReference({commentId:Te.attributes["w:id"]}))}function he(Te){return C(Te.children)}var pe={"w:p":function(Te){var Be=Te.firstOrEmpty("w:pPr"),qe=!!Be.firstOrEmpty("w:rPr").first("w:del");if(qe)return Te.children.forEach(function(xt){E.push(xt)}),f();var tt=Te.children;return E.length>0&&(tt=E.concat(tt),E=[]),b.map(B(Be),C(tt),function(xt,ft){return new t.Paragraph(ft,xt)}).insertExtra()},"w:r":function(Te){return b.map(X(Te.firstOrEmpty("w:rPr")),C(Te.children),function(Be,qe){var tt=Ee();return tt!==null&&(qe=[new t.Hyperlink(qe,tt)]),new t.Run(qe,Be)})},"w:fldChar":be,"w:instrText":ce,"w:t":function(Te){return p(new t.Text(Te.text()))},"w:tab":function(Te){return p(new t.Tab)},"w:noBreakHyphen":function(){return p(new t.Text(""))},"w:softHyphen":function(Te){return p(new t.Text(""))},"w:sym":ue,"w:hyperlink":function(Te){var Be=Te.attributes["r:id"],qe=Te.attributes["w:anchor"];return C(Te.children).map(function(tt){function xt(Wt){var Jn=Te.attributes["w:tgtFrame"]||null;return new t.Hyperlink(tt,e.extend({targetFrame:Jn},Wt))}if(Be){var ft=A.findTargetByRelationshipId(Be);return qe&&(ft=a.replaceFragment(ft,qe)),xt({href:ft})}else return qe?xt({anchor:qe}):tt})},"w:tbl":ie,"w:tr":ge,"w:tc":Ce,"w:footnoteReference":Se("footnote"),"w:endnoteReference":Se("endnote"),"w:commentReference":U,"w:br":function(Te){var Be=Te.attributes["w:type"];return Be==null||Be==="textWrapping"?p(t.lineBreak):Be==="page"?p(t.pageBreak):Be==="column"?p(t.columnBreak):h([i("Unsupported break type: "+Be)])},"w:bookmarkStart":function(Te){var Be=Te.attributes["w:name"];return Be==="_GoBack"?f():p(new t.BookmarkStart({name:Be}))},"mc:AlternateContent":function(Te){return he(Te.first("mc:Fallback"))},"w:sdt":function(Te){var Be=Te.firstOrEmpty("w:sdtPr").first("wordml:checkbox");if(Be){var qe=Be.first("wordml:checked"),tt=!!qe&&R(qe.attributes["wordml:val"]);return p(t.checkbox({checked:tt}))}else return C(Te.firstOrEmpty("w:sdtContent").children)},"w:ins":he,"w:object":he,"w:smartTag":he,"w:drawing":he,"w:pict":function(Te){return he(Te).toExtra()},"v:roundrect":he,"v:shape":he,"v:textbox":he,"w:txbxContent":he,"wp:inline":j,"wp:anchor":j,"v:imagedata":ke,"v:group":he,"v:rect":he};return{readXmlElement:H,readXmlElements:C};function ie(Te){var Be=re(Te.firstOrEmpty("w:tblPr"));return C(Te.children).flatMap(te).flatMap(function(qe){return Be.map(function(tt){return t.Table(qe,tt)})})}function re(Te){return de(Te).map(function(Be){return{styleId:Be.styleId,styleName:Be.name}})}function ge(Te){var Be=Te.firstOrEmpty("w:trPr"),qe=!!Be.first("w:tblHeader");return C(Te.children).map(function(tt){return t.TableRow(tt,{isHeader:qe})})}function Ce(Te){return C(Te.children).map(function(Be){var qe=Te.firstOrEmpty("w:tcPr"),tt=qe.firstOrEmpty("w:gridSpan").attributes["w:val"],xt=tt?parseInt(tt,10):1,ft=t.TableCell(Be,{colSpan:xt});return ft._vMerge=q(qe),ft})}function q(Te){var Be=Te.first("w:vMerge");if(Be){var qe=Be.attributes["w:val"];return qe==="continue"||!qe}else return null}function te(Te){var Be=e.any(Te,function(xt){return xt.type!==t.types.tableRow});if(Be)return g(Te,[i("unexpected non-row element in table, cell merging may be incorrect")]);var qe=e.any(Te,function(xt){return e.any(xt.children,function(ft){return ft.type!==t.types.tableCell})});if(qe)return g(Te,[i("unexpected non-cell element in table row, cell merging may be incorrect")]);var tt={};return Te.forEach(function(xt){var ft=0;xt.children.forEach(function(Wt){Wt._vMerge&&tt[ft]?tt[ft].rowSpan++:(tt[ft]=Wt,Wt._vMerge=!1),ft+=Wt.colSpan})}),Te.forEach(function(xt){xt.children=xt.children.filter(function(ft){return!ft._vMerge}),xt.children.forEach(function(ft){delete ft._vMerge})}),p(Te)}function j(Te){var Be=Te.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip");return _(Be.map(ee.bind(null,Te)))}function ee(Te,Be){var qe=Te.first("wp:docPr").attributes,tt=se(qe.descr)?qe.title:qe.descr,xt=ve(Be);return xt===null?h([i("Could not find image file for a:blip element")]):Oe(xt,tt)}function se(Te){return Te==null||/^\s*$/.test(Te)}function ve(Te){var Be=Te.attributes["r:embed"],qe=Te.attributes["r:link"];if(Be)return Re(Be);if(qe){var tt=A.findTargetByRelationshipId(qe);return{path:tt,read:G.read.bind(G,tt)}}else return null}function ke(Te){var Be=Te.attributes["r:id"];return Be?Oe(Re(Be),Te.attributes["o:title"]):h([i("A v:imagedata element without a relationship ID was ignored")])}function Re(Te){var Be=a.uriToZipEntryName("word",A.findTargetByRelationshipId(Te));return{path:Be,read:F.read.bind(F,Be)}}function Oe(Te,Be){var qe=M.findContentType(Te.path),tt=t.Image({readImage:Te.read,altText:Be,contentType:qe}),xt=u[qe]?[]:i("Image of type "+qe+" is unlikely to display in web browsers");return g(tt,xt)}function ze(Te,Be){return i(Te+" style with ID "+Be+" was referenced but not defined in the document")}}function c(x,w,T){var E=w.firstOrEmpty("w:ilvl").attributes["w:val"],A=w.firstOrEmpty("w:numId").attributes["w:val"];if(E!==void 0&&A!==void 0)return T.findLevel(A,E);if(x!=null){var M=T.findLevelByParagraphStyleId(x);if(M!=null)return M}return null}var u={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},d={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function h(x){return new b(null,null,x)}function f(){return new b(null)}function p(x){return new b(x)}function g(x,w){return new b(x,null,w)}function b(x,w,T){this.value=x||[],this.extra=w||[],this._result=new r({element:this.value,extra:w},T),this.messages=this._result.messages}b.prototype.toExtra=function(){return new b(null,m(this.extra,this.value),this.messages)},b.prototype.insertExtra=function(){var x=this.extra;return x&&x.length?new b(m(this.value,x),null,this.messages):this},b.prototype.map=function(x){var w=this._result.map(function(T){return x(T.element)});return new b(w.value,this.extra,w.messages)},b.prototype.flatMap=function(x){var w=this._result.flatMap(function(T){return x(T.element)._result});return new b(w.value.element,m(this.extra,w.value.extra),w.messages)},b.map=function(x,w,T){return new b(T(x.value,w.value),m(x.extra,w.extra),x.messages.concat(w.messages))};function _(x){var w=r.combine(e.pluck(x,"_result"));return new b(e.flatten(e.pluck(w.value,"element")),e.filter(e.flatten(e.pluck(w.value,"extra")),v),w.messages)}function m(x,w){return e.flatten([x,w])}function v(x){return x}return oy}var yw={},qP;function K6(){if(qP)return yw;qP=1,yw.DocumentXmlReader=t;var n=td(),e=Fo().Result;function t(r){var i=r.bodyReader;function s(a){var o=a.first("w:body");if(o==null)throw new Error("Could not find the body element: are you sure this is a docx file?");var l=i.readXmlElements(o.children).map(function(c){return new n.Document(c,{notes:r.notes,comments:r.comments})});return new e(l.value,l.messages)}return{convertXmlToDocument:s}}return yw}var qp={},HP;function X6(){if(HP)return qp;HP=1,qp.readRelationships=n,qp.defaultValue=new e([]),qp.Relationships=e;function n(t){var r=[];return t.children.forEach(function(i){if(i.name==="relationships:Relationship"){var s={relationshipId:i.attributes.Id,target:i.attributes.Target,type:i.attributes.Type};r.push(s)}}),new e(r)}function e(t){var r={};t.forEach(function(s){r[s.relationshipId]=s.target});var i={};return t.forEach(function(s){i[s.type]||(i[s.type]=[]),i[s.type].push(s.target)}),{findTargetByRelationshipId:function(s){return r[s]},findTargetsByType:function(s){return i[s]||[]}}}return qp}var uy={},KP;function Y6(){if(KP)return uy;KP=1,uy.readContentTypesFromXml=e;var n={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};uy.defaultContentTypes=t({},{});function e(r){var i={},s={};return r.children.forEach(function(a){if(a.name==="content-types:Default"&&(i[a.attributes.Extension]=a.attributes.ContentType),a.name==="content-types:Override"){var o=a.attributes.PartName;o.charAt(0)==="/"&&(o=o.substring(1)),s[o]=a.attributes.ContentType}}),t(s,i)}function t(r,i){return{findContentType:function(s){var a=r[s];if(a)return a;var o=s.split("."),l=o[o.length-1];if(i.hasOwnProperty(l))return i[l];var c=n[l.toLowerCase()];return c?"image/"+c:null}}}return uy}var Hp={},XP;function Q6(){if(XP)return Hp;XP=1;var n=cr;Hp.readNumberingXml=t,Hp.Numbering=e,Hp.defaultNumbering=new e({},{});function e(a,o,l){var c=n.flatten(n.values(o).map(function(f){return n.values(f.levels)})),u=n.indexBy(c.filter(function(f){return f.paragraphStyleId!=null}),"paragraphStyleId");function d(f,p){var g=a[f];if(g){var b=o[g.abstractNumId];if(b){if(b.numStyleLink==null)return o[g.abstractNumId].levels[p];var _=l.findNumberingStyleById(b.numStyleLink);return d(_.numId,p)}else return null}else return null}function h(f){return u[f]||null}return{findLevel:d,findLevelByParagraphStyleId:h}}function t(a,o){if(!o||!o.styles)throw new Error("styles is missing");var l=r(a),c=s(a);return new e(c,l,o.styles)}function r(a){var o={};return a.getElementsByTagName("w:abstractNum").forEach(function(l){var c=l.attributes["w:abstractNumId"];o[c]=i(l)}),o}function i(a){var o={};a.getElementsByTagName("w:lvl").forEach(function(c){var u=c.attributes["w:ilvl"],d=c.firstOrEmpty("w:numFmt").attributes["w:val"],h=c.firstOrEmpty("w:pStyle").attributes["w:val"];o[u]={isOrdered:d!=="bullet",level:u,paragraphStyleId:h}});var l=a.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:o,numStyleLink:l}}function s(a){var o={};return a.getElementsByTagName("w:num").forEach(function(l){var c=l.attributes["w:numId"],u=l.first("w:abstractNumId").attributes["w:val"];o[c]={abstractNumId:u}}),o}return Hp}var Kp={},YP;function Z6(){if(YP)return Kp;YP=1,Kp.readStylesXml=e,Kp.Styles=n,Kp.defaultStyles=new n({},{});function n(s,a,o,l){return{findParagraphStyleById:function(c){return s[c]},findCharacterStyleById:function(c){return a[c]},findTableStyleById:function(c){return o[c]},findNumberingStyleById:function(c){return l[c]}}}n.EMPTY=new n({},{},{},{});function e(s){var a={},o={},l={},c={},u={paragraph:a,character:o,table:l};return s.getElementsByTagName("w:style").forEach(function(d){var h=t(d);if(h.type==="numbering")c[h.styleId]=i(d);else{var f=u[h.type];f&&(f[h.styleId]=h)}}),new n(a,o,l,c)}function t(s){var a=s.attributes["w:type"],o=s.attributes["w:styleId"],l=r(s);return{type:a,styleId:o,name:l}}function r(s){var a=s.first("w:name");return a?a.attributes["w:val"]:null}function i(s){var a=s.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"];return{numId:a}}return Kp}var Wd={},QP;function J6(){if(QP)return Wd;QP=1;var n=td(),e=Fo().Result;Wd.createFootnotesReader=t.bind(Wd,"footnote"),Wd.createEndnotesReader=t.bind(Wd,"endnote");function t(r,i){function s(l){return e.combine(l.getElementsByTagName("w:"+r).filter(a).map(o))}function a(l){var c=l.attributes["w:type"];return c!=="continuationSeparator"&&c!=="separator"}function o(l){var c=l.attributes["w:id"];return i.readXmlElements(l.children).map(function(u){return n.Note({noteType:r,noteId:c,body:u})})}return s}return Wd}var vw={},ZP;function eW(){if(ZP)return vw;ZP=1;var n=td(),e=Fo().Result;function t(r){function i(a){return e.combine(a.getElementsByTagName("w:comment").map(s))}function s(a){var o=a.attributes["w:id"];function l(c){return(a.attributes[c]||"").trim()||null}return r.readXmlElements(a.children).map(function(c){return n.comment({commentId:o,body:c,authorName:l("w:author"),authorInitials:l("w:initials")})})}return i}return vw.createCommentsReader=t,vw}var ww={},JP;function tW(){if(JP)return ww;JP=1;var n=Xl();ww.Files=e;function e(){function t(r){return n.reject(new Error("could not open external image: '"+r+`'
cannot open linked files from a web browser`))}return{read:t}}return ww}var ek;function nW(){if(ek)return ty;ek=1,ty.read=p,ty._findPartPaths=g;var n=Xl(),e=td(),t=Fo().Result,r=WL(),i=j6().readXmlFromZipFile,s=H6().createBodyReader,a=K6().DocumentXmlReader,o=X6(),l=Y6(),c=Q6(),u=Z6(),d=J6(),h=eW(),f=tW().Files;function p(M,F){return F=F||{},n.props({contentTypes:w(M),partPaths:g(M),docxFile:M,files:F.path?f.relativeToFile(F.path):new f(null)}).also(function(G){return{styles:E(M,G.partPaths.styles)}}).also(function(G){return{numbering:T(M,G.partPaths.numbering,G.styles)}}).also(function(G){return{footnotes:v(G.partPaths.footnotes,G,function(S,I){return I?d.createFootnotesReader(S)(I):new t([])}),endnotes:v(G.partPaths.endnotes,G,function(S,I){return I?d.createEndnotesReader(S)(I):new t([])}),comments:v(G.partPaths.comments,G,function(S,I){return I?h.createCommentsReader(S)(I):new t([])})}}).also(function(G){return{notes:G.footnotes.flatMap(function(S){return G.endnotes.map(function(I){return new e.Notes(S.concat(I))})})}}).then(function(G){return v(G.partPaths.mainDocument,G,function(S,I){return G.notes.flatMap(function(C){return G.comments.flatMap(function(H){var B=new a({bodyReader:S,notes:C,comments:H});return B.convertXmlToDocument(I)})})})})}function g(M){return A(M).then(function(F){var G=b({docxFile:M,relationships:F,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!M.exists(G))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return m({filename:x(G),readElement:o.readRelationships,defaultValue:o.defaultValue})(M).then(function(S){function I(C){return b({docxFile:M,relationships:S,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+C,basePath:r.splitPath(G).dirname,fallbackPath:"word/"+C+".xml"})}return{mainDocument:G,comments:I("comments"),endnotes:I("endnotes"),footnotes:I("footnotes"),numbering:I("numbering"),styles:I("styles")}})})}function b(M){var F=M.docxFile,G=M.relationships,S=M.relationshipType,I=M.basePath,C=M.fallbackPath,H=G.findTargetsByType(S),B=H.map(function(X){return _(r.joinPath(I,X),"/")}),$=B.filter(function(X){return F.exists(X)});return $.length===0?C:$[0]}function _(M,F){return M.substring(0,F.length)===F?M.substring(F.length):M}function m(M){return function(F){return i(F,M.filename).then(function(G){return G?M.readElement(G):M.defaultValue})}}function v(M,F,G){var S=m({filename:x(M),readElement:o.readRelationships,defaultValue:o.defaultValue});return S(F.docxFile).then(function(I){var C=new s({relationships:I,contentTypes:F.contentTypes,docxFile:F.docxFile,numbering:F.numbering,styles:F.styles,files:F.files});return i(F.docxFile,M).then(function(H){return G(C,H)})})}function x(M){var F=r.splitPath(M);return r.joinPath(F.dirname,"_rels",F.basename+".rels")}var w=m({filename:"[Content_Types].xml",readElement:l.readContentTypesFromXml,defaultValue:l.defaultContentTypes});function T(M,F,G){return m({filename:F,readElement:function(S){return c.readNumberingXml(S,{styles:G})},defaultValue:c.defaultNumbering})(M)}function E(M,F){return m({filename:F,readElement:u.readStylesXml,defaultValue:u.defaultStyles})(M)}var A=m({filename:"_rels/.rels",readElement:o.readRelationships,defaultValue:o.defaultValue});return ty}var dy={},tk;function rW(){if(tk)return dy;tk=1;var n=cr,e=Xl(),t=WE();dy.writeStyleMap=a,dy.readStyleMap=u;var r="http://schemas.zwobble.org/mammoth/style-map",i="mammoth/style-map",s="/"+i;function a(d,h){return d.write(i,h),o(d).then(function(){return l(d)})}function o(d){var h="word/_rels/document.xml.rels",f="http://schemas.openxmlformats.org/package/2006/relationships",p="{"+f+"}Relationship";return d.read(h,"utf8").then(t.readString).then(function(g){var b=g.children;c(b,p,"Id",{Id:"rMammothStyleMap",Type:r,Target:s});var _={"":f};return d.write(h,t.writeString(g,_))})}function l(d){var h="[Content_Types].xml",f="http://schemas.openxmlformats.org/package/2006/content-types",p="{"+f+"}Override";return d.read(h,"utf8").then(t.readString).then(function(g){var b=g.children;c(b,p,"PartName",{PartName:s,ContentType:"text/prs.mammoth.style-map"});var _={"":f};return d.write(h,t.writeString(g,_))})}function c(d,h,f,p){var g=n.find(d,function(b){return b.name===h&&b.attributes[f]===p[f]});g?g.attributes=p:d.push(t.element(h,p))}function u(d){return d.exists(i)?d.read(i,"utf8"):e.resolve(null)}return dy}var hy={},wc={},Ya={},el={},nk;function HL(){if(nk)return el;nk=1;var n=Vv();function e(l,c,u){return r(n.element(l,c,{fresh:!1}),u)}function t(l,c,u){var d=n.element(l,c,{fresh:!0});return r(d,u)}function r(l,c){return{type:"element",tag:l,children:c||[]}}function i(l){return{type:"text",value:l}}var s={type:"forceWrite"};el.freshElement=t,el.nonFreshElement=e,el.elementWithTag=r,el.text=i,el.forceWrite=s;var a={br:!0,hr:!0,img:!0,input:!0};function o(l){return l.children.length===0&&a[l.tag.tagName]}return el.isVoidElement=o,el}var xw,rk;function iW(){if(rk)return xw;rk=1;var n=cr,e=HL();function t(g){return r(c(g))}function r(g){var b=[];return g.map(i).forEach(function(_){l(b,_)}),b}function i(g){return s[g.type](g)}var s={element:a,text:o,forceWrite:o};function a(g){return e.elementWithTag(g.tag,r(g.children))}function o(g){return g}function l(g,b){var _=g[g.length-1];b.type==="element"&&!b.tag.fresh&&_&&_.type==="element"&&b.tag.matchesElement(_.tag)?(b.tag.separator&&l(_.children,e.text(b.tag.separator)),b.children.forEach(function(m){l(_.children,m)})):g.push(b)}function c(g){return u(g,function(b){return d[b.type](b)})}function u(g,b){return n.flatten(n.map(g,b),!0)}var d={element:f,text:p,forceWrite:h};function h(g){return[g]}function f(g){var b=c(g.children);return b.length===0&&!e.isVoidElement(g)?[]:[e.elementWithTag(g.tag,b)]}function p(g){return g.value.length===0?[]:[g]}return xw=t,xw}var ik;function jv(){if(ik)return Ya;ik=1;var n=HL();Ya.freshElement=n.freshElement,Ya.nonFreshElement=n.nonFreshElement,Ya.elementWithTag=n.elementWithTag,Ya.text=n.text,Ya.forceWrite=n.forceWrite,Ya.simplify=iW();function e(a,o){o.forEach(function(l){t(a,l)})}function t(a,o){r[o.type](a,o)}var r={element:i,text:s,forceWrite:function(){}};function i(a,o){n.isVoidElement(o)?a.selfClosing(o.tag.tagName,o.tag.attributes):(a.open(o.tag.tagName,o.tag.attributes),e(a,o.children),a.close(o.tag.tagName))}function s(a,o){a.text(o.value)}return Ya.write=e,Ya}var sk;function Vv(){if(sk)return wc;sk=1;var n=cr,e=jv();wc.topLevelElement=t,wc.elements=r,wc.element=s;function t(o,l){return r([s(o,l,{fresh:!0})])}function r(o){return new i(o.map(function(l){return n.isString(l)?s(l):l}))}function i(o){this._elements=o}i.prototype.wrap=function(l){for(var c=l(),u=this._elements.length-1;u>=0;u--)c=this._elements[u].wrapNodes(c);return c};function s(o,l,c){return c=c||{},new a(o,l,c)}function a(o,l,c){var u={};n.isArray(o)?(o.forEach(function(d){u[d]=!0}),o=o[0]):u[o]=!0,this.tagName=o,this.tagNames=u,this.attributes=l||{},this.fresh=c.fresh,this.separator=c.separator}return a.prototype.matchesElement=function(o){return this.tagNames[o.tagName]&&n.isEqual(this.attributes||{},o.attributes||{})},a.prototype.wrap=function(l){return this.wrapNodes(l())},a.prototype.wrapNodes=function(l){return[e.elementWithTag(this,l)]},wc.empty=r([]),wc.ignore={wrap:function(){return[]}},wc}var Tw={},ak;function KL(){return ak||(ak=1,function(n){var e=cr,t=Xl(),r=jv();n.imgElement=i;function i(s){return function(a,o){return t.when(s(a)).then(function(l){var c={};return a.altText&&(c.alt=a.altText),e.extend(c,l),[r.freshElement("img",c)]})}}n.inline=n.imgElement,n.dataUri=i(function(s){return s.readAsBase64String().then(function(a){return{src:"data:"+s.contentType+";base64,"+a}})})}(Tw)),Tw}var Ew={},Dw={},ok;function sW(){if(ok)return Dw;ok=1;var n=cr;Dw.writer=e;function e(o){return o=o||{},o.prettyPrint?r():i()}var t={div:!0,p:!0,ul:!0,li:!0};function r(){var o=0,l="  ",c=[],u=!0,d=!1,h=i();function f(w,T){t[w]&&v(),c.push(w),h.open(w,T),t[w]&&o++,u=!1}function p(w){t[w]&&(o--,v()),c.pop(),h.close(w)}function g(w){m();var T=x()?w:w.replace(`
`,`
`+l);h.text(T)}function b(w,T){v(),h.selfClosing(w,T)}function _(){return c.length===0||t[c[c.length-1]]}function m(){d||(v(),d=!0)}function v(){if(d=!1,!u&&_()&&!x()){h._append(`
`);for(var w=0;w<o;w++)h._append(l)}}function x(){return n.some(c,function(w){return w==="pre"})}return{asString:h.asString,open:f,close:p,text:g,selfClosing:b}}function i(){var o=[];function l(g,b){var _=d(b);o.push("<"+g+_+">")}function c(g){o.push("</"+g+">")}function u(g,b){var _=d(b);o.push("<"+g+_+" />")}function d(g){return n.map(g,function(b,_){return" "+_+'="'+a(b)+'"'}).join("")}function h(g){o.push(s(g))}function f(g){o.push(g)}function p(){return o.join("")}return{asString:p,open:l,close:c,text:h,selfClosing:u,_append:f}}function s(o){return o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function a(o){return o.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}return Dw}var Mw={},lk;function aW(){if(lk)return Mw;lk=1;var n=cr;function e(d){return t(d,d)}function t(d,h){return function(){return{start:d,end:h}}}function r(d){var h=d.href||"";return h?{start:"[",end:"]("+h+")",anchorPosition:"before"}:{}}function i(d){var h=d.src||"",f=d.alt||"";return h||f?{start:"!["+f+"]("+h+")"}:{}}function s(d){return function(h,f){return{start:f?`
`:"",end:f?"":`
`,list:{isOrdered:d.isOrdered,indent:f?f.indent+1:0,count:0}}}}function a(d,h,f){h=h||{indent:0,isOrdered:!1,count:0},h.count++,f.hasClosed=!1;var p=h.isOrdered?h.count+".":"-",g=l("	",h.indent)+p+" ";return{start:g,end:function(){if(!f.hasClosed)return f.hasClosed=!0,`
`}}}var o={p:t("",`

`),br:t("",`  
`),ul:s({isOrdered:!1}),ol:s({isOrdered:!0}),li:a,strong:e("__"),em:e("*"),a:r,img:i};(function(){for(var d=1;d<=6;d++)o["h"+d]=t(l("#",d)+" ",`

`)})();function l(d,h){return new Array(h+1).join(d)}function c(){var d=[],h=[],f=null,p={};function g(w,T){T=T||{};var E=o[w]||function(){return{}},A=E(T,f,p);h.push({end:A.end,list:f}),A.list&&(f=A.list);var M=A.anchorPosition==="before";M&&b(T),d.push(A.start||""),M||b(T)}function b(w){w.id&&d.push('<a id="'+w.id+'"></a>')}function _(w){var T=h.pop();f=T.list;var E=n.isFunction(T.end)?T.end():T.end;d.push(E||"")}function m(w,T){g(w,T),_()}function v(w){d.push(u(w))}function x(){return d.join("")}return{asString:x,open:g,close:_,text:v,selfClosing:m}}Mw.writer=c;function u(d){return d.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}return Mw}var ck;function oW(){if(ck)return Ew;ck=1;var n=sW(),e=aW();Ew.writer=t;function t(r){return r=r||{},r.outputFormat==="markdown"?e.writer():n.writer(r)}return Ew}var uk;function lW(){if(uk)return hy;uk=1;var n=cr,e=Xl(),t=td(),r=Vv(),i=Fo(),s=KL(),a=jv(),o=oW();hy.DocumentConverter=l;function l(b){return{convertToHtml:function(_){var m=n.indexBy(_.type===t.types.document?_.comments:[],"commentId"),v=new c(b,m);return v.convertToHtml(_)}}}function c(b,_){var m=1,v=[],x=[];b=n.extend({ignoreEmptyParagraphs:!0},b);var w=b.idPrefix===void 0?"":b.idPrefix,T=b.ignoreEmptyParagraphs,E=r.topLevelElement("p"),A=b.styleMap||[];function M(U){var he=[],pe=G(U,he,{}),ie=[];p(pe,function(ge){ge.type==="deferred"&&ie.push(ge)});var re={};return e.mapSeries(ie,function(ge){return ge.value().then(function(Ce){re[ge.id]=Ce})}).then(function(){function ge(q){return f(q,function(te){return te.type==="deferred"?re[te.id]:te.children?[n.extend({},te,{children:ge(te.children)})]:[te]})}var Ce=o.writer({prettyPrint:b.prettyPrint,outputFormat:b.outputFormat});return a.write(Ce,a.simplify(ge(pe))),new i.Result(Ce.asString(),he)})}function F(U,he,pe){return f(U,function(ie){return G(ie,he,pe)})}function G(U,he,pe){if(!pe)throw new Error("options not set");var ie=Se[U.type];return ie?ie(U,he,pe):[]}function S(U,he,pe){return I(U,he).wrap(function(){var ie=F(U.children,he,pe);return T?ie:[a.forceWrite].concat(ie)})}function I(U,he){var pe=$(U);return pe?pe.to:(U.styleId&&he.push(h("paragraph",U)),E)}function C(U,he,pe){var ie=function(){return F(U.children,he,pe)},re=[];if(U.highlight!==null){var ge=B({type:"highlight",color:U.highlight});ge&&re.push(ge)}U.isSmallCaps&&re.push(H("smallCaps")),U.isAllCaps&&re.push(H("allCaps")),U.isStrikethrough&&re.push(H("strikethrough","s")),U.isUnderline&&re.push(H("underline")),U.verticalAlignment===t.verticalAlignment.subscript&&re.push(r.element("sub",{},{fresh:!1})),U.verticalAlignment===t.verticalAlignment.superscript&&re.push(r.element("sup",{},{fresh:!1})),U.isItalic&&re.push(H("italic","em")),U.isBold&&re.push(H("bold","strong"));var Ce=r.empty,q=$(U);return q?Ce=q.to:U.styleId&&he.push(h("run",U)),re.push(Ce),re.forEach(function(te){ie=te.wrap.bind(te,ie)}),ie()}function H(U,he){var pe=B({type:U});return pe||(he?r.element(he,{},{fresh:!1}):r.empty)}function B(U,he){var pe=$(U);return pe?pe.to:he}function $(U){for(var he=0;he<A.length;he++)if(A[he].from.matches(U))return A[he]}function X(U){return function(he,pe){return e.attempt(function(){return U(he,pe)}).caught(function(ie){return pe.push(i.error(ie)),[]})}}function V(U){return R(U.noteType,U.noteId)}function Q(U){return O(U.noteType,U.noteId)}function R(U,he){return L(U+"-"+he)}function O(U,he){return L(U+"-ref-"+he)}function L(U){return w+U}var ne=r.elements([r.element("table",{},{fresh:!0})]);function de(U,he,pe){return B(U,ne).wrap(function(){return we(U,he,pe)})}function we(U,he,pe){var ie=n.findIndex(U.children,function(q){return!q.type===t.types.tableRow||!q.isHeader});ie===-1&&(ie=U.children.length);var re;if(ie===0)re=F(U.children,he,n.extend({},pe,{isTableHeader:!1}));else{var ge=F(U.children.slice(0,ie),he,n.extend({},pe,{isTableHeader:!0})),Ce=F(U.children.slice(ie),he,n.extend({},pe,{isTableHeader:!1}));re=[a.freshElement("thead",{},ge),a.freshElement("tbody",{},Ce)]}return[a.forceWrite].concat(re)}function be(U,he,pe){var ie=F(U.children,he,pe);return[a.freshElement("tr",{},[a.forceWrite].concat(ie))]}function Ee(U,he,pe){var ie=pe.isTableHeader?"th":"td",re=F(U.children,he,pe),ge={};return U.colSpan!==1&&(ge.colspan=U.colSpan.toString()),U.rowSpan!==1&&(ge.rowspan=U.rowSpan.toString()),[a.freshElement(ie,ge,[a.forceWrite].concat(re))]}function Fe(U,he,pe){return B(U,r.ignore).wrap(function(){var ie=_[U.commentId],re=x.length+1,ge="["+g(ie)+re+"]";return x.push({label:ge,comment:ie}),[a.freshElement("a",{href:"#"+R("comment",U.commentId),id:O("comment",U.commentId)},[a.text(ge)])]})}function xe(U,he,pe){var ie=U.label,re=U.comment,ge=F(re.body,he,pe).concat([a.nonFreshElement("p",{},[a.text(" "),a.freshElement("a",{href:"#"+O("comment",re.commentId)},[a.text("")])])]);return[a.freshElement("dt",{id:R("comment",re.commentId)},[a.text("Comment "+ie)]),a.freshElement("dd",{},ge)]}function ce(U,he,pe){return ue(U).wrap(function(){return[]})}function ue(U){var he=$(U);return he?he.to:U.breakType==="line"?r.topLevelElement("br"):r.empty}var Se={document:function(U,he,pe){var ie=F(U.children,he,pe),re=v.map(function(Ce){return U.notes.resolve(Ce)}),ge=F(re,he,pe);return ie.concat([a.freshElement("ol",{},ge),a.freshElement("dl",{},f(x,function(Ce){return xe(Ce,he,pe)}))])},paragraph:S,run:C,text:function(U,he,pe){return[a.text(U.value)]},tab:function(U,he,pe){return[a.text("	")]},hyperlink:function(U,he,pe){var ie=U.anchor?"#"+L(U.anchor):U.href,re={href:ie};U.targetFrame!=null&&(re.target=U.targetFrame);var ge=F(U.children,he,pe);return[a.nonFreshElement("a",re,ge)]},checkbox:function(U){var he={type:"checkbox"};return U.checked&&(he.checked="checked"),[a.freshElement("input",he)]},bookmarkStart:function(U,he,pe){var ie=a.freshElement("a",{id:L(U.name)},[a.forceWrite]);return[ie]},noteReference:function(U,he,pe){v.push(U);var ie=a.freshElement("a",{href:"#"+V(U),id:Q(U)},[a.text("["+m+++"]")]);return[a.freshElement("sup",{},[ie])]},note:function(U,he,pe){var ie=F(U.body,he,pe),re=a.elementWithTag(r.element("p",{},{fresh:!1}),[a.text(" "),a.freshElement("a",{href:"#"+Q(U)},[a.text("")])]),ge=ie.concat([re]);return a.freshElement("li",{id:V(U)},ge)},commentReference:Fe,comment:xe,image:d(X(b.convertImage||s.dataUri)),table:de,tableRow:be,tableCell:Ee,break:ce};return{convertToHtml:M}}var u=1;function d(b){return function(_,m,v){return[{type:"deferred",id:u++,value:function(){return b(_,m,v)}}]}}function h(b,_){return i.warning("Unrecognised "+b+" style: '"+_.styleName+"' (Style ID: "+_.styleId+")")}function f(b,_){return n.flatten(b.map(_),!0)}function p(b,_){b.forEach(function(m){_(m),m.children&&p(m.children,_)})}var g=hy.commentAuthorLabel=function(_){return _.authorInitials||""};return hy}var Aw={},dk;function cW(){if(dk)return Aw;dk=1;var n=td();function e(t){if(t.type==="text")return t.value;if(t.type===n.types.tab)return"	";var r=t.type==="paragraph"?`

`:"";return(t.children||[]).map(e).join("")+r}return Aw.convertElementToRawText=e,Aw}var Xp={},Ns={},Cw={},Sw={exports:{}},hk;function uW(){if(hk)return Sw.exports;hk=1;var n=Sw.exports=function(e,t){this._tokens=e,this._startIndex=t||0};return n.prototype.head=function(){return this._tokens[this._startIndex]},n.prototype.tail=function(e){return new n(this._tokens,this._startIndex+1)},n.prototype.toArray=function(){return this._tokens.slice(this._startIndex)},n.prototype.end=function(){return this._tokens[this._tokens.length-1]},n.prototype.to=function(e){var t=this.head().source,r=e.head()||e.end();return t.to(r.source)},Sw.exports}var fk;function dW(){if(fk)return Cw;fk=1;var n=uW();return Cw.Parser=function(e){var t=function(r,i){return r(new n(i))};return{parseTokens:t}},Cw}var Pw={},kw={},pk;function hW(){return pk||(pk=1,function(n){n.none=Object.create({value:function(){throw new Error("Called value on none")},isNone:function(){return!0},isSome:function(){return!1},map:function(){return n.none},flatMap:function(){return n.none},filter:function(){return n.none},toArray:function(){return[]},orElse:e,valueOrElse:e});function e(r){return typeof r=="function"?r():r}n.some=function(r){return new t(r)};var t=function(r){this._value=r};t.prototype.value=function(){return this._value},t.prototype.isNone=function(){return!1},t.prototype.isSome=function(){return!0},t.prototype.map=function(r){return new t(r(this._value))},t.prototype.flatMap=function(r){return r(this._value)},t.prototype.filter=function(r){return r(this._value)?this:n.none},t.prototype.toArray=function(){return[this._value]},t.prototype.orElse=function(r){return this},t.prototype.valueOrElse=function(r){return this._value},n.isOption=function(r){return r===n.none||r instanceof t},n.fromNullable=function(r){return r==null?n.none:new t(r)}}(kw)),kw}var Fw,mk;function jE(){if(mk)return Fw;mk=1,Fw={failure:function(e,t){if(e.length<1)throw new Error("Failure must have errors");return new n({status:"failure",remaining:t,errors:e})},error:function(e,t){if(e.length<1)throw new Error("Failure must have errors");return new n({status:"error",remaining:t,errors:e})},success:function(e,t,r){return new n({status:"success",value:e,source:r,remaining:t,errors:[]})},cut:function(e){return new n({status:"cut",remaining:e,errors:[]})}};var n=function(e){this._value=e.value,this._status=e.status,this._hasValue=e.value!==void 0,this._remaining=e.remaining,this._source=e.source,this._errors=e.errors};return n.prototype.map=function(e){return this._hasValue?new n({value:e(this._value,this._source),status:this._status,remaining:this._remaining,source:this._source,errors:this._errors}):this},n.prototype.changeRemaining=function(e){return new n({value:this._value,status:this._status,remaining:e,source:this._source,errors:this._errors})},n.prototype.isSuccess=function(){return this._status==="success"||this._status==="cut"},n.prototype.isFailure=function(){return this._status==="failure"},n.prototype.isError=function(){return this._status==="error"},n.prototype.isCut=function(){return this._status==="cut"},n.prototype.value=function(){return this._value},n.prototype.remaining=function(){return this._remaining},n.prototype.source=function(){return this._source},n.prototype.errors=function(){return this._errors},Fw}var Iw={},gk;function XL(){if(gk)return Iw;gk=1,Iw.error=function(e){return new n(e)};var n=function(e){this.expected=e.expected,this.actual=e.actual,this._location=e.location};return n.prototype.describe=function(){var e=this._location?this._location.describe()+`:
`:"";return e+"Expected "+this.expected+`
but got `+this.actual},n.prototype.lineNumber=function(){return this._location.lineNumber()},n.prototype.characterNumber=function(){return this._location.characterNumber()},Iw}var Ow={},_k;function fW(){if(_k)return Ow;_k=1,Ow.fromArray=function(e){var t=0,r=function(){return t<e.length};return new n({hasNext:r,next:function(){if(r())return e[t++];throw new Error("No more elements")}})};var n=function(e){this._iterator=e};return n.prototype.map=function(e){var t=this._iterator;return new n({hasNext:function(){return t.hasNext()},next:function(){return e(t.next())}})},n.prototype.filter=function(e){var t=this._iterator,r=!1,i=!1,s,a=function(){if(!r)for(r=!0,i=!1;t.hasNext()&&!i;)s=t.next(),i=e(s)};return new n({hasNext:function(){return a(),i},next:function(){a();var o=s;return r=!1,o}})},n.prototype.first=function(){var e=this._iterator;return this._iterator.hasNext()?e.next():null},n.prototype.toArray=function(){for(var e=[];this._iterator.hasNext();)e.push(this._iterator.next());return e},Ow}var bk;function YL(){return bk||(bk=1,function(n){var e=cr,t=hW(),r=jE(),i=XL(),s=fW();n.token=function(h,f){var p=f!==void 0;return function(g){var b=g.head();if(b&&b.name===h&&(!p||b.value===f))return r.success(b.value,g.tail(),b.source);var _=u({name:h,value:f});return d(g,_)}},n.tokenOfType=function(h){return n.token(h)},n.firstOf=function(h,f){return e.isArray(f)||(f=Array.prototype.slice.call(arguments,1)),function(p){return s.fromArray(f).map(function(g){return g(p)}).filter(function(g){return g.isSuccess()||g.isError()}).first()||d(p,h)}},n.then=function(h,f){return function(p){var g=h(p);return g.map||console.log(g),g.map(f)}},n.sequence=function(){var h=Array.prototype.slice.call(arguments,0),f=function(g){var b=e.foldl(h,function(m,v){var x=m.result,w=m.hasCut;if(!x.isSuccess())return{result:x,hasCut:w};var T=v(x.remaining());if(T.isCut())return{result:x,hasCut:!0};if(T.isSuccess()){var E;v.isCaptured?E=x.value().withValue(v,T.value()):E=x.value();var A=T.remaining(),M=g.to(A);return{result:r.success(E,A,M),hasCut:w}}else return w?{result:r.error(T.errors(),T.remaining()),hasCut:w}:{result:T,hasCut:w}},{result:r.success(new a,g),hasCut:!1}).result,_=g.to(b.remaining());return b.map(function(m){return m.withValue(n.sequence.source,_)})};f.head=function(){var g=e.find(h,p);return n.then(f,n.sequence.extract(g))},f.map=function(g){return n.then(f,function(b){return g.apply(this,b.toArray())})};function p(g){return g.isCaptured}return f};var a=function(h,f){this._values=h||{},this._valuesArray=f||[]};a.prototype.withValue=function(h,f){if(h.captureName&&h.captureName in this._values)throw new Error('Cannot add second value for capture "'+h.captureName+'"');var p=e.clone(this._values);p[h.captureName]=f;var g=this._valuesArray.concat([f]);return new a(p,g)},a.prototype.get=function(h){if(h.captureName in this._values)return this._values[h.captureName];throw new Error('No value for capture "'+h.captureName+'"')},a.prototype.toArray=function(){return this._valuesArray},n.sequence.capture=function(h,f){var p=function(){return h.apply(this,arguments)};return p.captureName=f,p.isCaptured=!0,p},n.sequence.extract=function(h){return function(f){return f.get(h)}},n.sequence.applyValues=function(h){var f=Array.prototype.slice.call(arguments,1);return function(p){var g=f.map(function(b){return p.get(b)});return h.apply(this,g)}},n.sequence.source={captureName:"source"},n.sequence.cut=function(){return function(h){return r.cut(h)}},n.optional=function(h){return function(f){var p=h(f);return p.isSuccess()?p.map(t.some):p.isFailure()?r.success(t.none,f):p}},n.zeroOrMoreWithSeparator=function(h,f){return c(h,f,!1)},n.oneOrMoreWithSeparator=function(h,f){return c(h,f,!0)};var o=n.zeroOrMore=function(h){return function(f){for(var p=[],g;(g=h(f))&&g.isSuccess();)f=g.remaining(),p.push(g.value());return g.isError()?g:r.success(p,f)}};n.oneOrMore=function(h){return n.oneOrMoreWithSeparator(h,l)};function l(h){return r.success(null,h)}var c=function(h,f,p){return function(g){var b=h(g);if(b.isSuccess()){var _=n.sequence.capture(h,"main"),m=o(n.then(n.sequence(f,_),n.sequence.extract(_))),v=m(b.remaining());return r.success([b.value()].concat(v.value()),v.remaining())}else return p||b.isError()?b:r.success([],g)}};n.leftAssociative=function(h,f,p){var g;p?g=[{func:p,rule:f}]:g=f,g=g.map(function(_){return n.then(_.rule,function(m){return function(v,x){return _.func(v,m,x)}})});var b=n.firstOf.apply(null,["rules"].concat(g));return function(_){var m=_,v=h(_);if(!v.isSuccess())return v;for(var x=b(v.remaining());x.isSuccess();){var w=x.remaining(),T=m.to(x.remaining()),E=x.value();v=r.success(E(v.value(),T),w,T),x=b(v.remaining())}return x.isError()?x:v}},n.leftAssociative.firstOf=function(){return Array.prototype.slice.call(arguments,0)},n.nonConsuming=function(h){return function(f){return h(f).changeRemaining(f)}};var u=function(h){return h.value?h.name+' "'+h.value+'"':h.name};function d(h,f){var p,g=h.head();return g?p=i.error({expected:f,actual:u(g),location:g.source}):p=i.error({expected:f,actual:"end of tokens"}),r.failure([p],h)}}(Pw)),Pw}var Uw={exports:{}},yk;function QL(){if(yk)return Uw.exports;yk=1,Uw.exports=function(e,t){var r={asString:function(){return e},range:function(i,s){return new n(e,t,i,s)}};return r};var n=function(e,t,r,i){this._string=e,this._description=t,this._startIndex=r,this._endIndex=i};return n.prototype.to=function(e){return new n(this._string,this._description,this._startIndex,e._endIndex)},n.prototype.describe=function(){var e=this._position(),t=this._description?this._description+`
`:"";return t+"Line number: "+e.lineNumber+`
Character number: `+e.characterNumber},n.prototype.lineNumber=function(){return this._position().lineNumber},n.prototype.characterNumber=function(){return this._position().characterNumber},n.prototype._position=function(){for(var e=this,t=0,r=function(){return e._string.indexOf(`
`,t)},i=1;r()!==-1&&r()<this._startIndex;)t=r()+1,i+=1;var s=this._startIndex-t+1;return{lineNumber:i,characterNumber:s}},Uw.exports}var Lw,vk;function ZL(){return vk||(vk=1,Lw=function(n,e,t){this.name=n,this.value=e,t&&(this.source=t)}),Lw}var Rw={},wk;function pW(){return wk||(wk=1,function(n){var e=YL(),t=jE();n.parser=function(s,a,o){var l={rule:h,leftAssociative:f,rightAssociative:p},c=new r(o.map(d)),u=e.firstOf(s,a);function d(_){return{name:_.name,rule:i(_.ruleBuilder.bind(null,l))}}function h(){return g(c)}function f(_){return g(c.untilExclusive(_))}function p(_){return g(c.untilInclusive(_))}function g(_){return b.bind(null,_)}function b(_,m){var v=u(m);return v.isSuccess()?_.apply(v):v}return l};function r(s){function a(d){return new r(s.slice(0,l().indexOf(d)))}function o(d){return new r(s.slice(0,l().indexOf(d)+1))}function l(){return s.map(function(d){return d.name})}function c(d){for(var h,f;;)if(h=u(d.remaining()),h.isSuccess())f=d.source().to(h.source()),d=t.success(h.value()(d.value(),f),h.remaining(),f);else return h.isFailure()?d:h}function u(d){return e.firstOf("infix",s.map(function(h){return h.rule}))(d)}return{apply:c,untilExclusive:a,untilInclusive:o}}n.infix=function(s,a){function o(l){return n.infix(s,function(c){var u=a(c);return function(d){var h=u(d);return h.map(function(f){return function(p,g){return l(p,f,g)}})}})}return{name:s,ruleBuilder:a,map:o}};var i=function(s){var a;return function(o){return a||(a=s()),a(o)}}}(Rw)),Rw}var Bw={},xk;function mW(){if(xk)return Bw;xk=1;var n=ZL(),e=QL();Bw.RegexTokeniser=t;function t(r){r=r.map(function(o){return{name:o.name,regex:new RegExp(o.regex.source,"g")}});function i(o,l){for(var c=new e(o,l),u=0,d=[];u<o.length;){var h=s(o,u,c);u=h.endIndex,d.push(h.token)}return d.push(a(o,c)),d}function s(o,l,c){for(var u=0;u<r.length;u++){var d=r[u].regex;d.lastIndex=l;var h=d.exec(o);if(h){var p=l+h[0].length;if(h.index===l&&p>l){var f=h[1],g=new n(r[u].name,f,c.range(l,p));return{token:g,endIndex:p}}}}var p=l+1,g=new n("unrecognisedCharacter",o.substring(l,p),c.range(l,p));return{token:g,endIndex:p}}function a(o,l){return new n("end",null,l.range(o.length,o.length))}return{tokenise:i}}return Bw}var Tk;function JL(){return Tk||(Tk=1,Ns.Parser=dW().Parser,Ns.rules=YL(),Ns.errors=XL(),Ns.results=jE(),Ns.StringSource=QL(),Ns.Token=ZL(),Ns.bottomUp=pW(),Ns.RegexTokeniser=mW().RegexTokeniser,Ns.rule=function(n){var e;return function(t){return e||(e=n()),e(t)}}),Ns}var Or={},Ek;function gW(){if(Ek)return Or;Ek=1,Or.paragraph=n,Or.run=e,Or.table=t,Or.bold=new i("bold"),Or.italic=new i("italic"),Or.underline=new i("underline"),Or.strikethrough=new i("strikethrough"),Or.allCaps=new i("allCaps"),Or.smallCaps=new i("smallCaps"),Or.highlight=r,Or.commentReference=new i("commentReference"),Or.lineBreak=new a({breakType:"line"}),Or.pageBreak=new a({breakType:"page"}),Or.columnBreak=new a({breakType:"column"}),Or.equalTo=l,Or.startsWith=c;function n(h){return new i("paragraph",h)}function e(h){return new i("run",h)}function t(h){return new i("table",h)}function r(h){return new s(h)}function i(h,f){f=f||{},this._elementType=h,this._styleId=f.styleId,this._styleName=f.styleName,f.list&&(this._listIndex=f.list.levelIndex,this._listIsOrdered=f.list.isOrdered)}i.prototype.matches=function(h){return h.type===this._elementType&&(this._styleId===void 0||h.styleId===this._styleId)&&(this._styleName===void 0||h.styleName&&this._styleName.operator(this._styleName.operand,h.styleName))&&(this._listIndex===void 0||o(h,this._listIndex,this._listIsOrdered))&&(this._breakType===void 0||this._breakType===h.breakType)};function s(h){h=h||{},this._color=h.color}s.prototype.matches=function(h){return h.type==="highlight"&&(this._color===void 0||h.color===this._color)};function a(h){h=h||{},this._breakType=h.breakType}a.prototype.matches=function(h){return h.type==="break"&&(this._breakType===void 0||h.breakType===this._breakType)};function o(h,f,p){return h.numbering&&h.numbering.level==f&&h.numbering.isOrdered==p}function l(h){return{operator:u,operand:h}}function c(h){return{operator:d,operand:h}}function u(h,f){return h.toUpperCase()===f.toUpperCase()}function d(h,f){return f.toUpperCase().indexOf(h.toUpperCase())===0}return Or}var $w={},Dk;function _W(){if(Dk)return $w;Dk=1;var n=JL(),e=n.RegexTokeniser;$w.tokenise=r;var t="'((?:\\\\.|[^'])*)";function r(i){var s="(?:[a-zA-Z\\-_]|\\\\.)",a=new e([{name:"identifier",regex:new RegExp("("+s+"(?:"+s+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(t+"'")},{name:"unterminated-string",regex:new RegExp(t)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]);return a.tokenise(i)}return $w}var Mk;function bW(){if(Mk)return Xp;Mk=1;var n=cr,e=JL(),t=gW(),r=Vv(),i=_W().tokenise,s=Fo();Xp.readHtmlPath=u,Xp.readDocumentMatcher=l,Xp.readStyle=a;function a(A){return x(E,A)}function o(){return e.rules.sequence(e.rules.sequence.capture(c()),e.rules.tokenOfType("whitespace"),e.rules.tokenOfType("arrow"),e.rules.sequence.capture(e.rules.optional(e.rules.sequence(e.rules.tokenOfType("whitespace"),e.rules.sequence.capture(d())).head())),e.rules.tokenOfType("end")).map(function(A,M){return{from:A,to:M.valueOrElse(r.empty)}})}function l(A){return x(c(),A)}function c(){var A=e.rules.sequence,M=function(xe,ce){return e.rules.then(e.rules.token("identifier",xe),function(){return ce})},F=M("p",t.paragraph),G=M("r",t.run),S=e.rules.firstOf("p or r or table",F,G),I=e.rules.sequence(e.rules.tokenOfType("dot"),e.rules.sequence.cut(),e.rules.sequence.capture(h)).map(function(xe){return{styleId:xe}}),C=e.rules.firstOf("style name matcher",e.rules.then(e.rules.sequence(e.rules.tokenOfType("equals"),e.rules.sequence.cut(),e.rules.sequence.capture(p)).head(),function(xe){return{styleName:t.equalTo(xe)}}),e.rules.then(e.rules.sequence(e.rules.tokenOfType("startsWith"),e.rules.sequence.cut(),e.rules.sequence.capture(p)).head(),function(xe){return{styleName:t.startsWith(xe)}})),H=e.rules.sequence(e.rules.tokenOfType("open-square-bracket"),e.rules.sequence.cut(),e.rules.token("identifier","style-name"),e.rules.sequence.capture(C),e.rules.tokenOfType("close-square-bracket")).head(),B=e.rules.firstOf("list type",M("ordered-list",{isOrdered:!0}),M("unordered-list",{isOrdered:!1})),$=A(e.rules.tokenOfType("colon"),A.capture(B),A.cut(),e.rules.tokenOfType("open-paren"),A.capture(f),e.rules.tokenOfType("close-paren")).map(function(xe,ce){return{list:{isOrdered:xe.isOrdered,levelIndex:ce-1}}});function X(xe){var ce=e.rules.firstOf.apply(e.rules.firstOf,["matcher suffix"].concat(xe)),ue=e.rules.zeroOrMore(ce);return e.rules.then(ue,function(Se){var U={};return Se.forEach(function(he){n.extend(U,he)}),U})}var V=A(A.capture(S),A.capture(X([I,H,$]))).map(function(xe,ce){return xe(ce)}),Q=A(e.rules.token("identifier","table"),A.capture(X([I,H]))).map(function(xe){return t.table(xe)}),R=M("b",t.bold),O=M("i",t.italic),L=M("u",t.underline),ne=M("strike",t.strikethrough),de=M("all-caps",t.allCaps),we=M("small-caps",t.smallCaps),be=A(e.rules.token("identifier","highlight"),e.rules.sequence.capture(e.rules.optional(e.rules.sequence(e.rules.tokenOfType("open-square-bracket"),e.rules.sequence.cut(),e.rules.token("identifier","color"),e.rules.tokenOfType("equals"),e.rules.sequence.capture(p),e.rules.tokenOfType("close-square-bracket")).head()))).map(function(xe){return t.highlight({color:xe.valueOrElse(void 0)})}),Ee=M("comment-reference",t.commentReference),Fe=A(e.rules.token("identifier","br"),A.cut(),e.rules.tokenOfType("open-square-bracket"),e.rules.token("identifier","type"),e.rules.tokenOfType("equals"),A.capture(p),e.rules.tokenOfType("close-square-bracket")).map(function(xe){switch(xe){case"line":return t.lineBreak;case"page":return t.pageBreak;case"column":return t.columnBreak}});return e.rules.firstOf("element type",V,Q,R,O,L,ne,de,we,be,Ee,Fe)}function u(A){return x(d(),A)}function d(){var A=e.rules.sequence.capture,M=e.rules.tokenOfType("whitespace"),F=e.rules.then(e.rules.optional(e.rules.sequence(e.rules.tokenOfType("colon"),e.rules.token("identifier","fresh"))),function(C){return C.map(function(){return!0}).valueOrElse(!1)}),G=e.rules.then(e.rules.optional(e.rules.sequence(e.rules.tokenOfType("colon"),e.rules.token("identifier","separator"),e.rules.tokenOfType("open-paren"),A(p),e.rules.tokenOfType("close-paren")).head()),function(C){return C.valueOrElse("")}),S=e.rules.oneOrMoreWithSeparator(h,e.rules.tokenOfType("choice")),I=e.rules.sequence(A(S),A(e.rules.zeroOrMore(v)),A(F),A(G)).map(function(C,H,B,$){var X={},V={};return H.forEach(function(Q){Q.append&&X[Q.name]?X[Q.name]+=" "+Q.value:X[Q.name]=Q.value}),B&&(V.fresh=!0),$&&(V.separator=$),r.element(C,X,V)});return e.rules.firstOf("html path",e.rules.then(e.rules.tokenOfType("bang"),function(){return r.ignore}),e.rules.then(e.rules.zeroOrMoreWithSeparator(I,e.rules.sequence(M,e.rules.tokenOfType("gt"),M)),r.elements))}var h=e.rules.then(e.rules.tokenOfType("identifier"),b),f=e.rules.tokenOfType("integer"),p=e.rules.then(e.rules.tokenOfType("string"),b),g={n:`
`,r:"\r",t:"	"};function b(A){return A.replace(/\\(.)/g,function(M,F){return g[F]||F})}var _=e.rules.sequence(e.rules.tokenOfType("open-square-bracket"),e.rules.sequence.cut(),e.rules.sequence.capture(h),e.rules.tokenOfType("equals"),e.rules.sequence.capture(p),e.rules.tokenOfType("close-square-bracket")).map(function(A,M){return{name:A,value:M,append:!1}}),m=e.rules.sequence(e.rules.tokenOfType("dot"),e.rules.sequence.cut(),e.rules.sequence.capture(h)).map(function(A){return{name:"class",value:A,append:!0}}),v=e.rules.firstOf("attribute or class",_,m);function x(A,M){var F=i(M),G=e.Parser(),S=G.parseTokens(A,F);return S.isSuccess()?s.success(S.value()):new s.Result(null,[s.warning(w(M,S))])}function w(A,M){return"Did not understand this style mapping, so ignored it: "+A+`
`+M.errors().map(T).join(`
`)}function T(A){return"Error was at character number "+A.characterNumber()+": Expected "+A.expected+" but got "+A.actual}var E=o();return Xp}var Yp={},Ak;function yW(){if(Ak)return Yp;Ak=1,Yp.readOptions=r;var n=cr,e=Yp._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh"],t=Yp._standardOptions={transformDocument:s,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function r(a){return a=a||{},n.extend({},t,a,{customStyleMap:i(a.styleMap),readStyleMap:function(){var o=this.customStyleMap;return this.includeEmbeddedStyleMap&&(o=o.concat(i(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(o=o.concat(e)),o}})}function i(a){return a?n.isString(a)?a.split(`
`).map(function(o){return o.trim()}).filter(function(o){return o!==""&&o.charAt(0)!=="#"}):a:[]}function s(a){return a}return Yp}var Nw={},Ck;function vW(){if(Ck)return Nw;Ck=1;var n=Xl(),e=WL();Nw.openZip=t;function t(r){return r.arrayBuffer?n.resolve(e.openArrayBuffer(r.arrayBuffer)):n.reject(new Error("Could not find file in options"))}return Nw}var xc={},Sk;function wW(){if(Sk)return xc;Sk=1;var n=cr;xc.paragraph=e,xc.run=t,xc._elements=i,xc.getDescendantsOfType=s,xc.getDescendants=a;function e(l){return r("paragraph",l)}function t(l){return r("run",l)}function r(l,c){return i(function(u){return u.type===l?c(u):u})}function i(l){return function c(u){if(u.children){var d=n.map(u.children,c);u=n.extend(u,{children:d})}return l(u)}}function s(l,c){return a(l).filter(function(u){return u.type===c})}function a(l){var c=[];return o(l,function(u){c.push(u)}),c}function o(l,c){l.children&&l.children.forEach(function(u){o(u,c),c(u)})}return xc}var zw={},Pk;function xW(){if(Pk)return zw;Pk=1;var n=Vv(),e=jv();zw.element=t;function t(r){return function(i){return e.elementWithTag(n.element(r),[i])}}return zw}var kk;function TW(){if(kk)return bs;kk=1;var n=cr,e=nW(),t=rW(),r=lW().DocumentConverter,i=cW().convertElementToRawText,s=bW().readStyle,a=yW().readOptions,o=vW(),l=Fo().Result;bs.convertToHtml=c,bs.convertToMarkdown=u,bs.convert=d,bs.extractRawText=g,bs.images=KL(),bs.transforms=wW(),bs.underline=xW(),bs.embedStyleMap=b,bs.readEmbeddedStyleMap=h;function c(_,m){return d(_,m)}function u(_,m){var v=Object.create(m||{});return v.outputFormat="markdown",d(_,v)}function d(_,m){return m=a(m),o.openZip(_).tap(function(v){return t.readStyleMap(v).then(function(x){m.embeddedStyleMap=x})}).then(function(v){return e.read(v,_).then(function(x){return x.map(m.transformDocument)}).then(function(x){return f(x,m)})})}function h(_){return o.openZip(_).then(t.readStyleMap)}function f(_,m){var v=p(m.readStyleMap()),x=n.extend({},m,{styleMap:v.value}),w=new r(x);return _.flatMapThen(function(T){return v.flatMapThen(function(E){return w.convertToHtml(T)})})}function p(_){return l.combine((_||[]).map(s)).map(function(m){return m.filter(function(v){return!!v})})}function g(_){return o.openZip(_).then(e.read).then(function(m){return m.map(i)})}function b(_,m){return o.openZip(_).tap(function(v){return t.writeStyleMap(v,m)}).then(function(v){return v.toArrayBuffer()}).then(function(v){return{toArrayBuffer:function(){return v},toBuffer:function(){return Buffer.from(v)}}})}return bs.styleMapping=function(){throw new Error(`Use a raw string instead of mammoth.styleMapping e.g. "p[style-name='Title'] => h1" instead of mammoth.styleMapping("p[style-name='Title'] => h1")`)},bs}var EW=TW();const DW=pU(EW),MW={__name:"FileInput",emits:["file-processed"],setup(n,{emit:e}){const t=Sn(null),r=e,i=async o=>{if(console.log("File changed:",o),!o)return;const l=o.type||o.name.split(".").pop().toLowerCase();try{let c="";if(l==="application/pdf"||l==="pdf")c=await s(o);else if(l==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"||l==="application/msword"||l==="docx"||l==="doc")c=await a(o);else return alert(`File type not supported: ${l}`),null;return console.log("Input text:",c),r("file-processed",c),c}catch(c){return console.error("Error processing file:",c),alert("Error reading document: "+c.message),null}},s=o=>new Promise((l,c)=>{const u=new FileReader;u.onload=async d=>{try{const h=new Uint8Array(d.target.result),f=await _5(()=>import("https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/+esm"),[],import.meta.url);f.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/build/pdf.worker.min.mjs";const p=await f.getDocument(h).promise,g=p.numPages;let b="";for(let _=1;_<=g;_++){const x=(await(await p.getPage(_)).getTextContent()).items;for(let w=0;w<x.length;w++)b+=x[w].str+" "}l(b)}catch(h){c(h)}},u.onerror=d=>{c(d)},u.readAsArrayBuffer(o)}),a=o=>new Promise((l,c)=>{const u=new FileReader;u.onload=async d=>{try{const h=d.target.result,f=await DW.extractRawText({arrayBuffer:h}),p=f.value;f.messages&&f.messages.length>0&&console.warn("Warnings when parsing Word document:",f.messages),l(p)}catch(h){c(h)}},u.onerror=d=>{c(d)},u.readAsArrayBuffer(o)});return(o,l)=>(F0(),QT(fU,{modelValue:t.value,"onUpdate:modelValue":[l[0]||(l[0]=c=>t.value=c),i],label:"Read PDF/DOCX/DOC",filled:"",style:{"max-width":"300px"},accept:"application/pdf, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document"},null,8,["modelValue"]))}};var Ww={exports:{}},Fk;function AW(){return Fk||(Fk=1,function(n){var e=function(t){var r=Object.prototype,i=r.hasOwnProperty,s=Object.defineProperty||function(V,Q,R){V[Q]=R.value},a,o=typeof Symbol=="function"?Symbol:{},l=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function d(V,Q,R){return Object.defineProperty(V,Q,{value:R,enumerable:!0,configurable:!0,writable:!0}),V[Q]}try{d({},"")}catch{d=function(Q,R,O){return Q[R]=O}}function h(V,Q,R,O){var L=Q&&Q.prototype instanceof v?Q:v,ne=Object.create(L.prototype),de=new B(O||[]);return s(ne,"_invoke",{value:S(V,R,de)}),ne}t.wrap=h;function f(V,Q,R){try{return{type:"normal",arg:V.call(Q,R)}}catch(O){return{type:"throw",arg:O}}}var p="suspendedStart",g="suspendedYield",b="executing",_="completed",m={};function v(){}function x(){}function w(){}var T={};d(T,l,function(){return this});var E=Object.getPrototypeOf,A=E&&E(E($([])));A&&A!==r&&i.call(A,l)&&(T=A);var M=w.prototype=v.prototype=Object.create(T);x.prototype=w,s(M,"constructor",{value:w,configurable:!0}),s(w,"constructor",{value:x,configurable:!0}),x.displayName=d(w,u,"GeneratorFunction");function F(V){["next","throw","return"].forEach(function(Q){d(V,Q,function(R){return this._invoke(Q,R)})})}t.isGeneratorFunction=function(V){var Q=typeof V=="function"&&V.constructor;return Q?Q===x||(Q.displayName||Q.name)==="GeneratorFunction":!1},t.mark=function(V){return Object.setPrototypeOf?Object.setPrototypeOf(V,w):(V.__proto__=w,d(V,u,"GeneratorFunction")),V.prototype=Object.create(M),V},t.awrap=function(V){return{__await:V}};function G(V,Q){function R(ne,de,we,be){var Ee=f(V[ne],V,de);if(Ee.type==="throw")be(Ee.arg);else{var Fe=Ee.arg,xe=Fe.value;return xe&&typeof xe=="object"&&i.call(xe,"__await")?Q.resolve(xe.__await).then(function(ce){R("next",ce,we,be)},function(ce){R("throw",ce,we,be)}):Q.resolve(xe).then(function(ce){Fe.value=ce,we(Fe)},function(ce){return R("throw",ce,we,be)})}}var O;function L(ne,de){function we(){return new Q(function(be,Ee){R(ne,de,be,Ee)})}return O=O?O.then(we,we):we()}s(this,"_invoke",{value:L})}F(G.prototype),d(G.prototype,c,function(){return this}),t.AsyncIterator=G,t.async=function(V,Q,R,O,L){L===void 0&&(L=Promise);var ne=new G(h(V,Q,R,O),L);return t.isGeneratorFunction(Q)?ne:ne.next().then(function(de){return de.done?de.value:ne.next()})};function S(V,Q,R){var O=p;return function(ne,de){if(O===b)throw new Error("Generator is already running");if(O===_){if(ne==="throw")throw de;return X()}for(R.method=ne,R.arg=de;;){var we=R.delegate;if(we){var be=I(we,R);if(be){if(be===m)continue;return be}}if(R.method==="next")R.sent=R._sent=R.arg;else if(R.method==="throw"){if(O===p)throw O=_,R.arg;R.dispatchException(R.arg)}else R.method==="return"&&R.abrupt("return",R.arg);O=b;var Ee=f(V,Q,R);if(Ee.type==="normal"){if(O=R.done?_:g,Ee.arg===m)continue;return{value:Ee.arg,done:R.done}}else Ee.type==="throw"&&(O=_,R.method="throw",R.arg=Ee.arg)}}}function I(V,Q){var R=Q.method,O=V.iterator[R];if(O===a)return Q.delegate=null,R==="throw"&&V.iterator.return&&(Q.method="return",Q.arg=a,I(V,Q),Q.method==="throw")||R!=="return"&&(Q.method="throw",Q.arg=new TypeError("The iterator does not provide a '"+R+"' method")),m;var L=f(O,V.iterator,Q.arg);if(L.type==="throw")return Q.method="throw",Q.arg=L.arg,Q.delegate=null,m;var ne=L.arg;if(!ne)return Q.method="throw",Q.arg=new TypeError("iterator result is not an object"),Q.delegate=null,m;if(ne.done)Q[V.resultName]=ne.value,Q.next=V.nextLoc,Q.method!=="return"&&(Q.method="next",Q.arg=a);else return ne;return Q.delegate=null,m}F(M),d(M,u,"Generator"),d(M,l,function(){return this}),d(M,"toString",function(){return"[object Generator]"});function C(V){var Q={tryLoc:V[0]};1 in V&&(Q.catchLoc=V[1]),2 in V&&(Q.finallyLoc=V[2],Q.afterLoc=V[3]),this.tryEntries.push(Q)}function H(V){var Q=V.completion||{};Q.type="normal",delete Q.arg,V.completion=Q}function B(V){this.tryEntries=[{tryLoc:"root"}],V.forEach(C,this),this.reset(!0)}t.keys=function(V){var Q=Object(V),R=[];for(var O in Q)R.push(O);return R.reverse(),function L(){for(;R.length;){var ne=R.pop();if(ne in Q)return L.value=ne,L.done=!1,L}return L.done=!0,L}};function $(V){if(V){var Q=V[l];if(Q)return Q.call(V);if(typeof V.next=="function")return V;if(!isNaN(V.length)){var R=-1,O=function L(){for(;++R<V.length;)if(i.call(V,R))return L.value=V[R],L.done=!1,L;return L.value=a,L.done=!0,L};return O.next=O}}return{next:X}}t.values=$;function X(){return{value:a,done:!0}}return B.prototype={constructor:B,reset:function(V){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(H),!V)for(var Q in this)Q.charAt(0)==="t"&&i.call(this,Q)&&!isNaN(+Q.slice(1))&&(this[Q]=a)},stop:function(){this.done=!0;var V=this.tryEntries[0],Q=V.completion;if(Q.type==="throw")throw Q.arg;return this.rval},dispatchException:function(V){if(this.done)throw V;var Q=this;function R(be,Ee){return ne.type="throw",ne.arg=V,Q.next=be,Ee&&(Q.method="next",Q.arg=a),!!Ee}for(var O=this.tryEntries.length-1;O>=0;--O){var L=this.tryEntries[O],ne=L.completion;if(L.tryLoc==="root")return R("end");if(L.tryLoc<=this.prev){var de=i.call(L,"catchLoc"),we=i.call(L,"finallyLoc");if(de&&we){if(this.prev<L.catchLoc)return R(L.catchLoc,!0);if(this.prev<L.finallyLoc)return R(L.finallyLoc)}else if(de){if(this.prev<L.catchLoc)return R(L.catchLoc,!0)}else if(we){if(this.prev<L.finallyLoc)return R(L.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(V,Q){for(var R=this.tryEntries.length-1;R>=0;--R){var O=this.tryEntries[R];if(O.tryLoc<=this.prev&&i.call(O,"finallyLoc")&&this.prev<O.finallyLoc){var L=O;break}}L&&(V==="break"||V==="continue")&&L.tryLoc<=Q&&Q<=L.finallyLoc&&(L=null);var ne=L?L.completion:{};return ne.type=V,ne.arg=Q,L?(this.method="next",this.next=L.finallyLoc,m):this.complete(ne)},complete:function(V,Q){if(V.type==="throw")throw V.arg;return V.type==="break"||V.type==="continue"?this.next=V.arg:V.type==="return"?(this.rval=this.arg=V.arg,this.method="return",this.next="end"):V.type==="normal"&&Q&&(this.next=Q),m},finish:function(V){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var R=this.tryEntries[Q];if(R.finallyLoc===V)return this.complete(R.completion,R.afterLoc),H(R),m}},catch:function(V){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var R=this.tryEntries[Q];if(R.tryLoc===V){var O=R.completion;if(O.type==="throw"){var L=O.arg;H(R)}return L}}throw new Error("illegal catch attempt")},delegateYield:function(V,Q,R){return this.delegate={iterator:$(V),resultName:Q,nextLoc:R},this.method==="next"&&(this.arg=a),m}},t}(n.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}(Ww)),Ww.exports}var jw,Ik;function VE(){return Ik||(Ik=1,jw=(n,e)=>`${n}-${e}-${Math.random().toString(16).slice(3,8)}`),jw}var Vw,Ok;function eR(){if(Ok)return Vw;Ok=1;const n=VE();let e=0;return Vw=({id:t,action:r,payload:i={}})=>{let s=t;return typeof s>"u"&&(s=n("Job",e),e+=1),{id:s,action:r,payload:i}},Vw}var Qp={},Uk;function GE(){if(Uk)return Qp;Uk=1;let n=!1;return Qp.logging=n,Qp.setLogging=e=>{n=e},Qp.log=(...e)=>n?console.log.apply(this,e):null,Qp}var Gw,Lk;function CW(){if(Lk)return Gw;Lk=1;const n=eR(),{log:e}=GE(),t=VE();let r=0;return Gw=()=>{const i=t("Scheduler",r),s={},a={};let o=[];r+=1;const l=()=>o.length,c=()=>Object.keys(s).length,u=()=>{if(o.length!==0){const g=Object.keys(s);for(let b=0;b<g.length;b+=1)if(typeof a[g[b]]>"u"){o[0](s[g[b]]);break}}},d=(g,b)=>new Promise((_,m)=>{const v=n({action:g,payload:b});o.push(async x=>{o.shift(),a[x.id]=v;try{_(await x[g].apply(this,[...b,v.id]))}catch(w){m(w)}finally{delete a[x.id],u()}}),e(`[${i}]: Add ${v.id} to JobQueue`),e(`[${i}]: JobQueue length=${o.length}`),u()});return{addWorker:g=>(s[g.id]=g,e(`[${i}]: Add ${g.id}`),e(`[${i}]: Number of workers=${c()}`),u(),g.id),addJob:async(g,...b)=>{if(c()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return d(g,b)},terminate:async()=>{Object.keys(s).forEach(async g=>{await s[g].terminate()}),o=[]},getQueueLen:l,getNumWorkers:c}},Gw}var qw,Rk;function SW(){return Rk||(Rk=1,qw=n=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof hm=="function"&&(e.type="node"),typeof n>"u"?e:e[n]}),qw}var Hw,Bk;function PW(){if(Bk)return Hw;Bk=1;const e=SW()("type")==="browser"?t=>new URL(t,window.location.href).href:t=>t;return Hw=t=>{const r={...t};return["corePath","workerPath","langPath"].forEach(i=>{t[i]&&(r[i]=e(r[i]))}),r},Hw}var Kw,$k;function tR(){return $k||($k=1,Kw={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),Kw}const kW="6.0.0",FW={version:kW};var Xw,Nk;function IW(){return Nk||(Nk=1,Xw={workerBlobURL:!0,logger:()=>{}}),Xw}var Yw,zk;function OW(){if(zk)return Yw;zk=1;const n=FW.version;return Yw={...IW(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`},Yw}var Qw,Wk;function UW(){return Wk||(Wk=1,Qw=({workerPath:n,workerBlobURL:e})=>{let t;if(Blob&&URL&&e){const r=new Blob([`importScripts("${n}");`],{type:"application/javascript"});t=new Worker(URL.createObjectURL(r))}else t=new Worker(n);return t}),Qw}var Zw,jk;function LW(){return jk||(jk=1,Zw=n=>{n.terminate()}),Zw}var Jw,Vk;function RW(){return Vk||(Vk=1,Jw=(n,e)=>{n.onmessage=({data:t})=>{e(t)}}),Jw}var e2,Gk;function BW(){return Gk||(Gk=1,e2=async(n,e)=>{n.postMessage(e)}),e2}var t2,qk;function $W(){if(qk)return t2;qk=1;const n=t=>new Promise((r,i)=>{const s=new FileReader;s.onload=()=>{r(s.result)},s.onerror=({target:{error:{code:a}}})=>{i(Error(`File could not be read! Code=${a}`))},s.readAsArrayBuffer(t)}),e=async t=>{let r=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?r=atob(t.split(",")[1]).split("").map(i=>i.charCodeAt(0)):r=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(r=await e(t.src)),t.tagName==="VIDEO"&&(r=await e(t.poster)),t.tagName==="CANVAS"&&await new Promise(i=>{t.toBlob(async s=>{r=await n(s),i()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){const i=await t.convertToBlob();r=await n(i)}else(t instanceof File||t instanceof Blob)&&(r=await n(t));return new Uint8Array(r)};return t2=e,t2}var n2,Hk;function NW(){if(Hk)return n2;Hk=1;const n=OW(),e=UW(),t=LW(),r=RW(),i=BW(),s=$W();return n2={defaultOptions:n,spawnWorker:e,terminateWorker:t,onMessage:r,send:i,loadImage:s},n2}var r2,Kk;function nR(){if(Kk)return r2;Kk=1;const n=PW(),e=eR(),{log:t}=GE(),r=VE(),i=tR(),{defaultOptions:s,spawnWorker:a,terminateWorker:o,onMessage:l,loadImage:c,send:u}=NW();let d=0;return r2=async(h="eng",f=i.LSTM_ONLY,p={},g={})=>{const b=r("Worker",d),{logger:_,errorHandler:m,...v}=n({...s,...p}),x={},w=typeof h=="string"?h.split("+"):h;let T=f,E=g;const A=[i.DEFAULT,i.LSTM_ONLY].includes(f)&&!v.legacyCore;let M,F;const G=new Promise((Fe,xe)=>{F=Fe,M=xe}),S=Fe=>{M(Fe.message)};let I=a(v);I.onerror=S,d+=1;const C=({id:Fe,action:xe,payload:ce})=>new Promise((ue,Se)=>{t(`[${b}]: Start ${Fe}, action=${xe}`);const U=`${xe}-${Fe}`;x[U]={resolve:ue,reject:Se},u(I,{workerId:b,jobId:Fe,action:xe,payload:ce})}),H=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),B=Fe=>C(e({id:Fe,action:"load",payload:{options:{lstmOnly:A,corePath:v.corePath,logging:v.logging}}})),$=(Fe,xe,ce)=>C(e({id:ce,action:"FS",payload:{method:"writeFile",args:[Fe,xe]}})),X=(Fe,xe)=>C(e({id:xe,action:"FS",payload:{method:"readFile",args:[Fe,{encoding:"utf8"}]}})),V=(Fe,xe)=>C(e({id:xe,action:"FS",payload:{method:"unlink",args:[Fe]}})),Q=(Fe,xe,ce)=>C(e({id:ce,action:"FS",payload:{method:Fe,args:xe}})),R=(Fe,xe)=>C(e({id:xe,action:"loadLanguage",payload:{langs:Fe,options:{langPath:v.langPath,dataPath:v.dataPath,cachePath:v.cachePath,cacheMethod:v.cacheMethod,gzip:v.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(T)&&!v.legacyLang}}})),O=(Fe,xe,ce,ue)=>C(e({id:ue,action:"initialize",payload:{langs:Fe,oem:xe,config:ce}})),L=(Fe="eng",xe,ce,ue)=>{if(A&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(xe))throw Error("Legacy model requested but code missing.");const Se=xe||T;T=Se;const U=ce||E;E=U;const pe=(typeof Fe=="string"?Fe.split("+"):Fe).filter(ie=>!w.includes(ie));return w.push(...pe),pe.length>0?R(pe,ue).then(()=>O(Fe,Se,U,ue)):O(Fe,Se,U,ue)},ne=(Fe={},xe)=>C(e({id:xe,action:"setParameters",payload:{params:Fe}})),de=async(Fe,xe={},ce={text:!0},ue)=>C(e({id:ue,action:"recognize",payload:{image:await c(Fe),options:xe,output:ce}})),we=async(Fe,xe)=>{if(A)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return C(e({id:xe,action:"detect",payload:{image:await c(Fe)}}))},be=async()=>(I!==null&&(o(I),I=null),Promise.resolve());l(I,({workerId:Fe,jobId:xe,status:ce,action:ue,data:Se})=>{const U=`${ue}-${xe}`;if(ce==="resolve")t(`[${Fe}]: Complete ${xe}`),x[U].resolve({jobId:xe,data:Se}),delete x[U];else if(ce==="reject")if(x[U].reject(Se),delete x[U],ue==="load"&&M(Se),m)m(Se);else throw Error(Se);else ce==="progress"&&_({...Se,userJobId:xe})});const Ee={id:b,worker:I,load:H,writeText:$,readText:X,removeFile:V,FS:Q,reinitialize:L,setParameters:ne,recognize:de,detect:we,terminate:be};return B().then(()=>R(h)).then(()=>O(h,f,g)).then(()=>F(Ee)).catch(()=>{}),G},r2}var i2,Xk;function zW(){if(Xk)return i2;Xk=1;const n=nR();return i2={recognize:async(r,i,s)=>{const a=await n(i,1,s);return a.recognize(r).finally(async()=>{await a.terminate()})},detect:async(r,i)=>{const s=await n("osd",0,i);return s.detect(r).finally(async()=>{await s.terminate()})}},i2}var s2,Yk;function WW(){return Yk||(Yk=1,s2={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),s2}var a2,Qk;function jW(){return Qk||(Qk=1,a2={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),a2}var o2,Zk;function VW(){if(Zk)return o2;Zk=1,AW();const n=CW(),e=nR(),t=zW(),r=WW(),i=tR(),s=jW(),{setLogging:a}=GE();return o2={languages:r,OEM:i,PSM:s,createScheduler:n,createWorker:e,setLogging:a,...t},o2}var GW=VW();const Jk=pU(GW);var Om={};Om.d=(n,e)=>{for(var t in e)Om.o(e,t)&&!Om.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};Om.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Nt=globalThis.pdfjsLib={};Om.d(Nt,{AbortException:()=>Wl,AnnotationEditorLayer:()=>AT,AnnotationEditorParamsType:()=>sn,AnnotationEditorType:()=>Kt,AnnotationEditorUIManager:()=>Gu,AnnotationLayer:()=>N9,AnnotationMode:()=>al,ColorPicker:()=>V0,DOMSVGFactory:()=>eD,DrawLayer:()=>PT,FeatureTest:()=>Ai,GlobalWorkerOptions:()=>Wu,ImageKind:()=>Zy,InvalidPDFException:()=>vx,MissingPDFException:()=>Vm,OPS:()=>Hs,OutputScale:()=>xx,PDFDataRangeTransport:()=>iB,PDFDateString:()=>YE,PDFWorker:()=>ah,PasswordResponses:()=>XW,PermissionFlag:()=>KW,PixelsPerInch:()=>jl,RenderingCancelledException:()=>KE,TextLayer:()=>Gm,TouchManager:()=>W0,UnexpectedResponseException:()=>$0,Util:()=>At,VerbosityLevel:()=>Gv,XfaLayer:()=>aB,build:()=>v9,createValidAbsoluteUrl:()=>JW,fetchData:()=>Xv,getDocument:()=>d9,getFilenameFromUrl:()=>lj,getPdfFilenameFromUrl:()=>cj,getXfaPageViewport:()=>uj,isDataScheme:()=>Yv,isPdfFile:()=>XE,noContextMenu:()=>da,normalizeUnicode:()=>sj,setLayerDimensions:()=>Vu,shadow:()=>Zt,stopEvent:()=>ds,version:()=>y9});const hi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),rR=[1,0,0,1,0,0],yx=[.001,0,0,.001,0,0],qW=1e7,l2=1.35,ls={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},al={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},HW="pdfjs_internal_editor_",Kt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},sn={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},KW={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},ri={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Zy={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Tr={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Zp={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Gv={ERRORS:0,WARNINGS:1,INFOS:5},Hs={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},XW={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let qv=Gv.WARNINGS;function YW(n){Number.isInteger(n)&&(qv=n)}function QW(){return qv}function Hv(n){qv>=Gv.INFOS&&console.log(`Info: ${n}`)}function Xt(n){qv>=Gv.WARNINGS&&console.log(`Warning: ${n}`)}function Pn(n){throw new Error(n)}function _r(n,e){n||Pn(e)}function ZW(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function JW(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=ij(n)}catch{}const r=e?new URL(n,e):new URL(n);if(ZW(r))return r}catch{}return null}function Zt(n,e,t,r=!1){return Object.defineProperty(n,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}const Ql=function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e}();class eF extends Ql{constructor(e,t){super(e,"PasswordException"),this.code=t}}class c2 extends Ql{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class vx extends Ql{constructor(e){super(e,"InvalidPDFException")}}class Vm extends Ql{constructor(e){super(e,"MissingPDFException")}}class $0 extends Ql{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class ej extends Ql{constructor(e){super(e,"FormatError")}}class Wl extends Ql{constructor(e){super(e,"AbortException")}}function iR(n){(typeof n!="object"||n?.length===void 0)&&Pn("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const r=[];for(let i=0;i<e;i+=t){const s=Math.min(i+t,e),a=n.subarray(i,s);r.push(String.fromCharCode.apply(null,a))}return r.join("")}function Kv(n){typeof n!="string"&&Pn("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=n.charCodeAt(r)&255;return t}function tj(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function qE(n){const e=Object.create(null);for(const[t,r]of n)e[t]=r;return e}function nj(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function rj(){try{return new Function(""),!0}catch{return!1}}class Ai{static get isLittleEndian(){return Zt(this,"isLittleEndian",nj())}static get isEvalSupported(){return Zt(this,"isEvalSupported",rj())}static get isOffscreenCanvasSupported(){return Zt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Zt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Zt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Zt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Zt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const u2=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var So,Jy,wx;class At{static makeHexColor(e,t,r){return`#${u2[e]}${u2[t]}${u2[r]}`}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const r=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[r,i]}static applyInverseTransform(e,t){const r=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/r,s=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/r;return[i,s]}static getAxialAlignedBoundingBox(e,t){const r=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),s=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(r[0],i[0],s[0],a[0]),Math.min(r[1],i[1],s[1],a[1]),Math.max(r[0],i[0],s[0],a[0]),Math.max(r[1],i[1],s[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],r=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],s=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(r+a)/2,l=Math.sqrt((r+a)**2-4*(r*a-s*i))/2,c=o+l||1,u=o-l||1;return[Math.sqrt(c),Math.sqrt(u)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>a?null:[r,s,i,a]}static bezierBoundingBox(e,t,r,i,s,a,o,l,c){return c?(c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],le(this,So,wx).call(this,e,r,s,o,t,i,a,l,3*(-e+3*(r-s)+o),6*(e-2*r+s),3*(r-e),c),le(this,So,wx).call(this,e,r,s,o,t,i,a,l,3*(-t+3*(i-a)+l),6*(t-2*i+a),3*(i-t),c),c}}So=new WeakSet,Jy=function(e,t,r,i,s,a,o,l,c,u){if(c<=0||c>=1)return;const d=1-c,h=c*c,f=h*c,p=d*(d*(d*e+3*c*t)+3*h*r)+f*i,g=d*(d*(d*s+3*c*a)+3*h*o)+f*l;u[0]=Math.min(u[0],p),u[1]=Math.min(u[1],g),u[2]=Math.max(u[2],p),u[3]=Math.max(u[3],g)},wx=function(e,t,r,i,s,a,o,l,c,u,d,h){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&le(this,So,Jy).call(this,e,t,r,i,s,a,o,l,-d/u,h);return}const f=u**2-4*d*c;if(f<0)return;const p=Math.sqrt(f),g=2*c;le(this,So,Jy).call(this,e,t,r,i,s,a,o,l,(-u+p)/g,h),le(this,So,Jy).call(this,e,t,r,i,s,a,o,l,(-u-p)/g,h)},oe(At,So);function ij(n){return decodeURIComponent(escape(n))}let d2=null,tF=null;function sj(n){return d2||(d2=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,tF=new Map([["","t"]])),n.replaceAll(d2,(e,t,r)=>t?t.normalize("NFKC"):tF.get(r))}function aj(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),iR(n)}const HE="pdfjs_internal_id_";function oj(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(iR(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const Za="http://www.w3.org/2000/svg",Oc=class Oc{};Xe(Oc,"CSS",96),Xe(Oc,"PDF",72),Xe(Oc,"PDF_TO_CSS_UNITS",Oc.CSS/Oc.PDF);let jl=Oc;async function Xv(n,e="text"){if(fm(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}class T_{constructor({viewBox:e,userUnit:t,scale:r,rotation:i,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=r,this.rotation=i,this.offsetX=s,this.offsetY=a,r*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let u,d,h,f;switch(i%=360,i<0&&(i+=360),i){case 180:u=-1,d=0,h=0,f=1;break;case 90:u=0,d=1,h=1,f=0;break;case 270:u=0,d=-1,h=-1,f=0;break;case 0:u=1,d=0,h=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(h=-h,f=-f);let p,g,b,_;u===0?(p=Math.abs(c-e[1])*r+s,g=Math.abs(l-e[0])*r+a,b=(e[3]-e[1])*r,_=(e[2]-e[0])*r):(p=Math.abs(l-e[0])*r+s,g=Math.abs(c-e[1])*r+a,b=(e[2]-e[0])*r,_=(e[3]-e[1])*r),this.transform=[u*r,d*r,h*r,f*r,p-u*r*l-h*r*c,g-d*r*l-f*r*c],this.width=b,this.height=_}get rawDims(){const{userUnit:e,viewBox:t}=this,r=t.map(i=>i*e);return Zt(this,"rawDims",{pageWidth:r[2]-r[0],pageHeight:r[3]-r[1],pageX:r[0],pageY:r[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new T_({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){return At.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=At.applyTransform([e[0],e[1]],this.transform),r=At.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){return At.applyInverseTransform([e,t],this.transform)}}class KE extends Ql{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Yv(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function XE(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function lj(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function cj(n,e="document.pdf"){if(typeof n!="string")return e;if(Yv(n))return Xt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let s=r.exec(i[1])||r.exec(i[2])||r.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=r.exec(decodeURIComponent(s))[0]}catch{}return s||e}class nF{started=Object.create(null);times=[];time(e){e in this.started&&Xt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Xt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:r}of this.times)t=Math.max(r.length,t);for(const{name:r,start:i,end:s}of this.times)e.push(`${r.padEnd(t)} ${s-i}ms
`);return e.join("")}}function fm(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function da(n){n.preventDefault()}function ds(n){n.preventDefault(),n.stopPropagation()}var Xm;class YE{static toDateObject(e){if(!e||typeof e!="string")return null;y(this,Xm)||Z(this,Xm,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=y(this,Xm).exec(e);if(!t)return null;const r=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,c==="-"?(a+=u,o+=d):c==="+"&&(a-=u,o-=d),new Date(Date.UTC(r,i,s,a,o,l))}}Xm=new WeakMap,oe(YE,Xm);function uj(n,{scale:e=1,rotation:t=0}){const{width:r,height:i}=n.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new T_({viewBox:s,userUnit:1,scale:e,rotation:t})}function QE(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Xt(`Not a valid color format: "${n}"`),[0,0,0])}function dj(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const r=window.getComputedStyle(e).color;n.set(t,QE(r))}e.remove()}function zn(n){const{a:e,b:t,c:r,d:i,e:s,f:a}=n.getTransform();return[e,t,r,i,s,a]}function ya(n){const{a:e,b:t,c:r,d:i,e:s,f:a}=n.getTransform().invertSelf();return[e,t,r,i,s,a]}function Vu(n,e,t=!1,r=!0){if(e instanceof T_){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:a}=n,o=Ai.isCSSRoundSupported,l=`var(--scale-factor) * ${i}px`,c=`var(--scale-factor) * ${s}px`,u=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,d=o?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=u,a.height=d):(a.width=d,a.height=u)}r&&n.setAttribute("data-main-rotation",e.rotation)}class xx{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var ol,Rc,Ks,Bc,Ym,Qm,ev,sR,Ci,aR,oR,e0,lR,Ex;const to=class to{constructor(e){oe(this,Ci);oe(this,ol,null);oe(this,Rc,null);oe(this,Ks);oe(this,Bc,null);oe(this,Ym,null);Z(this,Ks,e),y(to,Qm)||Z(to,Qm,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=Z(this,ol,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=y(this,Ks)._uiManager._signal;e.addEventListener("contextmenu",da,{signal:t}),e.addEventListener("pointerdown",le(to,ev,sR),{signal:t});const r=Z(this,Bc,document.createElement("div"));r.className="buttons",e.append(r);const i=y(this,Ks).toolbarPosition;if(i){const{style:s}=e,a=y(this,Ks)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return le(this,Ci,lR).call(this),e}get div(){return y(this,ol)}hide(){y(this,ol).classList.add("hidden"),y(this,Rc)?.hideDropdown()}show(){y(this,ol).classList.remove("hidden"),y(this,Ym)?.shown()}async addAltText(e){const t=await e.render();le(this,Ci,e0).call(this,t),y(this,Bc).prepend(t,y(this,Ci,Ex)),Z(this,Ym,e)}addColorPicker(e){Z(this,Rc,e);const t=e.renderButton();le(this,Ci,e0).call(this,t),y(this,Bc).prepend(t,y(this,Ci,Ex))}remove(){y(this,ol).remove(),y(this,Rc)?.destroy(),Z(this,Rc,null)}};ol=new WeakMap,Rc=new WeakMap,Ks=new WeakMap,Bc=new WeakMap,Ym=new WeakMap,Qm=new WeakMap,ev=new WeakSet,sR=function(e){e.stopPropagation()},Ci=new WeakSet,aR=function(e){y(this,Ks)._focusEventsAllowed=!1,ds(e)},oR=function(e){y(this,Ks)._focusEventsAllowed=!0,ds(e)},e0=function(e){const t=y(this,Ks)._uiManager._signal;e.addEventListener("focusin",le(this,Ci,aR).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",le(this,Ci,oR).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",da,{signal:t})},lR=function(){const{editorType:e,_uiManager:t}=y(this,Ks),r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",y(to,Qm)[e]),le(this,Ci,e0).call(this,r),r.addEventListener("click",i=>{t.delete()},{signal:t._signal}),y(this,Bc).append(r)},Ex=function(){const e=document.createElement("div");return e.className="divider",e},oe(to,ev),oe(to,Qm,null);let Tx=to;var Zm,$c,Nc,Gl,cR,uR,dR;class hj{constructor(e){oe(this,Gl);oe(this,Zm,null);oe(this,$c,null);oe(this,Nc);Z(this,Nc,e)}show(e,t,r){const[i,s]=le(this,Gl,uR).call(this,t,r),{style:a}=y(this,$c)||Z(this,$c,le(this,Gl,cR).call(this));e.append(y(this,$c)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){y(this,$c).remove()}}Zm=new WeakMap,$c=new WeakMap,Nc=new WeakMap,Gl=new WeakSet,cR=function(){const e=Z(this,$c,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",da,{signal:y(this,Nc)._signal});const t=Z(this,Zm,document.createElement("div"));return t.className="buttons",e.append(t),le(this,Gl,dR).call(this),e},uR=function(e,t){let r=0,i=0;for(const s of e){const a=s.y+s.height;if(a<r)continue;const o=s.x+(t?s.width:0);if(a>r){i=o,r=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,r]},dR=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const r=y(this,Nc)._signal;e.addEventListener("contextmenu",da,{signal:r}),e.addEventListener("click",()=>{y(this,Nc).highlightSelection("floating_button")},{signal:r}),y(this,Zm).append(e)};function N0(n,e,t){for(const r of t)e.addEventListener(r,n[r].bind(n))}var tv;class fj{constructor(){oe(this,tv,0)}get id(){return`${HW}${vi(this,tv)._++}`}}tv=new WeakMap;var oh,Jm,ai,lh,t0;const FD=class FD{constructor(){oe(this,lh);oe(this,oh,aj());oe(this,Jm,0);oe(this,ai,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Zt(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:r,size:i,type:s}=e;return le(this,lh,t0).call(this,`${t}_${r}_${i}_${s}`,e)}async getFromUrl(e){return le(this,lh,t0).call(this,e,e)}async getFromBlob(e,t){const r=await t;return le(this,lh,t0).call(this,e,r)}async getFromId(e){y(this,ai)||Z(this,ai,new Map);const t=y(this,ai).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){y(this,ai)||Z(this,ai,new Map);let r=y(this,ai).get(e);if(r?.bitmap)return r.refCounter+=1,r;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${y(this,oh)}_${vi(this,Jm)._++}`,refCounter:1,isSvg:!1},y(this,ai).set(e,r),y(this,ai).set(r.id,r),r}getSvgUrl(e){const t=y(this,ai).get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){y(this,ai)||Z(this,ai,new Map);const t=y(this,ai).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:r}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(r.width,r.height);i.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=i.convertToBlob()}r.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${y(this,oh)}_`)}};oh=new WeakMap,Jm=new WeakMap,ai=new WeakMap,lh=new WeakSet,t0=async function(e,t){y(this,ai)||Z(this,ai,new Map);let r=y(this,ai).get(e);if(r===null)return null;if(r?.bitmap)return r.refCounter+=1,r;try{r||={bitmap:null,id:`image_${y(this,oh)}_${vi(this,Jm)._++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(r.url=t,i=await Xv(t,"blob")):t instanceof File?i=r.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const s=FD._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,u)=>{o.onload=()=>{r.bitmap=o,r.isSvg=!0,c()},a.onload=async()=>{const d=r.svgUrl=a.result;o.src=await s?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=u});a.readAsDataURL(i),await l}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){Xt(i),r=null}return y(this,ai).set(e,r),r&&y(this,ai).set(r.id,r),r};let Dx=FD;var ar,ll,eg,Xn;class pj{constructor(e=128){oe(this,ar,[]);oe(this,ll,!1);oe(this,eg);oe(this,Xn,-1);Z(this,eg,e)}add({cmd:e,undo:t,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),y(this,ll))return;const l={cmd:e,undo:t,post:r,type:s};if(y(this,Xn)===-1){y(this,ar).length>0&&(y(this,ar).length=0),Z(this,Xn,0),y(this,ar).push(l);return}if(a&&y(this,ar)[y(this,Xn)].type===s){o&&(l.undo=y(this,ar)[y(this,Xn)].undo),y(this,ar)[y(this,Xn)]=l;return}const c=y(this,Xn)+1;c===y(this,eg)?y(this,ar).splice(0,1):(Z(this,Xn,c),c<y(this,ar).length&&y(this,ar).splice(c)),y(this,ar).push(l)}undo(){if(y(this,Xn)===-1)return;Z(this,ll,!0);const{undo:e,post:t}=y(this,ar)[y(this,Xn)];e(),t?.(),Z(this,ll,!1),Z(this,Xn,y(this,Xn)-1)}redo(){if(y(this,Xn)<y(this,ar).length-1){Z(this,Xn,y(this,Xn)+1),Z(this,ll,!0);const{cmd:e,post:t}=y(this,ar)[y(this,Xn)];e(),t?.(),Z(this,ll,!1)}}hasSomethingToUndo(){return y(this,Xn)!==-1}hasSomethingToRedo(){return y(this,Xn)<y(this,ar).length-1}cleanType(e){if(y(this,Xn)!==-1){for(let t=y(this,Xn);t>=0;t--)if(y(this,ar)[t].type!==e){y(this,ar).splice(t+1,y(this,Xn)-t),Z(this,Xn,t);return}y(this,ar).length=0,Z(this,Xn,-1)}}destroy(){Z(this,ar,null)}}ar=new WeakMap,ll=new WeakMap,eg=new WeakMap,Xn=new WeakMap;var nv,hR;class E_{constructor(e){oe(this,nv);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Ai.platform;for(const[r,i,s={}]of e)for(const a of r){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const r=this.callbacks.get(le(this,nv,hR).call(this,t));if(!r)return;const{callback:i,options:{bubbles:s=!1,args:a=[],checker:o=null}}=r;o&&!o(e,t)||(i.bind(e,...a,t)(),s||ds(t))}}nv=new WeakSet,hR=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const rv=class rv{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return dj(e),Zt(this,"_colors",e)}convert(e){const t=QE(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[r,i]of this._colors)if(i.every((s,a)=>s===t[a]))return rv._colorsMapping.get(r);return t}getHexCode(e){const t=this._colors.get(e);return t?At.makeHexColor(...t):e}};Xe(rv,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Mx=rv;var ch,Yi,Dr,qr,uh,ro,dh,Ts,cl,zc,hh,Wc,Ta,Xs,jc,tg,ng,fh,rg,Ea,ul,ph,dl,Da,iv,hl,ig,fl,Vc,sg,ag,Ur,vn,io,Gc,og,lg,pl,Ma,so,cg,Es,ht,n0,Ax,fR,pR,r0,mR,gR,_R,Cx,bR,Sx,Px,yR,xi,Ja,vR,wR,kx,xR,pm,Fx;const th=class th{constructor(e,t,r,i,s,a,o,l,c,u,d,h,f){oe(this,ht);oe(this,ch,new AbortController);oe(this,Yi,null);oe(this,Dr,new Map);oe(this,qr,new Map);oe(this,uh,null);oe(this,ro,null);oe(this,dh,null);oe(this,Ts,new pj);oe(this,cl,null);oe(this,zc,null);oe(this,hh,0);oe(this,Wc,new Set);oe(this,Ta,null);oe(this,Xs,null);oe(this,jc,new Set);Xe(this,"_editorUndoBar",null);oe(this,tg,!1);oe(this,ng,!1);oe(this,fh,!1);oe(this,rg,null);oe(this,Ea,null);oe(this,ul,null);oe(this,ph,null);oe(this,dl,!1);oe(this,Da,null);oe(this,iv,new fj);oe(this,hl,!1);oe(this,ig,!1);oe(this,fl,null);oe(this,Vc,null);oe(this,sg,null);oe(this,ag,null);oe(this,Ur,Kt.NONE);oe(this,vn,new Set);oe(this,io,null);oe(this,Gc,null);oe(this,og,null);oe(this,lg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});oe(this,pl,[0,0]);oe(this,Ma,null);oe(this,so,null);oe(this,cg,null);oe(this,Es,null);const p=this._signal=y(this,ch).signal;Z(this,so,e),Z(this,cg,t),Z(this,uh,r),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:p}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:p}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:p}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:p}),i._on("setpreference",this.onSetPreference.bind(this),{signal:p}),i._on("switchannotationeditorparams",g=>this.updateParams(g.type,g.value),{signal:p}),le(this,ht,mR).call(this),le(this,ht,yR).call(this),le(this,ht,Cx).call(this),Z(this,ro,s.annotationStorage),Z(this,rg,s.filterFactory),Z(this,Gc,a),Z(this,ph,o||null),Z(this,tg,l),Z(this,ng,c),Z(this,fh,u),Z(this,ag,d||null),this.viewParameters={realScale:jl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=h||null,this._supportsPinchToZoom=f!==!1}static get _keyboardManager(){const e=th.prototype,t=a=>y(a,so).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),r=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Zt(this,"_keyboardManager",new E_([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&y(a,so).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&y(a,so).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){y(this,Es)?.resolve(),Z(this,Es,null),y(this,ch)?.abort(),Z(this,ch,null),this._signal=null;for(const e of y(this,qr).values())e.destroy();y(this,qr).clear(),y(this,Dr).clear(),y(this,jc).clear(),Z(this,Yi,null),y(this,vn).clear(),y(this,Ts).destroy(),y(this,uh)?.destroy(),y(this,Da)?.hide(),Z(this,Da,null),y(this,Ea)&&(clearTimeout(y(this,Ea)),Z(this,Ea,null)),y(this,Ma)&&(clearTimeout(y(this,Ma)),Z(this,Ma,null)),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return y(this,ag)}get useNewAltTextFlow(){return y(this,ng)}get useNewAltTextWhenAddingImage(){return y(this,fh)}get hcmFilter(){return Zt(this,"hcmFilter",y(this,Gc)?y(this,rg).addHCMFilter(y(this,Gc).foreground,y(this,Gc).background):"none")}get direction(){return Zt(this,"direction",getComputedStyle(y(this,so)).direction)}get highlightColors(){return Zt(this,"highlightColors",y(this,ph)?new Map(y(this,ph).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Zt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),Z(this,zc,e)}setMainHighlightColorPicker(e){Z(this,sg,e)}editAltText(e,t=!1){y(this,uh)?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":Z(this,fh,t);break}}onPageChanging({pageNumber:e}){Z(this,hh,e-1)}focusMainContainer(){y(this,so).focus()}findParent(e,t){for(const r of y(this,qr).values()){const{x:i,y:s,width:a,height:o}=r.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=s&&t<=s+o)return r}return null}disableUserSelect(e=!1){y(this,cg).classList.toggle("noUserSelect",e)}addShouldRescale(e){y(this,jc).add(e)}removeShouldRescale(e){y(this,jc).delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*jl.PDF_TO_CSS_UNITS;for(const t of y(this,jc))t.onScaleChanging();y(this,zc)?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:a}=t,o=t.toString(),c=le(this,ht,n0).call(this,t).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;t.empty();const d=le(this,ht,Ax).call(this,c),h=y(this,Ur)===Kt.NONE,f=()=>{d?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:a,text:o}),h&&this.showAllEditors("highlight",!0,!0)};if(h){this.switchToMode(Kt.HIGHLIGHT,f);return}f()}addToAnnotationStorage(e){!e.isEmpty()&&y(this,ro)&&!y(this,ro).has(e.id)&&y(this,ro).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,y(this,dl)&&(Z(this,dl,!1),le(this,ht,r0).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of y(this,vn))if(t.div.contains(e)){Z(this,Vc,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!y(this,Vc))return;const[e,t]=y(this,Vc);Z(this,Vc,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){le(this,ht,Cx).call(this),le(this,ht,Sx).call(this)}removeEditListeners(){le(this,ht,bR).call(this),le(this,ht,Px).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const r of y(this,Xs))if(r.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const r of y(this,Xs))if(r.isHandlingMimeForPasting(t.type)){r.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),y(this,Yi)?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of y(this,vn)){const i=r.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const a of y(this,Xs))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let r=t.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){Xt(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const l of r){const c=await i.deserialize(l);if(!c)return;s.push(c)}const a=()=>{for(const l of s)le(this,ht,kx).call(this,l);le(this,ht,Fx).call(this,s)},o=()=>{for(const l of s)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){Xt(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),y(this,Ur)!==Kt.NONE&&!this.isEditorHandlingKeyboard&&th._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,y(this,dl)&&(Z(this,dl,!1),le(this,ht,r0).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(le(this,ht,gR).call(this),le(this,ht,Sx).call(this),le(this,ht,xi).call(this,{isEditing:y(this,Ur)!==Kt.NONE,isEmpty:le(this,ht,pm).call(this),hasSomethingToUndo:y(this,Ts).hasSomethingToUndo(),hasSomethingToRedo:y(this,Ts).hasSomethingToRedo(),hasSelectedEditor:!1})):(le(this,ht,_R).call(this),le(this,ht,Px).call(this),le(this,ht,xi).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!y(this,Xs)){Z(this,Xs,e);for(const t of y(this,Xs))le(this,ht,Ja).call(this,t.defaultPropertiesToUpdate)}}getId(){return y(this,iv).id}get currentLayer(){return y(this,qr).get(y(this,hh))}getLayer(e){return y(this,qr).get(e)}get currentPageIndex(){return y(this,hh)}addLayer(e){y(this,qr).set(e.pageIndex,e),y(this,hl)?e.enable():e.disable()}removeLayer(e){y(this,qr).delete(e.pageIndex)}async updateMode(e,t=null,r=!1){if(y(this,Ur)!==e&&!(y(this,Es)&&(await y(this,Es).promise,!y(this,Es)))){if(Z(this,Es,Promise.withResolvers()),Z(this,Ur,e),e===Kt.NONE){this.setEditingState(!1),le(this,ht,wR).call(this),this._editorUndoBar?.hide(),y(this,Es).resolve();return}this.setEditingState(!0),await le(this,ht,vR).call(this),this.unselectAll();for(const i of y(this,qr).values())i.updateMode(e);if(!t){r&&this.addNewEditorFromKeyboard(),y(this,Es).resolve();return}for(const i of y(this,Dr).values())i.annotationElementId===t?(this.setSelected(i),i.enterInEditMode()):i.unselect();y(this,Es).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==y(this,Ur)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(y(this,Xs)){switch(e){case sn.CREATE:this.currentLayer.addNewEditor();return;case sn.HIGHLIGHT_DEFAULT_COLOR:y(this,sg)?.updateColor(t);break;case sn.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(y(this,og)||Z(this,og,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const r of y(this,vn))r.updateParams(e,t);for(const r of y(this,Xs))r.updateDefaultParams(e,t)}}showAllEditors(e,t,r=!1){for(const s of y(this,Dr).values())s.editorType===e&&s.show(t);(y(this,og)?.get(sn.HIGHLIGHT_SHOW_ALL)??!0)!==t&&le(this,ht,Ja).call(this,[[sn.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(y(this,ig)!==e){Z(this,ig,e);for(const t of y(this,qr).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const r of y(this,Dr).values())r.pageIndex===e&&t.push(r);return t}getEditor(e){return y(this,Dr).get(e)}addEditor(e){y(this,Dr).set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(y(this,Ea)&&clearTimeout(y(this,Ea)),Z(this,Ea,setTimeout(()=>{this.focusMainContainer(),Z(this,Ea,null)},0))),y(this,Dr).delete(e.id),this.unselect(e),(!e.annotationElementId||!y(this,Wc).has(e.annotationElementId))&&y(this,ro)?.remove(e.id)}addDeletedAnnotationElement(e){y(this,Wc).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return y(this,Wc).has(e)}removeDeletedAnnotationElement(e){y(this,Wc).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){y(this,Yi)!==e&&(Z(this,Yi,e),e&&le(this,ht,Ja).call(this,e.propertiesToUpdate))}updateUI(e){y(this,ht,xR)===e&&le(this,ht,Ja).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){le(this,ht,Ja).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(y(this,vn).has(e)){y(this,vn).delete(e),e.unselect(),le(this,ht,xi).call(this,{hasSelectedEditor:this.hasSelection});return}y(this,vn).add(e),e.select(),le(this,ht,Ja).call(this,e.propertiesToUpdate),le(this,ht,xi).call(this,{hasSelectedEditor:!0})}setSelected(e){y(this,zc)?.commitOrRemove();for(const t of y(this,vn))t!==e&&t.unselect();y(this,vn).clear(),y(this,vn).add(e),e.select(),le(this,ht,Ja).call(this,e.propertiesToUpdate),le(this,ht,xi).call(this,{hasSelectedEditor:!0})}isSelected(e){return y(this,vn).has(e)}get firstSelectedEditor(){return y(this,vn).values().next().value}unselect(e){e.unselect(),y(this,vn).delete(e),le(this,ht,xi).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return y(this,vn).size!==0}get isEnterHandled(){return y(this,vn).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){y(this,Ts).undo(),le(this,ht,xi).call(this,{hasSomethingToUndo:y(this,Ts).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:le(this,ht,pm).call(this)}),this._editorUndoBar?.hide()}redo(){y(this,Ts).redo(),le(this,ht,xi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:y(this,Ts).hasSomethingToRedo(),isEmpty:le(this,ht,pm).call(this)})}addCommands(e){y(this,Ts).add(e),le(this,ht,xi).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:le(this,ht,pm).call(this)})}cleanUndoStack(e){y(this,Ts).cleanType(e)}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...y(this,vn)],r=()=>{this._editorUndoBar?.show(i,t.length===1?t[0].editorType:t.length);for(const s of t)s.remove()},i=()=>{for(const s of t)le(this,ht,kx).call(this,s)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){y(this,Yi)?.commitOrRemove()}hasSomethingToControl(){return y(this,Yi)||this.hasSelection}selectAll(){for(const e of y(this,vn))e.commit();le(this,ht,Fx).call(this,y(this,Dr).values())}unselectAll(){if(!(y(this,Yi)&&(y(this,Yi).commitOrRemove(),y(this,Ur)!==Kt.NONE))&&!y(this,zc)?.commitOrRemove()&&this.hasSelection){for(const e of y(this,vn))e.unselect();y(this,vn).clear(),le(this,ht,xi).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;y(this,pl)[0]+=e,y(this,pl)[1]+=t;const[i,s]=y(this,pl),a=[...y(this,vn)],o=1e3;y(this,Ma)&&clearTimeout(y(this,Ma)),Z(this,Ma,setTimeout(()=>{Z(this,Ma,null),y(this,pl)[0]=y(this,pl)[1]=0,this.addCommands({cmd:()=>{for(const l of a)y(this,Dr).has(l.id)&&l.translateInPage(i,s)},undo:()=>{for(const l of a)y(this,Dr).has(l.id)&&l.translateInPage(-i,-s)},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Z(this,Ta,new Map);for(const e of y(this,vn))y(this,Ta).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!y(this,Ta))return!1;this.disableUserSelect(!1);const e=y(this,Ta);Z(this,Ta,null);let t=!1;for(const[{x:i,y:s,pageIndex:a},o]of e)o.newX=i,o.newY=s,o.newPageIndex=a,t||=i!==o.savedX||s!==o.savedY||a!==o.savedPageIndex;if(!t)return!1;const r=(i,s,a,o)=>{if(y(this,Dr).has(i.id)){const l=y(this,qr).get(o);l?i._setParentAndPosition(l,s,a):(i.pageIndex=o,i.x=s,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:a,newPageIndex:o}]of e)r(i,s,a,o)},undo:()=>{for(const[i,{savedX:s,savedY:a,savedPageIndex:o}]of e)r(i,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(y(this,Ta))for(const r of y(this,Ta).keys())r.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||y(this,vn).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return y(this,Yi)===e}getActive(){return y(this,Yi)}getMode(){return y(this,Ur)}get imageManager(){return Zt(this,"imageManager",new Dx)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,u=t.rangeCount;c<u;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:r,y:i,width:s,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,u,d,h)=>({x:(u-i)/a,y:1-(c+d-r)/s,width:h/a,height:d/s});break;case"180":o=(c,u,d,h)=>({x:1-(c+d-r)/s,y:1-(u+h-i)/a,width:d/s,height:h/a});break;case"270":o=(c,u,d,h)=>({x:1-(u+h-i)/a,y:(c-r)/s,width:h/a,height:d/s});break;default:o=(c,u,d,h)=>({x:(c-r)/s,y:(u-i)/a,width:d/s,height:h/a});break}const l=[];for(let c=0,u=t.rangeCount;c<u;c++){const d=t.getRangeAt(c);if(!d.collapsed)for(const{x:h,y:f,width:p,height:g}of d.getClientRects())p===0||g===0||l.push(o(h,f,p,g))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(y(this,dh)||Z(this,dh,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){y(this,dh)?.delete(e)}renderAnnotationElement(e){const t=y(this,dh)?.get(e.data.id);if(!t)return;const r=y(this,ro).getRawValue(t);r&&(y(this,Ur)===Kt.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}};ch=new WeakMap,Yi=new WeakMap,Dr=new WeakMap,qr=new WeakMap,uh=new WeakMap,ro=new WeakMap,dh=new WeakMap,Ts=new WeakMap,cl=new WeakMap,zc=new WeakMap,hh=new WeakMap,Wc=new WeakMap,Ta=new WeakMap,Xs=new WeakMap,jc=new WeakMap,tg=new WeakMap,ng=new WeakMap,fh=new WeakMap,rg=new WeakMap,Ea=new WeakMap,ul=new WeakMap,ph=new WeakMap,dl=new WeakMap,Da=new WeakMap,iv=new WeakMap,hl=new WeakMap,ig=new WeakMap,fl=new WeakMap,Vc=new WeakMap,sg=new WeakMap,ag=new WeakMap,Ur=new WeakMap,vn=new WeakMap,io=new WeakMap,Gc=new WeakMap,og=new WeakMap,lg=new WeakMap,pl=new WeakMap,Ma=new WeakMap,so=new WeakMap,cg=new WeakMap,Es=new WeakMap,ht=new WeakSet,n0=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Ax=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const r of y(this,qr).values())if(r.hasTextLayer(e))return r;return null},fR=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=le(this,ht,n0).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(r);i&&(y(this,Da)||Z(this,Da,new hj(this)),y(this,Da).show(r,i,this.direction==="ltr"))},pR=function(){const e=document.getSelection();if(!e||e.isCollapsed){y(this,io)&&(y(this,Da)?.hide(),Z(this,io,null),le(this,ht,xi).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===y(this,io))return;const i=le(this,ht,n0).call(this,e).closest(".textLayer");if(!i){y(this,io)&&(y(this,Da)?.hide(),Z(this,io,null),le(this,ht,xi).call(this,{hasSelectedText:!1}));return}if(y(this,Da)?.hide(),Z(this,io,t),le(this,ht,xi).call(this,{hasSelectedText:!0}),!(y(this,Ur)!==Kt.HIGHLIGHT&&y(this,Ur)!==Kt.NONE)&&(y(this,Ur)===Kt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),Z(this,dl,this.isShiftKeyDown),!this.isShiftKeyDown)){const s=y(this,Ur)===Kt.HIGHLIGHT?le(this,ht,Ax).call(this,i):null;s?.toggleDrawing();const a=new AbortController,o=this.combinedSignal(a),l=c=>{c.type==="pointerup"&&c.button!==0||(a.abort(),s?.toggleDrawing(!0),c.type==="pointerup"&&le(this,ht,r0).call(this,"main_toolbar"))};window.addEventListener("pointerup",l,{signal:o}),window.addEventListener("blur",l,{signal:o})}},r0=function(e=""){y(this,Ur)===Kt.HIGHLIGHT?this.highlightSelection(e):y(this,tg)&&le(this,ht,fR).call(this)},mR=function(){document.addEventListener("selectionchange",le(this,ht,pR).bind(this),{signal:this._signal})},gR=function(){if(y(this,ul))return;Z(this,ul,new AbortController);const e=this.combinedSignal(y(this,ul));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},_R=function(){y(this,ul)?.abort(),Z(this,ul,null)},Cx=function(){if(y(this,fl))return;Z(this,fl,new AbortController);const e=this.combinedSignal(y(this,fl));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},bR=function(){y(this,fl)?.abort(),Z(this,fl,null)},Sx=function(){if(y(this,cl))return;Z(this,cl,new AbortController);const e=this.combinedSignal(y(this,cl));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Px=function(){y(this,cl)?.abort(),Z(this,cl,null)},yR=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},xi=function(e){Object.entries(e).some(([r,i])=>y(this,lg)[r]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(y(this,lg),e)}),y(this,Ur)===Kt.HIGHLIGHT&&e.hasSelectedEditor===!1&&le(this,ht,Ja).call(this,[[sn.HIGHLIGHT_FREE,!0]]))},Ja=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},vR=async function(){if(!y(this,hl)){Z(this,hl,!0);const e=[];for(const t of y(this,qr).values())e.push(t.enable());await Promise.all(e);for(const t of y(this,Dr).values())t.enable()}},wR=function(){if(this.unselectAll(),y(this,hl)){Z(this,hl,!1);for(const e of y(this,qr).values())e.disable();for(const e of y(this,Dr).values())e.disable()}},kx=function(e){const t=y(this,qr).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},xR=function(){let e=null;for(e of y(this,vn));return e},pm=function(){if(y(this,Dr).size===0)return!0;if(y(this,Dr).size===1)for(const e of y(this,Dr).values())return e.isEmpty();return!1},Fx=function(e){for(const t of y(this,vn))t.unselect();y(this,vn).clear();for(const t of e)t.isEmpty()||(y(this,vn).add(t),t.select());le(this,ht,xi).call(this,{hasSelectedEditor:this.hasSelection})},Xe(th,"TRANSLATE_SMALL",1),Xe(th,"TRANSLATE_BIG",10);let Gu=th;var Lr,Aa,Ys,mh,Ca,Qi,gh,Sa,$i,ao,qc,Pa,ml,la,mm,i0;const Xi=class Xi{constructor(e){oe(this,la);oe(this,Lr,null);oe(this,Aa,!1);oe(this,Ys,null);oe(this,mh,null);oe(this,Ca,null);oe(this,Qi,null);oe(this,gh,!1);oe(this,Sa,null);oe(this,$i,null);oe(this,ao,null);oe(this,qc,null);oe(this,Pa,!1);Z(this,$i,e),Z(this,Pa,e._uiManager.useNewAltTextFlow),y(Xi,ml)||Z(Xi,ml,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Xi._l10n??=e}async render(){const e=Z(this,Ys,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=Z(this,mh,document.createElement("span"));e.append(t),y(this,Pa)?(e.classList.add("new"),e.setAttribute("data-l10n-id",y(Xi,ml).missing),t.setAttribute("data-l10n-id",y(Xi,ml)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=y(this,$i)._uiManager._signal;e.addEventListener("contextmenu",da,{signal:r}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),y(this,$i)._uiManager.editAltText(y(this,$i)),y(this,Pa)&&y(this,$i)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:y(this,la,mm)}})};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(Z(this,gh,!0),i(s))},{signal:r}),await le(this,la,i0).call(this),e}finish(){y(this,Ys)&&(y(this,Ys).focus({focusVisible:y(this,gh)}),Z(this,gh,!1))}isEmpty(){return y(this,Pa)?y(this,Lr)===null:!y(this,Lr)&&!y(this,Aa)}hasData(){return y(this,Pa)?y(this,Lr)!==null||!!y(this,ao):this.isEmpty()}get guessedText(){return y(this,ao)}async setGuessedText(e){y(this,Lr)===null&&(Z(this,ao,e),Z(this,qc,await Xi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),le(this,la,i0).call(this))}toggleAltTextBadge(e=!1){if(!y(this,Pa)||y(this,Lr)){y(this,Sa)?.remove(),Z(this,Sa,null);return}if(!y(this,Sa)){const t=Z(this,Sa,document.createElement("div"));t.className="noAltTextBadge",y(this,$i).div.append(t)}y(this,Sa).classList.toggle("hidden",!e)}serialize(e){let t=y(this,Lr);return!e&&y(this,ao)===t&&(t=y(this,qc)),{altText:t,decorative:y(this,Aa),guessedText:y(this,ao),textWithDisclaimer:y(this,qc)}}get data(){return{altText:y(this,Lr),decorative:y(this,Aa)}}set data({altText:e,decorative:t,guessedText:r,textWithDisclaimer:i,cancel:s=!1}){r&&(Z(this,ao,r),Z(this,qc,i)),!(y(this,Lr)===e&&y(this,Aa)===t)&&(s||(Z(this,Lr,e),Z(this,Aa,t)),le(this,la,i0).call(this))}toggle(e=!1){y(this,Ys)&&(!e&&y(this,Qi)&&(clearTimeout(y(this,Qi)),Z(this,Qi,null)),y(this,Ys).disabled=!e)}shown(){y(this,$i)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:y(this,la,mm)}})}destroy(){y(this,Ys)?.remove(),Z(this,Ys,null),Z(this,mh,null),Z(this,Ca,null),y(this,Sa)?.remove(),Z(this,Sa,null)}};Lr=new WeakMap,Aa=new WeakMap,Ys=new WeakMap,mh=new WeakMap,Ca=new WeakMap,Qi=new WeakMap,gh=new WeakMap,Sa=new WeakMap,$i=new WeakMap,ao=new WeakMap,qc=new WeakMap,Pa=new WeakMap,ml=new WeakMap,la=new WeakSet,mm=function(){return y(this,Lr)&&"added"||y(this,Lr)===null&&this.guessedText&&"review"||"missing"},i0=async function(){const e=y(this,Ys);if(!e)return;if(y(this,Pa)){if(e.classList.toggle("done",!!y(this,Lr)),e.setAttribute("data-l10n-id",y(Xi,ml)[y(this,la,mm)]),y(this,mh)?.setAttribute("data-l10n-id",y(Xi,ml)[`${y(this,la,mm)}-label`]),!y(this,Lr)){y(this,Ca)?.remove();return}}else{if(!y(this,Lr)&&!y(this,Aa)){e.classList.remove("done"),y(this,Ca)?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=y(this,Ca);if(!t){Z(this,Ca,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${y(this,$i).id}`;const i=100,s=y(this,$i)._uiManager._signal;s.addEventListener("abort",()=>{clearTimeout(y(this,Qi)),Z(this,Qi,null)},{once:!0}),e.addEventListener("mouseenter",()=>{Z(this,Qi,setTimeout(()=>{Z(this,Qi,null),y(this,Ca).classList.add("show"),y(this,$i)._reportTelemetry({action:"alt_text_tooltip"})},i))},{signal:s}),e.addEventListener("mouseleave",()=>{y(this,Qi)&&(clearTimeout(y(this,Qi)),Z(this,Qi,null)),y(this,Ca)?.classList.remove("show")},{signal:s})}y(this,Aa)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=y(this,Lr)),t.parentNode||e.append(t),y(this,$i).getImageForAltText()?.setAttribute("aria-describedby",t.id)},oe(Xi,ml,null),Xe(Xi,"_l10n",null);let z0=Xi;var ug,Hc,dg,hg,fg,pg,mg,_h,oo,Kc,gl,Io,TR,ER,Ix;const ID=class ID{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:r=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:a=null,signal:o}){oe(this,Io);oe(this,ug);oe(this,Hc,!1);oe(this,dg,null);oe(this,hg);oe(this,fg);oe(this,pg);oe(this,mg);oe(this,_h);oe(this,oo,null);oe(this,Kc);oe(this,gl,null);Z(this,ug,e),Z(this,dg,r),Z(this,hg,t),Z(this,fg,i),Z(this,pg,s),Z(this,mg,a),Z(this,Kc,new AbortController),Z(this,_h,AbortSignal.any([o,y(this,Kc).signal])),e.addEventListener("touchstart",le(this,Io,TR).bind(this),{passive:!1,signal:y(this,_h)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Zt(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){y(this,Kc)?.abort(),Z(this,Kc,null)}};ug=new WeakMap,Hc=new WeakMap,dg=new WeakMap,hg=new WeakMap,fg=new WeakMap,pg=new WeakMap,mg=new WeakMap,_h=new WeakMap,oo=new WeakMap,Kc=new WeakMap,gl=new WeakMap,Io=new WeakSet,TR=function(e){var i,s,a;if((i=y(this,hg))!=null&&i.call(this)||e.touches.length<2)return;if(!y(this,gl)){Z(this,gl,new AbortController);const o=AbortSignal.any([y(this,_h),y(this,gl).signal]),l=y(this,ug),c={signal:o,passive:!1};l.addEventListener("touchmove",le(this,Io,ER).bind(this),c),l.addEventListener("touchend",le(this,Io,Ix).bind(this),c),l.addEventListener("touchcancel",le(this,Io,Ix).bind(this),c),(s=y(this,fg))==null||s.call(this)}if(ds(e),e.touches.length!==2||(a=y(this,dg))!=null&&a.call(this)){Z(this,oo,null);return}let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]),Z(this,oo,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:r.screenX,touch1Y:r.screenY})},ER=function(e){var x;if(!y(this,oo)||e.touches.length!==2)return;let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]);const{screenX:i,screenY:s}=t,{screenX:a,screenY:o}=r,l=y(this,oo),{touch0X:c,touch0Y:u,touch1X:d,touch1Y:h}=l,f=d-c,p=h-u,g=a-i,b=o-s,_=Math.hypot(g,b)||1,m=Math.hypot(f,p)||1;if(!y(this,Hc)&&Math.abs(m-_)<=ID.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=s,l.touch1X=a,l.touch1Y=o,e.preventDefault(),!y(this,Hc)){Z(this,Hc,!0);return}const v=[(i+a)/2,(s+o)/2];(x=y(this,pg))==null||x.call(this,v,m,_)},Ix=function(e){var t;y(this,gl).abort(),Z(this,gl,null),(t=y(this,mg))==null||t.call(this),y(this,oo)&&(e.preventDefault(),Z(this,oo,null),Z(this,Hc,!1))};let W0=ID;var Xc,Qs,Rn,bh,_l,gg,Yc,Hr,Qc,lo,bl,_g,Zc,Zi,bg,Jc,co,ka,yh,vh,Ds,eu,yg,sv,Ut,Ox,vg,Ux,s0,DR,MR,Lx,a0,Rx,AR,CR,SR,Bx,PR,$x,kR,FR,IR,Nx,gm;const tn=class tn{constructor(e){oe(this,Ut);oe(this,Xc,null);oe(this,Qs,null);oe(this,Rn,null);oe(this,bh,!1);oe(this,_l,null);oe(this,gg,"");oe(this,Yc,!1);oe(this,Hr,null);oe(this,Qc,null);oe(this,lo,null);oe(this,bl,null);oe(this,_g,"");oe(this,Zc,!1);oe(this,Zi,null);oe(this,bg,!1);oe(this,Jc,!1);oe(this,co,!1);oe(this,ka,null);oe(this,yh,0);oe(this,vh,0);oe(this,Ds,null);oe(this,eu,null);Xe(this,"_editToolbar",null);Xe(this,"_initialOptions",Object.create(null));Xe(this,"_initialData",null);Xe(this,"_isVisible",!0);Xe(this,"_uiManager",null);Xe(this,"_focusEventsAllowed",!0);oe(this,yg,!1);oe(this,sv,tn._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=tn.prototype._resizeWithKeyboard,t=Gu.TRANSLATE_SMALL,r=Gu.TRANSLATE_BIG;return Zt(this,"_resizerKeyboardManager",new E_([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],tn.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Zt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new mj({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(tn._l10n??=e,tn._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),tn._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);tn._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Pn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return y(this,yg)}set _isDraggable(e){Z(this,yg,e),this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=y(this,sv)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):le(this,Ut,gm).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(y(this,Zc)?Z(this,Zc,!1):this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,i){const[s,a]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(e+r)/s,this.y=(t+i)/a,this.fixAndSetPosition()}translate(e,t){le(this,Ut,Ox).call(this,this.parentDimensions,e,t)}translateInPage(e,t){y(this,Zi)||Z(this,Zi,[this.x,this.y,this.width,this.height]),le(this,Ut,Ox).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){y(this,Zi)||Z(this,Zi,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:h}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,h)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:u}=r;u.left=`${(100*a).toFixed(2)}%`,u.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),r.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!y(this,Zi)&&(y(this,Zi)[0]!==this.x||y(this,Zi)[1]!==this.y)}get _hasBeenResized(){return!!y(this,Zi)&&(y(this,Zi)[2]!==this.width||y(this,Zi)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:r}=tn,i=r/e,s=r/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[r,i]}=this;let{x:s,y:a,width:o,height:l}=this;if(o*=r,l*=i,s*=r,a*=i,this._mustFixPosition)switch(e){case 0:s=Math.max(0,Math.min(r-o,s)),a=Math.max(0,Math.min(i-l,a));break;case 90:s=Math.max(0,Math.min(r-l,s)),a=Math.min(i,Math.max(o,a));break;case 180:s=Math.min(r,Math.max(o,s)),a=Math.min(i,Math.max(l,a));break;case 270:s=Math.min(r,Math.max(l,s)),a=Math.max(0,Math.min(i-o,a));break}this.x=s/=r,this.y=a/=i;const[c,u]=this.getBaseTranslation();s+=c,a+=u,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var r;return le(r=tn,vg,Ux).call(r,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var r;return le(r=tn,vg,Ux).call(r,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(e,t){const[r,i]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*e/r).toFixed(2)}%`,y(this,Yc)||(s.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:r}=e,i=r.endsWith("%"),s=!y(this,Yc)&&t.endsWith("%");if(i&&s)return;const[a,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(r)/a).toFixed(2)}%`),!y(this,Yc)&&!s&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){y(this,Rn)?.finish()}async addEditToolbar(){return this._editToolbar||y(this,Jc)?this._editToolbar:(this._editToolbar=new Tx(this),this.div.append(this._editToolbar.render()),y(this,Rn)&&await this._editToolbar.addAltText(y(this,Rn)),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,y(this,Rn)?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){y(this,Rn)||(z0.initialize(tn._l10n),Z(this,Rn,new z0(this)),y(this,Xc)&&(y(this,Rn).data=y(this,Xc),Z(this,Xc,null)),await this.addEditToolbar())}get altTextData(){return y(this,Rn)?.data}set altTextData(e){y(this,Rn)&&(y(this,Rn).data=e)}get guessedAltText(){return y(this,Rn)?.guessedText}async setGuessedAltText(e){await y(this,Rn)?.setGuessedText(e)}serializeAltText(e){return y(this,Rn)?.serialize(e)}hasAltText(){return!!y(this,Rn)&&!y(this,Rn).isEmpty()}hasAltTextData(){return y(this,Rn)?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=y(this,bh)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),le(this,Ut,$x).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[r,i]=this.getInitialTranslation();return this.translate(r,i),N0(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(y(this,eu)||Z(this,eu,new W0({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:le(this,Ut,AR).bind(this),onPinching:le(this,Ut,CR).bind(this),onPinchEnd:le(this,Ut,SR).bind(this),signal:this._uiManager._signal}))),this._uiManager._editorUndoBar?.hide(),this.div}pointerdown(e){const{isMac:t}=Ai.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(Z(this,Zc,!0),this._isDraggable){le(this,Ut,PR).call(this,e);return}le(this,Ut,Bx).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){y(this,ka)&&clearTimeout(y(this,ka)),Z(this,ka,setTimeout(()=>{Z(this,ka,null),this.parent?.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,r=this.rotation){const i=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/i,u=t/i,d=this.x*s,h=this.y*a,f=this.width*s,p=this.height*a;switch(r){case 0:return[d+c+o,a-h-u-p+l,d+c+f+o,a-h-u+l];case 90:return[d+u+o,a-h+c+l,d+u+p+o,a-h+c+f+l];case 180:return[d-c-f+o,a-h+u+l,d-c+o,a-h+u+p+l];case 270:return[d-u-p+o,a-h-c-f+l,d-u+o,a-h-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[r,i,s,a]=e,o=s-r,l=a-i;switch(this.rotation){case 0:return[r,t-a,o,l];case 90:return[r,t-i,l,o];case 180:return[s,t-i,o,l];case 270:return[s,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){Z(this,Jc,!0)}disableEditMode(){Z(this,Jc,!1)}isInEditMode(){return y(this,Jc)}shouldGetKeyboardEvents(){return y(this,co)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:r,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return t<a&&i>0&&e<s&&r>0}rebuild(){le(this,Ut,$x).call(this)}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){Pn("An editor must be serializable")}static async deserialize(e,t,r){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r});i.rotation=e.rotation,Z(i,Xc,e.accessibilityData);const[s,a]=i.pageDimensions,[o,l,c,u]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/s,i.y=l/a,i.width=c/s,i.height=u/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(y(this,bl)?.abort(),Z(this,bl,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),y(this,ka)&&(clearTimeout(y(this,ka)),Z(this,ka,null)),le(this,Ut,gm).call(this),this.removeEditToolbar(),y(this,Ds)){for(const e of y(this,Ds).values())clearTimeout(e);Z(this,Ds,null)}this.parent=null,y(this,eu)?.destroy(),Z(this,eu,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(le(this,Ut,DR).call(this),y(this,Hr).classList.remove("hidden"),N0(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),Z(this,lo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=y(this,Hr).children;if(!y(this,Qs)){Z(this,Qs,Array.from(t));const a=le(this,Ut,kR).bind(this),o=le(this,Ut,FR).bind(this),l=this._uiManager._signal;for(const c of y(this,Qs)){const u=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",le(this,Ut,IR).bind(this,u),{signal:l}),c.setAttribute("data-l10n-id",tn._l10nResizer[u])}}const r=y(this,Qs)[0];let i=0;for(const a of t){if(a===r)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(y(this,Qs).length/4);if(s!==i){if(s<i)for(let o=0;o<i-s;o++)y(this,Hr).append(y(this,Hr).firstChild);else if(s>i)for(let o=0;o<s-i;o++)y(this,Hr).firstChild.before(y(this,Hr).lastChild);let a=0;for(const o of t){const c=y(this,Qs)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",tn._l10nResizer[c])}}le(this,Ut,Nx).call(this,0),Z(this,co,!0),y(this,Hr).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){y(this,co)&&le(this,Ut,Rx).call(this,y(this,_g),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){le(this,Ut,gm).call(this),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),y(this,Rn)?.toggleAltTextBadge(!1)}unselect(){y(this,Hr)?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),y(this,Rn)?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return y(this,bg)}set isEditing(e){Z(this,bg,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){Z(this,Yc,!0);const r=e/t,{style:i}=this.div;i.aspectRatio=r,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){y(this,Ds)||Z(this,Ds,new Map);const{action:r}=e;let i=y(this,Ds).get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),y(this,Ds).delete(r),y(this,Ds).size===0&&Z(this,Ds,null)},tn._telemetryTimeout),y(this,Ds).set(r,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),Z(this,bh,!1)}disable(){this.div&&(this.div.tabIndex=-1),Z(this,bh,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Xc=new WeakMap,Qs=new WeakMap,Rn=new WeakMap,bh=new WeakMap,_l=new WeakMap,gg=new WeakMap,Yc=new WeakMap,Hr=new WeakMap,Qc=new WeakMap,lo=new WeakMap,bl=new WeakMap,_g=new WeakMap,Zc=new WeakMap,Zi=new WeakMap,bg=new WeakMap,Jc=new WeakMap,co=new WeakMap,ka=new WeakMap,yh=new WeakMap,vh=new WeakMap,Ds=new WeakMap,eu=new WeakMap,yg=new WeakMap,sv=new WeakMap,Ut=new WeakSet,Ox=function([e,t],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},vg=new WeakSet,Ux=function(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},s0=function(e){switch(e){case 90:{const[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}},DR=function(){if(y(this,Hr))return;Z(this,Hr,document.createElement("div")),y(this,Hr).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const r of e){const i=document.createElement("div");y(this,Hr).append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",le(this,Ut,MR).bind(this,r),{signal:t}),i.addEventListener("contextmenu",da,{signal:t}),i.tabIndex=-1}this.div.prepend(y(this,Hr))},MR=function(e,t){t.preventDefault();const{isMac:r}=Ai.platform;if(t.button!==0||t.ctrlKey&&r)return;y(this,Rn)?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,Z(this,Qc,[t.screenX,t.screenY]);const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",le(this,Ut,Rx).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",ds,{passive:!1,signal:a}),window.addEventListener("contextmenu",da,{signal:a}),Z(this,lo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{s.abort(),this.parent.togglePointerEvents(!0),y(this,Rn)?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=l,le(this,Ut,a0).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},Lx=function(e,t,r,i){this.width=r,this.height=i,this.x=e,this.y=t;const[s,a]=this.parentDimensions;this.setDims(s*r,a*i),this.fixAndSetPosition(),this._onResized()},a0=function(){if(!y(this,lo))return;const{savedX:e,savedY:t,savedWidth:r,savedHeight:i}=y(this,lo);Z(this,lo,null);const s=this.x,a=this.y,o=this.width,l=this.height;s===e&&a===t&&o===r&&l===i||this.addCommands({cmd:le(this,Ut,Lx).bind(this,s,a,o,l),undo:le(this,Ut,Lx).bind(this,e,t,r,i),mustExec:!0})},Rx=function(e,t){const[r,i]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,c=tn.MIN_SIZE/r,u=tn.MIN_SIZE/i,d=le(this,Ut,s0).call(this,this.rotation),h=(B,$)=>[d[0]*B+d[2]*$,d[1]*B+d[3]*$],f=le(this,Ut,s0).call(this,360-this.rotation),p=(B,$)=>[f[0]*B+f[2]*$,f[1]*B+f[3]*$];let g,b,_=!1,m=!1;switch(e){case"topLeft":_=!0,g=(B,$)=>[0,0],b=(B,$)=>[B,$];break;case"topMiddle":g=(B,$)=>[B/2,0],b=(B,$)=>[B/2,$];break;case"topRight":_=!0,g=(B,$)=>[B,0],b=(B,$)=>[0,$];break;case"middleRight":m=!0,g=(B,$)=>[B,$/2],b=(B,$)=>[0,$/2];break;case"bottomRight":_=!0,g=(B,$)=>[B,$],b=(B,$)=>[0,0];break;case"bottomMiddle":g=(B,$)=>[B/2,$],b=(B,$)=>[B/2,0];break;case"bottomLeft":_=!0,g=(B,$)=>[0,$],b=(B,$)=>[B,0];break;case"middleLeft":m=!0,g=(B,$)=>[0,$/2],b=(B,$)=>[B,$/2];break}const v=g(o,l),x=b(o,l);let w=h(...x);const T=tn._round(s+w[0]),E=tn._round(a+w[1]);let A=1,M=1,F,G;if(t.fromKeyboard)({deltaX:F,deltaY:G}=t);else{const{screenX:B,screenY:$}=t,[X,V]=y(this,Qc);[F,G]=this.screenToPageTranslation(B-X,$-V),y(this,Qc)[0]=B,y(this,Qc)[1]=$}if([F,G]=p(F/r,G/i),_){const B=Math.hypot(o,l);A=M=Math.max(Math.min(Math.hypot(x[0]-v[0]-F,x[1]-v[1]-G)/B,1/o,1/l),c/o,u/l)}else m?A=Math.max(c,Math.min(1,Math.abs(x[0]-v[0]-F)))/o:M=Math.max(u,Math.min(1,Math.abs(x[1]-v[1]-G)))/l;const S=tn._round(o*A),I=tn._round(l*M);w=h(...b(S,I));const C=T-w[0],H=E-w[1];y(this,Zi)||Z(this,Zi,[this.x,this.y,this.width,this.height]),this.width=S,this.height=I,this.x=C,this.y=H,this.setDims(r*S,i*I),this.fixAndSetPosition(),this._onResizing()},AR=function(){Z(this,lo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),y(this,Rn)?.toggle(!1),this.parent.togglePointerEvents(!1)},CR=function(e,t,r){let s=.7*(r/t)+1-.7;if(s===1)return;const a=le(this,Ut,s0).call(this,this.rotation),o=(T,E)=>[a[0]*T+a[2]*E,a[1]*T+a[3]*E],[l,c]=this.parentDimensions,u=this.x,d=this.y,h=this.width,f=this.height,p=tn.MIN_SIZE/l,g=tn.MIN_SIZE/c;s=Math.max(Math.min(s,1/h,1/f),p/h,g/f);const b=tn._round(h*s),_=tn._round(f*s);if(b===h&&_===f)return;y(this,Zi)||Z(this,Zi,[u,d,h,f]);const m=o(h/2,f/2),v=tn._round(u+m[0]),x=tn._round(d+m[1]),w=o(b/2,_/2);this.x=v-w[0],this.y=x-w[1],this.width=b,this.height=_,this.setDims(l*b,c*_),this.fixAndSetPosition(),this._onResizing()},SR=function(){y(this,Rn)?.toggle(!0),this.parent.togglePointerEvents(!0),le(this,Ut,a0).call(this)},Bx=function(e){const{isMac:t}=Ai.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},PR=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let r=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:s},o=c=>{i.abort(),Z(this,_l,null),Z(this,Zc,!1),this._uiManager.endDragSession()||le(this,Ut,Bx).call(this,c),r&&this._onStopDragging()};t&&(Z(this,yh,e.clientX),Z(this,vh,e.clientY),Z(this,_l,e.pointerId),Z(this,gg,e.pointerType),window.addEventListener("pointermove",c=>{r||(r=!0,this._onStartDragging());const{clientX:u,clientY:d,pointerId:h}=c;if(h!==y(this,_l)){ds(c);return}const[f,p]=this.screenToPageTranslation(u-y(this,yh),d-y(this,vh));Z(this,yh,u),Z(this,vh,d),this._uiManager.dragSelectedEditors(f,p)},a),window.addEventListener("touchmove",ds,a),window.addEventListener("pointerdown",c=>{c.pointerType===y(this,gg)&&(y(this,eu)||c.isPrimary)&&o(c),ds(c)},a));const l=c=>{if(!y(this,_l)||y(this,_l)===c.pointerId){o(c);return}ds(c)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},$x=function(){if(y(this,bl)||!this.div)return;Z(this,bl,new AbortController);const e=this._uiManager.combinedSignal(y(this,bl));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},kR=function(e){tn._resizerKeyboardManager.exec(this,e)},FR=function(e){y(this,co)&&e.relatedTarget?.parentNode!==y(this,Hr)&&le(this,Ut,gm).call(this)},IR=function(e){Z(this,_g,y(this,co)?e:"")},Nx=function(e){if(y(this,Qs))for(const t of y(this,Qs))t.tabIndex=e},gm=function(){Z(this,co,!1),le(this,Ut,Nx).call(this,-1),le(this,Ut,a0).call(this)},oe(tn,vg),Xe(tn,"_l10n",null),Xe(tn,"_l10nResizer",null),Xe(tn,"_borderLineWidth",-1),Xe(tn,"_colorManager",new Mx),Xe(tn,"_zIndex",1),Xe(tn,"_telemetryTimeout",1e3);let Qn=tn;class mj extends Qn{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const rF=3285377520,vs=4294901760,va=65535;class OR{constructor(e){this.h1=e?e&4294967295:rF,this.h2=e?e&4294967295:rF}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let g=0,b=e.length;g<b;g++){const _=e.charCodeAt(g);_<=255?t[r++]=_:(t[r++]=_>>>8,t[r++]=_&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=r>>2,s=r-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,l=0,c=this.h1,u=this.h2;const d=3432918353,h=461845907,f=d&va,p=h&va;for(let g=0;g<i;g++)g&1?(o=a[g],o=o*d&vs|o*f&va,o=o<<15|o>>>17,o=o*h&vs|o*p&va,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[g],l=l*d&vs|l*f&va,l=l<<15|l>>>17,l=l*h&vs|l*p&va,u^=l,u=u<<13|u>>>19,u=u*5+3864292196);switch(o=0,s){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*d&vs|o*f&va,o=o<<15|o>>>17,o=o*h&vs|o*p&va,i&1?c^=o:u^=o}this.h1=c,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&vs|e*36045&va,t=t*4283543511&vs|((t<<16|e>>>16)*2950163797&vs)>>>16,e^=t>>>1,e=e*444984403&vs|e*60499&va,t=t*3301882366&vs|((t<<16|e>>>16)*3120437893&vs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const zx=Object.freeze({map:null,hash:"",transfer:void 0});var tu,nu,Rr,av,UR;class ZE{constructor(){oe(this,av);oe(this,tu,!1);oe(this,nu,null);oe(this,Rr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const r=y(this,Rr).get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return y(this,Rr).get(e)}remove(e){if(y(this,Rr).delete(e),y(this,Rr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of y(this,Rr).values())if(t instanceof Qn)return;this.onAnnotationEditor(null)}}setValue(e,t){const r=y(this,Rr).get(e);let i=!1;if(r!==void 0)for(const[s,a]of Object.entries(t))r[s]!==a&&(i=!0,r[s]=a);else i=!0,y(this,Rr).set(e,t);i&&le(this,av,UR).call(this),t instanceof Qn&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return y(this,Rr).has(e)}getAll(){return y(this,Rr).size>0?qE(y(this,Rr)):null}setAll(e){for(const[t,r]of Object.entries(e))this.setValue(t,r)}get size(){return y(this,Rr).size}resetModified(){y(this,tu)&&(Z(this,tu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new LR(this)}get serializable(){if(y(this,Rr).size===0)return zx;const e=new Map,t=new OR,r=[],i=Object.create(null);let s=!1;for(const[a,o]of y(this,Rr)){const l=o instanceof Qn?o.serialize(!1,i):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),s||=!!l.bitmap)}if(s)for(const a of e.values())a.bitmap&&r.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:zx}get editorStats(){let e=null;const t=new Map;for(const r of y(this,Rr).values()){if(!(r instanceof Qn))continue;const i=r.telemetryFinalData;if(!i)continue;const{type:s}=i;t.has(s)||t.set(s,Object.getPrototypeOf(r).constructor),e||=Object.create(null);const a=e[s]||=new Map;for(const[o,l]of Object.entries(i)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const u=c.get(l)??0;c.set(l,u+1)}}for(const[r,i]of t)e[r]=i.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){Z(this,nu,null)}get modifiedIds(){if(y(this,nu))return y(this,nu);const e=[];for(const t of y(this,Rr).values())!(t instanceof Qn)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return Z(this,nu,{ids:new Set(e),hash:e.join(",")})}}tu=new WeakMap,nu=new WeakMap,Rr=new WeakMap,av=new WeakSet,UR=function(){y(this,tu)||(Z(this,tu,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var wg;class LR extends ZE{constructor(t){super();oe(this,wg);const{map:r,hash:i,transfer:s}=t.serializable,a=structuredClone(r,s?{transfer:s}:null);Z(this,wg,{map:a,hash:i,transfer:s})}get print(){Pn("Should not call PrintAnnotationStorage.print")}get serializable(){return y(this,wg)}get modifiedIds(){return Zt(this,"modifiedIds",{ids:new Set,hash:""})}}wg=new WeakMap;var wh;class gj{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){oe(this,wh,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),y(this,wh).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||y(this,wh).has(e.loadedName))){if(_r(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:i,style:s}=e,a=new FontFace(r,i,s);this.addNativeFontFace(a);try{await a.load(),y(this,wh).add(r),t?.(e)}catch{Xt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Pn("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw Xt(`Failed to load font '${r.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Zt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(hi||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Zt(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(_r(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,i={done:!1,complete:t,callback:e};return r.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Zt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(x,w){return x.charCodeAt(w)<<24|x.charCodeAt(w+1)<<16|x.charCodeAt(w+2)<<8|x.charCodeAt(w+3)&255}function i(x,w,T,E){const A=x.substring(0,w),M=x.substring(w+T);return A+E+M}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function u(x,w){if(++c>30){Xt("Load test font never loaded."),w();return}if(l.font="30px "+x,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){w();return}setTimeout(u.bind(null,x,w))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=i(h,976,d.length,d);const p=16,g=1482184792;let b=r(h,p);for(s=0,a=d.length-3;s<a;s+=4)b=b-g+r(d,s)|0;s<d.length&&(b=b-g+r(d+"XXX",s)|0),h=i(h,p,4,tj(b));const _=`url(data:font/opentype;base64,${btoa(h)});`,m=`@font-face {font-family:"${d}";src:${_}}`;this.insertRule(m);const v=this._document.createElement("div");v.style.visibility="hidden",v.style.width=v.style.height="10px",v.style.position="absolute",v.style.top=v.style.left="0px";for(const x of[e.loadedName,d]){const w=this._document.createElement("span");w.textContent="Hi",w.style.fontFamily=x,v.append(w)}this._document.body.append(v),u(d,()=>{v.remove(),t.complete()})}}wh=new WeakMap;class _j{constructor(e,{disableFontFace:t=!1,fontExtraProperties:r=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this.disableFontFace=t===!0,this.fontExtraProperties=r===!0,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${oj(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const r=this.loadedName+"_path_"+t;let i;try{i=e.get(r)}catch(a){Xt(`getPathGenerator - ignoring character: "${a}".`)}const s=new Path2D(i||"");return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[t]=s}}const fy={DATA:1,ERROR:2},gr={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function iF(){}function Ri(n){if(n instanceof Wl||n instanceof vx||n instanceof Vm||n instanceof eF||n instanceof $0||n instanceof c2)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Pn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Wl(n.message);case"InvalidPDFException":return new vx(n.message);case"MissingPDFException":return new Vm(n.message);case"PasswordException":return new eF(n.message,n.code);case"UnexpectedResponseException":return new $0(n.message,n.status);case"UnknownErrorException":return new c2(n.message,n.details)}return new c2(n.message,n.toString())}var xh,Us,RR,BR,$R,o0;class _m{constructor(e,t,r){oe(this,Us);oe(this,xh,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",le(this,Us,RR).bind(this),{signal:y(this,xh).signal})}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,t,r,i){const s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const u=Promise.withResolvers();return this.streamControllers[s]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:s,data:t,desiredSize:c.desiredSize},i),u.promise},pull:c=>{const u=Promise.withResolvers();return this.streamControllers[s].pullCall=u,l.postMessage({sourceName:a,targetName:o,stream:gr.PULL,streamId:s,desiredSize:c.desiredSize}),u.promise},cancel:c=>{_r(c instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[s].cancelCall=u,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:gr.CANCEL,streamId:s,reason:Ri(c)}),u.promise}},r)}destroy(){y(this,xh)?.abort(),Z(this,xh,null)}}xh=new WeakMap,Us=new WeakSet,RR=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){le(this,Us,$R).call(this,e);return}if(e.callback){const r=e.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===fy.DATA)i.resolve(e.data);else if(e.callback===fy.ERROR)i.reject(Ri(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,i=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(a){s.postMessage({sourceName:r,targetName:i,callback:fy.DATA,callbackId:e.callbackId,data:a})},function(a){s.postMessage({sourceName:r,targetName:i,callback:fy.ERROR,callbackId:e.callbackId,reason:Ri(a)})});return}if(e.streamId){le(this,Us,BR).call(this,e);return}t(e.data)},BR=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,u=1,d){if(this.isCancelled)return;const h=this.desiredSize;this.desiredSize-=u,h>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:gr.ENQUEUE,streamId:t,chunk:c},d)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:gr.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){_r(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:gr.ERROR,streamId:t,reason:Ri(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:gr.START_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:i,stream:gr.START_COMPLETE,streamId:t,reason:Ri(c)})})},$R=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case gr.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Ri(e.reason));break;case gr.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Ri(e.reason));break;case gr.PULL:if(!o){s.postMessage({sourceName:r,targetName:i,stream:gr.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||iF).then(function(){s.postMessage({sourceName:r,targetName:i,stream:gr.PULL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:i,stream:gr.PULL_COMPLETE,streamId:t,reason:Ri(c)})});break;case gr.ENQUEUE:if(_r(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case gr.CLOSE:if(_r(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),le(this,Us,o0).call(this,a,t);break;case gr.ERROR:_r(a,"error should have stream controller"),a.controller.error(Ri(e.reason)),le(this,Us,o0).call(this,a,t);break;case gr.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Ri(e.reason)),le(this,Us,o0).call(this,a,t);break;case gr.CANCEL:if(!o)break;const l=Ri(e.reason);Promise.try(o.onCancel||iF,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:gr.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){s.postMessage({sourceName:r,targetName:i,stream:gr.CANCEL_COMPLETE,streamId:t,reason:Ri(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},o0=async function(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]};var xg;class NR{constructor({enableHWA:e=!1}){oe(this,xg,!1);Z(this,xg,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!y(this,xg)})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Pn("Abstract method `_createCanvas` called.")}}xg=new WeakMap;class bj extends NR{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const r=this._document.createElement("canvas");return r.width=e,r.height=t,r}}class zR{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Pn("Abstract method `_fetch` called.")}}class WR extends zR{async _fetch(e){const t=await Xv(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Kv(t)}}class jR{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,i,s){return"none"}destroy(e=!1){}}var ru,Th,uo,ho,oi,iu,su,pt,ii,bm,Gd,l0,qd,VR,Wx,Hd,ym,vm,jx,wm;class yj extends jR{constructor({docId:t,ownerDocument:r=globalThis.document}){super();oe(this,pt);oe(this,ru);oe(this,Th);oe(this,uo);oe(this,ho);oe(this,oi);oe(this,iu);oe(this,su,0);Z(this,ho,t),Z(this,oi,r)}addFilter(t){if(!t)return"none";let r=y(this,pt,ii).get(t);if(r)return r;const[i,s,a]=le(this,pt,l0).call(this,t),o=t.length===1?i:`${i}${s}${a}`;if(r=y(this,pt,ii).get(o),r)return y(this,pt,ii).set(t,r),r;const l=`g_${y(this,ho)}_transfer_map_${vi(this,su)._++}`,c=le(this,pt,qd).call(this,l);y(this,pt,ii).set(t,c),y(this,pt,ii).set(o,c);const u=le(this,pt,Hd).call(this,l);return le(this,pt,vm).call(this,i,s,a,u),c}addHCMFilter(t,r){const i=`${t}-${r}`,s="base";let a=y(this,pt,bm).get(s);if(a?.key===i||(a?(a.filter?.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},y(this,pt,bm).set(s,a)),!t||!r))return a.url;const o=le(this,pt,wm).call(this,t);t=At.makeHexColor(...o);const l=le(this,pt,wm).call(this,r);if(r=At.makeHexColor(...l),y(this,pt,Gd).style.color="",t==="#000000"&&r==="#ffffff"||t===r)return a.url;const c=new Array(256);for(let p=0;p<=255;p++){const g=p/255;c[p]=g<=.03928?g/12.92:((g+.055)/1.055)**2.4}const u=c.join(","),d=`g_${y(this,ho)}_hcm_filter`,h=a.filter=le(this,pt,Hd).call(this,d);le(this,pt,vm).call(this,u,u,u,h),le(this,pt,Wx).call(this,h);const f=(p,g)=>{const b=o[p]/255,_=l[p]/255,m=new Array(g+1);for(let v=0;v<=g;v++)m[v]=b+v/g*(_-b);return m.join(",")};return le(this,pt,vm).call(this,f(0,5),f(1,5),f(2,5),h),a.url=le(this,pt,qd).call(this,d),a.url}addAlphaFilter(t){let r=y(this,pt,ii).get(t);if(r)return r;const[i]=le(this,pt,l0).call(this,[t]),s=`alpha_${i}`;if(r=y(this,pt,ii).get(s),r)return y(this,pt,ii).set(t,r),r;const a=`g_${y(this,ho)}_alpha_map_${vi(this,su)._++}`,o=le(this,pt,qd).call(this,a);y(this,pt,ii).set(t,o),y(this,pt,ii).set(s,o);const l=le(this,pt,Hd).call(this,a);return le(this,pt,jx).call(this,i,l),o}addLuminosityFilter(t){let r=y(this,pt,ii).get(t||"luminosity");if(r)return r;let i,s;if(t?([i]=le(this,pt,l0).call(this,[t]),s=`luminosity_${i}`):s="luminosity",r=y(this,pt,ii).get(s),r)return y(this,pt,ii).set(t,r),r;const a=`g_${y(this,ho)}_luminosity_map_${vi(this,su)._++}`,o=le(this,pt,qd).call(this,a);y(this,pt,ii).set(t,o),y(this,pt,ii).set(s,o);const l=le(this,pt,Hd).call(this,a);return le(this,pt,VR).call(this,l),t&&le(this,pt,jx).call(this,i,l),o}addHighlightHCMFilter(t,r,i,s,a){const o=`${r}-${i}-${s}-${a}`;let l=y(this,pt,bm).get(t);if(l?.key===o||(l?(l.filter?.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},y(this,pt,bm).set(t,l)),!r||!i))return l.url;const[c,u]=[r,i].map(le(this,pt,wm).bind(this));let d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[f,p]=[s,a].map(le(this,pt,wm).bind(this));h<d&&([d,h,f,p]=[h,d,p,f]),y(this,pt,Gd).style.color="";const g=(m,v,x)=>{const w=new Array(256),T=(h-d)/x,E=m/255,A=(v-m)/(255*x);let M=0;for(let F=0;F<=x;F++){const G=Math.round(d+F*T),S=E+F*A;for(let I=M;I<=G;I++)w[I]=S;M=G+1}for(let F=M;F<256;F++)w[F]=w[M-1];return w.join(",")},b=`g_${y(this,ho)}_hcm_${t}_filter`,_=l.filter=le(this,pt,Hd).call(this,b);return le(this,pt,Wx).call(this,_),le(this,pt,vm).call(this,g(f[0],p[0],5),g(f[1],p[1],5),g(f[2],p[2],5),_),l.url=le(this,pt,qd).call(this,b),l.url}destroy(t=!1){t&&y(this,iu)?.size||(y(this,uo)?.parentNode.parentNode.remove(),Z(this,uo,null),y(this,Th)?.clear(),Z(this,Th,null),y(this,iu)?.clear(),Z(this,iu,null),Z(this,su,0))}}ru=new WeakMap,Th=new WeakMap,uo=new WeakMap,ho=new WeakMap,oi=new WeakMap,iu=new WeakMap,su=new WeakMap,pt=new WeakSet,ii=function(){return y(this,Th)||Z(this,Th,new Map)},bm=function(){return y(this,iu)||Z(this,iu,new Map)},Gd=function(){if(!y(this,uo)){const t=y(this,oi).createElement("div"),{style:r}=t;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const i=y(this,oi).createElementNS(Za,"svg");i.setAttribute("width",0),i.setAttribute("height",0),Z(this,uo,y(this,oi).createElementNS(Za,"defs")),t.append(i),i.append(y(this,uo)),y(this,oi).body.append(t)}return y(this,uo)},l0=function(t){if(t.length===1){const c=t[0],u=new Array(256);for(let h=0;h<256;h++)u[h]=c[h]/255;const d=u.join(",");return[d,d,d]}const[r,i,s]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=r[c]/255,o[c]=i[c]/255,l[c]=s[c]/255;return[a.join(","),o.join(","),l.join(",")]},qd=function(t){if(y(this,ru)===void 0){Z(this,ru,"");const r=y(this,oi).URL;r!==y(this,oi).baseURI&&(Yv(r)?Xt('#createUrl: ignore "data:"-URL for performance reasons.'):Z(this,ru,r.split("#",1)[0]))}return`url(${y(this,ru)}#${t})`},VR=function(t){const r=y(this,oi).createElementNS(Za,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(r)},Wx=function(t){const r=y(this,oi).createElementNS(Za,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(r)},Hd=function(t){const r=y(this,oi).createElementNS(Za,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",t),y(this,pt,Gd).append(r),r},ym=function(t,r,i){const s=y(this,oi).createElementNS(Za,r);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)},vm=function(t,r,i,s){const a=y(this,oi).createElementNS(Za,"feComponentTransfer");s.append(a),le(this,pt,ym).call(this,a,"feFuncR",t),le(this,pt,ym).call(this,a,"feFuncG",r),le(this,pt,ym).call(this,a,"feFuncB",i)},jx=function(t,r){const i=y(this,oi).createElementNS(Za,"feComponentTransfer");r.append(i),le(this,pt,ym).call(this,i,"feFuncA",t)},wm=function(t){return y(this,pt,Gd).style.color=t,QE(getComputedStyle(y(this,pt,Gd)).getPropertyValue("color"))};class GR{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Pn("Abstract method `_fetch` called.")}}class qR extends GR{async _fetch(e){const t=await Xv(e,"arraybuffer");return new Uint8Array(t)}}hi&&Xt("Please use the `legacy` build in Node.js environments.");async function HR(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class vj extends jR{}class wj extends NR{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class xj extends zR{async _fetch(e){return HR(e)}}class Tj extends GR{async _fetch(e){return HR(e)}}const di={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Vx(n,e){if(!e)return;const t=e[2]-e[0],r=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,r),n.clip(i)}class JE{getPattern(){Pn("Abstract method `getPattern` called.")}}class Ej extends JE{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,r,i){let s;if(i===di.STROKE||i===di.FILL){const a=t.current.getClippedPathBoundingBox(i,zn(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-a[0],-a[1]),r=At.transform(r,[1,0,0,1,a[0],a[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),Vx(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),s=e.createPattern(c.canvas,"no-repeat");const d=new DOMMatrix(r);s.setTransform(d)}else Vx(e,this._bbox),s=this._createGradient(e);return s}}function h2(n,e,t,r,i,s,a,o){const l=e.coords,c=e.colors,u=n.data,d=n.width*4;let h;l[t+1]>l[r+1]&&(h=t,t=r,r=h,h=s,s=a,a=h),l[r+1]>l[i+1]&&(h=r,r=i,i=h,h=a,a=o,o=h),l[t+1]>l[r+1]&&(h=t,t=r,r=h,h=s,s=a,a=h);const f=(l[t]+e.offsetX)*e.scaleX,p=(l[t+1]+e.offsetY)*e.scaleY,g=(l[r]+e.offsetX)*e.scaleX,b=(l[r+1]+e.offsetY)*e.scaleY,_=(l[i]+e.offsetX)*e.scaleX,m=(l[i+1]+e.offsetY)*e.scaleY;if(p>=m)return;const v=c[s],x=c[s+1],w=c[s+2],T=c[a],E=c[a+1],A=c[a+2],M=c[o],F=c[o+1],G=c[o+2],S=Math.round(p),I=Math.round(m);let C,H,B,$,X,V,Q,R;for(let O=S;O<=I;O++){if(O<b){const be=O<p?0:(p-O)/(p-b);C=f-(f-g)*be,H=v-(v-T)*be,B=x-(x-E)*be,$=w-(w-A)*be}else{let be;O>m?be=1:b===m?be=0:be=(b-O)/(b-m),C=g-(g-_)*be,H=T-(T-M)*be,B=E-(E-F)*be,$=A-(A-G)*be}let L;O<p?L=0:O>m?L=1:L=(p-O)/(p-m),X=f-(f-_)*L,V=v-(v-M)*L,Q=x-(x-F)*L,R=w-(w-G)*L;const ne=Math.round(Math.min(C,X)),de=Math.round(Math.max(C,X));let we=d*O+ne*4;for(let be=ne;be<=de;be++)L=(C-be)/(C-X),L<0?L=0:L>1&&(L=1),u[we++]=H-(H-V)*L|0,u[we++]=B-(B-Q)*L|0,u[we++]=$-($-R)*L|0,u[we++]=255}}function Dj(n,e,t){const r=e.coords,i=e.colors;let s,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(r.length/o)-1,c=o-1;for(s=0;s<l;s++){let u=s*o;for(let d=0;d<c;d++,u++)h2(n,t,r[u],r[u+1],r[u+o],i[u],i[u+1],i[u+o]),h2(n,t,r[u+o+1],r[u+1],r[u+o],i[u+o+1],i[u+1],i[u+o])}break;case"triangles":for(s=0,a=r.length;s<a;s+=3)h2(n,t,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class Mj extends JE{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,r){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,u=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),h=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),f=c/d,p=u/h,g={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/p},b=d+2*2,_=h+2*2,m=r.getCanvas("mesh",b,_),v=m.context,x=v.createImageData(d,h);if(t){const T=x.data;for(let E=0,A=T.length;E<A;E+=4)T[E]=t[0],T[E+1]=t[1],T[E+2]=t[2],T[E+3]=255}for(const T of this._figures)Dj(x,T,g);return v.putImageData(x,2,2),{canvas:m.canvas,offsetX:o-2*f,offsetY:l-2*p,scaleX:f,scaleY:p}}getPattern(e,t,r,i){Vx(e,this._bbox);let s;if(i===di.SHADING)s=At.singularValueDecompose2dScale(zn(e));else if(s=At.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=At.singularValueDecompose2dScale(this.matrix);s=[s[0]*o[0],s[1]*o[1]]}const a=this._createMeshCanvas(s,i===di.SHADING?null:this._background,t.cachedCanvases);return i!==di.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class Aj extends JE{getPattern(){return"hotpink"}}function Cj(n){switch(n[0]){case"RadialAxial":return new Ej(n);case"Mesh":return new Mj(n);case"Dummy":return new Aj}throw new Error(`Unknown IR type: ${n[0]}`)}const sF={COLORED:1,UNCOLORED:2},ov=class ov{constructor(e,t,r,i,s){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=r,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(e){const{bbox:t,operatorList:r,paintType:i,tilingType:s,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),Hv("TilingType: "+s);const u=t[0],d=t[1],h=t[2],f=t[3],p=h-u,g=f-d,b=At.singularValueDecompose2dScale(this.matrix),_=At.singularValueDecompose2dScale(this.baseTransform),m=b[0]*_[0],v=b[1]*_[1];let x=p,w=g,T=!1,E=!1;const A=Math.ceil(l*m),M=Math.ceil(c*v),F=Math.ceil(p*m),G=Math.ceil(g*v);A>=F?x=l:T=!0,M>=G?w=c:E=!0;const S=this.getSizeAndScale(x,this.ctx.canvas.width,m),I=this.getSizeAndScale(w,this.ctx.canvas.height,v),C=e.cachedCanvases.getCanvas("pattern",S.size,I.size),H=C.context,B=o.createCanvasGraphics(H);if(B.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(B,i,a),H.translate(-S.scale*u,-I.scale*d),B.transform(S.scale,0,0,I.scale,0,0),H.save(),this.clipBbox(B,u,d,h,f),B.baseTransform=zn(B.ctx),B.executeOperatorList(r),B.endDrawing(),H.restore(),T||E){const $=C.canvas;T&&(x=l),E&&(w=c);const X=this.getSizeAndScale(x,this.ctx.canvas.width,m),V=this.getSizeAndScale(w,this.ctx.canvas.height,v),Q=X.size,R=V.size,O=e.cachedCanvases.getCanvas("pattern-workaround",Q,R),L=O.context,ne=T?Math.floor(p/l):0,de=E?Math.floor(g/c):0;for(let we=0;we<=ne;we++)for(let be=0;be<=de;be++)L.drawImage($,Q*we,R*be,Q,R,0,0,Q,R);return{canvas:O.canvas,scaleX:X.scale,scaleY:V.scale,offsetX:u,offsetY:d}}return{canvas:C.canvas,scaleX:S.scale,scaleY:I.scale,offsetX:u,offsetY:d}}getSizeAndScale(e,t,r){const i=Math.max(ov.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*r);return s>=i?s=i:r=s/e,{scale:r,size:s}}clipBbox(e,t,r,i,s){const a=i-t,o=s-r;e.ctx.rect(t,r,a,o),e.current.updateRectMinMax(zn(e.ctx),[t,r,i,s]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,r){const i=e.ctx,s=e.current;switch(t){case sF.COLORED:const a=this.ctx;i.fillStyle=a.fillStyle,i.strokeStyle=a.strokeStyle,s.fillColor=a.fillStyle,s.strokeColor=a.strokeStyle;break;case sF.UNCOLORED:const o=At.makeHexColor(r[0],r[1],r[2]);i.fillStyle=o,i.strokeStyle=o,s.fillColor=o,s.strokeColor=o;break;default:throw new ej(`Unsupported paint type: ${t}`)}}getPattern(e,t,r,i){let s=r;i!==di.SHADING&&(s=At.transform(s,t.baseTransform),this.matrix&&(s=At.transform(s,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(s);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};Xe(ov,"MAX_PATTERN_SIZE",3e3);let Gx=ov;function Sj({src:n,srcPos:e=0,dest:t,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=Ai.isLittleEndian?4278190080:255,[l,c]=a?[s,o]:[o,s],u=r>>3,d=r&7,h=n.length;t=new Uint32Array(t.buffer);let f=0;for(let p=0;p<i;p++){for(const b=e+u;e<b;e++){const _=e<h?n[e]:255;t[f++]=_&128?c:l,t[f++]=_&64?c:l,t[f++]=_&32?c:l,t[f++]=_&16?c:l,t[f++]=_&8?c:l,t[f++]=_&4?c:l,t[f++]=_&2?c:l,t[f++]=_&1?c:l}if(d===0)continue;const g=e<h?n[e++]:255;for(let b=0;b<d;b++)t[f++]=g&1<<7-b?c:l}return{srcPos:e,destPos:f}}const aF=16,oF=100,Pj=15,lF=10,cF=1e3,Wi=16;function kj(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(r,i){e.translate(r,i),this.__originalTranslate(r,i)},n.scale=function(r,i){e.scale(r,i),this.__originalScale(r,i)},n.transform=function(r,i,s,a,o,l){e.transform(r,i,s,a,o,l),this.__originalTransform(r,i,s,a,o,l)},n.setTransform=function(r,i,s,a,o,l){e.setTransform(r,i,s,a,o,l),this.__originalSetTransform(r,i,s,a,o,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(r){e.rotate(r),this.__originalRotate(r)},n.clip=function(r){e.clip(r),this.__originalClip(r)},n.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},n.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},n.bezierCurveTo=function(t,r,i,s,a,o){e.bezierCurveTo(t,r,i,s,a,o),this.__originalBezierCurveTo(t,r,i,s,a,o)},n.rect=function(t,r,i,s){e.rect(t,r,i,s),this.__originalRect(t,r,i,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Fj{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,r)):(i=this.canvasFactory.create(t,r),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function py(n,e,t,r,i,s,a,o,l,c){const[u,d,h,f,p,g]=zn(n);if(d===0&&h===0){const m=a*u+p,v=Math.round(m),x=o*f+g,w=Math.round(x),T=(a+l)*u+p,E=Math.abs(Math.round(T)-v)||1,A=(o+c)*f+g,M=Math.abs(Math.round(A)-w)||1;return n.setTransform(Math.sign(u),0,0,Math.sign(f),v,w),n.drawImage(e,t,r,i,s,0,0,E,M),n.setTransform(u,d,h,f,p,g),[E,M]}if(u===0&&f===0){const m=o*h+p,v=Math.round(m),x=a*d+g,w=Math.round(x),T=(o+c)*h+p,E=Math.abs(Math.round(T)-v)||1,A=(a+l)*d+g,M=Math.abs(Math.round(A)-w)||1;return n.setTransform(0,Math.sign(d),Math.sign(h),0,v,w),n.drawImage(e,t,r,i,s,0,0,M,E),n.setTransform(u,d,h,f,p,g),[M,E]}n.drawImage(e,t,r,i,s,a,o,l,c);const b=Math.hypot(u,d),_=Math.hypot(h,f);return[b*l,_*c]}function Ij(n){const{width:e,height:t}=n;if(e>cF||t>cF)return null;const r=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=e+1;let a=new Uint8Array(s*(t+1)),o,l,c;const u=e+7&-8;let d=new Uint8Array(u*t),h=0;for(const _ of n.data){let m=128;for(;m>0;)d[h++]=_&m?0:255,m>>=1}let f=0;for(h=0,d[h]!==0&&(a[0]=1,++f),l=1;l<e;l++)d[h]!==d[h+1]&&(a[l]=d[h]?2:1,++f),h++;for(d[h]!==0&&(a[l]=2,++f),o=1;o<t;o++){h=o*u,c=o*s,d[h-u]!==d[h]&&(a[c]=d[h]?1:8,++f);let _=(d[h]?4:0)+(d[h-u]?8:0);for(l=1;l<e;l++)_=(_>>2)+(d[h+1]?4:0)+(d[h-u+1]?8:0),i[_]&&(a[c+l]=i[_],++f),h++;if(d[h-u]!==d[h]&&(a[c+l]=d[h]?2:4,++f),f>r)return null}for(h=u*(t-1),c=o*s,d[h]!==0&&(a[c]=8,++f),l=1;l<e;l++)d[h]!==d[h+1]&&(a[c+l]=d[h]?4:8,++f),h++;if(d[h]!==0&&(a[c+l]=4,++f),f>r)return null;const p=new Int32Array([0,s,-1,0,-s,0,0,0,1]),g=new Path2D;for(o=0;f&&o<=t;o++){let _=o*s;const m=_+e;for(;_<m&&!a[_];)_++;if(_===m)continue;g.moveTo(_%s,o);const v=_;let x=a[_];do{const w=p[x];do _+=w;while(!a[_]);const T=a[_];T!==5&&T!==10?(x=T,a[_]=0):(x=T&51*x>>4,a[_]&=x>>2|x<<2),g.lineTo(_%s,_/s|0),a[_]||--f}while(v!==_);--o}return d=null,a=null,function(_){_.save(),_.scale(1/e,-1/t),_.translate(0,-t),_.fill(g),_.beginPath(),_.restore()}}class uF{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=rR,this.textMatrixScale=1,this.fontMatrix=yx,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=ri.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,r){[t,r]=At.applyTransform([t,r],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,r),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,r)}updateRectMinMax(e,t){const r=At.applyTransform(t,e),i=At.applyTransform(t.slice(2),e),s=At.applyTransform([t[0],t[3]],e),a=At.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,r[0],i[0],s[0],a[0]),this.minY=Math.min(this.minY,r[1],i[1],s[1],a[1]),this.maxX=Math.max(this.maxX,r[0],i[0],s[0],a[0]),this.maxY=Math.max(this.maxY,r[1],i[1],s[1],a[1])}updateScalingPathMinMax(e,t){At.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,r,i,s,a,o,l,c,u){const d=At.bezierBoundingBox(t,r,i,s,a,o,l,c,u);u||this.updateRectMinMax(e,d)}getPathBoundingBox(e=di.FILL,t=null){const r=[this.minX,this.minY,this.maxX,this.maxY];if(e===di.STROKE){t||Pn("Stroke bounding box must include transform.");const i=At.singularValueDecompose2dScale(t),s=i[0]*this.lineWidth/2,a=i[1]*this.lineWidth/2;r[0]-=s,r[1]-=a,r[2]+=s,r[3]+=a}return r}updateClipFromPath(){const e=At.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=di.FILL,t=null){return At.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function dF(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,r=e.width,i=t%Wi,s=(t-i)/Wi,a=i===0?s:s+1,o=n.createImageData(r,Wi);let l=0,c;const u=e.data,d=o.data;let h,f,p,g;if(e.kind===Zy.GRAYSCALE_1BPP){const b=u.byteLength,_=new Uint32Array(d.buffer,0,d.byteLength>>2),m=_.length,v=r+7>>3,x=4294967295,w=Ai.isLittleEndian?4278190080:255;for(h=0;h<a;h++){for(p=h<s?Wi:i,c=0,f=0;f<p;f++){const T=b-l;let E=0;const A=T>v?r:T*8-7,M=A&-8;let F=0,G=0;for(;E<M;E+=8)G=u[l++],_[c++]=G&128?x:w,_[c++]=G&64?x:w,_[c++]=G&32?x:w,_[c++]=G&16?x:w,_[c++]=G&8?x:w,_[c++]=G&4?x:w,_[c++]=G&2?x:w,_[c++]=G&1?x:w;for(;E<A;E++)F===0&&(G=u[l++],F=128),_[c++]=G&F?x:w,F>>=1}for(;c<m;)_[c++]=0;n.putImageData(o,0,h*Wi)}}else if(e.kind===Zy.RGBA_32BPP){for(f=0,g=r*Wi*4,h=0;h<s;h++)d.set(u.subarray(l,l+g)),l+=g,n.putImageData(o,0,f),f+=Wi;h<a&&(g=r*i*4,d.set(u.subarray(l,l+g)),n.putImageData(o,0,f))}else if(e.kind===Zy.RGB_24BPP)for(p=Wi,g=r*p,h=0;h<a;h++){for(h>=s&&(p=i,g=r*p),c=0,f=g;f--;)d[c++]=u[l++],d[c++]=u[l++],d[c++]=u[l++],d[c++]=255;n.putImageData(o,0,h*Wi)}else throw new Error(`bad image kind: ${e.kind}`)}function hF(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,r=e.width,i=t%Wi,s=(t-i)/Wi,a=i===0?s:s+1,o=n.createImageData(r,Wi);let l=0;const c=e.data,u=o.data;for(let d=0;d<a;d++){const h=d<s?Wi:i;({srcPos:l}=Sj({src:c,srcPos:l,dest:u,width:r,height:h,nonBlackColor:0})),n.putImageData(o,0,d*Wi)}}function Jp(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of t)n[r]!==void 0&&(e[r]=n[r]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function my(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!hi){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function fF(n,e){if(e)return!0;const t=At.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const r=Math.fround((globalThis.devicePixelRatio||1)*jl.PDF_TO_CSS_UNITS);return t[0]<=r&&t[1]<=r}const Oj=["butt","round","square"],Uj=["miter","round","bevel"],Lj={},pF={};var fa,qx,Hx,Kx;const OD=class OD{constructor(e,t,r,i,s,{optionalContentConfig:a,markedContentStack:o=null},l,c){oe(this,fa);this.ctx=e,this.current=new uF(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new Fj(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:i=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,r){const l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...zn(this.compositeCtx))}this.ctx.save(),my(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=zn(this.ctx)}executeOperatorList(e,t,r,i){const s=e.argsArray,a=e.fnArray;let o=t||0;const l=s.length;if(l===o)return o;const c=l-o>lF&&typeof r=="function",u=c?Date.now()+Pj:0;let d=0;const h=this.commonObjs,f=this.objs;let p;for(;;){if(i!==void 0&&o===i.nextBreakPoint)return i.breakIt(o,r),o;if(p=a[o],p!==Hs.dependency)this[p].apply(this,s[o]);else for(const g of s[o]){const b=g.startsWith("g_")?h:f;if(!b.has(g))return b.get(g,r),o}if(o++,o===l)return o;if(c&&++d>lF){if(Date.now()>u)return r(),o;d=0}}}endDrawing(){le(this,fa,qx).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),le(this,fa,Hx).call(this)}_scaleImage(e,t){const r=e.width??e.displayWidth,i=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=r,l=i,c="prescale1",u,d;for(;s>2&&o>1||a>2&&l>1;){let h=o,f=l;s>2&&o>1&&(h=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/h),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),u=this.cachedCanvases.getCanvas(c,h,f),d=u.context,d.clearRect(0,0,h,f),d.drawImage(e,0,0,o,l,0,0,h,f),e=u.canvas,o=h,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:r,height:i}=e,s=this.current.fillColor,a=this.current.patternFill,o=zn(t);let l,c,u,d;if((e.bitmap||e.data)&&e.count>1){const A=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),s]),l=this._cachedBitmapsMap.get(A),l||(l=new Map,this._cachedBitmapsMap.set(A,l));const M=l.get(c);if(M&&!a){const F=Math.round(Math.min(o[0],o[2])+o[4]),G=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:M,offsetX:F,offsetY:G}}u=M}u||(d=this.cachedCanvases.getCanvas("maskCanvas",r,i),hF(d.context,e));let h=At.transform(o,[1/r,0,0,-1/i,0,0]);h=At.transform(h,[1,0,0,1,0,-i]);const[f,p,g,b]=At.getAxialAlignedBoundingBox([0,0,r,i],h),_=Math.round(g-f)||1,m=Math.round(b-p)||1,v=this.cachedCanvases.getCanvas("fillCanvas",_,m),x=v.context,w=f,T=p;x.translate(-w,-T),x.transform(...h),u||(u=this._scaleImage(d.canvas,ya(x)),u=u.img,l&&a&&l.set(c,u)),x.imageSmoothingEnabled=fF(zn(x),e.interpolate),py(x,u,0,0,u.width,u.height,0,0,r,i),x.globalCompositeOperation="source-in";const E=At.transform(ya(x),[1,0,0,1,-w,-T]);return x.fillStyle=a?s.getPattern(t,this,E,di.FILL):s,x.fillRect(0,0,r,i),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,v.canvas)),{canvas:v.canvas,offsetX:Math.round(w),offsetY:Math.round(T)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Oj[e]}setLineJoin(e){this.ctx.lineJoin=Uj[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,r]of e)switch(t){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.current.fillAlpha=r,this.ctx.globalAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const s=this.ctx;s.setTransform(...zn(this.suspendedCtx)),Jp(this.suspendedCtx,s),kj(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Jp(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,i){const s=i[0],a=i[1],o=i[2]-s,l=i[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,r,o,l,t.subtype,t.backdrop,t.transferMap,s,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,i,s,a,o,l,c,u,d){let h=e.canvas,f=l-u,p=c-d;if(a){const b=At.makeHexColor(...a);if(f<0||p<0||f+r>h.width||p+i>h.height){const _=this.cachedCanvases.getCanvas("maskExtension",r,i),m=_.context;m.drawImage(h,-f,-p),m.globalCompositeOperation="destination-atop",m.fillStyle=b,m.fillRect(0,0,r,i),m.globalCompositeOperation="source-over",h=_.canvas,f=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const _=new Path2D;_.rect(f,p,r,i),e.clip(_),e.globalCompositeOperation="destination-atop",e.fillStyle=b,e.fillRect(f,p,r,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const g=new Path2D;g.rect(l,c,r,i),t.clip(g),t.globalCompositeOperation="destination-in",t.drawImage(h,f,p,r,i,l,c,r,i),t.restore()}save(){this.inSMaskMode?(Jp(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Jp(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,r,i,s,a){this.ctx.transform(e,t,r,i,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r){const i=this.ctx,s=this.current;let a=s.x,o=s.y,l,c;const u=zn(i),d=u[0]===0&&u[3]===0||u[1]===0&&u[2]===0,h=d?r.slice(0):null;for(let f=0,p=0,g=e.length;f<g;f++)switch(e[f]|0){case Hs.rectangle:a=t[p++],o=t[p++];const b=t[p++],_=t[p++],m=a+b,v=o+_;i.moveTo(a,o),b===0||_===0?i.lineTo(m,v):(i.lineTo(m,o),i.lineTo(m,v),i.lineTo(a,v)),d||s.updateRectMinMax(u,[a,o,m,v]),i.closePath();break;case Hs.moveTo:a=t[p++],o=t[p++],i.moveTo(a,o),d||s.updatePathMinMax(u,a,o);break;case Hs.lineTo:a=t[p++],o=t[p++],i.lineTo(a,o),d||s.updatePathMinMax(u,a,o);break;case Hs.curveTo:l=a,c=o,a=t[p+4],o=t[p+5],i.bezierCurveTo(t[p],t[p+1],t[p+2],t[p+3],a,o),s.updateCurvePathMinMax(u,l,c,t[p],t[p+1],t[p+2],t[p+3],a,o,h),p+=6;break;case Hs.curveTo2:l=a,c=o,i.bezierCurveTo(a,o,t[p],t[p+1],t[p+2],t[p+3]),s.updateCurvePathMinMax(u,l,c,a,o,t[p],t[p+1],t[p+2],t[p+3],h),a=t[p+2],o=t[p+3],p+=4;break;case Hs.curveTo3:l=a,c=o,a=t[p+2],o=t[p+3],i.bezierCurveTo(t[p],t[p+1],a,o,a,o),s.updateCurvePathMinMax(u,l,c,t[p],t[p+1],a,o,a,o,h),p+=4;break;case Hs.closePath:i.closePath();break}d&&s.updateScalingPathMinMax(u,h),s.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,r=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof r=="object"&&r?.getPattern?(t.save(),t.strokeStyle=r.getPattern(t,this,ya(t),di.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,r=this.current.fillColor,i=this.current.patternFill;let s=!1;i&&(t.save(),t.fillStyle=r.getPattern(t,this,ya(t),di.FILL),s=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),s&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Lj}eoClip(){this.pendingClip=pF}beginText(){this.current.textMatrix=rR,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const r=new Path2D,i=t.getTransform().invertSelf();for(const{transform:s,x:a,y:o,fontSize:l,path:c}of e)r.addPath(c,new DOMMatrix(s).preMultiplySelf(i).translate(a,o).scale(l,-l));t.clip(r),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const r=this.commonObjs.get(e),i=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=r.fontMatrix||yx,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Xt("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=t,r.isType3Font)return;const s=r.loadedName||"sans-serif",a=r.systemFontInfo?.css||`"${s}", ${r.fallbackName}`;let o="normal";r.black?o="900":r.bold&&(o="bold");const l=r.italic?"italic":"normal";let c=t;t<aF?c=aF:t>oF&&(c=oF),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,r,i,s,a){this.current.textMatrix=[e,t,r,i,s,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,r,i,s){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,u=o.fontSize/o.fontSizeScale,d=c&ri.FILL_STROKE_MASK,h=!!(c&ri.ADD_TO_PATH_FLAG),f=o.patternFill&&!l.missingFile,p=o.patternStroke&&!l.missingFile;let g;if((l.disableFontFace||h||f||p)&&(g=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||f||p){if(a.save(),a.translate(t,r),a.scale(u,-u),d===ri.FILL||d===ri.FILL_STROKE)if(i){const b=a.getTransform();a.setTransform(...i),a.fill(le(this,fa,Kx).call(this,g,b,i))}else a.fill(g);if(d===ri.STROKE||d===ri.FILL_STROKE)if(s){const b=a.getTransform();a.setTransform(...s),a.stroke(le(this,fa,Kx).call(this,g,b,s))}else a.lineWidth/=u,a.stroke(g);a.restore()}else(d===ri.FILL||d===ri.FILL_STROKE)&&a.fillText(e,t,r),(d===ri.STROKE||d===ri.FILL_STROKE)&&a.strokeText(e,t,r);h&&(this.pendingTextPaths||=[]).push({transform:zn(a),x:t,y:r,fontSize:u,path:g})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){r=!0;break}return Zt(this,"isFontSubpixelAAEnabled",r)}showText(e){const t=this.current,r=t.font;if(r.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const s=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,u=t.textHScale*c,d=e.length,h=r.vertical,f=h?1:-1,p=r.defaultVMetrics,g=i*t.fontMatrix[0],b=t.textRenderingMode===ri.FILL&&!r.disableFontFace&&!t.patternFill;s.save(),s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),c>0?s.scale(u,-1):s.scale(u,1);let _,m;if(t.patternFill){s.save();const E=t.fillColor.getPattern(s,this,ya(s),di.FILL);_=zn(s),s.restore(),s.fillStyle=E}if(t.patternStroke){s.save();const E=t.strokeColor.getPattern(s,this,ya(s),di.STROKE);m=zn(s),s.restore(),s.strokeStyle=E}let v=t.lineWidth;const x=t.textMatrixScale;if(x===0||v===0){const E=t.textRenderingMode&ri.FILL_STROKE_MASK;(E===ri.STROKE||E===ri.FILL_STROKE)&&(v=this.getSinglePixelWidth())}else v/=x;if(a!==1&&(s.scale(a,a),v/=a),s.lineWidth=v,r.isInvalidPDFjsFont){const E=[];let A=0;for(const M of e)E.push(M.unicode),A+=M.width;s.fillText(E.join(""),0,0),t.x+=A*g*u,s.restore(),this.compose();return}let w=0,T;for(T=0;T<d;++T){const E=e[T];if(typeof E=="number"){w+=f*E*i/1e3;continue}let A=!1;const M=(E.isSpace?l:0)+o,F=E.fontChar,G=E.accent;let S,I,C=E.width;if(h){const B=E.vmetric||p,$=-(E.vmetric?B[1]:C*.5)*g,X=B[2]*g;C=B?-B[0]:C,S=$/a,I=(w+X)/a}else S=w/a,I=0;if(r.remeasure&&C>0){const B=s.measureText(F).width*1e3/i*a;if(C<B&&this.isFontSubpixelAAEnabled){const $=C/B;A=!0,s.save(),s.scale($,1),S/=$}else C!==B&&(S+=(C-B)/2e3*i/a)}if(this.contentVisible&&(E.isInFont||r.missingFile)){if(b&&!G)s.fillText(F,S,I);else if(this.paintChar(F,S,I,_,m),G){const B=S+i*G.offset.x/a,$=I-i*G.offset.y/a;this.paintChar(G.fontChar,B,$,_,m)}}const H=h?C*g-M*c:C*g+M*c;w+=H,A&&s.restore()}h?t.y-=w:t.x+=w*u,s.restore(),this.compose()}showType3Text(e){const t=this.ctx,r=this.current,i=r.font,s=r.fontSize,a=r.fontDirection,o=i.vertical?1:-1,l=r.charSpacing,c=r.wordSpacing,u=r.textHScale*a,d=r.fontMatrix||yx,h=e.length,f=r.textRenderingMode===ri.INVISIBLE;let p,g,b,_;if(!(f||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...r.textMatrix),t.translate(r.x,r.y),t.scale(u,a),p=0;p<h;++p){if(g=e[p],typeof g=="number"){_=o*g*s/1e3,this.ctx.translate(_,0),r.x+=_*u;continue}const m=(g.isSpace?c:0)+l,v=i.charProcOperatorList[g.operatorListId];if(!v){Xt(`Type3 character "${g.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=g,this.save(),t.scale(s,s),t.transform(...d),this.executeOperatorList(v),this.restore()),b=At.applyTransform([g.width,0],d)[0]*s+m,t.translate(b,0),r.x+=b*u}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,r,i,s,a){this.ctx.rect(r,i,s-r,a-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const r=e[1],i=this.baseTransform||zn(this.ctx),s={createCanvasGraphics:a=>new OD(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Gx(e,r,this.ctx,s,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,r){this.ctx.strokeStyle=this.current.strokeColor=At.makeHexColor(e,t,r),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,r){this.ctx.fillStyle=this.current.fillColor=At.makeHexColor(e,t,r),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=Cj(this.getObject(e)),this.cachedPatterns.set(e,r)),t&&(r.matrix=t),r}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const r=this._getPattern(e);t.fillStyle=r.getPattern(t,this,ya(t),di.SHADING);const i=ya(t);if(i){const{width:s,height:a}=t.canvas,[o,l,c,u]=At.getAxialAlignedBoundingBox([0,0,s,a],i);this.ctx.fillRect(o,l,c-o,u-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Pn("Should not call beginInlineImage")}beginImageData(){Pn("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=zn(this.ctx),t)){const r=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],r,i),this.current.updateRectMinMax(zn(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Hv("TODO: Support non-isolated groups."),e.knockout&&Xt("Knockout groups not supported.");const r=zn(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=At.getAxialAlignedBoundingBox(e.bbox,zn(t));const s=[0,0,t.canvas.width,t.canvas.height];i=At.intersect(i,s)||[0,0,0,0];const a=Math.floor(i[0]),o=Math.floor(i[1]),l=Math.max(Math.ceil(i[2])-a,1),c=Math.max(Math.ceil(i[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let u="groupAt"+this.groupLevel;e.smask&&(u+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(u,l,c),h=d.context;h.translate(-a,-o),h.transform(...r),e.smask?this.smaskStack.push({canvas:d.canvas,context:h,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Jp(t,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=zn(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const s=At.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,r,i,s){if(le(this,fa,qx).call(this),my(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(s&&this.annotationCanvasMap){r=r.slice(),r[4]-=t[0],r[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[l,c]=At.singularValueDecompose2dScale(zn(this.ctx)),{viewportScale:u}=this,d=Math.ceil(a*this.outputScaleX*u),h=Math.ceil(o*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(d,h);const{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(e,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),my(this.ctx)}else my(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new uF(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),le(this,fa,Hx).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const r=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=Ij(e)),i.compiled)){i.compiled(r);return}const s=this._createMaskCanvas(e),a=s.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(a,s.offsetX,s.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r=0,i=0,s,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=zn(o);o.transform(t,r,i,s,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let u=0,d=a.length;u<d;u+=2){const h=At.transform(l,[t,r,i,s,a[u],a[u+1]]),[f,p]=At.applyTransform([0,0],h);o.drawImage(c.canvas,f,p)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,r=this.current.fillColor,i=this.current.patternFill;for(const s of e){const{data:a,width:o,height:l,transform:c}=s,u=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=u.context;d.save();const h=this.getObject(a,s);hF(d,h),d.globalCompositeOperation="source-in",d.fillStyle=i?r.getPattern(d,this,ya(t),di.FILL):r,d.fillRect(0,0,o,l),d.restore(),t.save(),t.transform(...c),t.scale(1,-1),py(t,u.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Xt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,r,i){if(!this.contentVisible)return;const s=this.getObject(e);if(!s){Xt("Dependent image isn't ready yet");return}const a=s.width,o=s.height,l=[];for(let c=0,u=i.length;c<u;c+=2)l.push({transform:[t,0,0,r,i[c],i[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:r,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",r,i),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,r=e.height,i=this.ctx;if(this.save(),!hi){const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none")}i.scale(1/t,-1/r);let s;if(e.bitmap)s=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)s=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,r).context;dF(l,e),s=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(s,ya(i));i.imageSmoothingEnabled=fF(zn(i),e.interpolate),py(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-r,t,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const r=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const s=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",s,a).context;dF(l,e),i=this.applyTransferMapsToCanvas(l)}for(const s of t)r.save(),r.transform(...s.transform),r.scale(1,-1),py(r,i,s.x,s.y,s.w,s.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const r=this.ctx;this.pendingClip&&(t||(this.pendingClip===pF?r.clip("evenodd"):r.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),r.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=zn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:r,c:i,d:s}=this.ctx.getTransform();let a,o;if(r===0&&i===0){const l=Math.abs(t),c=Math.abs(s);if(l===c)if(e===0)a=o=1/l;else{const u=l*e;a=o=u<1?1/u:1}else if(e===0)a=1/l,o=1/c;else{const u=l*e,d=c*e;a=u<1?1/u:1,o=d<1?1/d:1}}else{const l=Math.abs(t*s-r*i),c=Math.hypot(t,r),u=Math.hypot(i,s);if(e===0)a=u/l,o=c/l;else{const d=e*l;a=u>d?u/d:1,o=c>d?c/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:r}=this.current,[i,s]=this.getScaleForStroking();if(t.lineWidth=r||1,i===1&&s===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(i,s),a.length>0){const o=Math.max(i,s);t.setLineDash(a.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};fa=new WeakSet,qx=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Hx=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Kx=function(e,t,r){const i=new Path2D;return i.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(t)),i};let sh=OD;for(const n in Hs)sh.prototype[n]!==void 0&&(sh.prototype[Hs[n]]=sh.prototype[n]);var Tg,Eg;class Wu{static get workerPort(){return y(this,Tg)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");Z(this,Tg,e)}static get workerSrc(){return y(this,Eg)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");Z(this,Eg,e)}}Tg=new WeakMap,Eg=new WeakMap,oe(Wu,Tg,null),oe(Wu,Eg,"");var au,Dg;class Rj{constructor({parsedData:e,rawData:t}){oe(this,au);oe(this,Dg);Z(this,au,e),Z(this,Dg,t)}getRaw(){return y(this,Dg)}get(e){return y(this,au).get(e)??null}getAll(){return qE(y(this,au))}has(e){return y(this,au).has(e)}}au=new WeakMap,Dg=new WeakMap;const Kd=Symbol("INTERNAL");var Mg,Ag,Cg,Eh;class Bj{constructor(e,{name:t,intent:r,usage:i,rbGroups:s}){oe(this,Mg,!1);oe(this,Ag,!1);oe(this,Cg,!1);oe(this,Eh,!0);Z(this,Mg,!!(e&ls.DISPLAY)),Z(this,Ag,!!(e&ls.PRINT)),this.name=t,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(y(this,Cg))return y(this,Eh);if(!y(this,Eh))return!1;const{print:e,view:t}=this.usage;return y(this,Mg)?t?.viewState!=="OFF":y(this,Ag)?e?.printState!=="OFF":!0}_setVisible(e,t,r=!1){e!==Kd&&Pn("Internal method `_setVisible` called."),Z(this,Cg,r),Z(this,Eh,t)}}Mg=new WeakMap,Ag=new WeakMap,Cg=new WeakMap,Eh=new WeakMap;var yl,wn,Dh,Mh,Sg,Xx;class $j{constructor(e,t=ls.DISPLAY){oe(this,Sg);oe(this,yl,null);oe(this,wn,new Map);oe(this,Dh,null);oe(this,Mh,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,Z(this,Mh,e.order);for(const r of e.groups)y(this,wn).set(r.id,new Bj(t,r));if(e.baseState==="OFF")for(const r of y(this,wn).values())r._setVisible(Kd,!1);for(const r of e.on)y(this,wn).get(r)._setVisible(Kd,!0);for(const r of e.off)y(this,wn).get(r)._setVisible(Kd,!1);Z(this,Dh,this.getHash())}}isVisible(e){if(y(this,wn).size===0)return!0;if(!e)return Hv("Optional content group not defined."),!0;if(e.type==="OCG")return y(this,wn).has(e.id)?y(this,wn).get(e.id).visible:(Xt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return le(this,Sg,Xx).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!y(this,wn).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(y(this,wn).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!y(this,wn).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(!y(this,wn).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!y(this,wn).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(!y(this,wn).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!y(this,wn).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(y(this,wn).get(t).visible)return!1}return!0}return Xt(`Unknown optional content policy ${e.policy}.`),!0}return Xt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){const i=y(this,wn).get(e);if(!i){Xt(`Optional content group not found: ${e}`);return}if(r&&t&&i.rbGroups.length)for(const s of i.rbGroups)for(const a of s)a!==e&&y(this,wn).get(a)?._setVisible(Kd,!1,!0);i._setVisible(Kd,!!t,!0),Z(this,yl,null)}setOCGState({state:e,preserveRB:t}){let r;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}const s=y(this,wn).get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!s.visible,t);break}}Z(this,yl,null)}get hasInitialVisibility(){return y(this,Dh)===null||this.getHash()===y(this,Dh)}getOrder(){return y(this,wn).size?y(this,Mh)?y(this,Mh).slice():[...y(this,wn).keys()]:null}getGroups(){return y(this,wn).size>0?qE(y(this,wn)):null}getGroup(e){return y(this,wn).get(e)||null}getHash(){if(y(this,yl)!==null)return y(this,yl);const e=new OR;for(const[t,r]of y(this,wn))e.update(`${t}:${r.visible}`);return Z(this,yl,e.hexdigest())}}yl=new WeakMap,wn=new WeakMap,Dh=new WeakMap,Mh=new WeakMap,Sg=new WeakSet,Xx=function(e){const t=e.length;if(t<2)return!0;const r=e[0];for(let i=1;i<t;i++){const s=e[i];let a;if(Array.isArray(s))a=le(this,Sg,Xx).call(this,s);else if(y(this,wn).has(s))a=y(this,wn).get(s).visible;else return Xt(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"};class Nj{constructor(e,{disableRange:t=!1,disableStream:r=!1}){_r(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,s?.length>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(r),!0)});_r(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){_r(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new zj(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new Wj(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class zj{constructor(e,t,r=!1,i=null){this._stream=e,this._done=r||!1,this._filename=XE(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Wj{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function jj(n){let e=!0,t=r("filename\\*","i").exec(n);if(t){t=t[1];let u=o(t);return u=unescape(u),u=l(u),u=c(u),s(u)}if(t=a(n),t){const u=c(t);return s(u)}if(t=r("filename","i").exec(n),t){t=t[1];let u=o(t);return u=c(u),s(u)}function r(u,d){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function i(u,d){if(u){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const h=new TextDecoder(u,{fatal:!0}),f=Kv(d);d=h.decode(f),e=!1}catch{}}return d}function s(u){return e&&/[\x80-\xff]/.test(u)&&(u=i("utf-8",u),e&&(u=i("iso-8859-1",u))),u}function a(u){const d=[];let h;const f=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(h=f.exec(u))!==null;){let[,g,b,_]=h;if(g=parseInt(g,10),g in d){if(g===0)break;continue}d[g]=[b,_]}const p=[];for(let g=0;g<d.length&&g in d;++g){let[b,_]=d[g];_=o(_),b&&(_=unescape(_),g===0&&(_=l(_))),p.push(_)}return p.join("")}function o(u){if(u.startsWith('"')){const d=u.slice(1).split('\\"');for(let h=0;h<d.length;++h){const f=d[h].indexOf('"');f!==-1&&(d[h]=d[h].slice(0,f),d.length=h+1),d[h]=d[h].replaceAll(/\\(.)/g,"$1")}u=d.join('"')}return u}function l(u){const d=u.indexOf("'");if(d===-1)return u;const h=u.slice(0,d),p=u.slice(d+1).replace(/^[^']*'/,"");return i(h,p)}function c(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,h,f,p){if(f==="q"||f==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,b){return String.fromCharCode(parseInt(b,16))}),i(h,p);try{p=atob(p)}catch{}return i(h,p)})}return""}function KR(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const r in e){const i=e[r];i!==void 0&&t.append(r,i)}return t}function Qv(n){try{return new URL(n).origin}catch{}return null}function XR({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:r}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*t)||r||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function YR(n){const e=n.get("Content-Disposition");if(e){let t=jj(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(XE(t))return t}return null}function Zv(n,e){return n===404||n===0&&e.startsWith("file:")?new Vm('Missing PDF "'+e+'".'):new $0(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function QR(n){return n===200||n===206}function ZR(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function JR(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Xt(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class mF{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=KR(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return _r(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Vj(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new Gj(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Vj{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const r=new Headers(e.headers),i=t.url;fetch(i,ZR(r,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=Qv(s.url),!QR(s.status))throw Zv(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:o,suggestedLength:l}=XR({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=YR(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Wl("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:JR(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class Gj{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${r-1}`);const a=i.url;fetch(a,ZR(s,this._withCredentials,this._abortController)).then(o=>{const l=Qv(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!QR(o.status))throw Zv(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:JR(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const f2=200,p2=206;function qj(n){const e=n.response;return typeof e!="string"?e:Kv(e).buffer}class Hj{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:r}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=KR(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=p2):i.expectedStatus=f2,t.responseType="arraybuffer",_r(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){const r=this.pendingRequests[e];r&&r.onProgress?.(t)}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){r.onError(i.status);return}const s=i.status||f2;if(!(s===f2&&r.expectedStatus===p2)&&s!==r.expectedStatus){r.onError(i.status);return}const o=qj(i);if(s===p2){const l=i.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?r.onDone({begin:parseInt(c[1],10),chunk:o}):(Xt('Missing or invalid "Content-Range" header.'),r.onError(0))}else o?r.onDone({begin:0,chunk:o}):r.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Kj{constructor(e){this._source=e,this._manager=new Hj(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return _r(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Xj(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new Yj(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Xj{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Qv(t.responseURL);const r=t.getAllResponseHeaders(),i=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=XR({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=YR(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Zv(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Yj{constructor(e,t,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Qv(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Zv(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Qj=/^[a-z][a-z0-9\-+.]+:/i;function Zj(n){if(Qj.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class Jj{constructor(e){this.source=e,this.url=Zj(e.url),_r(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return _r(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new e9(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new t9(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class e9{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Vm(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Wl("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class t9{constructor(e,t,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const n9=1e5,Li=30,r9=.8;var vl,Ni,Pg,kg,ou,fo,Fg,Ig,lu,Ah,Ch,wl,Sh,Og,Ph,cu,Ug,Lg,uu,du,Rg,xl,kh,Oo,eB,tB,Yx,fs,c0,Qx,nB,rB;const Er=class Er{constructor({textContentSource:e,container:t,viewport:r}){oe(this,Oo);oe(this,vl,Promise.withResolvers());oe(this,Ni,null);oe(this,Pg,!1);oe(this,kg,!!globalThis.FontInspector?.enabled);oe(this,ou,null);oe(this,fo,null);oe(this,Fg,0);oe(this,Ig,0);oe(this,lu,null);oe(this,Ah,null);oe(this,Ch,0);oe(this,wl,0);oe(this,Sh,Object.create(null));oe(this,Og,[]);oe(this,Ph,null);oe(this,cu,[]);oe(this,Ug,new WeakMap);oe(this,Lg,null);var l;if(e instanceof ReadableStream)Z(this,Ph,e);else if(typeof e=="object")Z(this,Ph,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');Z(this,Ni,Z(this,Ah,t)),Z(this,wl,r.scale*(globalThis.devicePixelRatio||1)),Z(this,Ch,r.rotation),Z(this,fo,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:a,pageY:o}=r.rawDims;Z(this,Lg,[1,0,0,-1,-a,o+s]),Z(this,Ig,i),Z(this,Fg,s),le(l=Er,fs,nB).call(l),Vu(t,r),y(this,vl).promise.finally(()=>{y(Er,kh).delete(this),Z(this,fo,null),Z(this,Sh,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Ai.platform;return Zt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{y(this,lu).read().then(({value:t,done:r})=>{if(r){y(this,vl).resolve();return}y(this,ou)??Z(this,ou,t.lang),Object.assign(y(this,Sh),t.styles),le(this,Oo,eB).call(this,t.items),e()},y(this,vl).reject)};return Z(this,lu,y(this,Ph).getReader()),y(Er,kh).add(this),e(),y(this,vl).promise}update({viewport:e,onBefore:t=null}){var s;const r=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==y(this,Ch)&&(t?.(),Z(this,Ch,i),Vu(y(this,Ah),{rotation:i})),r!==y(this,wl)){t?.(),Z(this,wl,r);const a={div:null,properties:null,ctx:le(s=Er,fs,c0).call(s,y(this,ou))};for(const o of y(this,cu))a.properties=y(this,Ug).get(o),a.div=o,le(this,Oo,Yx).call(this,a)}}cancel(){const e=new Wl("TextLayer task cancelled.");y(this,lu)?.cancel(e).catch(()=>{}),Z(this,lu,null),y(this,vl).reject(e)}get textDivs(){return y(this,cu)}get textContentItemsStr(){return y(this,Og)}static cleanup(){if(!(y(this,kh).size>0)){y(this,uu).clear();for(const{canvas:e}of y(this,du).values())e.remove();y(this,du).clear()}}};vl=new WeakMap,Ni=new WeakMap,Pg=new WeakMap,kg=new WeakMap,ou=new WeakMap,fo=new WeakMap,Fg=new WeakMap,Ig=new WeakMap,lu=new WeakMap,Ah=new WeakMap,Ch=new WeakMap,wl=new WeakMap,Sh=new WeakMap,Og=new WeakMap,Ph=new WeakMap,cu=new WeakMap,Ug=new WeakMap,Lg=new WeakMap,uu=new WeakMap,du=new WeakMap,Rg=new WeakMap,xl=new WeakMap,kh=new WeakMap,Oo=new WeakSet,eB=function(e){var i;if(y(this,Pg))return;y(this,fo).ctx??=le(i=Er,fs,c0).call(i,y(this,ou));const t=y(this,cu),r=y(this,Og);for(const s of e){if(t.length>n9){Xt("Ignoring additional textDivs for performance reasons."),Z(this,Pg,!0);return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const a=y(this,Ni);Z(this,Ni,document.createElement("span")),y(this,Ni).classList.add("markedContent"),s.id!==null&&y(this,Ni).setAttribute("id",`${s.id}`),a.append(y(this,Ni))}else s.type==="endMarkedContent"&&Z(this,Ni,y(this,Ni).parentNode);continue}r.push(s.str),le(this,Oo,tB).call(this,s)}},tB=function(e){var g;const t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};y(this,cu).push(t);const i=At.transform(y(this,Lg),e.transform);let s=Math.atan2(i[1],i[0]);const a=y(this,Sh)[e.fontName];a.vertical&&(s+=Math.PI/2);let o=y(this,kg)&&a.fontSubstitution||a.fontFamily;o=Er.fontFamilyMap.get(o)||o;const l=Math.hypot(i[2],i[3]),c=l*le(g=Er,fs,rB).call(g,o,y(this,ou));let u,d;s===0?(u=i[4],d=i[5]-c):(u=i[4]+c*Math.sin(s),d=i[5]-c*Math.cos(s));const h="calc(var(--scale-factor)*",f=t.style;y(this,Ni)===y(this,Ah)?(f.left=`${(100*u/y(this,Ig)).toFixed(2)}%`,f.top=`${(100*d/y(this,Fg)).toFixed(2)}%`):(f.left=`${h}${u.toFixed(2)}px)`,f.top=`${h}${d.toFixed(2)}px)`),f.fontSize=`${h}${(y(Er,xl)*l).toFixed(2)}px)`,f.fontFamily=o,r.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,y(this,kg)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),s!==0&&(r.angle=s*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const b=Math.abs(e.transform[0]),_=Math.abs(e.transform[3]);b!==_&&Math.max(b,_)/Math.min(b,_)>1.5&&(p=!0)}if(p&&(r.canvasWidth=a.vertical?e.height:e.width),y(this,Ug).set(t,r),y(this,fo).div=t,y(this,fo).properties=r,le(this,Oo,Yx).call(this,y(this,fo)),r.hasText&&y(this,Ni).append(t),r.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),y(this,Ni).append(b)}},Yx=function(e){var o;const{div:t,properties:r,ctx:i}=e,{style:s}=t;let a="";if(y(Er,xl)>1&&(a=`scale(${1/y(Er,xl)})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:l}=s,{canvasWidth:c,fontSize:u}=r;le(o=Er,fs,Qx).call(o,i,u*y(this,wl),l);const{width:d}=i.measureText(t.textContent);d>0&&(a=`scaleX(${c*y(this,wl)/d}) ${a}`)}r.angle!==0&&(a=`rotate(${r.angle}deg) ${a}`),a.length>0&&(s.transform=a)},fs=new WeakSet,c0=function(e=null){let t=y(this,du).get(e||="");if(!t){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),y(this,du).set(e,t),y(this,Rg).set(t,{size:0,family:""})}return t},Qx=function(e,t,r){const i=y(this,Rg).get(e);t===i.size&&r===i.family||(e.font=`${t}px ${r}`,i.size=t,i.family=r)},nB=function(){if(y(this,xl)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),Z(this,xl,e.getBoundingClientRect().height),e.remove()},rB=function(e,t){const r=y(this,uu).get(e);if(r)return r;const i=le(this,fs,c0).call(this,t);i.canvas.width=i.canvas.height=Li,le(this,fs,Qx).call(this,i,Li,e);const s=i.measureText("");let a=s.fontBoundingBoxAscent,o=Math.abs(s.fontBoundingBoxDescent);if(a){const u=a/(a+o);return y(this,uu).set(e,u),i.canvas.width=i.canvas.height=0,u}i.strokeStyle="red",i.clearRect(0,0,Li,Li),i.strokeText("g",0,0);let l=i.getImageData(0,0,Li,Li).data;o=0;for(let u=l.length-1-3;u>=0;u-=4)if(l[u]>0){o=Math.ceil(u/4/Li);break}i.clearRect(0,0,Li,Li),i.strokeText("A",0,Li),l=i.getImageData(0,0,Li,Li).data,a=0;for(let u=0,d=l.length;u<d;u+=4)if(l[u]>0){a=Li-Math.floor(u/4/Li);break}i.canvas.width=i.canvas.height=0;const c=a?a/(a+o):r9;return y(this,uu).set(e,c),c},oe(Er,fs),oe(Er,uu,new Map),oe(Er,du,new Map),oe(Er,Rg,new WeakMap),oe(Er,xl,null),oe(Er,kh,new Set);let Gm=Er;class qm{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};function i(s){if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(qm.shouldBuildText(o))s?.attributes?.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&t.push({str:a}),!!s.children)for(const l of s.children)i(l)}return i(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const i9=65536,s9=100,a9=5e3,o9=hi?wj:bj,l9=hi?xj:WR,c9=hi?vj:yj,u9=hi?Tj:qR;function d9(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Zx,{docId:t}=e,r=n.url?h9(n.url):null,i=n.data?f9(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof iB?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:i9;let u=n.worker instanceof ah?n.worker:null;const d=n.verbosity,h=typeof n.docBaseUrl=="string"&&!Yv(n.docBaseUrl)?n.docBaseUrl:null,f=typeof n.cMapUrl=="string"?n.cMapUrl:null,p=n.cMapPacked!==!1,g=n.CMapReaderFactory||l9,b=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,_=n.StandardFontDataFactory||u9,m=n.stopAtErrors!==!0,v=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,x=n.isEvalSupported!==!1,w=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!hi,T=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!hi&&(Ai.platform.isFirefox||!globalThis.chrome),E=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,A=typeof n.disableFontFace=="boolean"?n.disableFontFace:hi,M=n.fontExtraProperties===!0,F=n.enableXfa===!0,G=n.ownerDocument||globalThis.document,S=n.disableRange===!0,I=n.disableStream===!0,C=n.disableAutoFetch===!0,H=n.pdfBug===!0,B=n.CanvasFactory||o9,$=n.FilterFactory||c9,X=n.enableHWA===!0,V=l?l.length:n.length??NaN,Q=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!hi&&!A,R=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:g===WR&&_===qR&&f&&b&&fm(f,document.baseURI)&&fm(b,document.baseURI),O=null;YW(d);const L={canvasFactory:new B({ownerDocument:G,enableHWA:X}),filterFactory:new $({docId:t,ownerDocument:G}),cMapReaderFactory:R?null:new g({baseUrl:f,isCompressed:p}),standardFontDataFactory:R?null:new _({baseUrl:b})};if(!u){const we={verbosity:d,port:Wu.workerPort};u=we.port?ah.fromPort(we):new ah(we),e._worker=u}const ne={docId:t,apiVersion:"4.10.38",data:i,password:o,disableAutoFetch:C,rangeChunkSize:c,length:V,docBaseUrl:h,enableXfa:F,evaluatorOptions:{maxImageSize:v,disableFontFace:A,ignoreErrors:m,isEvalSupported:x,isOffscreenCanvasSupported:w,isImageDecoderSupported:T,canvasMaxAreaInBytes:E,fontExtraProperties:M,useSystemFonts:Q,cMapUrl:R?f:null,standardFontDataUrl:R?b:null}},de={disableFontFace:A,fontExtraProperties:M,ownerDocument:G,pdfBug:H,styleElement:O,loadingParams:{disableAutoFetch:C,enableXfa:F}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const we=u.messageHandler.sendWithPromise("GetDocRequest",ne,i?[i.buffer]:null);let be;if(l)be=new Nj(l,{disableRange:S,disableStream:I});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");let Ee;if(hi)if(fm(r)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Ee=mF}else Ee=Jj;else Ee=fm(r)?mF:Kj;be=new Ee({url:r,length:V,httpHeaders:s,withCredentials:a,rangeChunkSize:c,disableRange:S,disableStream:I})}return we.then(Ee=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Fe=new _m(t,Ee,u.port),xe=new _9(Fe,e,be,de,L);e._transport=xe,Fe.send("Ready",null)})}).catch(e._capability.reject),e}function h9(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(hi&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function f9(n){if(hi&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Kv(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function gF(n){return typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0}var lv;const cv=class cv{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${vi(cv,lv)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}};lv=new WeakMap,oe(cv,lv,0);let Zx=cv;class iB{constructor(e,t,r=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const r of this._rangeListeners)r(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Pn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class p9{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Zt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Tl,po,ks,Xd,u0;class m9{constructor(e,t,r,i=!1){oe(this,ks);oe(this,Tl,null);oe(this,po,!1);this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=i?new nF:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new sB,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new T_({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Zt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:r="display",annotationMode:i=al.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:u=null,isEditing:d=!1}){this._stats?.time("Overall");const h=this._transport.getRenderingIntent(r,i,u,d),{renderingIntent:f,cacheKey:p}=h;Z(this,po,!1),le(this,ks,u0).call(this),o||=this._transport.getOptionalContentConfig(f);let g=this._intentStates.get(p);g||(g=Object.create(null),this._intentStates.set(p,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const b=!!(f&ls.PRINT);g.displayReadyCapability||(g.displayReadyCapability=Promise.withResolvers(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(h));const _=x=>{g.renderTasks.delete(m),(this._maybeCleanupAfterRender||b)&&Z(this,po,!0),le(this,ks,Xd).call(this,!b),x?(m.capability.reject(x),this._abortOperatorList({intentState:g,reason:x instanceof Error?x:new Error(x)})):m.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},m=new eT({callback:_,params:{canvasContext:e,viewport:t,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:c});(g.renderTasks||=new Set).add(m);const v=m.task;return Promise.all([g.displayReadyCapability.promise,o]).then(([x,w])=>{if(this.destroyed){_();return}if(this._stats?.time("Rendering"),!(w.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");m.initializeGraphics({transparency:x,optionalContentConfig:w}),m.operatorListChanged()}).catch(_),v}getOperatorList({intent:e="display",annotationMode:t=al.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,r,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||=new Set).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>qm.textContent(r));const t=this.streamTextContent(e);return new Promise(function(r,i){function s(){a.read().then(function({value:l,done:c}){if(c){r(o);return}o.lang??=l.lang,Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),Z(this,po,!1),le(this,ks,u0).call(this),Promise.all(e)}cleanup(e=!1){Z(this,po,!0);const t=le(this,ks,Xd).call(this,!1);return e&&t&&(this._stats&&=new nF),t}_startRenderPage(e,t){const r=this._intentStates.get(t);r&&(this._stats?.timeEnd("Page Request"),r.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let r=0,i=e.length;r<i;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const r of t.renderTasks)r.operatorListChanged();e.lastChunk&&le(this,ks,Xd).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:i}){const{map:s,transfer:a}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:i},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const u=()=>{l.read().then(({value:d,done:h})=>{if(h){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,c),u())},d=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const h of c.renderTasks)h.operatorListChanged();le(this,ks,Xd).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(d);else if(c.opListReadCapability)c.opListReadCapability.reject(d);else throw d}})};u()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof KE){let i=s9;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Wl(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Tl=new WeakMap,po=new WeakMap,ks=new WeakSet,Xd=function(e=!1){if(le(this,ks,u0).call(this),!y(this,po)||this.destroyed)return!1;if(e)return Z(this,Tl,setTimeout(()=>{Z(this,Tl,null),le(this,ks,Xd).call(this,!1)},a9)),!1;for(const{renderTasks:t,operatorList:r}of this._intentStates.values())if(t.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Z(this,po,!1),!0},u0=function(){y(this,Tl)&&(clearTimeout(y(this,Tl)),Z(this,Tl,null))};var mo,uv;class g9{constructor(){oe(this,mo,new Map);oe(this,uv,Promise.resolve())}postMessage(e,t){const r={data:structuredClone(e,t?{transfer:t}:null)};y(this,uv).then(()=>{for(const[i]of y(this,mo))i.call(this,r)})}addEventListener(e,t,r=null){let i=null;if(r?.signal instanceof AbortSignal){const{signal:s}=r;if(s.aborted){Xt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}y(this,mo).set(t,i)}removeEventListener(e,t){y(this,mo).get(t)?.(),y(this,mo).delete(t)}terminate(){for(const[,e]of y(this,mo))e?.();y(this,mo).clear()}}mo=new WeakMap,uv=new WeakMap;var dv,hu,fu,Fh,d0,Ih,h0;const Nn=class Nn{constructor({name:e=null,port:t=null,verbosity:r=QW()}={}){oe(this,Fh);if(this.name=e,this.destroyed=!1,this.verbosity=r,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(y(Nn,fu)?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(y(Nn,fu)||Z(Nn,fu,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _m("main","worker",e),this._messageHandler.on("ready",function(){}),le(this,Fh,d0).call(this)}_initialize(){if(y(Nn,hu)||y(Nn,Ih,h0)){this._setupFakeWorker();return}let{workerSrc:e}=Nn;try{Nn._isSameOrigin(window.location.href,e)||(e=Nn._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),r=new _m("main","worker",t),i=()=>{s.abort(),r.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:s.signal}),r.on("test",o=>{if(s.abort(),this.destroyed||!o){i();return}this._messageHandler=r,this._port=t,this._webWorker=t,le(this,Fh,d0).call(this)}),r.on("ready",o=>{if(s.abort(),this.destroyed){i();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;r.send("test",o,[o.buffer])};a();return}catch{Hv("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){y(Nn,hu)||(Xt("Setting up fake worker."),Z(Nn,hu,!0)),Nn._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new g9;this._port=t;const r=`fake${vi(Nn,dv)._++}`,i=new _m(r+"_worker",r,t);e.setup(i,t),this._messageHandler=new _m(r,r+"_worker",t),le(this,Fh,d0).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,y(Nn,fu)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=y(this,fu)?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Nn(e)}static get workerSrc(){if(Wu.workerSrc)return Wu.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Zt(this,"_setupFakeWorkerGlobal",(async()=>y(this,Ih,h0)?y(this,Ih,h0):(await import(this.workerSrc)).WorkerMessageHandler)())}};dv=new WeakMap,hu=new WeakMap,fu=new WeakMap,Fh=new WeakSet,d0=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Ih=new WeakSet,h0=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},oe(Nn,Ih),oe(Nn,dv,0),oe(Nn,hu,!1),oe(Nn,fu),hi&&(Z(Nn,hu,!0),Wu.workerSrc||="./pdf.worker.mjs"),Nn._isSameOrigin=(e,t)=>{let r;try{if(r=new URL(e),!r.origin||r.origin==="null")return!1}catch{return!1}const i=new URL(t,r);return r.origin===i.origin},Nn._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let ah=Nn;var go,Fa,Oh,Uh,_o,pu,xm;class _9{constructor(e,t,r,i,s){oe(this,pu);oe(this,go,new Map);oe(this,Fa,new Map);oe(this,Oh,new Map);oe(this,Uh,new Map);oe(this,_o,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new sB,this.fontLoader=new gj({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Zt(this,"annotationStorage",new ZE)}getRenderingIntent(e,t=al.ENABLE,r=null,i=!1,s=!1){let a=ls.DISPLAY,o=zx;switch(e){case"any":a=ls.ANY;break;case"display":break;case"print":a=ls.PRINT;break;default:Xt(`getRenderingIntent - invalid intent: ${e}`)}const l=a&ls.PRINT&&r instanceof LR?r:this.annotationStorage;switch(t){case al.DISABLE:a+=ls.ANNOTATIONS_DISABLE;break;case al.ENABLE:break;case al.ENABLE_FORMS:a+=ls.ANNOTATIONS_FORMS;break;case al.ENABLE_STORAGE:a+=ls.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Xt(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=ls.IS_EDITING),s&&(a+=ls.OPLIST);const{ids:c,hash:u}=l.modifiedIds,d=[a,o.hash,u];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),y(this,_o)?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of y(this,Fa).values())e.push(r._destroy());y(this,Fa).clear(),y(this,Oh).clear(),y(this,Uh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),y(this,go).clear(),this.filterFactory.destroy(),Gm.cleanup(),this._networkStream?.cancelAllRequests(new Wl("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,i)=>{_r(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){i.close();return}_r(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async r=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:a}=this._fullReader;return(!i||!s)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=o=>{t.onProgress?.({loaded:o.loaded,total:o.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:a}}),e.on("GetRangeReader",(r,i)=>{_r(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){i.close();return}_r(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{s.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new p9(r,this))}),e.on("DocException",r=>{t._capability.reject(Ri(r))}),e.on("PasswordRequest",r=>{Z(this,_o,Promise.withResolvers());try{if(!t.onPassword)throw Ri(r);const i=s=>{s instanceof Error?y(this,_o).reject(s):y(this,_o).resolve({password:s})};t.onPassword(i,r.code)}catch(i){y(this,_o).reject(i)}return y(this,_o).promise}),e.on("DataLoaded",r=>{t.onProgress?.({loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;y(this,Fa).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,s])=>{if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":const{disableFontFace:a,fontExtraProperties:o,pdfBug:l}=this._params;if("error"in s){const h=s.error;Xt(`Error during font loading: ${h}`),this.commonObjs.resolve(r,h);break}const c=l&&globalThis.FontInspector?.enabled?(h,f)=>globalThis.FontInspector.fontAdded(h,f):null,u=new _j(s,{disableFontFace:a,fontExtraProperties:o,inspectFont:c});this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!o&&u.data&&(u.data=null),this.commonObjs.resolve(r,u)});break;case"CopyLocalImage":const{imageRef:d}=s;_r(d,"The imageRef must be defined.");for(const h of y(this,Fa).values())for(const[,f]of h.objs)if(f?.ref===d)return f.dataLen?(this.commonObjs.resolve(r,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([r,i,s,a])=>{if(this.destroyed)return;const o=y(this,Fa).get(i);if(!o.objs.has(r)){if(o._intentStates.size===0){a?.bitmap?.close();return}switch(s){case"Image":o.objs.resolve(r,a),a?.dataLen>qW&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",r=>{this.destroyed||t.onProgress?.({loaded:r.loaded,total:r.total})}),e.on("FetchBuiltInCMap",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(r)}),e.on("FetchStandardFontData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Xt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,r=y(this,Oh).get(t);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&y(this,Uh).set(s.refStr,e);const a=new m9(t,s,this,this._params.pdfBug);return y(this,Fa).set(t,a),a});return y(this,Oh).set(t,i),i}getPageIndex(e){return gF(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return le(this,pu,xm).call(this,"GetFieldObjects")}hasJSActions(){return le(this,pu,xm).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return le(this,pu,xm).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return le(this,pu,xm).call(this,"GetOptionalContentConfig").then(t=>new $j(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=y(this,go).get(e);if(t)return t;const r=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new Rj(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return y(this,go).set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of y(this,Fa).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),y(this,go).clear(),this.filterFactory.destroy(!0),Gm.cleanup()}}cachedPageNumber(e){if(!gF(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return y(this,Uh).get(t)??null}}go=new WeakMap,Fa=new WeakMap,Oh=new WeakMap,Uh=new WeakMap,_o=new WeakMap,pu=new WeakSet,xm=function(e,t=null){const r=y(this,go).get(e);if(r)return r;const i=this.messageHandler.sendWithPromise(e,t);return y(this,go).set(e,i),i};const em=Symbol("INITIAL_DATA");var Ji,Bg,Jx;class sB{constructor(){oe(this,Bg);oe(this,Ji,Object.create(null))}get(e,t=null){if(t){const i=le(this,Bg,Jx).call(this,e);return i.promise.then(()=>t(i.data)),null}const r=y(this,Ji)[e];if(!r||r.data===em)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=y(this,Ji)[e];return!!t&&t.data!==em}delete(e){const t=y(this,Ji)[e];return!t||t.data===em?!1:(delete y(this,Ji)[e],!0)}resolve(e,t=null){const r=le(this,Bg,Jx).call(this,e);r.data=t,r.resolve()}clear(){for(const e in y(this,Ji)){const{data:t}=y(this,Ji)[e];t?.bitmap?.close()}Z(this,Ji,Object.create(null))}*[Symbol.iterator](){for(const e in y(this,Ji)){const{data:t}=y(this,Ji)[e];t!==em&&(yield[e,t])}}}Ji=new WeakMap,Bg=new WeakSet,Jx=function(e){return y(this,Ji)[e]||={...Promise.withResolvers(),data:em}};var El;class b9{constructor(e){oe(this,El,null);Z(this,El,e),this.onContinue=null}get promise(){return y(this,El).capability.promise}cancel(e=0){y(this,El).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=y(this,El).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=y(this,El);return e.form||e.canvas&&t?.size>0}}El=new WeakMap;var Dl,mu;const Uc=class Uc{constructor({callback:e,params:t,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:d=!1,pageColors:h=null}){oe(this,Dl,null);this.callback=e,this.params=t,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=d,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new b9(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(y(Uc,mu).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");y(Uc,mu).add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:i,transform:s,background:a}=this.params;this.gfx=new sh(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),y(this,Dl)&&(window.cancelAnimationFrame(y(this,Dl)),Z(this,Dl,null)),y(Uc,mu).delete(this._canvas),this.callback(e||new KE(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?Z(this,Dl,window.requestAnimationFrame(()=>{Z(this,Dl,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),y(Uc,mu).delete(this._canvas),this.callback())))}};Dl=new WeakMap,mu=new WeakMap,oe(Uc,mu,new WeakSet);let eT=Uc;const y9="4.10.38",v9="f9bea397f";function _F(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function tm(n){return Math.max(0,Math.min(255,255*n))}class bF{static CMYK_G([e,t,r,i]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=tm(e),[e,e,e]}static G_HTML([e]){const t=_F(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(tm)}static RGB_HTML(e){return`#${e.map(_F).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,r+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,r,i]){return[tm(1-Math.min(1,e+i)),tm(1-Math.min(1,r+i)),tm(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){const i=1-e,s=1-t,a=1-r,o=Math.min(i,s,a);return["CMYK",i,s,a,o]}}class w9{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Pn("Abstract method `_createSVG` called.")}}class eD extends w9{_createSVG(e){return document.createElementNS(Za,e)}}class aB{static setupStorage(e,t,r,i,s){const a=i.getValue(t,{value:null});switch(r.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(a.value===r.attributes.xfaOn?e.setAttribute("checked",!0):a.value===r.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of r.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:i,linkService:s}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&s.addLinkAttributes(e,a.href,a.newWindow),r&&a.dataId&&this.setupStorage(e,a.dataId,t,r)}static render(e){const t=e.annotationStorage,r=e.linkService,i=e.xfaHtml,s=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:s,linkService:r});const o=s!=="richText",l=e.div;if(l.append(a),e.viewport){const d=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=d}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(i.children.length===0){if(i.value){const d=document.createTextNode(i.value);a.append(d),o&&qm.shouldBuildText(i.name)&&c.push(d)}return{textDivs:c}}const u=[[i,-1,a]];for(;u.length>0;){const[d,h,f]=u.at(-1);if(h+1===d.children.length){u.pop();continue}const p=d.children[++u.at(-1)[1]];if(p===null)continue;const{name:g}=p;if(g==="#text"){const _=document.createTextNode(p.value);c.push(_),f.append(_);continue}const b=p?.attributes?.xmlns?document.createElementNS(p.attributes.xmlns,g):document.createElement(g);if(f.append(b),p.attributes&&this.setAttributes({html:b,element:p,storage:t,intent:s,linkService:r}),p.children?.length>0)u.push([p,-1,b]);else if(p.value){const _=document.createTextNode(p.value);o&&qm.shouldBuildText(g)&&c.push(_),b.append(_)}}for(const d of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const D_=1e3,x9=9,qu=new WeakSet;function $l(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class T9{static create(e){switch(e.data.annotationType){case Tr.LINK:return new oB(e);case Tr.TEXT:return new E9(e);case Tr.WIDGET:switch(e.data.fieldType){case"Tx":return new D9(e);case"Btn":return e.data.radioButton?new uB(e):e.data.checkBox?new A9(e):new C9(e);case"Ch":return new S9(e);case"Sig":return new M9(e)}return new nd(e);case Tr.POPUP:return new nT(e);case Tr.FREETEXT:return new mB(e);case Tr.LINE:return new k9(e);case Tr.SQUARE:return new F9(e);case Tr.CIRCLE:return new I9(e);case Tr.POLYLINE:return new gB(e);case Tr.CARET:return new U9(e);case Tr.INK:return new tD(e);case Tr.POLYGON:return new O9(e);case Tr.HIGHLIGHT:return new _B(e);case Tr.UNDERLINE:return new L9(e);case Tr.SQUIGGLY:return new R9(e);case Tr.STRIKEOUT:return new B9(e);case Tr.STAMP:return new bB(e);case Tr.FILEATTACHMENT:return new $9(e);default:return new lr(e)}}}var gu,Lh,Rh,$g,tT;const UD=class UD{constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){oe(this,$g);oe(this,gu,null);oe(this,Lh,!1);oe(this,Rh,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:r}){return!!(e?.str||t?.str||r?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return UD._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;y(this,gu)||Z(this,gu,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&le(this,$g,tT).call(this,t),y(this,Rh)?.popup.updateEdited(e)}resetEdited(){y(this,gu)&&(le(this,$g,tT).call(this,y(this,gu).rect),y(this,Rh)?.popup.resetEdited(),Z(this,gu,null))}_createContainer(e){const{data:t,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof nd||(s.tabIndex=D_);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof nT){const{rotation:g}=t;return!t.hasOwnCanvas&&g!==0&&this.setRotation(g,s),s}const{width:o,height:l}=$l(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const g=t.borderStyle.horizontalCornerRadius,b=t.borderStyle.verticalCornerRadius;if(g>0||b>0){const m=`calc(${g}px * var(--scale-factor)) / calc(${b}px * var(--scale-factor))`;a.borderRadius=m}else if(this instanceof uB){const m=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=m}switch(t.borderStyle.style){case Zp.SOLID:a.borderStyle="solid";break;case Zp.DASHED:a.borderStyle="dashed";break;case Zp.BEVELED:Xt("Unimplemented border style: beveled");break;case Zp.INSET:Xt("Unimplemented border style: inset");break;case Zp.UNDERLINE:a.borderBottomStyle="solid";break}const _=t.borderColor||null;_?(Z(this,Lh,!0),a.borderColor=At.makeHexColor(_[0]|0,_[1]|0,_[2]|0)):a.borderWidth=0}const c=At.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:u,pageHeight:d,pageX:h,pageY:f}=i.rawDims;a.left=`${100*(c[0]-h)/u}%`,a.top=`${100*(c[1]-f)/d}%`;const{rotation:p}=t;return t.hasOwnCanvas||p===0?(a.width=`${100*o/u}%`,a.height=`${100*l/d}%`):this.setRotation(p,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims,{width:s,height:a}=$l(this.data.rect);let o,l;e%180===0?(o=100*s/r,l=100*a/i):(o=100*a/r,l=100*s/i),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,r,i)=>{const s=i.detail[t],a=s[0],o=s.slice(1);i.target.style[r]=bF[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[r]:bF[`${a}_rgb`](o)})};return Zt(this,"_commonActions",{display:t=>{const{display:r}=t.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){const r=this._commonActions;for(const i of Object.keys(t.detail))(e[i]||r[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const r=this._commonActions;for(const[i,s]of Object.entries(t)){const a=r[i];if(a){const o={detail:{[i]:s},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,r,i,s]=this.data.rect.map(g=>Math.fround(g));if(e.length===8){const[g,b,_,m]=e.subarray(2,6);if(i===g&&s===b&&t===_&&r===m)return}const{style:a}=this.container;let o;if(y(this,Lh)){const{borderColor:g,borderWidth:b}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const l=i-t,c=s-r,{svgFactory:u}=this,d=u.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const h=u.createElement("defs");d.append(h);const f=u.createElement("clipPath"),p=`clippath_${this.data.id}`;f.setAttribute("id",p),f.setAttribute("clipPathUnits","objectBoundingBox"),h.append(f);for(let g=2,b=e.length;g<b;g+=8){const _=e[g],m=e[g+1],v=e[g+2],x=e[g+3],w=u.createElement("rect"),T=(v-t)/l,E=(s-m)/c,A=(_-v)/l,M=(m-x)/c;w.setAttribute("x",T),w.setAttribute("y",E),w.setAttribute("width",A),w.setAttribute("height",M),f.append(w),o?.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${E}" width="${A}" height="${M}"/>`)}y(this,Lh)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{data:e}=this,t=Z(this,Rh,new nT({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Pn("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const r=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:s,id:a,exportValues:o}of i){if(s===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!qu.has(c)){Xt(`_getElementsByName - element not allowed: ${a}`);continue}r.push({id:a,exportValue:l,domElement:c})}return r}for(const i of document.getElementsByName(e)){const{exportValue:s}=i,a=i.getAttribute("data-element-id");a!==t&&qu.has(i)&&r.push({id:a,exportValue:s,domElement:i})}return r}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};gu=new WeakMap,Lh=new WeakMap,Rh=new WeakMap,$g=new WeakSet,tT=function(e){const{container:{style:t},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;r?.splice(0,4,...e);const{width:c,height:u}=$l(e);t.left=`${100*(e[0]-o)/s}%`,t.top=`${100*(a-e[3]+l)/a}%`,i===0?(t.width=`${100*c/s}%`,t.height=`${100*u/a}%`):this.setRotation(i)};let lr=UD;var us,Ac,lB,cB;class oB extends lr{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!r?.ignoreBorder,createQuadrilaterals:!0});oe(this,us);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:r}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(r.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action),s=!0):t.attachment?(le(this,us,lB).call(this,i,t.attachment,t.attachmentDest),s=!0):t.setOCGState?(le(this,us,cB).call(this,i,t.setOCGState),s=!0):t.dest?(this._bindLink(i,t.dest),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}_bindLink(t,r){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&le(this,us,Ac).call(this)}_bindNamedAction(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),le(this,us,Ac).call(this)}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(r.actions)){const a=i.get(s);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:s}}),!1))}t.onclick||(t.onclick=()=>!1),le(this,us,Ac).call(this)}_bindResetFormAction(t,r){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),le(this,us,Ac).call(this),!this._fieldObjects){Xt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:s,refs:a,include:o}=r,l=[];if(s.length!==0||a.length!==0){const d=new Set(a);for(const h of s){const f=this._fieldObjects[h]||[];for(const{id:p}of f)d.add(p)}for(const h of Object.values(this._fieldObjects))for(const f of h)d.has(f.id)===o&&l.push(f)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const c=this.annotationStorage,u=[];for(const d of l){const{id:h}=d;switch(u.push(h),d.type){case"text":{const p=d.defaultValue||"";c.setValue(h,{value:p});break}case"checkbox":case"radiobutton":{const p=d.defaultValue===d.exportValues;c.setValue(h,{value:p});break}case"combobox":case"listbox":{const p=d.defaultValue||"";c.setValue(h,{value:p});break}default:continue}const f=document.querySelector(`[data-element-id="${h}"]`);if(f){if(!qu.has(f)){Xt(`_bindResetFormAction - element not allowed: ${h}`);continue}}else continue;f.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}}),!1}}}us=new WeakSet,Ac=function(){this.container.setAttribute("data-internal-link","")},lB=function(t,r,i=null){t.href=this.linkService.getAnchorUrl(""),r.description&&(t.title=r.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(r.content,r.filename,i),!1),le(this,us,Ac).call(this)},cB=function(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(r),!1),le(this,us,Ac).call(this)};class E9 extends lr{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class nd extends lr{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Ai.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,i,s){r.includes("mouse")?e.addEventListener(r,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(r,a=>{if(r==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a)}})})}_setEventListeners(e,t,r,i){for(const[s,a]of r)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,s,a,i),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":At.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||x9,s=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),u=Math.round(c/(l2*i))||1,d=c/u;a=Math.min(i,l(d/l2))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,l(c/l2))}s.fontSize=`calc(${a}px * var(--scale-factor))`,s.color=At.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class D9 extends nd{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,i){const s=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=r),s.setValue(a.id,{[i]:r})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let s=i.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&s.length>a&&(s=s.slice(0,a));let o=i.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const l={userValue:s,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=o??s,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type="text",r.setAttribute("value",o??s),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),qu.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=D_,this._setRequired(r,this.data.required),a&&(r.maxLength=a),r.addEventListener("input",u=>{e.setValue(t,{value:u.target.value}),this.setPropertyOnSiblings(r,"value",u.target.value,"value"),l.formattedValue=null}),r.addEventListener("resetform",u=>{const d=this.data.defaultFieldValue??"";r.value=l.userValue=d,l.formattedValue=null});let c=u=>{const{formattedValue:d}=l;d!=null&&(u.target.value=d),u.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",d=>{if(l.focused)return;const{target:h}=d;l.userValue&&(h.value=l.userValue),l.lastCommittedValue=h.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),r.addEventListener("updatefromsandbox",d=>{this.showElementAndHideCanvas(d.target);const h={value(f){l.userValue=f.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),f.target.value=l.userValue},formattedValue(f){const{formattedValue:p}=f.detail;l.formattedValue=p,p!=null&&f.target!==document.activeElement&&(f.target.value=p),e.setValue(t,{formattedValue:p})},selRange(f){f.target.setSelectionRange(...f.detail.selRange)},charLimit:f=>{const{charLimit:p}=f.detail,{target:g}=f;if(p===0){g.removeAttribute("maxLength");return}g.setAttribute("maxLength",p);let b=l.userValue;!b||b.length<=p||(b=b.slice(0,p),g.value=l.userValue=b,e.setValue(t,{value:b}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:1,selStart:g.selectionStart,selEnd:g.selectionEnd}}))}};this._dispatchEventFromSandbox(h,d)}),r.addEventListener("keydown",d=>{l.commitKey=1;let h=-1;if(d.key==="Escape"?h=0:d.key==="Enter"&&!this.data.multiLine?h=2:d.key==="Tab"&&(l.commitKey=3),h===-1)return;const{value:f}=d.target;l.lastCommittedValue!==f&&(l.lastCommittedValue=f,l.userValue=f,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:h,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}))});const u=c;c=null,r.addEventListener("blur",d=>{if(!l.focused||!d.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{value:h}=d.target;l.userValue=h,l.lastCommittedValue!==h&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,willCommit:!0,commitKey:l.commitKey,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}),u(d)}),this.data.actions?.Keystroke&&r.addEventListener("beforeinput",d=>{l.lastCommittedValue=null;const{data:h,target:f}=d,{value:p,selectionStart:g,selectionEnd:b}=f;let _=g,m=b;switch(d.inputType){case"deleteWordBackward":{const v=p.substring(0,g).match(/\w*[^\w]*$/);v&&(_-=v[0].length);break}case"deleteWordForward":{const v=p.substring(g).match(/^[^\w]*\w*/);v&&(m+=v[0].length);break}case"deleteContentBackward":g===b&&(_-=1);break;case"deleteContentForward":g===b&&(m+=1);break}d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,change:h||"",willCommit:!1,selStart:_,selEnd:m}})}),this._setEventListeners(r,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.value)}if(c&&r.addEventListener("blur",c),this.data.comb){const d=(this.data.rect[2]-this.data.rect[0])/a;r.classList.add("comb"),r.style.letterSpacing=`calc(${d}px * var(--scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class M9 extends nd{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class A9 extends nd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return qu.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=D_,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,r)){const u=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=u),e.setValue(c.id,{value:u})}e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class uB extends nd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(r,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,r))e.setValue(a.id,{value:!1});const s=document.createElement("input");if(qu.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=D_,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,r))e.setValue(c.id,{value:!1});e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;s.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const u=a===c.detail.value;for(const d of this._getElementsByName(c.target.name)){const h=u&&d.id===r;d.domElement&&(d.domElement.checked=h),e.setValue(d.id,{value:h})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class C9 extends oB{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class S9 extends nd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");qu.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=D_;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",u=>{const d=this.data.defaultFieldValue;for(const h of i.options)h.selected=h.value===d});for(const u of this.data.options){const d=document.createElement("option");d.textContent=u.displayValue,d.value=u.exportValue,r.value.includes(u.exportValue)&&(d.setAttribute("selected",!0),s=!1),i.append(d)}let a=null;if(s){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),i.prepend(u),a=()=>{u.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=u=>{const d=u?"value":"textContent",{options:h,multiple:f}=i;return f?Array.prototype.filter.call(h,p=>p.selected).map(p=>p[d]):h.selectedIndex===-1?null:h[h.selectedIndex][d]};let l=o(!1);const c=u=>{const d=u.target.options;return Array.prototype.map.call(d,h=>({displayValue:h.textContent,exportValue:h.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",u=>{const d={value(h){a?.();const f=h.detail.value,p=new Set(Array.isArray(f)?f:[f]);for(const g of i.options)g.selected=p.has(g.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(h){i.multiple=!0},remove(h){const f=i.options,p=h.detail.remove;f[p].selected=!1,i.remove(p),f.length>0&&Array.prototype.findIndex.call(f,b=>b.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:o(!0),items:c(h)}),l=o(!1)},clear(h){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(h){const{index:f,displayValue:p,exportValue:g}=h.detail.insert,b=i.children[f],_=document.createElement("option");_.textContent=p,_.value=g,b?b.before(_):i.append(_),e.setValue(t,{value:o(!0),items:c(h)}),l=o(!1)},items(h){const{items:f}=h.detail;for(;i.length!==0;)i.remove(0);for(const p of f){const{displayValue:g,exportValue:b}=p,_=document.createElement("option");_.textContent=g,_.value=b,i.append(_)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(h)}),l=o(!1)},indices(h){const f=new Set(h.detail.indices);for(const p of h.target.options)p.selected=f.has(p.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(h){h.target.disabled=!h.detail.editable}};this._dispatchEventFromSandbox(d,u)}),i.addEventListener("input",u=>{const d=o(!0),h=o(!1);e.setValue(t,{value:d}),u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:h,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):i.addEventListener("input",function(u){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class nT extends lr{constructor(e){const{data:t,elements:r}=e;super(e,{isRenderable:lr._hasPopupData(t)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new P9({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",t.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(r=>`${HE}${r}`).join(",")),this.container}}var Bh,hv,fv,$h,_u,nr,bo,Nh,Ng,zg,zh,yo,Zs,vo,Wg,wo,jg,bu,yu,En,f0,rT,dB,hB,fB,pB,p0,m0,iT;class P9{constructor({container:e,color:t,elements:r,titleObj:i,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:c,parentRect:u,open:d}){oe(this,En);oe(this,Bh,le(this,En,fB).bind(this));oe(this,hv,le(this,En,iT).bind(this));oe(this,fv,le(this,En,m0).bind(this));oe(this,$h,le(this,En,p0).bind(this));oe(this,_u,null);oe(this,nr,null);oe(this,bo,null);oe(this,Nh,null);oe(this,Ng,null);oe(this,zg,null);oe(this,zh,null);oe(this,yo,!1);oe(this,Zs,null);oe(this,vo,null);oe(this,Wg,null);oe(this,wo,null);oe(this,jg,null);oe(this,bu,null);oe(this,yu,!1);Z(this,nr,e),Z(this,jg,i),Z(this,bo,a),Z(this,wo,o),Z(this,zg,l),Z(this,_u,t),Z(this,Wg,c),Z(this,zh,u),Z(this,Ng,r),Z(this,Nh,YE.toDateObject(s)),this.trigger=r.flatMap(h=>h.getElementsToTriggerPopup());for(const h of this.trigger)h.addEventListener("click",y(this,$h)),h.addEventListener("mouseenter",y(this,fv)),h.addEventListener("mouseleave",y(this,hv)),h.classList.add("popupTriggerArea");for(const h of r)h.container?.addEventListener("keydown",y(this,Bh));y(this,nr).hidden=!0,d&&le(this,En,p0).call(this)}render(){if(y(this,Zs))return;const e=Z(this,Zs,document.createElement("div"));if(e.className="popup",y(this,_u)){const s=e.style.outlineColor=At.makeHexColor(...y(this,_u));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:e.style.backgroundColor=At.makeHexColor(...y(this,_u).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const r=document.createElement("h1");if(t.append(r),{dir:r.dir,str:r.textContent}=y(this,jg),e.append(t),y(this,Nh)){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:y(this,Nh).valueOf()})),t.append(s)}const i=y(this,En,f0);if(i)aB.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(y(this,bo));e.append(s)}y(this,nr).append(e)}_formatContents({str:e,dir:t}){const r=document.createElement("p");r.classList.add("popupContent"),r.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let s=0,a=i.length;s<a;++s){const o=i[s];r.append(document.createTextNode(o)),s<a-1&&r.append(document.createElement("br"))}return r}updateEdited({rect:e,popupContent:t}){y(this,bu)||Z(this,bu,{contentsObj:y(this,bo),richText:y(this,wo)}),e&&Z(this,vo,null),t&&(Z(this,wo,le(this,En,hB).call(this,t)),Z(this,bo,null)),y(this,Zs)?.remove(),Z(this,Zs,null)}resetEdited(){y(this,bu)&&({contentsObj:vi(this,bo)._,richText:vi(this,wo)._}=y(this,bu),Z(this,bu,null),y(this,Zs)?.remove(),Z(this,Zs,null),Z(this,vo,null))}forceHide(){Z(this,yu,this.isVisible),y(this,yu)&&(y(this,nr).hidden=!0)}maybeShow(){y(this,yu)&&(y(this,Zs)||le(this,En,m0).call(this),Z(this,yu,!1),y(this,nr).hidden=!1)}get isVisible(){return y(this,nr).hidden===!1}}Bh=new WeakMap,hv=new WeakMap,fv=new WeakMap,$h=new WeakMap,_u=new WeakMap,nr=new WeakMap,bo=new WeakMap,Nh=new WeakMap,Ng=new WeakMap,zg=new WeakMap,zh=new WeakMap,yo=new WeakMap,Zs=new WeakMap,vo=new WeakMap,Wg=new WeakMap,wo=new WeakMap,jg=new WeakMap,bu=new WeakMap,yu=new WeakMap,En=new WeakSet,f0=function(){const e=y(this,wo),t=y(this,bo);return e?.str&&(!t?.str||t.str===e.str)&&y(this,wo).html||null},rT=function(){return y(this,En,f0)?.attributes?.style?.fontSize||0},dB=function(){return y(this,En,f0)?.attributes?.style?.color||null},hB=function(e){const t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:y(this,En,dB),fontSize:y(this,En,rT)?`calc(${y(this,En,rT)}px * var(--scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:i});return r},fB=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&y(this,yo))&&le(this,En,p0).call(this)},pB=function(){if(y(this,vo)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:i,pageY:s}}}=y(this,zg);let a=!!y(this,zh),o=a?y(this,zh):y(this,Wg);for(const p of y(this,Ng))if(!o||At.intersect(p.data.rect,o)!==null){o=p.data.rect,a=!0;break}const l=At.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),u=a?o[2]-o[0]+5:0,d=l[0]+u,h=l[1];Z(this,vo,[100*(d-i)/t,100*(h-s)/r]);const{style:f}=y(this,nr);f.left=`${y(this,vo)[0]}%`,f.top=`${y(this,vo)[1]}%`},p0=function(){Z(this,yo,!y(this,yo)),y(this,yo)?(le(this,En,m0).call(this),y(this,nr).addEventListener("click",y(this,$h)),y(this,nr).addEventListener("keydown",y(this,Bh))):(le(this,En,iT).call(this),y(this,nr).removeEventListener("click",y(this,$h)),y(this,nr).removeEventListener("keydown",y(this,Bh)))},m0=function(){y(this,Zs)||this.render(),this.isVisible?y(this,yo)&&y(this,nr).classList.add("focused"):(le(this,En,pB).call(this),y(this,nr).hidden=!1,y(this,nr).style.zIndex=parseInt(y(this,nr).style.zIndex)+1e3)},iT=function(){y(this,nr).classList.remove("focused"),!(y(this,yo)||!this.isVisible)&&(y(this,nr).hidden=!0,y(this,nr).style.zIndex=parseInt(y(this,nr).style.zIndex)-1e3)};class mB extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Kt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Vg;class k9 extends lr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});oe(this,Vg,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:r,height:i}=$l(t.rect),s=this.svgFactory.create(r,i,!0),a=Z(this,Vg,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return y(this,Vg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Vg=new WeakMap;var Gg;class F9 extends lr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});oe(this,Gg,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:r,height:i}=$l(t.rect),s=this.svgFactory.create(r,i,!0),a=t.borderStyle.width,o=Z(this,Gg,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",r-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return y(this,Gg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gg=new WeakMap;var qg;class I9 extends lr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});oe(this,qg,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:r,height:i}=$l(t.rect),s=this.svgFactory.create(r,i,!0),a=t.borderStyle.width,o=Z(this,qg,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",r/2),o.setAttribute("cy",i/2),o.setAttribute("rx",r/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return y(this,qg)}addHighlightArea(){this.container.classList.add("highlightArea")}}qg=new WeakMap;var Hg;class gB extends lr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});oe(this,Hg,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:r,borderStyle:i,popupRef:s}}=this;if(!r)return this.container;const{width:a,height:o}=$l(t),l=this.svgFactory.create(a,o,!0);let c=[];for(let d=0,h=r.length;d<h;d+=2){const f=r[d]-t[0],p=t[3]-r[d+1];c.push(`${f},${p}`)}c=c.join(" ");const u=Z(this,Hg,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",c),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),l.append(u),this.container.append(l),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return y(this,Hg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hg=new WeakMap;class O9 extends gB{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class U9 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Kg,vu,Xg,sT;class tD extends lr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});oe(this,Xg);oe(this,Kg,null);oe(this,vu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Kt.HIGHLIGHT:Kt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:r,inkLists:i,borderStyle:s,popupRef:a}}=this,{transform:o,width:l,height:c}=le(this,Xg,sT).call(this,r,t),u=this.svgFactory.create(l,c,!0),d=Z(this,Kg,this.svgFactory.createElement("svg:g"));u.append(d),d.setAttribute("stroke-width",s.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let h=0,f=i.length;h<f;h++){const p=this.svgFactory.createElement(this.svgElementName);y(this,vu).push(p),p.setAttribute("points",i[h].join(",")),d.append(p)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:r,points:i,rect:s}=t,a=y(this,Kg);if(r>=0&&a.setAttribute("stroke-width",r||1),i)for(let o=0,l=y(this,vu).length;o<l;o++)y(this,vu)[o].setAttribute("points",i[o].join(","));if(s){const{transform:o,width:l,height:c}=le(this,Xg,sT).call(this,this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return y(this,vu)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kg=new WeakMap,vu=new WeakMap,Xg=new WeakSet,sT=function(t,r){switch(t){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class _B extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Kt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class L9 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class R9 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class B9 extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class bB extends lr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Kt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Yg,Qg,aT;class $9 extends lr{constructor(t){super(t,{isRenderable:!0});oe(this,Qg);oe(this,Yg,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:r}=this;let i;r.hasAppearance||r.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),i.addEventListener("dblclick",le(this,Qg,aT).bind(this)),Z(this,Yg,i);const{isMac:s}=Ai.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&le(this,Qg,aT).call(this)}),!r.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return y(this,Yg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Yg=new WeakMap,Qg=new WeakSet,aT=function(){this.downloadManager?.openOrDownloadData(this.content,this.filename)};var Zg,wu,xu,Jg,Yu,yB,oT;class N9{constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:a,structTreeLayer:o}){oe(this,Yu);oe(this,Zg,null);oe(this,wu,null);oe(this,xu,new Map);oe(this,Jg,null);this.div=e,Z(this,Zg,t),Z(this,wu,r),Z(this,Jg,o||null),this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return y(this,xu).size>0}async render(e){const{annotations:t}=e,r=this.div;Vu(r,this.viewport);const i=new Map,s={data:null,layer:r,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new eD,annotationStorage:e.annotationStorage||new ZE,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const o=a.annotationType===Tr.POPUP;if(o){const u=i.get(a.id);if(!u)continue;s.elements=u}else{const{width:u,height:d}=$l(a.rect);if(u<=0||d<=0)continue}s.data=a;const l=T9.create(s);if(!l.isRenderable)continue;if(!o&&a.popupRef){const u=i.get(a.popupRef);u?u.push(l):i.set(a.popupRef,[l])}const c=l.render();a.hidden&&(c.style.visibility="hidden"),await le(this,Yu,yB).call(this,c,a.id),l._isEditable&&(y(this,xu).set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}le(this,Yu,oT).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Vu(t,{rotation:e.rotation}),le(this,Yu,oT).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(y(this,xu).values())}getEditableAnnotation(e){return y(this,xu).get(e)}}Zg=new WeakMap,wu=new WeakMap,xu=new WeakMap,Jg=new WeakMap,Yu=new WeakSet,yB=async function(e,t){const r=e.firstChild||e,i=r.id=`${HE}${t}`,s=await y(this,Jg)?.getAriaAttributes(i);if(s)for(const[a,o]of s)r.setAttribute(a,o);this.div.append(e),y(this,Zg)?.moveElementInDOM(this.div,e,r,!1)},oT=function(){if(!y(this,wu))return;const e=this.div;for(const[t,r]of y(this,wu)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;r.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(r):s.classList.contains("annotationContent")?s.after(r):s.before(r):i.append(r)}y(this,wu).clear()};const gy=/\r\n?|\n/g;var Js,es,e_,Tu,ts,br,vB,wB,xB,g0,Po,_0,b0,TB,cT,EB;const Fn=class Fn extends Qn{constructor(t){super({...t,name:"freeTextEditor"});oe(this,br);oe(this,Js);oe(this,es,"");oe(this,e_,`${this.id}-editor`);oe(this,Tu,null);oe(this,ts);Z(this,Js,t.color||Fn._defaultColor||Qn._defaultLineColor),Z(this,ts,t.fontSize||Fn._defaultFontSize)}static get _keyboardManager(){const t=Fn.prototype,r=a=>a.isEmpty(),i=Gu.TRANSLATE_SMALL,s=Gu.TRANSLATE_BIG;return Zt(this,"_keyboardManager",new E_([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:r}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:r}]]))}static initialize(t,r){Qn.initialize(t,r);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,r){switch(t){case sn.FREETEXT_SIZE:Fn._defaultFontSize=r;break;case sn.FREETEXT_COLOR:Fn._defaultColor=r;break}}updateParams(t,r){switch(t){case sn.FREETEXT_SIZE:le(this,br,vB).call(this,r);break;case sn.FREETEXT_COLOR:le(this,br,wB).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[sn.FREETEXT_SIZE,Fn._defaultFontSize],[sn.FREETEXT_COLOR,Fn._defaultColor||Qn._defaultLineColor]]}get propertiesToUpdate(){return[[sn.FREETEXT_SIZE,y(this,ts)],[sn.FREETEXT_COLOR,y(this,Js)]]}_translateEmpty(t,r){this._uiManager.translateSelectedEditors(t,r,!0)}getInitialTranslation(){const t=this.parentScale;return[-Fn._internalPadding*t,-(Fn._internalPadding+y(this,ts))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Kt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),Z(this,Tu,new AbortController);const t=this._uiManager.combinedSignal(y(this,Tu));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",y(this,e_)),this._isDraggable=!0,y(this,Tu)?.abort(),Z(this,Tu,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=y(this,es),r=Z(this,es,le(this,br,xB).call(this).trimEnd());if(t===r)return;const i=s=>{if(Z(this,es,s),!s){this.remove();return}le(this,br,b0).call(this),this._uiManager.rebuild(this),le(this,br,g0).call(this)};this.addCommands({cmd:()=>{i(r)},undo:()=>{i(t)},mustExec:!1}),le(this,br,g0).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Fn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,r;this.width&&(t=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",y(this,e_)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${y(this,ts)}px * var(--scale-factor))`,i.color=y(this,Js),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),N0(this,this.div,["dblclick","keydown"]),this.width){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[u,d]=this.pageDimensions,[h,f]=this.pageTranslation;let p,g;switch(this.rotation){case 0:p=t+(o[0]-h)/u,g=r+this.height-(o[1]-f)/d;break;case 90:p=t+(o[0]-h)/u,g=r-(o[1]-f)/d,[l,c]=[c,-l];break;case 180:p=t-this.width+(o[0]-h)/u,g=r-(o[1]-f)/d,[l,c]=[-l,-c];break;case 270:p=t+(o[0]-h-this.height*d)/u,g=r+(o[1]-f-this.width*u)/d,[l,c]=[-c,l];break}this.setAt(p*s,g*a,l,c)}else this.setAt(t*s,r*a,this.width*s,this.height*a);le(this,br,b0).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var p,g,b;const r=t.clipboardData||window.clipboardData,{types:i}=r;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=le(p=Fn,Po,cT).call(p,r.getData("text")||"").replaceAll(gy,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,u=[],d=[];if(l.nodeType===Node.TEXT_NODE){const _=l.parentElement;if(d.push(l.nodeValue.slice(c).replaceAll(gy,"")),_!==this.editorDiv){let m=u;for(const v of this.editorDiv.childNodes){if(v===_){m=d;continue}m.push(le(g=Fn,Po,_0).call(g,v))}}u.push(l.nodeValue.slice(0,c).replaceAll(gy,""))}else if(l===this.editorDiv){let _=u,m=0;for(const v of this.editorDiv.childNodes)m++===c&&(_=d),_.push(le(b=Fn,Po,_0).call(b,v))}Z(this,es,`${u.join(`
`)}${s}${d.join(`
`)}`),le(this,br,b0).call(this);const h=new Range;let f=u.reduce((_,m)=>_+m.length,0);for(const{firstChild:_}of this.editorDiv.childNodes)if(_.nodeType===Node.TEXT_NODE){const m=_.nodeValue.length;if(f<=m){h.setStart(_,f),h.setEnd(_,f);break}f-=m}a.removeAllRanges(),a.addRange(h)}get contentDiv(){return this.editorDiv}static async deserialize(t,r,i){var o;let s=null;if(t instanceof mB){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:u,rotation:d,id:h,popupRef:f},textContent:p,textPosition:g,parent:{page:{pageNumber:b}}}=t;if(!p||p.length===0)return null;s=t={annotationType:Kt.FREETEXT,color:Array.from(c),fontSize:l,value:p.join(`
`),position:g,pageIndex:b-1,rect:u.slice(0),rotation:d,id:h,deleted:!1,popupRef:f}}const a=await super.deserialize(t,r,i);return Z(a,ts,t.fontSize),Z(a,Js,At.makeHexColor(...t.color)),Z(a,es,le(o=Fn,Po,cT).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=s,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Fn._internalPadding*this.parentScale,i=this.getRect(r,r),s=Qn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:y(this,Js)),a={annotationType:Kt.FREETEXT,color:s,fontSize:y(this,ts),value:le(this,br,TB).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!le(this,br,EB).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const r=super.renderAnnotationElement(t);if(this.deleted)return r;const{style:i}=r;i.fontSize=`calc(${y(this,ts)}px * var(--scale-factor))`,i.color=y(this,Js),r.replaceChildren();for(const a of y(this,es).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),r.append(o)}const s=Fn._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(s,s),popupContent:y(this,es)}),r}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Js=new WeakMap,es=new WeakMap,e_=new WeakMap,Tu=new WeakMap,ts=new WeakMap,br=new WeakSet,vB=function(t){const r=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-y(this,ts))*this.parentScale),Z(this,ts,s),le(this,br,g0).call(this)},i=y(this,ts);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:sn.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},wB=function(t){const r=s=>{Z(this,Js,this.editorDiv.style.color=s)},i=y(this,Js);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:sn.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},xB=function(){var i;const t=[];this.editorDiv.normalize();let r=null;for(const s of this.editorDiv.childNodes)r?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(le(i=Fn,Po,_0).call(i,s)),r=s);return t.join(`
`)},g0=function(){const[t,r]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/r):(this.width=i.height/t,this.height=i.width/r),this.fixAndSetPosition()},Po=new WeakSet,_0=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(gy,"")},b0=function(){if(this.editorDiv.replaceChildren(),!!y(this,es))for(const t of y(this,es).split(`
`)){const r=document.createElement("div");r.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(r)}},TB=function(){return y(this,es).replaceAll(""," ")},cT=function(t){return t.replaceAll(" ","")},EB=function(t){const{value:r,fontSize:i,color:s,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==r||t.fontSize!==i||t.color.some((o,l)=>o!==s[l])||t.pageIndex!==a},oe(Fn,Po),Xe(Fn,"_freeTextDefaultContent",""),Xe(Fn,"_internalPadding",0),Xe(Fn,"_defaultColor",null),Xe(Fn,"_defaultFontSize",10),Xe(Fn,"_type","freetext"),Xe(Fn,"_editorType",Kt.FREETEXT);let lT=Fn;class gt{toSVGPath(){Pn("Abstract method `toSVGPath` must be implemented.")}get box(){Pn("Abstract getter `box` must be implemented.")}serialize(e,t){Pn("Abstract method `serialize` must be implemented.")}static _rescale(e,t,r,i,s,a){a||=new Float32Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*i,a[o+1]=r+e[o+1]*s;return a}static _rescaleAndSwap(e,t,r,i,s,a){a||=new Float32Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*i,a[o+1]=r+e[o]*s;return a}static _translate(e,t,r,i){i||=new Float32Array(e.length);for(let s=0,a=e.length;s<a;s+=2)i[s]=t+e[s],i[s+1]=r+e[s+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,r,i,s){switch(s){case 90:return[1-t/r,e/i];case 180:return[1-e/r,1-t/i];case 270:return[t/r,1-e/i];default:return[e/r,t/i]}}static _normalizePagePoint(e,t,r){switch(r){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,r,i,s,a){return[(e+5*r)/6,(t+5*i)/6,(5*r+s)/6,(5*i+a)/6,(r+s)/2,(i+a)/2]}}Xe(gt,"PRECISION",1e-4);var ns,ea,Wh,jh,Ia,Qt,Eu,Du,t_,n_,Vh,Gh,Ml,r_,pv,mv,Cr,Tm,DB,MB,AB,CB,SB,PB;const no=class no{constructor({x:e,y:t},r,i,s,a,o=0){oe(this,Cr);oe(this,ns);oe(this,ea,[]);oe(this,Wh);oe(this,jh);oe(this,Ia,[]);oe(this,Qt,new Float32Array(18));oe(this,Eu);oe(this,Du);oe(this,t_);oe(this,n_);oe(this,Vh);oe(this,Gh);oe(this,Ml,[]);Z(this,ns,r),Z(this,Gh,s*i),Z(this,jh,a),y(this,Qt).set([NaN,NaN,NaN,NaN,e,t],6),Z(this,Wh,o),Z(this,n_,y(no,r_)*i),Z(this,t_,y(no,mv)*i),Z(this,Vh,i),y(this,Ml).push(e,t)}isEmpty(){return isNaN(y(this,Qt)[8])}add({x:e,y:t}){Z(this,Eu,e),Z(this,Du,t);const[r,i,s,a]=y(this,ns);let[o,l,c,u]=y(this,Qt).subarray(8,12);const d=e-c,h=t-u,f=Math.hypot(d,h);if(f<y(this,t_))return!1;const p=f-y(this,n_),g=p/f,b=g*d,_=g*h;let m=o,v=l;o=c,l=u,c+=b,u+=_,y(this,Ml)?.push(e,t);const x=-_/p,w=b/p,T=x*y(this,Gh),E=w*y(this,Gh);return y(this,Qt).set(y(this,Qt).subarray(2,8),0),y(this,Qt).set([c+T,u+E],4),y(this,Qt).set(y(this,Qt).subarray(14,18),12),y(this,Qt).set([c-T,u-E],16),isNaN(y(this,Qt)[6])?(y(this,Ia).length===0&&(y(this,Qt).set([o+T,l+E],2),y(this,Ia).push(NaN,NaN,NaN,NaN,(o+T-r)/s,(l+E-i)/a),y(this,Qt).set([o-T,l-E],14),y(this,ea).push(NaN,NaN,NaN,NaN,(o-T-r)/s,(l-E-i)/a)),y(this,Qt).set([m,v,o,l,c,u],6),!this.isEmpty()):(y(this,Qt).set([m,v,o,l,c,u],6),Math.abs(Math.atan2(v-l,m-o)-Math.atan2(_,b))<Math.PI/2?([o,l,c,u]=y(this,Qt).subarray(2,6),y(this,Ia).push(NaN,NaN,NaN,NaN,((o+c)/2-r)/s,((l+u)/2-i)/a),[o,l,m,v]=y(this,Qt).subarray(14,18),y(this,ea).push(NaN,NaN,NaN,NaN,((m+o)/2-r)/s,((v+l)/2-i)/a),!0):([m,v,o,l,c,u]=y(this,Qt).subarray(0,6),y(this,Ia).push(((m+5*o)/6-r)/s,((v+5*l)/6-i)/a,((5*o+c)/6-r)/s,((5*l+u)/6-i)/a,((o+c)/2-r)/s,((l+u)/2-i)/a),[c,u,o,l,m,v]=y(this,Qt).subarray(12,18),y(this,ea).push(((m+5*o)/6-r)/s,((v+5*l)/6-i)/a,((5*o+c)/6-r)/s,((5*l+u)/6-i)/a,((o+c)/2-r)/s,((l+u)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=y(this,Ia),t=y(this,ea);if(isNaN(y(this,Qt)[6])&&!this.isEmpty())return le(this,Cr,DB).call(this);const r=[];r.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);le(this,Cr,AB).call(this,r);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return le(this,Cr,MB).call(this,r),r.join(" ")}newFreeDrawOutline(e,t,r,i,s,a){return new kB(e,t,r,i,s,a)}getOutlines(){const e=y(this,Ia),t=y(this,ea),r=y(this,Qt),[i,s,a,o]=y(this,ns),l=new Float32Array((y(this,Ml)?.length??0)+2);for(let d=0,h=l.length-2;d<h;d+=2)l[d]=(y(this,Ml)[d]-i)/a,l[d+1]=(y(this,Ml)[d+1]-s)/o;if(l[l.length-2]=(y(this,Eu)-i)/a,l[l.length-1]=(y(this,Du)-s)/o,isNaN(r[6])&&!this.isEmpty())return le(this,Cr,CB).call(this,l);const c=new Float32Array(y(this,Ia).length+24+y(this,ea).length);let u=e.length;for(let d=0;d<u;d+=2){if(isNaN(e[d])){c[d]=c[d+1]=NaN;continue}c[d]=e[d],c[d+1]=e[d+1]}u=le(this,Cr,PB).call(this,c,u);for(let d=t.length-6;d>=6;d-=6)for(let h=0;h<6;h+=2){if(isNaN(t[d+h])){c[u]=c[u+1]=NaN,u+=2;continue}c[u]=t[d+h],c[u+1]=t[d+h+1],u+=2}return le(this,Cr,SB).call(this,c,u),this.newFreeDrawOutline(c,l,y(this,ns),y(this,Vh),y(this,Wh),y(this,jh))}};ns=new WeakMap,ea=new WeakMap,Wh=new WeakMap,jh=new WeakMap,Ia=new WeakMap,Qt=new WeakMap,Eu=new WeakMap,Du=new WeakMap,t_=new WeakMap,n_=new WeakMap,Vh=new WeakMap,Gh=new WeakMap,Ml=new WeakMap,r_=new WeakMap,pv=new WeakMap,mv=new WeakMap,Cr=new WeakSet,Tm=function(){const e=y(this,Qt).subarray(4,6),t=y(this,Qt).subarray(16,18),[r,i,s,a]=y(this,ns);return[(y(this,Eu)+(e[0]-t[0])/2-r)/s,(y(this,Du)+(e[1]-t[1])/2-i)/a,(y(this,Eu)+(t[0]-e[0])/2-r)/s,(y(this,Du)+(t[1]-e[1])/2-i)/a]},DB=function(){const[e,t,r,i]=y(this,ns),[s,a,o,l]=le(this,Cr,Tm).call(this);return`M${(y(this,Qt)[2]-e)/r} ${(y(this,Qt)[3]-t)/i} L${(y(this,Qt)[4]-e)/r} ${(y(this,Qt)[5]-t)/i} L${s} ${a} L${o} ${l} L${(y(this,Qt)[16]-e)/r} ${(y(this,Qt)[17]-t)/i} L${(y(this,Qt)[14]-e)/r} ${(y(this,Qt)[15]-t)/i} Z`},MB=function(e){const t=y(this,ea);e.push(`L${t[4]} ${t[5]} Z`)},AB=function(e){const[t,r,i,s]=y(this,ns),a=y(this,Qt).subarray(4,6),o=y(this,Qt).subarray(16,18),[l,c,u,d]=le(this,Cr,Tm).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-r)/s} L${l} ${c} L${u} ${d} L${(o[0]-t)/i} ${(o[1]-r)/s}`)},CB=function(e){const t=y(this,Qt),[r,i,s,a]=y(this,ns),[o,l,c,u]=le(this,Cr,Tm).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-r)/s,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-r)/s,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(t[16]-r)/s,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-r)/s,(t[15]-i)/a],0),this.newFreeDrawOutline(d,e,y(this,ns),y(this,Vh),y(this,Wh),y(this,jh))},SB=function(e,t){const r=y(this,ea);return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6},PB=function(e,t){const r=y(this,Qt).subarray(4,6),i=y(this,Qt).subarray(16,18),[s,a,o,l]=y(this,ns),[c,u,d,h]=le(this,Cr,Tm).call(this);return e.set([NaN,NaN,NaN,NaN,(r[0]-s)/o,(r[1]-a)/l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-a)/l],t),t+=24},oe(no,r_,8),oe(no,pv,2),oe(no,mv,y(no,r_)+y(no,pv));let j0=no;var qh,Mu,xo,i_,rs,s_,or,gv,FB;class kB extends gt{constructor(t,r,i,s,a,o){super();oe(this,gv);oe(this,qh);oe(this,Mu,new Float32Array(4));oe(this,xo);oe(this,i_);oe(this,rs);oe(this,s_);oe(this,or);Z(this,or,t),Z(this,rs,r),Z(this,qh,i),Z(this,s_,s),Z(this,xo,a),Z(this,i_,o),this.lastPoint=[NaN,NaN],le(this,gv,FB).call(this,o);const[l,c,u,d]=y(this,Mu);for(let h=0,f=t.length;h<f;h+=2)t[h]=(t[h]-l)/u,t[h+1]=(t[h+1]-c)/d;for(let h=0,f=r.length;h<f;h+=2)r[h]=(r[h]-l)/u,r[h+1]=(r[h+1]-c)/d}toSVGPath(){const t=[`M${y(this,or)[4]} ${y(this,or)[5]}`];for(let r=6,i=y(this,or).length;r<i;r+=6){if(isNaN(y(this,or)[r])){t.push(`L${y(this,or)[r+4]} ${y(this,or)[r+5]}`);continue}t.push(`C${y(this,or)[r]} ${y(this,or)[r+1]} ${y(this,or)[r+2]} ${y(this,or)[r+3]} ${y(this,or)[r+4]} ${y(this,or)[r+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,r,i,s],a){const o=i-t,l=s-r;let c,u;switch(a){case 0:c=gt._rescale(y(this,or),t,s,o,-l),u=gt._rescale(y(this,rs),t,s,o,-l);break;case 90:c=gt._rescaleAndSwap(y(this,or),t,r,o,l),u=gt._rescaleAndSwap(y(this,rs),t,r,o,l);break;case 180:c=gt._rescale(y(this,or),i,r,-o,l),u=gt._rescale(y(this,rs),i,r,-o,l);break;case 270:c=gt._rescaleAndSwap(y(this,or),i,s,-o,-l),u=gt._rescaleAndSwap(y(this,rs),i,s,-o,-l);break}return{outline:Array.from(c),points:[Array.from(u)]}}get box(){return y(this,Mu)}newOutliner(t,r,i,s,a,o=0){return new j0(t,r,i,s,a,o)}getNewOutline(t,r){const[i,s,a,o]=y(this,Mu),[l,c,u,d]=y(this,qh),h=a*u,f=o*d,p=i*u+l,g=s*d+c,b=this.newOutliner({x:y(this,rs)[0]*h+p,y:y(this,rs)[1]*f+g},y(this,qh),y(this,s_),t,y(this,i_),r??y(this,xo));for(let _=2;_<y(this,rs).length;_+=2)b.add({x:y(this,rs)[_]*h+p,y:y(this,rs)[_+1]*f+g});return b.getOutlines()}}qh=new WeakMap,Mu=new WeakMap,xo=new WeakMap,i_=new WeakMap,rs=new WeakMap,s_=new WeakMap,or=new WeakMap,gv=new WeakSet,FB=function(t){const r=y(this,or);let i=r[4],s=r[5],a=i,o=s,l=i,c=s,u=i,d=s;const h=t?Math.max:Math.min;for(let p=6,g=r.length;p<g;p+=6){if(isNaN(r[p]))a=Math.min(a,r[p+4]),o=Math.min(o,r[p+5]),l=Math.max(l,r[p+4]),c=Math.max(c,r[p+5]),d<r[p+5]?(u=r[p+4],d=r[p+5]):d===r[p+5]&&(u=h(u,r[p+4]));else{const b=At.bezierBoundingBox(i,s,...r.slice(p,p+6));a=Math.min(a,b[0]),o=Math.min(o,b[1]),l=Math.max(l,b[2]),c=Math.max(c,b[3]),d<b[3]?(u=b[2],d=b[3]):d===b[3]&&(u=h(u,b[2]))}i=r[p+4],s=r[p+5]}const f=y(this,Mu);f[0]=a-y(this,xo),f[1]=o-y(this,xo),f[2]=l-a+2*y(this,xo),f[3]=c-o+2*y(this,xo),this.lastPoint=[u,d]};var a_,o_,Al,ta,Si,IB,y0,OB,UB,dT;class uT{constructor(e,t=0,r=0,i=!0){oe(this,Si);oe(this,a_);oe(this,o_);oe(this,Al,[]);oe(this,ta,[]);let s=1/0,a=-1/0,o=1/0,l=-1/0;const c=10**-4;for(const{x:b,y:_,width:m,height:v}of e){const x=Math.floor((b-t)/c)*c,w=Math.ceil((b+m+t)/c)*c,T=Math.floor((_-t)/c)*c,E=Math.ceil((_+v+t)/c)*c,A=[x,T,E,!0],M=[w,T,E,!1];y(this,Al).push(A,M),s=Math.min(s,x),a=Math.max(a,w),o=Math.min(o,T),l=Math.max(l,E)}const u=a-s+2*r,d=l-o+2*r,h=s-r,f=o-r,p=y(this,Al).at(i?-1:-2),g=[p[0],p[2]];for(const b of y(this,Al)){const[_,m,v]=b;b[0]=(_-h)/u,b[1]=(m-f)/d,b[2]=(v-f)/d}Z(this,a_,new Float32Array([h,f,u,d])),Z(this,o_,g)}getOutlines(){y(this,Al).sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);const e=[];for(const t of y(this,Al))t[3]?(e.push(...le(this,Si,dT).call(this,t)),le(this,Si,OB).call(this,t)):(le(this,Si,UB).call(this,t),e.push(...le(this,Si,dT).call(this,t)));return le(this,Si,IB).call(this,e)}}a_=new WeakMap,o_=new WeakMap,Al=new WeakMap,ta=new WeakMap,Si=new WeakSet,IB=function(e){const t=[],r=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),r.add(l),r.add(c)}const i=[];let s;for(;r.size>0;){const a=r.values().next().value;let[o,l,c,u,d]=a;r.delete(a);let h=o,f=l;for(s=[o,c],i.push(s);;){let p;if(r.has(u))p=u;else if(r.has(d))p=d;else break;r.delete(p),[o,l,c,u,d]=p,h!==o&&(s.push(h,f,o,f===l?l:c),h=o),f=f===l?c:l}s.push(h,f)}return new z9(i,y(this,a_),y(this,o_))},y0=function(e){const t=y(this,ta);let r=0,i=t.length-1;for(;r<=i;){const s=r+i>>1,a=t[s][0];if(a===e)return s;a<e?r=s+1:i=s-1}return i+1},OB=function([,e,t]){const r=le(this,Si,y0).call(this,e);y(this,ta).splice(r,0,[e,t])},UB=function([,e,t]){const r=le(this,Si,y0).call(this,e);for(let i=r;i<y(this,ta).length;i++){const[s,a]=y(this,ta)[i];if(s!==e)break;if(s===e&&a===t){y(this,ta).splice(i,1);return}}for(let i=r-1;i>=0;i--){const[s,a]=y(this,ta)[i];if(s!==e)break;if(s===e&&a===t){y(this,ta).splice(i,1);return}}},dT=function(e){const[t,r,i]=e,s=[[t,r,i]],a=le(this,Si,y0).call(this,i);for(let o=0;o<a;o++){const[l,c]=y(this,ta)[o];for(let u=0,d=s.length;u<d;u++){const[,h,f]=s[u];if(!(c<=h||f<=l)){if(h>=l){if(f>c)s[u][1]=c;else{if(d===1)return[];s.splice(u,1),u--,d--}continue}s[u][2]=l,f>c&&s.push([t,c,f])}}}return s};var l_,Hh;class z9 extends gt{constructor(t,r,i){super();oe(this,l_);oe(this,Hh);Z(this,Hh,t),Z(this,l_,r),this.lastPoint=i}toSVGPath(){const t=[];for(const r of y(this,Hh)){let[i,s]=r;t.push(`M${i} ${s}`);for(let a=2;a<r.length;a+=2){const o=r[a],l=r[a+1];o===i?(t.push(`V${l}`),s=l):l===s&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,r,i,s],a){const o=[],l=i-t,c=s-r;for(const u of y(this,Hh)){const d=new Array(u.length);for(let h=0;h<u.length;h+=2)d[h]=t+u[h]*l,d[h+1]=s-u[h+1]*c;o.push(d)}return o}get box(){return y(this,l_)}get classNamesForOutlining(){return["highlightOutline"]}}l_=new WeakMap,Hh=new WeakMap;class hT extends j0{newFreeDrawOutline(e,t,r,i,s,a){return new W9(e,t,r,i,s,a)}}class W9 extends kB{newOutliner(e,t,r,i,s,a=0){return new hT(e,t,r,i,s,a)}}var na,Au,Kh,Mr,c_,Xh,u_,d_,Cl,ra,Yh,h_,Tn,fT,pT,mT,Cc,LB,il;const Bi=class Bi{constructor({editor:e=null,uiManager:t=null}){oe(this,Tn);oe(this,na,null);oe(this,Au,null);oe(this,Kh);oe(this,Mr,null);oe(this,c_,!1);oe(this,Xh,!1);oe(this,u_,null);oe(this,d_);oe(this,Cl,null);oe(this,ra,null);oe(this,Yh);e?(Z(this,Xh,!1),Z(this,Yh,sn.HIGHLIGHT_COLOR),Z(this,u_,e)):(Z(this,Xh,!0),Z(this,Yh,sn.HIGHLIGHT_DEFAULT_COLOR)),Z(this,ra,e?._uiManager||t),Z(this,d_,y(this,ra)._eventBus),Z(this,Kh,e?.color||y(this,ra)?.highlightColors.values().next().value||"#FFFF98"),y(Bi,h_)||Z(Bi,h_,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Zt(this,"_keyboardManager",new E_([[["Escape","mac+Escape"],Bi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Bi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Bi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Bi.prototype._moveToPrevious],[["Home","mac+Home"],Bi.prototype._moveToBeginning],[["End","mac+End"],Bi.prototype._moveToEnd]]))}renderButton(){const e=Z(this,na,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=y(this,ra)._signal;e.addEventListener("click",le(this,Tn,Cc).bind(this),{signal:t}),e.addEventListener("keydown",le(this,Tn,mT).bind(this),{signal:t});const r=Z(this,Au,document.createElement("span"));return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=y(this,Kh),e.append(r),e}renderMainDropdown(){const e=Z(this,Mr,le(this,Tn,fT).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===y(this,na)){le(this,Tn,Cc).call(this,e);return}const t=e.target.getAttribute("data-color");t&&le(this,Tn,pT).call(this,t,e)}_moveToNext(e){if(!y(this,Tn,il)){le(this,Tn,Cc).call(this,e);return}if(e.target===y(this,na)){y(this,Mr).firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===y(this,Mr)?.firstChild||e.target===y(this,na)){y(this,Tn,il)&&this._hideDropdownFromKeyboard();return}y(this,Tn,il)||le(this,Tn,Cc).call(this,e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!y(this,Tn,il)){le(this,Tn,Cc).call(this,e);return}y(this,Mr).firstChild?.focus()}_moveToEnd(e){if(!y(this,Tn,il)){le(this,Tn,Cc).call(this,e);return}y(this,Mr).lastChild?.focus()}hideDropdown(){y(this,Mr)?.classList.add("hidden"),y(this,Cl)?.abort(),Z(this,Cl,null)}_hideDropdownFromKeyboard(){if(!y(this,Xh)){if(!y(this,Tn,il)){y(this,u_)?.unselect();return}this.hideDropdown(),y(this,na).focus({preventScroll:!0,focusVisible:y(this,c_)})}}updateColor(e){if(y(this,Au)&&(y(this,Au).style.backgroundColor=e),!y(this,Mr))return;const t=y(this,ra).highlightColors.values();for(const r of y(this,Mr).children)r.setAttribute("aria-selected",t.next().value===e)}destroy(){y(this,na)?.remove(),Z(this,na,null),Z(this,Au,null),y(this,Mr)?.remove(),Z(this,Mr,null)}};na=new WeakMap,Au=new WeakMap,Kh=new WeakMap,Mr=new WeakMap,c_=new WeakMap,Xh=new WeakMap,u_=new WeakMap,d_=new WeakMap,Cl=new WeakMap,ra=new WeakMap,Yh=new WeakMap,h_=new WeakMap,Tn=new WeakSet,fT=function(){const e=document.createElement("div"),t=y(this,ra)._signal;e.addEventListener("contextmenu",da,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[r,i]of y(this,ra).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",y(Bi,h_)[r]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=i,s.setAttribute("aria-selected",i===y(this,Kh)),s.addEventListener("click",le(this,Tn,pT).bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",le(this,Tn,mT).bind(this),{signal:t}),e},pT=function(e,t){t.stopPropagation(),y(this,d_).dispatch("switchannotationeditorparams",{source:this,type:y(this,Yh),value:e})},mT=function(e){Bi._keyboardManager.exec(this,e)},Cc=function(e){if(y(this,Tn,il)){this.hideDropdown();return}if(Z(this,c_,e.detail===0),y(this,Cl)||(Z(this,Cl,new AbortController),window.addEventListener("pointerdown",le(this,Tn,LB).bind(this),{signal:y(this,ra).combinedSignal(y(this,Cl))})),y(this,Mr)){y(this,Mr).classList.remove("hidden");return}const t=Z(this,Mr,le(this,Tn,fT).call(this));y(this,na).append(t)},LB=function(e){y(this,Mr)?.contains(e.target)||this.hideDropdown()},il=function(){return y(this,Mr)&&!y(this,Mr).classList.contains("hidden")},oe(Bi,h_,null);let V0=Bi;var Qh,f_,To,Cu,Zh,zi,p_,m_,Su,Ms,is,Kr,Jh,Eo,li,ef,As,g_,qt,gT,v0,RB,BB,$B,_T,Sc,Fs,Yd,NB,w0,Em,zB,WB,jB,VB,GB;const yn=class yn extends Qn{constructor(t){super({...t,name:"highlightEditor"});oe(this,qt);oe(this,Qh,null);oe(this,f_,0);oe(this,To);oe(this,Cu,null);oe(this,Zh,null);oe(this,zi,null);oe(this,p_,null);oe(this,m_,0);oe(this,Su,null);oe(this,Ms,null);oe(this,is,null);oe(this,Kr,!1);oe(this,Jh,null);oe(this,Eo);oe(this,li,null);oe(this,ef,"");oe(this,As);oe(this,g_,"");this.color=t.color||yn._defaultColor,Z(this,As,t.thickness||yn._defaultThickness),Z(this,Eo,t.opacity||yn._defaultOpacity),Z(this,To,t.boxes||null),Z(this,g_,t.methodOfCreation||""),Z(this,ef,t.text||""),this._isDraggable=!1,t.highlightId>-1?(Z(this,Kr,!0),le(this,qt,v0).call(this,t),le(this,qt,Sc).call(this)):y(this,To)&&(Z(this,Qh,t.anchorNode),Z(this,f_,t.anchorOffset),Z(this,p_,t.focusNode),Z(this,m_,t.focusOffset),le(this,qt,gT).call(this),le(this,qt,Sc).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=yn.prototype;return Zt(this,"_keyboardManager",new E_([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:y(this,Kr)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:y(this,As),methodOfCreation:y(this,g_)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,r){Qn.initialize(t,r),yn._defaultColor||=r.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,r){switch(t){case sn.HIGHLIGHT_DEFAULT_COLOR:yn._defaultColor=r;break;case sn.HIGHLIGHT_THICKNESS:yn._defaultThickness=r;break}}translateInPage(t,r){}get toolbarPosition(){return y(this,Jh)}updateParams(t,r){switch(t){case sn.HIGHLIGHT_COLOR:le(this,qt,RB).call(this,r);break;case sn.HIGHLIGHT_THICKNESS:le(this,qt,BB).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[sn.HIGHLIGHT_DEFAULT_COLOR,yn._defaultColor],[sn.HIGHLIGHT_THICKNESS,yn._defaultThickness]]}get propertiesToUpdate(){return[[sn.HIGHLIGHT_COLOR,this.color||yn._defaultColor],[sn.HIGHLIGHT_THICKNESS,y(this,As)||yn._defaultThickness],[sn.HIGHLIGHT_FREE,y(this,Kr)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(Z(this,Zh,new V0({editor:this})),t.addColorPicker(y(this,Zh))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(le(this,qt,Em).call(this))}getBaseTranslation(){return[0,0]}getRect(t,r){return super.getRect(t,r,le(this,qt,Em).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){le(this,qt,_T).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(le(this,qt,Sc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let r=!1;this.parent&&!t?le(this,qt,_T).call(this):t&&(le(this,qt,Sc).call(this,t),r=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),r&&this.select()}rotate(t){var s,a,o;const{drawLayer:r}=this.parent;let i;y(this,Kr)?(t=(t-this.rotation+360)%360,i=le(s=yn,Fs,Yd).call(s,y(this,Ms).box,t)):i=le(a=yn,Fs,Yd).call(a,[this.x,this.y,this.width,this.height],t),r.updateProperties(y(this,is),{bbox:i,root:{"data-main-rotation":t}}),r.updateProperties(y(this,li),{bbox:le(o=yn,Fs,Yd).call(o,y(this,zi).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();y(this,ef)&&(t.setAttribute("aria-label",y(this,ef)),t.setAttribute("role","mark")),y(this,Kr)?t.classList.add("free"):this.div.addEventListener("keydown",le(this,qt,NB).bind(this),{signal:this._uiManager._signal});const r=Z(this,Su,document.createElement("div"));t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=y(this,Cu);const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),N0(this,y(this,Su),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(y(this,li),{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(y(this,li),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:le(this,qt,w0).call(this,!0);break;case 1:case 3:le(this,qt,w0).call(this,!1);break}}select(){super.select(),y(this,li)&&this.parent?.drawLayer.updateProperties(y(this,li),{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),y(this,li)&&(this.parent?.drawLayer.updateProperties(y(this,li),{rootClass:{selected:!1}}),y(this,Kr)||le(this,qt,w0).call(this,!1))}get _mustFixPosition(){return!y(this,Kr)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(y(this,is),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(y(this,li),{rootClass:{hidden:!t}}))}static startHighlighting(t,r,{target:i,x:s,y:a}){const{x:o,y:l,width:c,height:u}=i.getBoundingClientRect(),d=new AbortController,h=t.combinedSignal(d),f=p=>{d.abort(),le(this,Fs,VB).call(this,t,p)};window.addEventListener("blur",f,{signal:h}),window.addEventListener("pointerup",f,{signal:h}),window.addEventListener("pointerdown",ds,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",da,{signal:h}),i.addEventListener("pointermove",le(this,Fs,jB).bind(this,t),{signal:h}),this._freeHighlight=new hT({x:s,y:a},[o,l,c,u],t.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,r,i){var g,b,_,m;let s=null;if(t instanceof _B){const{data:{quadPoints:v,rect:x,rotation:w,id:T,color:E,opacity:A,popupRef:M},parent:{page:{pageNumber:F}}}=t;s=t={annotationType:Kt.HIGHLIGHT,color:Array.from(E),opacity:A,quadPoints:v,boxes:null,pageIndex:F-1,rect:x.slice(0),rotation:w,id:T,deleted:!1,popupRef:M}}else if(t instanceof tD){const{data:{inkLists:v,rect:x,rotation:w,id:T,color:E,borderStyle:{rawWidth:A},popupRef:M},parent:{page:{pageNumber:F}}}=t;s=t={annotationType:Kt.HIGHLIGHT,color:Array.from(E),thickness:A,inkLists:v,boxes:null,pageIndex:F-1,rect:x.slice(0),rotation:w,id:T,deleted:!1,popupRef:M}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=t,u=await super.deserialize(t,r,i);u.color=At.makeHexColor(...a),Z(u,Eo,c||1),l&&Z(u,As,t.thickness),u.annotationElementId=t.id||null,u._initialData=s;const[d,h]=u.pageDimensions,[f,p]=u.pageTranslation;if(o){const v=Z(u,To,[]);for(let x=0;x<o.length;x+=8)v.push({x:(o[x]-f)/d,y:1-(o[x+1]-p)/h,width:(o[x+2]-o[x])/d,height:(o[x+1]-o[x+5])/h});le(g=u,qt,gT).call(g),le(b=u,qt,Sc).call(b),u.rotate(u.rotation)}else if(l){Z(u,Kr,!0);const v=l[0],x={x:v[0]-f,y:h-(v[1]-p)},w=new hT(x,[0,0,d,h],1,y(u,As)/2,!0,.001);for(let A=0,M=v.length;A<M;A+=2)x.x=v[A]-f,x.y=h-(v[A+1]-p),w.add(x);const{id:T,clipPathId:E}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:w.toSVGPath()}},!0,!0);le(_=u,qt,v0).call(_,{highlightOutlines:w.getOutlines(),highlightId:T,clipPathId:E}),le(m=u,qt,Sc).call(m)}return u}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const r=this.getRect(0,0),i=Qn._colorManager.convert(this.color),s={annotationType:Kt.HIGHLIGHT,color:i,opacity:y(this,Eo),thickness:y(this,As),quadPoints:le(this,qt,zB).call(this),outlines:le(this,qt,WB).call(this,r),pageIndex:this.pageIndex,rect:r,rotation:le(this,qt,Em).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!le(this,qt,GB).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Qh=new WeakMap,f_=new WeakMap,To=new WeakMap,Cu=new WeakMap,Zh=new WeakMap,zi=new WeakMap,p_=new WeakMap,m_=new WeakMap,Su=new WeakMap,Ms=new WeakMap,is=new WeakMap,Kr=new WeakMap,Jh=new WeakMap,Eo=new WeakMap,li=new WeakMap,ef=new WeakMap,As=new WeakMap,g_=new WeakMap,qt=new WeakSet,gT=function(){const t=new uT(y(this,To),.001);Z(this,Ms,t.getOutlines()),[this.x,this.y,this.width,this.height]=y(this,Ms).box;const r=new uT(y(this,To),.0025,.001,this._uiManager.direction==="ltr");Z(this,zi,r.getOutlines());const{lastPoint:i}=y(this,zi);Z(this,Jh,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},v0=function({highlightOutlines:t,highlightId:r,clipPathId:i}){var d,h;if(Z(this,Ms,t),Z(this,zi,t.getNewOutline(y(this,As)/2+1.5,.0025)),r>=0)Z(this,is,r),Z(this,Cu,i),this.parent.drawLayer.finalizeDraw(r,{bbox:t.box,path:{d:t.toSVGPath()}}),Z(this,li,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:y(this,zi).box,path:{d:y(this,zi).toSVGPath()}},!0));else if(this.parent){const f=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(y(this,is),{bbox:le(d=yn,Fs,Yd).call(d,y(this,Ms).box,(f-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(y(this,li),{bbox:le(h=yn,Fs,Yd).call(h,y(this,zi).box,f),path:{d:y(this,zi).toSVGPath()}})}const[a,o,l,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[f,p]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*p/f,this.height=c*f/p;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[f,p]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*p/f,this.height=c*f/p;break}}const{lastPoint:u}=y(this,zi);Z(this,Jh,[(u[0]-a)/l,(u[1]-o)/c])},RB=function(t){const r=(a,o)=>{this.color=a,Z(this,Eo,o),this.parent?.drawLayer.updateProperties(y(this,is),{root:{fill:a,"fill-opacity":o}}),y(this,Zh)?.updateColor(a)},i=this.color,s=y(this,Eo);this.addCommands({cmd:r.bind(this,t,yn._defaultOpacity),undo:r.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:sn.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},BB=function(t){const r=y(this,As),i=s=>{Z(this,As,s),le(this,qt,$B).call(this,s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:sn.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},$B=function(t){if(!y(this,Kr))return;le(this,qt,v0).call(this,{highlightOutlines:y(this,Ms).getNewOutline(t/2)}),this.fixAndSetPosition();const[r,i]=this.parentDimensions;this.setDims(this.width*r,this.height*i)},_T=function(){y(this,is)===null||!this.parent||(this.parent.drawLayer.remove(y(this,is)),Z(this,is,null),this.parent.drawLayer.remove(y(this,li)),Z(this,li,null))},Sc=function(t=this.parent){y(this,is)===null&&({id:vi(this,is)._,clipPathId:vi(this,Cu)._}=t.drawLayer.draw({bbox:y(this,Ms).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":y(this,Eo)},rootClass:{highlight:!0,free:y(this,Kr)},path:{d:y(this,Ms).toSVGPath()}},!1,!0),Z(this,li,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:y(this,Kr)},bbox:y(this,zi).box,path:{d:y(this,zi).toSVGPath()}},y(this,Kr))),y(this,Su)&&(y(this,Su).style.clipPath=y(this,Cu)))},Fs=new WeakSet,Yd=function([t,r,i,s],a){switch(a){case 90:return[1-r-s,t,s,i];case 180:return[1-t-i,1-r-s,i,s];case 270:return[r,1-t-i,s,i]}return[t,r,i,s]},NB=function(t){yn._keyboardManager.exec(this,t)},w0=function(t){if(!y(this,Qh))return;const r=window.getSelection();t?r.setPosition(y(this,Qh),y(this,f_)):r.setPosition(y(this,p_),y(this,m_))},Em=function(){return y(this,Kr)?this.rotation:0},zB=function(){if(y(this,Kr))return null;const[t,r]=this.pageDimensions,[i,s]=this.pageTranslation,a=y(this,To),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:u,width:d,height:h}of a){const f=c*t+i,p=(1-u)*r+s;o[l]=o[l+4]=f,o[l+1]=o[l+3]=p,o[l+2]=o[l+6]=f+d*t,o[l+5]=o[l+7]=p-h*r,l+=8}return o},WB=function(t){return y(this,Ms).serialize(t,le(this,qt,Em).call(this))},jB=function(t,r){this._freeHighlight.add(r)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},VB=function(t,r){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},GB=function(t){const{color:r}=this._initialData;return t.color.some((i,s)=>i!==r[s])},oe(yn,Fs),Xe(yn,"_defaultColor",null),Xe(yn,"_defaultOpacity",1),Xe(yn,"_defaultThickness",12),Xe(yn,"_type","highlight"),Xe(yn,"_editorType",Kt.HIGHLIGHT),Xe(yn,"_freeHighlightId",-1),Xe(yn,"_freeHighlight",null),Xe(yn,"_freeHighlightClipId","");let G0=yn;var Pu;class j9{constructor(){oe(this,Pu,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,r]of Object.entries(e))this.updateProperty(t,r)}updateSVGProperty(e,t){y(this,Pu)[e]=t}toSVGProperties(){const e=y(this,Pu);return Z(this,Pu,Object.create(null)),{root:e}}reset(){Z(this,Pu,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Pn("Not implemented")}}Pu=new WeakMap;var ss,tf,Br,ku,Fu,Sl,Pl,kl,Iu,un,yT,vT,wT,Dm,qB,x0,Mm,Qd;const bt=class bt extends Qn{constructor(t){super(t);oe(this,un);oe(this,ss,null);oe(this,tf);Xe(this,"_drawId",null);Z(this,tf,t.mustBeCommitted||!1),t.drawOutlines&&(le(this,un,yT).call(this,t),le(this,un,Dm).call(this))}static _mergeSVGProperties(t,r){const i=new Set(Object.keys(t));for(const[s,a]of Object.entries(r))i.has(s)?Object.assign(t[s],a):t[s]=a;return t}static getDefaultDrawingOptions(t){Pn("Not implemented")}static get typesMap(){Pn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,r){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,r),this._currentParent&&(y(bt,Br).updateProperty(i,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,r){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,r)}static get defaultPropertiesToUpdate(){const t=[],r=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,r[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:r}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,r[s]]);return t}_updateProperty(t,r,i){const s=this._drawingOptions,a=s[r],o=l=>{s.updateProperty(r,l);const c=y(this,ss).updateProperty(r,l);c&&le(this,un,Mm).call(this,c),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties())};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,bt._mergeSVGProperties(y(this,ss).getPathResizingSVGProperties(le(this,un,x0).call(this)),{bbox:le(this,un,Qd).call(this)}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,bt._mergeSVGProperties(y(this,ss).getPathResizedSVGProperties(le(this,un,x0).call(this)),{bbox:le(this,un,Qd).call(this)}))}_onTranslating(t,r){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:le(this,un,Qd).call(this,t,r)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,bt._mergeSVGProperties(y(this,ss).getPathTranslatedSVGProperties(le(this,un,x0).call(this),this.parentDimensions),{bbox:le(this,un,Qd).call(this)}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,y(this,tf)&&(Z(this,tf,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){le(this,un,wT).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(le(this,un,Dm).call(this),le(this,un,Mm).call(this,y(this,ss).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let r=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),le(this,un,wT).call(this)):t&&(this._uiManager.addShouldRescale(this),le(this,un,Dm).call(this,t),r=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,bt._mergeSVGProperties({bbox:le(this,un,Qd).call(this)},y(this,ss).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&le(this,un,Mm).call(this,y(this,ss).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const r=document.createElement("div");t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,r,i,s,a){Pn("Not implemented")}static startDrawing(t,r,i,s){const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:u}=s;if(y(bt,Pl)&&y(bt,Pl)!==u)return;const{viewport:{rotation:d}}=t,{width:h,height:f}=a.getBoundingClientRect(),p=Z(bt,ku,new AbortController),g=t.combinedSignal(p);if(y(bt,Sl)||Z(bt,Sl,c),y(bt,Pl)??Z(bt,Pl,u),window.addEventListener("pointerup",b=>{y(bt,Sl)===b.pointerId?this._endDraw(b):y(bt,kl)?.delete(b.pointerId)},{signal:g}),window.addEventListener("pointercancel",b=>{y(bt,Sl)===b.pointerId?this._currentParent.endDrawingSession():y(bt,kl)?.delete(b.pointerId)},{signal:g}),window.addEventListener("pointerdown",b=>{y(bt,Pl)===b.pointerType&&((y(bt,kl)||Z(bt,kl,new Set)).add(b.pointerId),y(bt,Br).isCancellable()&&(y(bt,Br).removeLastElement(),y(bt,Br).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",da,{signal:g}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),a.addEventListener("touchmove",b=>{b.timeStamp===y(bt,Iu)&&ds(b)},{signal:g}),t.toggleDrawing(),r._editorUndoBar?.hide(),y(bt,Br)){t.drawLayer.updateProperties(this._currentDrawId,y(bt,Br).startNew(o,l,h,f,d));return}r.updateUIForDefaultProperties(this),Z(bt,Br,this.createDrawerInstance(o,l,h,f,d)),Z(bt,Fu,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(y(bt,Fu).toSVGProperties(),y(bt,Br).defaultSVGProperties),!0,!1)}static _drawMove(t){if(Z(bt,Iu,-1),!y(bt,Br))return;const{offsetX:r,offsetY:i,pointerId:s}=t;if(y(bt,Sl)===s){if(y(bt,kl)?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,y(bt,Br).add(r,i)),Z(bt,Iu,t.timeStamp),ds(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Z(bt,Br,null),Z(bt,Fu,null),Z(bt,Pl,null),Z(bt,Iu,NaN)),y(bt,ku)&&(y(bt,ku).abort(),Z(bt,ku,null),Z(bt,Sl,NaN),Z(bt,kl,null))}static _endDraw(t){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),t&&r.drawLayer.updateProperties(this._currentDrawId,y(bt,Br).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=y(bt,Br),s=this._currentDrawId,a=i.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(s,i.setLastElement(a))},undo:()=>{r.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:sn.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(sn.DRAW_STEP),!y(bt,Br).isEmpty()){const{pageDimensions:[i,s],scale:a}=r,o=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:y(bt,Br).getOutlines(i*a,s*a,a,this._INNER_MARGIN),drawingOptions:y(bt,Fu),mustBeCommitted:!t});return this._cleanup(!0),o}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,r,i,s,a,o){Pn("Not implemented")}static async deserialize(t,r,i){var d,h;const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=r.viewport,c=this.deserializeDraw(o,l,s,a,this._INNER_MARGIN,t),u=await super.deserialize(t,r,i);return u.createDrawingOptions(t),le(d=u,un,yT).call(d,{drawOutlines:c}),le(h=u,un,Dm).call(h),u.onScaleChanging(),u.rotate(),u}serializeDraw(t){const[r,i]=this.pageTranslation,[s,a]=this.pageDimensions;return y(this,ss).serialize([r,i,s,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ss=new WeakMap,tf=new WeakMap,Br=new WeakMap,ku=new WeakMap,Fu=new WeakMap,Sl=new WeakMap,Pl=new WeakMap,kl=new WeakMap,Iu=new WeakMap,un=new WeakSet,yT=function({drawOutlines:t,drawId:r,drawingOptions:i}){Z(this,ss,t),this._drawingOptions||=i,r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,t.defaultProperties)):this._drawId=le(this,un,vT).call(this,t,this.parent),le(this,un,Mm).call(this,t.box)},vT=function(t,r){const{id:i}=r.drawLayer.draw(bt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},wT=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Dm=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=le(this,un,vT).call(this,y(this,ss),t)}},qB=function([t,r,i,s]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[r,1-t,i*(o/a),s*(a/o)];case 180:return[1-t,1-r,i,s];case 270:return[1-r,t,i*(o/a),s*(a/o)];default:return[t,r,i,s]}},x0=function(){const{x:t,y:r,width:i,height:s,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-r,t,i*(a/o),s*(o/a)];case 180:return[1-t,1-r,i,s];case 270:return[r,1-t,i*(a/o),s*(o/a)];default:return[t,r,i,s]}},Mm=function(t){if([this.x,this.y,this.width,this.height]=le(this,un,qB).call(this,t),this.div){this.fixAndSetPosition();const[r,i]=this.parentDimensions;this.setDims(this.width*r,this.height*i)}this._onResized()},Qd=function(){const{x:t,y:r,width:i,height:s,rotation:a,parentRotation:o,parentDimensions:[l,c]}=this;switch((a*4+o)/90){case 1:return[1-r-s,t,s,i];case 2:return[1-t-i,1-r-s,i,s];case 3:return[r,1-t-i,s,i];case 4:return[t,r-i*(l/c),s*(c/l),i*(l/c)];case 5:return[1-r,t,i*(l/c),s*(c/l)];case 6:return[1-t-s*(c/l),1-r,s*(c/l),i*(l/c)];case 7:return[r-i*(l/c),1-t-s*(c/l),i*(l/c),s*(c/l)];case 8:return[t-i,r-s,i,s];case 9:return[1-r,t-i,s,i];case 10:return[1-t,1-r,i,s];case 11:return[r-s,1-t,s,i];case 12:return[t-s*(c/l),r,s*(c/l),i*(l/c)];case 13:return[1-r-i*(l/c),t-s*(c/l),i*(l/c),s*(c/l)];case 14:return[1-t,1-r-i*(l/c),s*(c/l),i*(l/c)];case 15:return[r,1-t,i*(l/c),s*(c/l)];default:return[t,r,i,s]}},Xe(bt,"_currentDrawId",-1),Xe(bt,"_currentParent",null),oe(bt,Br,null),oe(bt,ku,null),oe(bt,Fu,null),oe(bt,Sl,NaN),oe(bt,Pl,null),oe(bt,kl,null),oe(bt,Iu,NaN),Xe(bt,"_INNER_MARGIN",3);let bT=bt;var Oa,$r,Nr,Ou,nf,Ti,Xr,Cs,Uu,Lu,Ru,rf,T0;class V9{constructor(e,t,r,i,s,a){oe(this,rf);oe(this,Oa,new Float64Array(6));oe(this,$r);oe(this,Nr);oe(this,Ou);oe(this,nf);oe(this,Ti);oe(this,Xr,"");oe(this,Cs,0);oe(this,Uu,new q0);oe(this,Lu);oe(this,Ru);Z(this,Lu,r),Z(this,Ru,i),Z(this,Ou,s),Z(this,nf,a),[e,t]=le(this,rf,T0).call(this,e,t);const o=Z(this,$r,[NaN,NaN,NaN,NaN,e,t]);Z(this,Ti,[e,t]),Z(this,Nr,[{line:o,points:y(this,Ti)}]),y(this,Oa).set(o,0)}updateProperty(e,t){e==="stroke-width"&&Z(this,nf,t)}isEmpty(){return!y(this,Nr)||y(this,Nr).length===0}isCancellable(){return y(this,Ti).length<=10}add(e,t){[e,t]=le(this,rf,T0).call(this,e,t);const[r,i,s,a]=y(this,Oa).subarray(2,6),o=e-s,l=t-a;return Math.hypot(y(this,Lu)*o,y(this,Ru)*l)<=2?null:(y(this,Ti).push(e,t),isNaN(r)?(y(this,Oa).set([s,a,e,t],2),y(this,$r).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(y(this,Oa)[0])&&y(this,$r).splice(6,6),y(this,Oa).set([r,i,s,a,e,t],0),y(this,$r).push(...gt.createBezierPoints(r,i,s,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const r=this.add(e,t);return r||(y(this,Ti).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,r,i,s){Z(this,Lu,r),Z(this,Ru,i),Z(this,Ou,s),[e,t]=le(this,rf,T0).call(this,e,t);const a=Z(this,$r,[NaN,NaN,NaN,NaN,e,t]);Z(this,Ti,[e,t]);const o=y(this,Nr).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),y(this,Nr).push({line:a,points:y(this,Ti)}),y(this,Oa).set(a,0),Z(this,Cs,0),this.toSVGPath(),null}getLastElement(){return y(this,Nr).at(-1)}setLastElement(e){return y(this,Nr)?(y(this,Nr).push(e),Z(this,$r,e.line),Z(this,Ti,e.points),Z(this,Cs,0),{path:{d:this.toSVGPath()}}):y(this,Uu).setLastElement(e)}removeLastElement(){if(!y(this,Nr))return y(this,Uu).removeLastElement();y(this,Nr).pop(),Z(this,Xr,"");for(let e=0,t=y(this,Nr).length;e<t;e++){const{line:r,points:i}=y(this,Nr)[e];Z(this,$r,r),Z(this,Ti,i),Z(this,Cs,0),this.toSVGPath()}return{path:{d:y(this,Xr)}}}toSVGPath(){const e=gt.svgRound(y(this,$r)[4]),t=gt.svgRound(y(this,$r)[5]);if(y(this,Ti).length===2)return Z(this,Xr,`${y(this,Xr)} M ${e} ${t} Z`),y(this,Xr);if(y(this,Ti).length<=6){const i=y(this,Xr).lastIndexOf("M");Z(this,Xr,`${y(this,Xr).slice(0,i)} M ${e} ${t}`),Z(this,Cs,6)}if(y(this,Ti).length===4){const i=gt.svgRound(y(this,$r)[10]),s=gt.svgRound(y(this,$r)[11]);return Z(this,Xr,`${y(this,Xr)} L ${i} ${s}`),Z(this,Cs,12),y(this,Xr)}const r=[];y(this,Cs)===0&&(r.push(`M ${e} ${t}`),Z(this,Cs,6));for(let i=y(this,Cs),s=y(this,$r).length;i<s;i+=6){const[a,o,l,c,u,d]=y(this,$r).slice(i,i+6).map(gt.svgRound);r.push(`C${a} ${o} ${l} ${c} ${u} ${d}`)}return Z(this,Xr,y(this,Xr)+r.join(" ")),Z(this,Cs,y(this,$r).length),y(this,Xr)}getOutlines(e,t,r,i){const s=y(this,Nr).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),y(this,Uu).build(y(this,Nr),e,t,r,y(this,Ou),y(this,nf),i),Z(this,Oa,null),Z(this,$r,null),Z(this,Nr,null),Z(this,Xr,null),y(this,Uu)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Oa=new WeakMap,$r=new WeakMap,Nr=new WeakMap,Ou=new WeakMap,nf=new WeakMap,Ti=new WeakMap,Xr=new WeakMap,Cs=new WeakMap,Uu=new WeakMap,Lu=new WeakMap,Ru=new WeakMap,rf=new WeakSet,T0=function(e,t){return gt._normalizePoint(e,t,y(this,Lu),y(this,Ru),y(this,Ou))};var Ei,__,b_,as,Ua,La,sf,af,of,Zr,eo,HB,KB,XB;const LD=class LD extends gt{constructor(){super(...arguments);oe(this,Zr);oe(this,Ei);oe(this,__,0);oe(this,b_);oe(this,as);oe(this,Ua);oe(this,La);oe(this,sf);oe(this,af);oe(this,of)}build(t,r,i,s,a,o,l){Z(this,Ua,r),Z(this,La,i),Z(this,sf,s),Z(this,af,a),Z(this,of,o),Z(this,b_,l??0),Z(this,as,t),le(this,Zr,KB).call(this)}setLastElement(t){return y(this,as).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return y(this,as).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:r}of y(this,as)){if(t.push(`M${gt.svgRound(r[4])} ${gt.svgRound(r[5])}`),r.length===6){t.push("Z");continue}if(r.length===12){t.push(`L${gt.svgRound(r[10])} ${gt.svgRound(r[11])}`);continue}for(let i=6,s=r.length;i<s;i+=6){const[a,o,l,c,u,d]=r.subarray(i,i+6).map(gt.svgRound);t.push(`C${a} ${o} ${l} ${c} ${u} ${d}`)}}return t.join("")}serialize([t,r,i,s],a){const o=[],l=[],[c,u,d,h]=le(this,Zr,HB).call(this);let f,p,g,b,_,m,v,x,w;switch(y(this,af)){case 0:w=gt._rescale,f=t,p=r+s,g=i,b=-s,_=t+c*i,m=r+(1-u-h)*s,v=t+(c+d)*i,x=r+(1-u)*s;break;case 90:w=gt._rescaleAndSwap,f=t,p=r,g=i,b=s,_=t+u*i,m=r+c*s,v=t+(u+h)*i,x=r+(c+d)*s;break;case 180:w=gt._rescale,f=t+i,p=r,g=-i,b=s,_=t+(1-c-d)*i,m=r+u*s,v=t+(1-c)*i,x=r+(u+h)*s;break;case 270:w=gt._rescaleAndSwap,f=t+i,p=r+s,g=-i,b=-s,_=t+(1-u-h)*i,m=r+(1-c-d)*s,v=t+(1-u)*i,x=r+(1-c)*s;break}for(const{line:T,points:E}of y(this,as))o.push(w(T,f,p,g,b,a?new Array(T.length):null)),l.push(w(E,f,p,g,b,a?new Array(E.length):null));return{lines:o,points:l,rect:[_,m,v,x]}}static deserialize(t,r,i,s,a,{paths:{lines:o,points:l},rotation:c,thickness:u}){const d=[];let h,f,p,g,b;switch(c){case 0:b=gt._rescale,h=-t/i,f=r/s+1,p=1/i,g=-1/s;break;case 90:b=gt._rescaleAndSwap,h=-r/s,f=-t/i,p=1/s,g=1/i;break;case 180:b=gt._rescale,h=t/i+1,f=-r/s,p=-1/i,g=1/s;break;case 270:b=gt._rescaleAndSwap,h=r/s+1,f=t/i+1,p=-1/s,g=-1/i;break}if(!o){o=[];for(const m of l){const v=m.length;if(v===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,m[0],m[1]]));continue}if(v===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,m[0],m[1],NaN,NaN,NaN,NaN,m[2],m[3]]));continue}const x=new Float32Array(3*(v-2));o.push(x);let[w,T,E,A]=m.subarray(0,4);x.set([NaN,NaN,NaN,NaN,w,T],0);for(let M=4;M<v;M+=2){const F=m[M],G=m[M+1];x.set(gt.createBezierPoints(w,T,E,A,F,G),(M-2)*3),[w,T,E,A]=[E,A,F,G]}}}for(let m=0,v=o.length;m<v;m++)d.push({line:b(o[m].map(x=>x??NaN),h,f,p,g),points:b(l[m].map(x=>x??NaN),h,f,p,g)});const _=new LD;return _.build(d,i,s,1,c,u,a),_}get box(){return y(this,Ei)}updateProperty(t,r){return t==="stroke-width"?le(this,Zr,XB).call(this,r):null}updateParentDimensions([t,r],i){const[s,a]=le(this,Zr,eo).call(this);Z(this,Ua,t),Z(this,La,r),Z(this,sf,i);const[o,l]=le(this,Zr,eo).call(this),c=o-s,u=l-a,d=y(this,Ei);return d[0]-=c,d[1]-=u,d[2]+=2*c,d[3]+=2*u,d}updateRotation(t){return Z(this,__,t),{path:{transform:this.rotationTransform}}}get viewBox(){return y(this,Ei).map(gt.svgRound).join(" ")}get defaultProperties(){const[t,r]=y(this,Ei);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(r)}`}}}get rotationTransform(){const[,,t,r]=y(this,Ei);let i=0,s=0,a=0,o=0,l=0,c=0;switch(y(this,__)){case 90:s=r/t,a=-t/r,l=t;break;case 180:i=-1,o=-1,l=t,c=r;break;case 270:s=-r/t,a=t/r,c=r;break;default:return""}return`matrix(${i} ${s} ${a} ${o} ${gt.svgRound(l)} ${gt.svgRound(c)})`}getPathResizingSVGProperties([t,r,i,s]){const[a,o]=le(this,Zr,eo).call(this),[l,c,u,d]=y(this,Ei);if(Math.abs(u-a)<=gt.PRECISION||Math.abs(d-o)<=gt.PRECISION){const b=t+i/2-(l+u/2),_=r+s/2-(c+d/2);return{path:{"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(r)}`,transform:`${this.rotationTransform} translate(${b} ${_})`}}}const h=(i-2*a)/(u-2*a),f=(s-2*o)/(d-2*o),p=u/i,g=d/s;return{path:{"transform-origin":`${gt.svgRound(l)} ${gt.svgRound(c)}`,transform:`${this.rotationTransform} scale(${p} ${g}) translate(${gt.svgRound(a)} ${gt.svgRound(o)}) scale(${h} ${f}) translate(${gt.svgRound(-a)} ${gt.svgRound(-o)})`}}}getPathResizedSVGProperties([t,r,i,s]){const[a,o]=le(this,Zr,eo).call(this),l=y(this,Ei),[c,u,d,h]=l;if(l[0]=t,l[1]=r,l[2]=i,l[3]=s,Math.abs(d-a)<=gt.PRECISION||Math.abs(h-o)<=gt.PRECISION){const _=t+i/2-(c+d/2),m=r+s/2-(u+h/2);for(const{line:v,points:x}of y(this,as))gt._translate(v,_,m,v),gt._translate(x,_,m,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(i-2*a)/(d-2*a),p=(s-2*o)/(h-2*o),g=-f*(c+a)+t+a,b=-p*(u+o)+r+o;if(f!==1||p!==1||g!==0||b!==0)for(const{line:_,points:m}of y(this,as))gt._rescale(_,g,b,f,p,_),gt._rescale(m,g,b,f,p,m);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,r],i){const[s,a]=i,o=y(this,Ei),l=t-o[0],c=r-o[1];if(y(this,Ua)===s&&y(this,La)===a)for(const{line:u,points:d}of y(this,as))gt._translate(u,l,c,u),gt._translate(d,l,c,d);else{const u=y(this,Ua)/s,d=y(this,La)/a;Z(this,Ua,s),Z(this,La,a);for(const{line:h,points:f}of y(this,as))gt._rescale(h,l,c,u,d,h),gt._rescale(f,l,c,u,d,f);o[2]*=u,o[3]*=d}return o[0]=t,o[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(r)}`}}}get defaultSVGProperties(){const t=y(this,Ei);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${gt.svgRound(t[0])} ${gt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Ei=new WeakMap,__=new WeakMap,b_=new WeakMap,as=new WeakMap,Ua=new WeakMap,La=new WeakMap,sf=new WeakMap,af=new WeakMap,of=new WeakMap,Zr=new WeakSet,eo=function(t=y(this,of)){const r=y(this,b_)+t/2*y(this,sf);return y(this,af)%180===0?[r/y(this,Ua),r/y(this,La)]:[r/y(this,La),r/y(this,Ua)]},HB=function(){const[t,r,i,s]=y(this,Ei),[a,o]=le(this,Zr,eo).call(this,0);return[t+a,r+o,i-2*a,s-2*o]},KB=function(){const t=Z(this,Ei,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of y(this,as)){if(s.length<=12){for(let l=4,c=s.length;l<c;l+=6){const[u,d]=s.subarray(l,l+2);t[0]=Math.min(t[0],u),t[1]=Math.min(t[1],d),t[2]=Math.max(t[2],u),t[3]=Math.max(t[3],d)}continue}let a=s[4],o=s[5];for(let l=6,c=s.length;l<c;l+=6){const[u,d,h,f,p,g]=s.subarray(l,l+6);At.bezierBoundingBox(a,o,u,d,h,f,p,g,t),a=p,o=g}}const[r,i]=le(this,Zr,eo).call(this);t[0]=Math.min(1,Math.max(0,t[0]-r)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+r)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},XB=function(t){const[r,i]=le(this,Zr,eo).call(this);Z(this,of,t);const[s,a]=le(this,Zr,eo).call(this),[o,l]=[s-r,a-i],c=y(this,Ei);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};let q0=LD;var lf;const RD=class RD extends j9{constructor(t){super();oe(this,lf);Z(this,lf,t),super.updateProperties({fill:"none",stroke:Qn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,r){t==="stroke-width"&&(r??=this["stroke-width"],r*=y(this,lf).realScale),super.updateSVGProperty(t,r)}clone(){const t=new RD(y(this,lf));return t.updateAll(this),t}};lf=new WeakMap;let xT=RD;var _v,YB;const nh=class nh extends bT{constructor(t){super({...t,name:"inkEditor"});oe(this,_v);this._willKeepAspectRatio=!0}static initialize(t,r){Qn.initialize(t,r),this._defaultDrawingOptions=new xT(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return Zt(this,"typesMap",new Map([[sn.INK_THICKNESS,"stroke-width"],[sn.INK_COLOR,"stroke"],[sn.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,r,i,s,a){return new V9(t,r,i,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,r,i,s,a,o){return q0.deserialize(t,r,i,s,a,o)}static async deserialize(t,r,i){let s=null;if(t instanceof tD){const{data:{inkLists:o,rect:l,rotation:c,id:u,color:d,opacity:h,borderStyle:{rawWidth:f},popupRef:p},parent:{page:{pageNumber:g}}}=t;s=t={annotationType:Kt.INK,color:Array.from(d),thickness:f,opacity:h,paths:{points:o},boxes:null,pageIndex:g-1,rect:l.slice(0),rotation:c,id:u,deleted:!1,popupRef:p}}const a=await super.deserialize(t,r,i);return a.annotationElementId=t.id||null,a._initialData=s,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:r,parent:i}=this;r.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:r,opacity:i}){this._drawingOptions=nh.getDefaultDrawingOptions({stroke:At.makeHexColor(...t),"stroke-width":r,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:i,rect:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,c={annotationType:Kt.INK,color:Qn._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:r,points:i},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?c:this.annotationElementId&&!le(this,_v,YB).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){const{points:r,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:r}),null}};_v=new WeakSet,YB=function(t){const{color:r,thickness:i,opacity:s,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==r[l])||t.thickness!==i||t.opacity!==s||t.pageIndex!==a},Xe(nh,"_type","ink"),Xe(nh,"_editorType",Kt.INK),Xe(nh,"_defaultDrawingOptions",null);let TT=nh;var Yn,Yr,Fl,Do,Il,cf,Ra,Ba,os,uf,dn,Am,Cm,E0,DT,D0,MT,M0,QB;const Lm=class Lm extends Qn{constructor(t){super({...t,name:"stampEditor"});oe(this,dn);oe(this,Yn,null);oe(this,Yr,null);oe(this,Fl,null);oe(this,Do,null);oe(this,Il,null);oe(this,cf,"");oe(this,Ra,null);oe(this,Ba,null);oe(this,os,!1);oe(this,uf,!1);Z(this,Do,t.bitmapUrl),Z(this,Il,t.bitmapFile)}static initialize(t,r){Qn.initialize(t,r)}static get supportedTypes(){return Zt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(r=>`image/${r}`))}static get supportedTypesStr(){return Zt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,r){r.pasteEditor(Kt.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const r=t.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(t=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),r&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){y(this,Yr)&&(Z(this,Yn,null),this._uiManager.imageManager.deleteId(y(this,Yr)),y(this,Ra)?.remove(),Z(this,Ra,null),y(this,Ba)&&(clearTimeout(y(this,Ba)),Z(this,Ba,null))),super.remove()}rebuild(){if(!this.parent){y(this,Yr)&&le(this,dn,E0).call(this);return}super.rebuild(),this.div!==null&&(y(this,Yr)&&y(this,Ra)===null&&le(this,dn,E0).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(y(this,Fl)||y(this,Yn)||y(this,Do)||y(this,Il)||y(this,Yr))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,r;if(this.width&&(t=this.x,r=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),y(this,Yn)?le(this,dn,DT).call(this):le(this,dn,E0).call(this),this.width&&!this.annotationElementId){const[i,s]=this.parentDimensions;this.setAt(t*i,r*s,this.width*i,this.height*s)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;y(this,Ba)!==null&&clearTimeout(y(this,Ba)),Z(this,Ba,setTimeout(()=>{Z(this,Ba,null),le(this,dn,MT).call(this)},200))}copyCanvas(t,r,i=!1){t||(t=224);const{width:s,height:a}=y(this,Yn),o=new xx;let l=y(this,Yn),c=s,u=a,d=null;if(r){if(s>r||a>r){const E=Math.min(r/s,r/a);c=Math.floor(s*E),u=Math.floor(a*E)}d=document.createElement("canvas");const f=d.width=Math.ceil(c*o.sx),p=d.height=Math.ceil(u*o.sy);y(this,os)||(l=le(this,dn,D0).call(this,f,p));const g=d.getContext("2d");g.filter=this._uiManager.hcmFilter;let b="white",_="#cfcfd8";this._uiManager.hcmFilter!=="none"?_="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(b="#8f8f9d",_="#42414d");const m=15,v=m*o.sx,x=m*o.sy,w=new OffscreenCanvas(v*2,x*2),T=w.getContext("2d");T.fillStyle=b,T.fillRect(0,0,v*2,x*2),T.fillStyle=_,T.fillRect(0,0,v,x),T.fillRect(v,x,v,x),g.fillStyle=g.createPattern(w,"repeat"),g.fillRect(0,0,f,p),g.drawImage(l,0,0,l.width,l.height,0,0,f,p)}let h=null;if(i){let f,p;if(o.symmetric&&l.width<t&&l.height<t)f=l.width,p=l.height;else if(l=y(this,Yn),s>t||a>t){const _=Math.min(t/s,t/a);f=Math.floor(s*_),p=Math.floor(a*_),y(this,os)||(l=le(this,dn,D0).call(this,f,p))}const b=new OffscreenCanvas(f,p).getContext("2d",{willReadFrequently:!0});b.drawImage(l,0,0,l.width,l.height,0,0,f,p),h={width:f,height:p,data:b.getImageData(0,0,f,p).data}}return{canvas:d,width:c,height:u,imageData:h}}getImageForAltText(){return y(this,Ra)}static async deserialize(t,r,i){let s=null;if(t instanceof bB){const{data:{rect:g,rotation:b,id:_,structParent:m,popupRef:v},container:x,parent:{page:{pageNumber:w}}}=t,T=x.querySelector("canvas"),E=i.imageManager.getFromCanvas(x.id,T);T.remove();const A=(await r._structTree.getAriaAttributes(`${HE}${_}`))?.get("aria-label")||"";s=t={annotationType:Kt.STAMP,bitmapId:E.id,bitmap:E.bitmap,pageIndex:w-1,rect:g.slice(0),rotation:b,id:_,deleted:!1,accessibilityData:{decorative:!1,altText:A},isSvg:!1,structParent:m,popupRef:v}}const a=await super.deserialize(t,r,i),{rect:o,bitmap:l,bitmapUrl:c,bitmapId:u,isSvg:d,accessibilityData:h}=t;u&&i.imageManager.isValidId(u)?(Z(a,Yr,u),l&&Z(a,Yn,l)):Z(a,Do,c),Z(a,os,d);const[f,p]=a.pageDimensions;return a.width=(o[2]-o[0])/f,a.height=(o[3]-o[1])/p,a.annotationElementId=t.id||null,h&&(a.altTextData=h),a._initialData=s,Z(a,uf,!!s),a}serialize(t=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Kt.STAMP,bitmapId:y(this,Yr),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:y(this,os),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=le(this,dn,M0).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=le(this,dn,QB).call(this,i);if(l.isSame)return null;l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,r===null)return i;r.stamps||=new Map;const o=y(this,os)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!r.stamps.has(y(this,Yr)))r.stamps.set(y(this,Yr),{area:o,serialized:i}),i.bitmap=le(this,dn,M0).call(this,!1);else if(y(this,os)){const l=r.stamps.get(y(this,Yr));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=le(this,dn,M0).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Yn=new WeakMap,Yr=new WeakMap,Fl=new WeakMap,Do=new WeakMap,Il=new WeakMap,cf=new WeakMap,Ra=new WeakMap,Ba=new WeakMap,os=new WeakMap,uf=new WeakMap,dn=new WeakSet,Am=function(t,r=!1){if(!t){this.remove();return}Z(this,Yn,t.bitmap),r||(Z(this,Yr,t.id),Z(this,os,t.isSvg)),t.file&&Z(this,cf,t.file.name),le(this,dn,DT).call(this)},Cm=function(){if(Z(this,Fl,null),this._uiManager.enableWaiting(!1),!!y(this,Ra)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&y(this,Yn)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&y(this,Yn)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},E0=function(){if(y(this,Yr)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(y(this,Yr)).then(i=>le(this,dn,Am).call(this,i,!0)).finally(()=>le(this,dn,Cm).call(this));return}if(y(this,Do)){const i=y(this,Do);Z(this,Do,null),this._uiManager.enableWaiting(!0),Z(this,Fl,this._uiManager.imageManager.getFromUrl(i).then(s=>le(this,dn,Am).call(this,s)).finally(()=>le(this,dn,Cm).call(this)));return}if(y(this,Il)){const i=y(this,Il);Z(this,Il,null),this._uiManager.enableWaiting(!0),Z(this,Fl,this._uiManager.imageManager.getFromFile(i).then(s=>le(this,dn,Am).call(this,s)).finally(()=>le(this,dn,Cm).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Lm.supportedTypesStr;const r=this._uiManager._signal;Z(this,Fl,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),le(this,dn,Am).call(this,s)}i()},{signal:r}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:r})}).finally(()=>le(this,dn,Cm).call(this))),t.click()},DT=function(){const{div:t}=this;let{width:r,height:i}=y(this,Yn);const[s,a]=this.pageDimensions,o=.75;if(this.width)r=this.width*s,i=this.height*a;else if(r>o*s||i>o*a){const d=Math.min(o*s/r,o*a/i);r*=d,i*=d}const[l,c]=this.parentDimensions;this.setDims(r*l/s,i*c/a),this._uiManager.enableWaiting(!1);const u=Z(this,Ra,document.createElement("canvas"));u.setAttribute("role","img"),this.addContainer(u),this.width=r/s,this.height=i/a,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),le(this,dn,MT).call(this),y(this,uf)||(this.parent.addUndoableEditor(this),Z(this,uf,!0)),this._reportTelemetry({action:"inserted_image"}),y(this,cf)&&u.setAttribute("aria-label",y(this,cf))},D0=function(t,r){const{width:i,height:s}=y(this,Yn);let a=i,o=s,l=y(this,Yn);for(;a>2*t||o>2*r;){const c=a,u=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*r&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(a,o);d.getContext("2d").drawImage(l,0,0,c,u,0,0,a,o),l=d.transferToImageBitmap()}return l},MT=function(){const[t,r]=this.parentDimensions,{width:i,height:s}=this,a=new xx,o=Math.ceil(i*t*a.sx),l=Math.ceil(s*r*a.sy),c=y(this,Ra);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const u=y(this,os)?y(this,Yn):le(this,dn,D0).call(this,o,l),d=c.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(u,0,0,u.width,u.height,0,0,o,l)},M0=function(t){if(t){if(y(this,os)){const s=this._uiManager.imageManager.getSvgUrl(y(this,Yr));if(s)return s}const r=document.createElement("canvas");return{width:r.width,height:r.height}=y(this,Yn),r.getContext("2d").drawImage(y(this,Yn),0,0),r.toDataURL()}if(y(this,os)){const[r,i]=this.pageDimensions,s=Math.round(this.width*r*jl.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*jl.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(y(this,Yn),0,0,y(this,Yn).width,y(this,Yn).height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(y(this,Yn))},QB=function(t){const{pageIndex:r,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===r,a=(t.accessibilityData?.alt||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}},Xe(Lm,"_type","stamp"),Xe(Lm,"_editorType",Kt.STAMP);let ET=Lm;var Bu,df,$a,Ol,Mo,Ss,Ul,hf,$u,ia,Ao,ci,Co,Mt,Ll,Wn,ZB,xa,CT,ST,A0;const qs=class qs{constructor({uiManager:e,pageIndex:t,div:r,structTreeLayer:i,accessibilityManager:s,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:u}){oe(this,Wn);oe(this,Bu);oe(this,df,!1);oe(this,$a,null);oe(this,Ol,null);oe(this,Mo,null);oe(this,Ss,new Map);oe(this,Ul,!1);oe(this,hf,!1);oe(this,$u,!1);oe(this,ia,null);oe(this,Ao,null);oe(this,ci,null);oe(this,Co,null);oe(this,Mt);const d=[...y(qs,Ll).values()];if(!qs._initialized){qs._initialized=!0;for(const h of d)h.initialize(u,e)}e.registerEditorTypes(d),Z(this,Mt,e),this.pageIndex=t,this.div=r,Z(this,Bu,s),Z(this,$a,a),this.viewport=c,Z(this,ci,l),this.drawLayer=o,this._structTree=i,y(this,Mt).addLayer(this)}get isEmpty(){return y(this,Ss).size===0}get isInvisible(){return this.isEmpty&&y(this,Mt).getMode()===Kt.NONE}updateToolbar(e){y(this,Mt).updateToolbar(e)}updateMode(e=y(this,Mt).getMode()){switch(le(this,Wn,A0).call(this),e){case Kt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Kt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Kt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const r of y(qs,Ll).values())t.toggle(`${r._type}Editing`,e===r._editorType);this.div.hidden=!1}hasTextLayer(e){return e===y(this,ci)?.div}setEditingState(e){y(this,Mt).setEditingState(e)}addCommands(e){y(this,Mt).addCommands(e)}cleanUndoStack(e){y(this,Mt).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){y(this,$a)?.div.classList.toggle("disabled",!e)}async enable(){Z(this,$u,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const r of y(this,Ss).values())r.enableEditing(),r.show(!0),r.annotationElementId&&(y(this,Mt).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));if(!y(this,$a)){Z(this,$u,!1);return}const t=y(this,$a).getEditableAnnotations();for(const r of t){if(r.hide(),y(this,Mt).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const i=await this.deserialize(r);i&&(this.addOrRebuild(i),i.enableEditing())}Z(this,$u,!1)}disable(){Z(this,hf,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const i of y(this,Ss).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);this.getEditableAnnotation(i.annotationElementId)?.show(),i.remove()}if(y(this,$a)){const i=y(this,$a).getEditableAnnotations();for(const s of i){const{id:a}=s.data;if(y(this,Mt).isDeletedAnnotationElement(a))continue;let o=t.get(a);if(o){o.resetAnnotationElement(s),o.show(!1),s.show();continue}o=e.get(a),o&&(y(this,Mt).addChangedExistingAnnotation(o),o.renderAnnotationElement(s)&&o.show(!1)),s.show()}}le(this,Wn,A0).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const i of y(qs,Ll).values())r.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),Z(this,hf,!1)}getEditableAnnotation(e){return y(this,$a)?.getEditableAnnotation(e)||null}setActiveEditor(e){y(this,Mt).getActive()!==e&&y(this,Mt).setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,y(this,ci)?.div&&!y(this,Co)){Z(this,Co,new AbortController);const e=y(this,Mt).combinedSignal(y(this,Co));y(this,ci).div.addEventListener("pointerdown",le(this,Wn,ZB).bind(this),{signal:e}),y(this,ci).div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,y(this,ci)?.div&&y(this,Co)&&(y(this,Co).abort(),Z(this,Co,null),y(this,ci).div.classList.remove("highlighting"))}enableClick(){if(y(this,Ol))return;Z(this,Ol,new AbortController);const e=y(this,Mt).combinedSignal(y(this,Ol));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){y(this,Ol)?.abort(),Z(this,Ol,null)}attach(e){y(this,Ss).set(e.id,e);const{annotationElementId:t}=e;t&&y(this,Mt).isDeletedAnnotationElement(t)&&y(this,Mt).removeDeletedAnnotationElement(e)}detach(e){y(this,Ss).delete(e.id),y(this,Bu)?.removePointerInTextLayer(e.contentDiv),!y(this,hf)&&e.annotationElementId&&y(this,Mt).addDeletedAnnotationElement(e)}remove(e){this.detach(e),y(this,Mt).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(y(this,Mt).addDeletedAnnotationElement(e.annotationElementId),Qn.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),y(this,Mt).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!y(this,$u)),y(this,Mt).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!y(this,Mo)&&(e._focusEventsAllowed=!1,Z(this,Mo,setTimeout(()=>{Z(this,Mo,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:y(this,Mt)._signal}),t.focus())},0))),e._structTreeParentId=y(this,Bu)?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:t,undo:r,mustExec:!1})}getNextId(){return y(this,Mt).getId()}combinedSignal(e){return y(this,Mt).combinedSignal(e)}canCreateNewEmptyEditor(){return y(this,Wn,xa)?.canCreateNewEmptyEditor()}pasteEditor(e,t){y(this,Mt).updateToolbar(e),y(this,Mt).updateMode(e);const{offsetX:r,offsetY:i}=le(this,Wn,ST).call(this),s=this.getNextId(),a=le(this,Wn,CT).call(this,{parent:this,id:s,x:r,y:i,uiManager:y(this,Mt),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){return await y(qs,Ll).get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,y(this,Mt))||null}createAndAddNewEditor(e,t,r={}){const i=this.getNextId(),s=le(this,Wn,CT).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:y(this,Mt),isCentered:t,...r});return s&&this.add(s),s}addNewEditor(){this.createAndAddNewEditor(le(this,Wn,ST).call(this),!0)}setSelected(e){y(this,Mt).setSelected(e)}toggleSelected(e){y(this,Mt).toggleSelected(e)}unselect(e){y(this,Mt).unselect(e)}pointerup(e){const{isMac:t}=Ai.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&y(this,Ul)&&(Z(this,Ul,!1),!(y(this,Wn,xa)?.isDrawer&&y(this,Wn,xa).supportMultipleDrawings))){if(!y(this,df)){Z(this,df,!0);return}if(y(this,Mt).getMode()===Kt.STAMP){y(this,Mt).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(y(this,Mt).getMode()===Kt.HIGHLIGHT&&this.enableTextSelection(),y(this,Ul)){Z(this,Ul,!1);return}const{isMac:t}=Ai.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(Z(this,Ul,!0),y(this,Wn,xa)?.isDrawer){this.startDrawingSession(e);return}const r=y(this,Mt).getActive();Z(this,df,!r||r.isEmpty())}startDrawingSession(e){if(this.div.focus(),y(this,ia)){y(this,Wn,xa).startDrawing(this,y(this,Mt),!1,e);return}y(this,Mt).setCurrentDrawingSession(this),Z(this,ia,new AbortController);const t=y(this,Mt).combinedSignal(y(this,ia));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(Z(this,Ao,null),this.commitOrRemove())},{signal:t}),y(this,Wn,xa).startDrawing(this,y(this,Mt),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&Z(this,Ao,t);return}y(this,Ao)&&setTimeout(()=>{y(this,Ao)?.focus(),Z(this,Ao,null)},0)}endDrawingSession(e=!1){return y(this,ia)?(y(this,Mt).setCurrentDrawingSession(null),y(this,ia).abort(),Z(this,ia,null),Z(this,Ao,null),y(this,Wn,xa).endDrawing(e)):null}findNewParent(e,t,r){const i=y(this,Mt).findParent(t,r);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return y(this,ia)?(this.endDrawingSession(),!0):!1}onScaleChanging(){y(this,ia)&&y(this,Wn,xa).onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),y(this,Mt).getActive()?.parent===this&&(y(this,Mt).commitOrRemove(),y(this,Mt).setActiveEditor(null)),y(this,Mo)&&(clearTimeout(y(this,Mo)),Z(this,Mo,null));for(const e of y(this,Ss).values())y(this,Bu)?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,y(this,Ss).clear(),y(this,Mt).removeLayer(this)}render({viewport:e}){this.viewport=e,Vu(this.div,e);for(const t of y(this,Mt).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){y(this,Mt).commitOrRemove(),le(this,Wn,A0).call(this);const t=this.viewport.rotation,r=e.rotation;if(this.viewport=e,Vu(this.div,{rotation:r}),t!==r)for(const i of y(this,Ss).values())i.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return y(this,Mt).viewParameters.realScale}};Bu=new WeakMap,df=new WeakMap,$a=new WeakMap,Ol=new WeakMap,Mo=new WeakMap,Ss=new WeakMap,Ul=new WeakMap,hf=new WeakMap,$u=new WeakMap,ia=new WeakMap,Ao=new WeakMap,ci=new WeakMap,Co=new WeakMap,Mt=new WeakMap,Ll=new WeakMap,Wn=new WeakSet,ZB=function(e){y(this,Mt).unselectAll();const{target:t}=e;if(t===y(this,ci).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&y(this,ci).div.contains(t)){const{isMac:r}=Ai.platform;if(e.button!==0||e.ctrlKey&&r)return;y(this,Mt).showAllEditors("highlight",!0,!0),y(this,ci).div.classList.add("free"),this.toggleDrawing(),G0.startHighlighting(this,y(this,Mt).direction==="ltr",{target:y(this,ci).div,x:e.x,y:e.y}),y(this,ci).div.addEventListener("pointerup",()=>{y(this,ci).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:y(this,Mt)._signal}),e.preventDefault()}},xa=function(){return y(qs,Ll).get(y(this,Mt).getMode())},CT=function(e){const t=y(this,Wn,xa);return t?new t.prototype.constructor(e):null},ST=function(){const{x:e,y:t,width:r,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+r),l=Math.min(window.innerHeight,t+i),c=(s+o)/2-e,u=(a+l)/2-t,[d,h]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:d,offsetY:h}},A0=function(){for(const e of y(this,Ss).values())e.isEmpty()&&e.remove()},Xe(qs,"_initialized",!1),oe(qs,Ll,new Map([lT,TT,ET,G0].map(e=>[e._editorType,e])));let AT=qs;var sa,y_,Di,Nu,bv,JB,Na,kT,e$,FT;const si=class si{constructor({pageIndex:e}){oe(this,Na);oe(this,sa,null);oe(this,y_,0);oe(this,Di,new Map);oe(this,Nu,new Map);this.pageIndex=e}setParent(e){if(!y(this,sa)){Z(this,sa,e);return}if(y(this,sa)!==e){if(y(this,Di).size>0)for(const t of y(this,Di).values())t.remove(),e.append(t);Z(this,sa,e)}}static get _svgFactory(){return Zt(this,"_svgFactory",new eD)}draw(e,t=!1,r=!1){const i=vi(this,y_)._++,s=le(this,Na,kT).call(this),a=si._svgFactory.createElement("defs");s.append(a);const o=si._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&y(this,Nu).set(i,o);const c=r?le(this,Na,e$).call(this,a,l):null,u=si._svgFactory.createElement("use");return s.append(u),u.setAttribute("href",`#${l}`),this.updateProperties(s,e),y(this,Di).set(i,s),{id:i,clipPathId:`url(#${c})`}}drawOutline(e,t){const r=vi(this,y_)._++,i=le(this,Na,kT).call(this),s=si._svgFactory.createElement("defs");i.append(s);const a=si._svgFactory.createElement("path");s.append(a);const o=`path_p${this.pageIndex}_${r}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const d=si._svgFactory.createElement("mask");s.append(d),l=`mask_p${this.pageIndex}_${r}`,d.setAttribute("id",l),d.setAttribute("maskUnits","objectBoundingBox");const h=si._svgFactory.createElement("rect");d.append(h),h.setAttribute("width","1"),h.setAttribute("height","1"),h.setAttribute("fill","white");const f=si._svgFactory.createElement("use");d.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const c=si._svgFactory.createElement("use");i.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const u=c.cloneNode();return i.append(u),c.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(i,e),y(this,Di).set(r,i),r}finalizeDraw(e,t){y(this,Nu).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:r,bbox:i,rootClass:s,path:a}=t,o=typeof e=="number"?y(this,Di).get(e):e;if(o){if(r&&le(this,Na,FT).call(this,o,r),i&&le(l=si,bv,JB).call(l,o,i),s){const{classList:c}=o;for(const[u,d]of Object.entries(s))c.toggle(u,d)}if(a){const u=o.firstChild.firstChild;le(this,Na,FT).call(this,u,a)}}}updateParent(e,t){if(t===this)return;const r=y(this,Di).get(e);r&&(y(t,sa).append(r),y(this,Di).delete(e),y(t,Di).set(e,r))}remove(e){y(this,Nu).delete(e),y(this,sa)!==null&&(y(this,Di).get(e).remove(),y(this,Di).delete(e))}destroy(){Z(this,sa,null);for(const e of y(this,Di).values())e.remove();y(this,Di).clear(),y(this,Nu).clear()}};sa=new WeakMap,y_=new WeakMap,Di=new WeakMap,Nu=new WeakMap,bv=new WeakSet,JB=function(e,[t,r,i,s]){const{style:a}=e;a.top=`${100*r}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*s}%`},Na=new WeakSet,kT=function(){const e=si._svgFactory.create(1,1,!0);return y(this,sa).append(e),e.setAttribute("aria-hidden",!0),e},e$=function(e,t){const r=si._svgFactory.createElement("clipPath");e.append(r);const i=`clip_${t}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");const s=si._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i},FT=function(e,t){for(const[r,i]of Object.entries(t))i===null?e.removeAttribute(r):e.setAttribute(r,i)},oe(si,bv);let PT=si;globalThis.pdfjsTestingUtils={HighlightOutliner:uT};Nt.AbortException;Nt.AnnotationEditorLayer;Nt.AnnotationEditorParamsType;Nt.AnnotationEditorType;Nt.AnnotationEditorUIManager;Nt.AnnotationLayer;Nt.AnnotationMode;Nt.ColorPicker;Nt.DOMSVGFactory;Nt.DrawLayer;Nt.FeatureTest;var G9=Nt.GlobalWorkerOptions;Nt.ImageKind;Nt.InvalidPDFException;Nt.MissingPDFException;Nt.OPS;Nt.OutputScale;Nt.PDFDataRangeTransport;Nt.PDFDateString;Nt.PDFWorker;Nt.PasswordResponses;Nt.PermissionFlag;Nt.PixelsPerInch;Nt.RenderingCancelledException;Nt.TextLayer;Nt.TouchManager;Nt.UnexpectedResponseException;Nt.Util;Nt.VerbosityLevel;Nt.XfaLayer;Nt.build;Nt.createValidAbsoluteUrl;Nt.fetchData;var q9=Nt.getDocument;Nt.getFilenameFromUrl;Nt.getPdfFilenameFromUrl;Nt.getXfaPageViewport;Nt.isDataScheme;Nt.isPdfFile;Nt.noContextMenu;Nt.normalizeUnicode;Nt.setLayerDimensions;Nt.shadow;Nt.stopEvent;Nt.version;var nm={},yF;function H9(){return yF||(yF=1,nm.createCanvas=function(n,e){return Object.assign(document.createElement("canvas"),{width:n,height:e})},nm.createImageData=function(n,e,t){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(n);case 2:return new ImageData(n,e);default:return new ImageData(n,e,t)}},nm.loadImage=function(n,e){return new Promise(function(t,r){const i=Object.assign(document.createElement("img"),e);function s(){i.onload=null,i.onerror=null}i.onload=function(){s(),t(i)},i.onerror=function(){s(),r(new Error('Failed to load the image "'+n+'"'))},i.src=n})}),nm}var K9=H9();const vF="deu",X9={__name:"OcrFileInput",emits:["file-processed"],setup(n,{emit:e}){const t=Sn(null),r=e;G9.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/build/pdf.worker.min.mjs";const i=async o=>{if(console.log("OCR File changed:",o),!o)return;const l=o.type;try{let c="";return l==="application/pdf"?c=await s(o):c=await a(o),console.log("OCR Text:",c),r("file-processed",c),c}catch(c){console.error("Error processing file:",c)}},s=o=>new Promise((l,c)=>{const u=new FileReader;u.onload=async d=>{try{const h=new Uint8Array(d.target.result),f=await q9({data:h}).promise,p=f.numPages;let g="";for(let b=1;b<=p;b++){console.log(`Processing page ${b} of ${p}`);const _=await f.getPage(b),m=_.getViewport({scale:2});let v,x,w;try{v=document.createElement("canvas"),x=v.getContext("2d"),v.height=m.height,v.width=m.width,await _.render({canvasContext:x,viewport:m}).promise,w=v.toDataURL("image/png")}catch(E){console.error("Browser canvas error, trying Node canvas:",E),v=K9.createCanvas(m.width,m.height),x=v.getContext("2d"),await _.render({canvasContext:x,viewport:m}).promise,w=v.toBuffer("image/png")}const{data:{text:T}}=await Jk.recognize(w,vF,{logger:E=>console.log(`Page ${b}: ${E.status} (${Math.floor(E.progress*100)}%)`)});g+=`

${T}

`}l(g)}catch(h){c(h)}},u.onerror=d=>{c(d)},u.readAsArrayBuffer(o)}),a=o=>new Promise((l,c)=>{const u=new FileReader;u.onload=async d=>{try{const h=d.target.result,{data:{text:f}}=await Jk.recognize(h,vF,{logger:p=>console.log(p)});l(f)}catch(h){c(h)}},u.onerror=d=>{c(d)},u.readAsDataURL(o)});return(o,l)=>(F0(),QT(fU,{modelValue:t.value,"onUpdate:modelValue":[l[0]||(l[0]=c=>t.value=c),i],label:"OCR Image/PDF",filled:"",style:{"max-width":"300px"},accept:"application/pdf,image/*"},null,8,["modelValue"]))}},C0=new Map,Pc=[],Y9=(n,e,t)=>{if(e&&typeof e.init=="function"&&typeof e.createInferenceSessionHandler=="function"){const r=C0.get(n);if(r===void 0)C0.set(n,{backend:e,priority:t});else{if(r.priority>t)return;if(r.priority===t&&r.backend!==e)throw new Error(`cannot register backend "${n}" using priority ${t}`)}if(t>=0){const i=Pc.indexOf(n);i!==-1&&Pc.splice(i,1);for(let s=0;s<Pc.length;s++)if(C0.get(Pc[s]).priority<=t){Pc.splice(s,0,n);return}Pc.push(n)}return}throw new TypeError("not a valid backend")},Q9=async n=>{const e=C0.get(n);if(!e)return"backend not found.";if(e.initialized)return e.backend;if(e.aborted)return e.error;{const t=!!e.initPromise;try{return t||(e.initPromise=e.backend.init(n)),await e.initPromise,e.initialized=!0,e.backend}catch(r){return t||(e.error=`${r}`,e.aborted=!0),e.error}finally{delete e.initPromise}}},t$=async n=>{const e=n.executionProviders||[],t=e.map(l=>typeof l=="string"?l:l.name),r=t.length===0?Pc:t;let i;const s=[],a=new Set;for(const l of r){const c=await Q9(l);typeof c=="string"?s.push({name:l,err:c}):(i||(i=c),i===c&&a.add(l))}if(!i)throw new Error(`no available backend found. ERR: ${s.map(l=>`[${l.name}] ${l.err}`).join(", ")}`);for(const{name:l,err:c}of s)t.includes(l)&&console.warn(`removing requested execution provider "${l}" from session options because it is not available: ${c}`);const o=e.filter(l=>a.has(typeof l=="string"?l:l.name));return[i,new Proxy(n,{get:(l,c)=>c==="executionProviders"?o:Reflect.get(l,c)})]},Z9="1.20.1";let wF="warning";const ca={wasm:{},webgl:{},webgpu:{},versions:{common:Z9},set logLevel(n){if(n!==void 0){if(typeof n!="string"||["verbose","info","warning","error","fatal"].indexOf(n)===-1)throw new Error(`Unsupported logging level: ${n}`);wF=n}},get logLevel(){return wF}};Object.defineProperty(ca,"logLevel",{enumerable:!0});const J9=ca,eV=(n,e)=>{const t=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);t.width=n.dims[3],t.height=n.dims[2];const r=t.getContext("2d");if(r!=null){let i,s;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(i=n.dims[2],s=n.dims[3]):(i=n.dims[3],s=n.dims[2]);const a=e?.format!==void 0?e.format:"RGB",o=e?.norm;let l,c;o===void 0||o.mean===void 0?l=[255,255,255,255]:typeof o.mean=="number"?l=[o.mean,o.mean,o.mean,o.mean]:(l=[o.mean[0],o.mean[1],o.mean[2],0],o.mean[3]!==void 0&&(l[3]=o.mean[3])),o===void 0||o.bias===void 0?c=[0,0,0,0]:typeof o.bias=="number"?c=[o.bias,o.bias,o.bias,o.bias]:(c=[o.bias[0],o.bias[1],o.bias[2],0],o.bias[3]!==void 0&&(c[3]=o.bias[3]));const u=s*i;let d=0,h=u,f=u*2,p=-1;a==="RGBA"?(d=0,h=u,f=u*2,p=u*3):a==="RGB"?(d=0,h=u,f=u*2):a==="RBG"&&(d=0,f=u,h=u*2);for(let g=0;g<s;g++)for(let b=0;b<i;b++){const _=(n.data[d++]-c[0])*l[0],m=(n.data[h++]-c[1])*l[1],v=(n.data[f++]-c[2])*l[2],x=p===-1?255:(n.data[p++]-c[3])*l[3];r.fillStyle="rgba("+_+","+m+","+v+","+x+")",r.fillRect(b,g,1,1)}if("toDataURL"in t)return t.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},tV=(n,e)=>{const t=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");let r;if(t!=null){let i,s,a;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(i=n.dims[2],s=n.dims[1],a=n.dims[3]):(i=n.dims[3],s=n.dims[2],a=n.dims[1]);const o=e!==void 0&&e.format!==void 0?e.format:"RGB",l=e?.norm;let c,u;l===void 0||l.mean===void 0?c=[255,255,255,255]:typeof l.mean=="number"?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],255],l.mean[3]!==void 0&&(c[3]=l.mean[3])),l===void 0||l.bias===void 0?u=[0,0,0,0]:typeof l.bias=="number"?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(u[3]=l.bias[3]));const d=s*i;if(e!==void 0&&(e.format!==void 0&&a===4&&e.format!=="RGBA"||a===3&&e.format!=="RGB"&&e.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");const h=4;let f=0,p=1,g=2,b=3,_=0,m=d,v=d*2,x=-1;o==="RGBA"?(_=0,m=d,v=d*2,x=d*3):o==="RGB"?(_=0,m=d,v=d*2):o==="RBG"&&(_=0,v=d,m=d*2),r=t.createImageData(i,s);for(let w=0;w<s*i;f+=h,p+=h,g+=h,b+=h,w++)r.data[f]=(n.data[_++]-u[0])*c[0],r.data[p]=(n.data[m++]-u[1])*c[1],r.data[g]=(n.data[v++]-u[2])*c[2],r.data[b]=x===-1?255:(n.data[x++]-u[3])*c[3]}else throw new Error("Can not access image data");return r},m2=(n,e)=>{if(n===void 0)throw new Error("Image buffer must be defined");if(e.height===void 0||e.width===void 0)throw new Error("Image height and width must be defined");if(e.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:t,width:r}=e,i=e.norm??{mean:255,bias:0};let s,a;typeof i.mean=="number"?s=[i.mean,i.mean,i.mean,i.mean]:s=[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],typeof i.bias=="number"?a=[i.bias,i.bias,i.bias,i.bias]:a=[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];const o=e.format!==void 0?e.format:"RGBA",l=e.tensorFormat!==void 0&&e.tensorFormat!==void 0?e.tensorFormat:"RGB",c=t*r,u=l==="RGBA"?new Float32Array(c*4):new Float32Array(c*3);let d=4,h=0,f=1,p=2,g=3,b=0,_=c,m=c*2,v=-1;o==="RGB"&&(d=3,h=0,f=1,p=2,g=-1),l==="RGBA"?v=c*3:l==="RBG"?(b=0,m=c,_=c*2):l==="BGR"&&(m=0,_=c,b=c*2);for(let w=0;w<c;w++,h+=d,p+=d,f+=d,g+=d)u[b++]=(n[h]+a[0])/s[0],u[_++]=(n[f]+a[1])/s[1],u[m++]=(n[p]+a[2])/s[2],v!==-1&&g!==-1&&(u[v++]=(n[g]+a[3])/s[3]);return l==="RGBA"?new Ps("float32",u,[1,4,t,r]):new Ps("float32",u,[1,3,t,r])},nV=async(n,e)=>{const t=typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement,r=typeof ImageData<"u"&&n instanceof ImageData,i=typeof ImageBitmap<"u"&&n instanceof ImageBitmap,s=typeof n=="string";let a,o=e??{};const l=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},c=u=>typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement||u instanceof OffscreenCanvas?u.getContext("2d"):null;if(t){const u=l();u.width=n.width,u.height=n.height;const d=c(u);if(d!=null){let h=n.height,f=n.width;if(e!==void 0&&e.resizedHeight!==void 0&&e.resizedWidth!==void 0&&(h=e.resizedHeight,f=e.resizedWidth),e!==void 0){if(o=e,e.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");o.tensorFormat="RGBA",o.height=h,o.width=f}else o.tensorFormat="RGBA",o.height=h,o.width=f;d.drawImage(n,0,0),a=d.getImageData(0,0,f,h).data}else throw new Error("Can not access image data")}else if(r){let u,d;if(e!==void 0&&e.resizedWidth!==void 0&&e.resizedHeight!==void 0?(u=e.resizedHeight,d=e.resizedWidth):(u=n.height,d=n.width),e!==void 0&&(o=e),o.format="RGBA",o.height=u,o.width=d,e!==void 0){const h=l();h.width=d,h.height=u;const f=c(h);if(f!=null)f.putImageData(n,0,0),a=f.getImageData(0,0,d,u).data;else throw new Error("Can not access image data")}else a=n.data}else if(i){if(e===void 0)throw new Error("Please provide image config with format for Imagebitmap");const u=l();u.width=n.width,u.height=n.height;const d=c(u);if(d!=null){const h=n.height,f=n.width;return d.drawImage(n,0,0,f,h),a=d.getImageData(0,0,f,h).data,o.height=h,o.width=f,m2(a,o)}else throw new Error("Can not access image data")}else{if(s)return new Promise((u,d)=>{const h=l(),f=c(h);if(!n||!f)return d();const p=new Image;p.crossOrigin="Anonymous",p.src=n,p.onload=()=>{h.width=p.width,h.height=p.height,f.drawImage(p,0,0,h.width,h.height);const g=f.getImageData(0,0,h.width,h.height);o.height=h.height,o.width=h.width,u(m2(g.data,o))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(a!==void 0)return m2(a,o);throw new Error("Input data provided is not supported - aborted tensor creation")},rV=(n,e)=>{const{width:t,height:r,download:i,dispose:s}=e,a=[1,r,t,4];return new Ps({location:"texture",type:"float32",texture:n,dims:a,download:i,dispose:s})},iV=(n,e)=>{const{dataType:t,dims:r,download:i,dispose:s}=e;return new Ps({location:"gpu-buffer",type:t??"float32",gpuBuffer:n,dims:r,download:i,dispose:s})},sV=(n,e)=>{const{dataType:t,dims:r,download:i,dispose:s}=e;return new Ps({location:"ml-tensor",type:t??"float32",mlTensor:n,dims:r,download:i,dispose:s})},aV=(n,e,t)=>new Ps({location:"cpu-pinned",type:n,data:e,dims:t??[e.length]}),Jd=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),S0=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let xF=!1;const oV=()=>{if(!xF){xF=!0;const n=typeof BigInt64Array<"u"&&BigInt64Array.from,e=typeof BigUint64Array<"u"&&BigUint64Array.from,t=typeof Float16Array<"u"&&Float16Array.from;n&&(Jd.set("int64",BigInt64Array),S0.set(BigInt64Array,"int64")),e&&(Jd.set("uint64",BigUint64Array),S0.set(BigUint64Array,"uint64")),t?(Jd.set("float16",Float16Array),S0.set(Float16Array,"float16")):Jd.set("float16",Uint16Array)}},lV=n=>{let e=1;for(let t=0;t<n.length;t++){const r=n[t];if(typeof r!="number"||!Number.isSafeInteger(r))throw new TypeError(`dims[${t}] must be an integer, got: ${r}`);if(r<0)throw new RangeError(`dims[${t}] must be a non-negative integer, got: ${r}`);e*=r}return e},cV=(n,e)=>{switch(n.location){case"cpu":return new Ps(n.type,n.data,e);case"cpu-pinned":return new Ps({location:"cpu-pinned",data:n.data,type:n.type,dims:e});case"texture":return new Ps({location:"texture",texture:n.texture,type:n.type,dims:e});case"gpu-buffer":return new Ps({location:"gpu-buffer",gpuBuffer:n.gpuBuffer,type:n.type,dims:e});case"ml-tensor":return new Ps({location:"ml-tensor",mlTensor:n.mlTensor,type:n.type,dims:e});default:throw new Error(`tensorReshape: tensor location ${n.location} is not supported`)}};let Ps=class{constructor(e,t,r){oV();let i,s;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,i=e.type,s=e.dims,e.location){case"cpu-pinned":{const o=Jd.get(i);if(!o)throw new TypeError(`unsupported type "${i}" to create tensor from pinned buffer`);if(!(e.data instanceof o))throw new TypeError(`buffer should be of type ${o.name}`);this.cpuData=e.data;break}case"texture":{if(i!=="float32")throw new TypeError(`unsupported type "${i}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(i!=="float32"&&i!=="float16"&&i!=="int32"&&i!=="int64"&&i!=="uint32"&&i!=="uint8"&&i!=="bool"&&i!=="uint4"&&i!=="int4")throw new TypeError(`unsupported type "${i}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}case"ml-tensor":{if(i!=="float32"&&i!=="float16"&&i!=="int32"&&i!=="int64"&&i!=="uint32"&&i!=="uint64"&&i!=="int8"&&i!=="uint8"&&i!=="bool")throw new TypeError(`unsupported type "${i}" to create tensor from MLTensor`);this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,l;if(typeof e=="string")if(i=e,l=r,e==="string"){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");o=t}else{const c=Jd.get(e);if(c===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if(e==="float16"&&c===Uint16Array||e==="uint4"||e==="int4")throw new TypeError(`Creating a ${e} tensor from number array is not supported. Please use ${c.name} as data.`);e==="uint64"||e==="int64"?o=c.from(t,BigInt):o=c.from(t)}else if(t instanceof c)o=t;else if(t instanceof Uint8ClampedArray)if(e==="uint8")o=Uint8Array.from(t);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else throw new TypeError(`A ${i} tensor's data must be type of ${c}`)}else if(l=t,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const c=typeof e[0];if(c==="string")i="string",o=e;else if(c==="boolean")i="bool",o=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${c}.`)}else if(e instanceof Uint8ClampedArray)i="uint8",o=Uint8Array.from(e);else{const c=S0.get(e.constructor);if(c===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);i=c,o=e}if(l===void 0)l=[o.length];else if(!Array.isArray(l))throw new TypeError("A tensor's dims must be a number array");s=l,this.cpuData=o,this.dataLocation="cpu"}const a=lV(s);if(this.cpuData&&a!==this.cpuData.length&&!((i==="uint4"||i==="int4")&&Math.ceil(a/2)===this.cpuData.length))throw new Error(`Tensor's size(${a}) does not match data length(${this.cpuData.length}).`);this.type=i,this.dims=s,this.size=a}static async fromImage(e,t){return nV(e,t)}static fromTexture(e,t){return rV(e,t)}static fromGpuBuffer(e,t){return iV(e,t)}static fromMLTensor(e,t){return sV(e,t)}static fromPinnedBuffer(e,t,r){return aV(e,t,r)}toDataURL(e){return eV(this,e)}toImageData(e){return tV(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;const t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return cV(this,e)}};const aa=Ps,n$=(n,e)=>{(typeof ca.trace>"u"?!ca.wasm.trace:!ca.trace)||console.timeStamp(`${n}::ORT::${e}`)},r$=(n,e)=>{const t=new Error().stack?.split(/\r\n|\r|\n/g)||[];let r=!1;for(let i=0;i<t.length;i++){if(r&&!t[i].includes("TRACE_FUNC")){let s=`FUNC_${n}::${t[i].trim().split(" ")[1]}`;e&&(s+=`::${e}`),n$("CPU",s);return}t[i].includes("TRACE_FUNC")&&(r=!0)}},IT=n=>{(typeof ca.trace>"u"?!ca.wasm.trace:!ca.trace)||r$("BEGIN",n)},OT=n=>{(typeof ca.trace>"u"?!ca.wasm.trace:!ca.trace)||r$("END",n)};let uV=class i${constructor(e){this.handler=e}async run(e,t,r){IT();const i={};let s={};if(typeof e!="object"||e===null||e instanceof aa||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if(typeof t=="object"){if(t===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof aa)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(t.length===0)throw new TypeError("'fetches' cannot be an empty array.");a=!1;for(const c of t){if(typeof c!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(c)===-1)throw new RangeError(`'fetches' contains invalid output name: ${c}.`);i[c]=null}if(typeof r=="object"&&r!==null)s=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let c=!1;const u=Object.getOwnPropertyNames(t);for(const d of this.outputNames)if(u.indexOf(d)!==-1){const h=t[d];(h===null||h instanceof aa)&&(c=!0,a=!1,i[d]=h)}if(c){if(typeof r=="object"&&r!==null)s=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else s=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const c of this.inputNames)if(typeof e[c]>"u")throw new Error(`input '${c}' is missing in 'feeds'.`);if(a)for(const c of this.outputNames)i[c]=null;const o=await this.handler.run(e,i,s),l={};for(const c in o)if(Object.hasOwnProperty.call(o,c)){const u=o[c];u instanceof aa?l[c]=u:l[c]=new aa(u.type,u.data,u.dims)}return OT(),l}async release(){return this.handler.dispose()}static async create(e,t,r,i){IT();let s,a={};if(typeof e=="string"){if(s=e,typeof t=="object"&&t!==null)a=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(s=e,typeof t=="object"&&t!==null)a=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer){const u=e;let d=0,h=e.byteLength;if(typeof t=="object"&&t!==null)a=t;else if(typeof t=="number"){if(d=t,!Number.isSafeInteger(d))throw new RangeError("'byteOffset' must be an integer.");if(d<0||d>=u.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${u.byteLength}).`);if(h=e.byteLength-d,typeof r=="number"){if(h=r,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||d+h>u.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${u.byteLength-d}].`);if(typeof i=="object"&&i!==null)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof t<"u")throw new TypeError("'options' must be an object.");s=new Uint8Array(u,d,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");const[o,l]=await t$(a),c=await o.createInferenceSessionHandler(s,l);return OT(),new i$(c)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}};const dV=uV,hV="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.";let fV=class s${constructor(e,t,r){this.handler=e,this.hasOptimizerModel=t,this.hasEvalModel=r}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(e,t){const r=e.evalModel||"",i=e.optimizerModel||"",s=t||{},[a,o]=await t$(s);if(a.createTrainingSessionHandler){const l=await a.createTrainingSessionHandler(e.checkpointState,e.trainModel,r,i,o);return new s$(l,!!e.optimizerModel,!!e.evalModel)}else throw new Error(hV)}typeNarrowingForRunStep(e,t,r,i,s){const a={};let o={};if(typeof r!="object"||r===null||r instanceof aa||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let l=!0;if(typeof i=="object"){if(i===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(i instanceof aa)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(i)){if(i.length===0)throw new TypeError("'fetches' cannot be an empty array.");l=!1;for(const c of i){if(typeof c!="string")throw new TypeError("'fetches' must be a string array or an object.");if(t.indexOf(c)===-1)throw new RangeError(`'fetches' contains invalid output name: ${c}.`);a[c]=null}if(typeof s=="object"&&s!==null)o=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else{let c=!1;const u=Object.getOwnPropertyNames(i);for(const d of t)if(u.indexOf(d)!==-1){const h=i[d];(h===null||h instanceof aa)&&(c=!0,l=!1,a[d]=h)}if(c){if(typeof s=="object"&&s!==null)o=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else o=i}}else if(typeof i<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const c of e)if(typeof r[c]>"u")throw new Error(`input '${c}' is missing in 'feeds'.`);if(l)for(const c of t)a[c]=null;return[a,o]}convertHandlerReturnTypeToMapOfTensors(e){const t={};for(const r in e)if(Object.hasOwnProperty.call(e,r)){const i=e[r];i instanceof aa?t[r]=i:t[r]=new aa(i.type,i.data,i.dims)}return t}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(e,t,r){const[i,s]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,e,t,r),a=await this.handler.runTrainStep(e,i,s);return this.convertHandlerReturnTypeToMapOfTensors(a)}async runOptimizerStep(e){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(e||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(e,t,r){if(this.hasEvalModel){const[i,s]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,e,t,r),a=await this.handler.runEvalStep(e,i,s);return this.convertHandlerReturnTypeToMapOfTensors(a)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(e=!0){return this.handler.getParametersSize(e)}async loadParametersBuffer(e,t=!0){const r=await this.getParametersSize(t);if(e.length!==4*r)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(e,t)}async getContiguousParameters(e=!0){return this.handler.getContiguousParameters(e)}async release(){return this.handler.dispose()}};const pV=fV,mV=Object.freeze(Object.defineProperty({__proto__:null,InferenceSession:dV,TRACE:n$,TRACE_FUNC_BEGIN:IT,TRACE_FUNC_END:OT,Tensor:aa,TrainingSession:pV,env:J9,registerBackend:Y9},Symbol.toStringTag,{value:"Module"}));/*!
 * ONNX Runtime Web v1.22.0-dev.20250306-ccf8fdd9ea
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var nD=Object.defineProperty,gV=Object.getOwnPropertyDescriptor,_V=Object.getOwnPropertyNames,bV=Object.prototype.hasOwnProperty,yV=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')}),nt=(n,e)=>()=>(n&&(e=n(n=0)),e),M_=(n,e)=>{for(var t in e)nD(n,t,{get:e[t],enumerable:!0})},vV=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of _V(e))!bV.call(n,i)&&i!==t&&nD(n,i,{get:()=>e[i],enumerable:!(r=gV(e,i))||r.enumerable});return n},H0=n=>vV(nD({},"__esModule",{value:!0}),n),rm,tl,Lc,TF,a$,o$=nt(()=>{rm=new Map,tl=[],Lc=(n,e,t)=>{if(e&&typeof e.init=="function"&&typeof e.createInferenceSessionHandler=="function"){let r=rm.get(n);if(r===void 0)rm.set(n,{backend:e,priority:t});else{if(r.priority>t)return;if(r.priority===t&&r.backend!==e)throw new Error(`cannot register backend "${n}" using priority ${t}`)}if(t>=0){let i=tl.indexOf(n);i!==-1&&tl.splice(i,1);for(let s=0;s<tl.length;s++)if(rm.get(tl[s]).priority<=t){tl.splice(s,0,n);return}tl.push(n)}return}throw new TypeError("not a valid backend")},TF=async n=>{let e=rm.get(n);if(!e)return"backend not found.";if(e.initialized)return e.backend;if(e.aborted)return e.error;{let t=!!e.initPromise;try{return t||(e.initPromise=e.backend.init(n)),await e.initPromise,e.initialized=!0,e.backend}catch(r){return t||(e.error=`${r}`,e.aborted=!0),e.error}finally{delete e.initPromise}}},a$=async n=>{let e=n.executionProviders||[],t=e.map(l=>typeof l=="string"?l:l.name),r=t.length===0?tl:t,i,s=[],a=new Set;for(let l of r){let c=await TF(l);typeof c=="string"?s.push({name:l,err:c}):(i||(i=c),i===c&&a.add(l))}if(!i)throw new Error(`no available backend found. ERR: ${s.map(l=>`[${l.name}] ${l.err}`).join(", ")}`);for(let{name:l,err:c}of s)t.includes(l)&&console.warn(`removing requested execution provider "${l}" from session options because it is not available: ${c}`);let o=e.filter(l=>a.has(typeof l=="string"?l:l.name));return[i,new Proxy(n,{get:(l,c)=>c==="executionProviders"?o:Reflect.get(l,c)})]}}),wV=nt(()=>{o$()}),l$,xV=nt(()=>{l$="1.22.0-dev.20250306-aafa8d170a"}),g2,xs,c$=nt(()=>{xV(),g2="warning",xs={wasm:{},webgl:{},webgpu:{},versions:{common:l$},set logLevel(n){if(n!==void 0){if(typeof n!="string"||["verbose","info","warning","error","fatal"].indexOf(n)===-1)throw new Error(`Unsupported logging level: ${n}`);g2=n}},get logLevel(){return g2}},Object.defineProperty(xs,"logLevel",{enumerable:!0})}),In,TV=nt(()=>{c$(),In=xs}),u$,d$,EV=nt(()=>{u$=(n,e)=>{let t=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);t.width=n.dims[3],t.height=n.dims[2];let r=t.getContext("2d");if(r!=null){let i,s;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(i=n.dims[2],s=n.dims[3]):(i=n.dims[3],s=n.dims[2]);let a=e?.format!==void 0?e.format:"RGB",o=e?.norm,l,c;o===void 0||o.mean===void 0?l=[255,255,255,255]:typeof o.mean=="number"?l=[o.mean,o.mean,o.mean,o.mean]:(l=[o.mean[0],o.mean[1],o.mean[2],0],o.mean[3]!==void 0&&(l[3]=o.mean[3])),o===void 0||o.bias===void 0?c=[0,0,0,0]:typeof o.bias=="number"?c=[o.bias,o.bias,o.bias,o.bias]:(c=[o.bias[0],o.bias[1],o.bias[2],0],o.bias[3]!==void 0&&(c[3]=o.bias[3]));let u=s*i,d=0,h=u,f=u*2,p=-1;a==="RGBA"?(d=0,h=u,f=u*2,p=u*3):a==="RGB"?(d=0,h=u,f=u*2):a==="RBG"&&(d=0,f=u,h=u*2);for(let g=0;g<s;g++)for(let b=0;b<i;b++){let _=(n.data[d++]-c[0])*l[0],m=(n.data[h++]-c[1])*l[1],v=(n.data[f++]-c[2])*l[2],x=p===-1?255:(n.data[p++]-c[3])*l[3];r.fillStyle="rgba("+_+","+m+","+v+","+x+")",r.fillRect(b,g,1,1)}if("toDataURL"in t)return t.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},d$=(n,e)=>{let t=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),r;if(t!=null){let i,s,a;e?.tensorLayout!==void 0&&e.tensorLayout==="NHWC"?(i=n.dims[2],s=n.dims[1],a=n.dims[3]):(i=n.dims[3],s=n.dims[2],a=n.dims[1]);let o=e!==void 0&&e.format!==void 0?e.format:"RGB",l=e?.norm,c,u;l===void 0||l.mean===void 0?c=[255,255,255,255]:typeof l.mean=="number"?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],255],l.mean[3]!==void 0&&(c[3]=l.mean[3])),l===void 0||l.bias===void 0?u=[0,0,0,0]:typeof l.bias=="number"?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],l.bias[3]!==void 0&&(u[3]=l.bias[3]));let d=s*i;if(e!==void 0&&(e.format!==void 0&&a===4&&e.format!=="RGBA"||a===3&&e.format!=="RGB"&&e.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let h=4,f=0,p=1,g=2,b=3,_=0,m=d,v=d*2,x=-1;o==="RGBA"?(_=0,m=d,v=d*2,x=d*3):o==="RGB"?(_=0,m=d,v=d*2):o==="RBG"&&(_=0,v=d,m=d*2),r=t.createImageData(i,s);for(let w=0;w<s*i;f+=h,p+=h,g+=h,b+=h,w++)r.data[f]=(n.data[_++]-u[0])*c[0],r.data[p]=(n.data[m++]-u[1])*c[1],r.data[g]=(n.data[v++]-u[2])*c[2],r.data[b]=x===-1?255:(n.data[x++]-u[3])*c[3]}else throw new Error("Can not access image data");return r}}),_y,h$,f$,p$,m$,g$,DV=nt(()=>{rD(),_y=(n,e)=>{if(n===void 0)throw new Error("Image buffer must be defined");if(e.height===void 0||e.width===void 0)throw new Error("Image height and width must be defined");if(e.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:t,width:r}=e,i=e.norm??{mean:255,bias:0},s,a;typeof i.mean=="number"?s=[i.mean,i.mean,i.mean,i.mean]:s=[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],typeof i.bias=="number"?a=[i.bias,i.bias,i.bias,i.bias]:a=[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];let o=e.format!==void 0?e.format:"RGBA",l=e.tensorFormat!==void 0&&e.tensorFormat!==void 0?e.tensorFormat:"RGB",c=t*r,u=l==="RGBA"?new Float32Array(c*4):new Float32Array(c*3),d=4,h=0,f=1,p=2,g=3,b=0,_=c,m=c*2,v=-1;o==="RGB"&&(d=3,h=0,f=1,p=2,g=-1),l==="RGBA"?v=c*3:l==="RBG"?(b=0,m=c,_=c*2):l==="BGR"&&(m=0,_=c,b=c*2);for(let x=0;x<c;x++,h+=d,p+=d,f+=d,g+=d)u[b++]=(n[h]+a[0])/s[0],u[_++]=(n[f]+a[1])/s[1],u[m++]=(n[p]+a[2])/s[2],v!==-1&&g!==-1&&(u[v++]=(n[g]+a[3])/s[3]);return l==="RGBA"?new cs("float32",u,[1,4,t,r]):new cs("float32",u,[1,3,t,r])},h$=async(n,e)=>{let t=typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement,r=typeof ImageData<"u"&&n instanceof ImageData,i=typeof ImageBitmap<"u"&&n instanceof ImageBitmap,s=typeof n=="string",a,o=e??{},l=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},c=u=>typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement||u instanceof OffscreenCanvas?u.getContext("2d"):null;if(t){let u=l();u.width=n.width,u.height=n.height;let d=c(u);if(d!=null){let h=n.height,f=n.width;if(e!==void 0&&e.resizedHeight!==void 0&&e.resizedWidth!==void 0&&(h=e.resizedHeight,f=e.resizedWidth),e!==void 0){if(o=e,e.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");o.tensorFormat="RGBA",o.height=h,o.width=f}else o.tensorFormat="RGBA",o.height=h,o.width=f;d.drawImage(n,0,0),a=d.getImageData(0,0,f,h).data}else throw new Error("Can not access image data")}else if(r){let u,d;if(e!==void 0&&e.resizedWidth!==void 0&&e.resizedHeight!==void 0?(u=e.resizedHeight,d=e.resizedWidth):(u=n.height,d=n.width),e!==void 0&&(o=e),o.format="RGBA",o.height=u,o.width=d,e!==void 0){let h=l();h.width=d,h.height=u;let f=c(h);if(f!=null)f.putImageData(n,0,0),a=f.getImageData(0,0,d,u).data;else throw new Error("Can not access image data")}else a=n.data}else if(i){if(e===void 0)throw new Error("Please provide image config with format for Imagebitmap");let u=l();u.width=n.width,u.height=n.height;let d=c(u);if(d!=null){let h=n.height,f=n.width;return d.drawImage(n,0,0,f,h),a=d.getImageData(0,0,f,h).data,o.height=h,o.width=f,_y(a,o)}else throw new Error("Can not access image data")}else{if(s)return new Promise((u,d)=>{let h=l(),f=c(h);if(!n||!f)return d();let p=new Image;p.crossOrigin="Anonymous",p.src=n,p.onload=()=>{h.width=p.width,h.height=p.height,f.drawImage(p,0,0,h.width,h.height);let g=f.getImageData(0,0,h.width,h.height);o.height=h.height,o.width=h.width,u(_y(g.data,o))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(a!==void 0)return _y(a,o);throw new Error("Input data provided is not supported - aborted tensor creation")},f$=(n,e)=>{let{width:t,height:r,download:i,dispose:s}=e,a=[1,r,t,4];return new cs({location:"texture",type:"float32",texture:n,dims:a,download:i,dispose:s})},p$=(n,e)=>{let{dataType:t,dims:r,download:i,dispose:s}=e;return new cs({location:"gpu-buffer",type:t??"float32",gpuBuffer:n,dims:r,download:i,dispose:s})},m$=(n,e)=>{let{dataType:t,dims:r,download:i,dispose:s}=e;return new cs({location:"ml-tensor",type:t??"float32",mlTensor:n,dims:r,download:i,dispose:s})},g$=(n,e,t)=>new cs({location:"cpu-pinned",type:n,data:e,dims:t??[e.length]})}),kc,Sm,_2,_$,MV=nt(()=>{kc=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),Sm=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),_2=!1,_$=()=>{if(!_2){_2=!0;let n=typeof BigInt64Array<"u"&&BigInt64Array.from,e=typeof BigUint64Array<"u"&&BigUint64Array.from,t=globalThis.Float16Array,r=typeof t<"u"&&t.from;n&&(kc.set("int64",BigInt64Array),Sm.set(BigInt64Array,"int64")),e&&(kc.set("uint64",BigUint64Array),Sm.set(BigUint64Array,"uint64")),r?(kc.set("float16",t),Sm.set(t,"float16")):kc.set("float16",Uint16Array)}}}),b$,y$,AV=nt(()=>{rD(),b$=n=>{let e=1;for(let t=0;t<n.length;t++){let r=n[t];if(typeof r!="number"||!Number.isSafeInteger(r))throw new TypeError(`dims[${t}] must be an integer, got: ${r}`);if(r<0)throw new RangeError(`dims[${t}] must be a non-negative integer, got: ${r}`);e*=r}return e},y$=(n,e)=>{switch(n.location){case"cpu":return new cs(n.type,n.data,e);case"cpu-pinned":return new cs({location:"cpu-pinned",data:n.data,type:n.type,dims:e});case"texture":return new cs({location:"texture",texture:n.texture,type:n.type,dims:e});case"gpu-buffer":return new cs({location:"gpu-buffer",gpuBuffer:n.gpuBuffer,type:n.type,dims:e});case"ml-tensor":return new cs({location:"ml-tensor",mlTensor:n.mlTensor,type:n.type,dims:e});default:throw new Error(`tensorReshape: tensor location ${n.location} is not supported`)}}}),cs,rD=nt(()=>{EV(),DV(),MV(),AV(),cs=class{constructor(n,e,t){_$();let r,i;if(typeof n=="object"&&"location"in n)switch(this.dataLocation=n.location,r=n.type,i=n.dims,n.location){case"cpu-pinned":{let a=kc.get(r);if(!a)throw new TypeError(`unsupported type "${r}" to create tensor from pinned buffer`);if(!(n.data instanceof a))throw new TypeError(`buffer should be of type ${a.name}`);this.cpuData=n.data;break}case"texture":{if(r!=="float32")throw new TypeError(`unsupported type "${r}" to create tensor from texture`);this.gpuTextureData=n.texture,this.downloader=n.download,this.disposer=n.dispose;break}case"gpu-buffer":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from gpu buffer`);this.gpuBufferData=n.gpuBuffer,this.downloader=n.download,this.disposer=n.dispose;break}case"ml-tensor":{if(r!=="float32"&&r!=="float16"&&r!=="int32"&&r!=="int64"&&r!=="uint32"&&r!=="uint64"&&r!=="int8"&&r!=="uint8"&&r!=="bool"&&r!=="uint4"&&r!=="int4")throw new TypeError(`unsupported type "${r}" to create tensor from MLTensor`);this.mlTensorData=n.mlTensor,this.downloader=n.download,this.disposer=n.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let a,o;if(typeof n=="string")if(r=n,o=t,n==="string"){if(!Array.isArray(e))throw new TypeError("A string tensor's data must be a string array.");a=e}else{let l=kc.get(n);if(l===void 0)throw new TypeError(`Unsupported tensor type: ${n}.`);if(Array.isArray(e)){if(n==="float16"&&l===Uint16Array||n==="uint4"||n==="int4")throw new TypeError(`Creating a ${n} tensor from number array is not supported. Please use ${l.name} as data.`);n==="uint64"||n==="int64"?a=l.from(e,BigInt):a=l.from(e)}else if(e instanceof l)a=e;else if(e instanceof Uint8ClampedArray)if(n==="uint8")a=Uint8Array.from(e);else throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");else if(n==="float16"&&e instanceof Uint16Array&&l!==Uint16Array)a=new globalThis.Float16Array(e.buffer,e.byteOffset,e.length);else throw new TypeError(`A ${r} tensor's data must be type of ${l}`)}else if(o=e,Array.isArray(n)){if(n.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let l=typeof n[0];if(l==="string")r="string",a=n;else if(l==="boolean")r="bool",a=Uint8Array.from(n);else throw new TypeError(`Invalid element type of data array: ${l}.`)}else if(n instanceof Uint8ClampedArray)r="uint8",a=Uint8Array.from(n);else{let l=Sm.get(n.constructor);if(l===void 0)throw new TypeError(`Unsupported type for tensor data: ${n.constructor}.`);r=l,a=n}if(o===void 0)o=[a.length];else if(!Array.isArray(o))throw new TypeError("A tensor's dims must be a number array");i=o,this.cpuData=a,this.dataLocation="cpu"}let s=b$(i);if(this.cpuData&&s!==this.cpuData.length&&!((r==="uint4"||r==="int4")&&Math.ceil(s/2)===this.cpuData.length))throw new Error(`Tensor's size(${s}) does not match data length(${this.cpuData.length}).`);this.type=r,this.dims=i,this.size=s}static async fromImage(n,e){return h$(n,e)}static fromTexture(n,e){return f$(n,e)}static fromGpuBuffer(n,e){return p$(n,e)}static fromMLTensor(n,e){return m$(n,e)}static fromPinnedBuffer(n,e,t){return g$(n,e,t)}toDataURL(n){return u$(this,n)}toImageData(n){return d$(this,n)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(n){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let e=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=e,n&&this.disposer&&(this.disposer(),this.disposer=void 0),e}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(n){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return y$(this,n)}}}),oa,v$=nt(()=>{rD(),oa=cs}),Hm,b2,ha,Os,w$=nt(()=>{c$(),Hm=(n,e)=>{(typeof xs.trace>"u"?!xs.wasm.trace:!xs.trace)||console.timeStamp(`${n}::ORT::${e}`)},b2=(n,e)=>{let t=new Error().stack?.split(/\r\n|\r|\n/g)||[],r=!1;for(let i=0;i<t.length;i++){if(r&&!t[i].includes("TRACE_FUNC")){let s=`FUNC_${n}::${t[i].trim().split(" ")[1]}`;e&&(s+=`::${e}`),Hm("CPU",s);return}t[i].includes("TRACE_FUNC")&&(r=!0)}},ha=n=>{(typeof xs.trace>"u"?!xs.wasm.trace:!xs.trace)||b2("BEGIN",n)},Os=n=>{(typeof xs.trace>"u"?!xs.wasm.trace:!xs.trace)||b2("END",n)}}),x$,CV=nt(()=>{o$(),v$(),w$(),x$=class T${constructor(e){this.handler=e}async run(e,t,r){ha();let i={},s={};if(typeof e!="object"||e===null||e instanceof oa||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if(typeof t=="object"){if(t===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof oa)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(t.length===0)throw new TypeError("'fetches' cannot be an empty array.");a=!1;for(let c of t){if(typeof c!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(c)===-1)throw new RangeError(`'fetches' contains invalid output name: ${c}.`);i[c]=null}if(typeof r=="object"&&r!==null)s=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let c=!1,u=Object.getOwnPropertyNames(t);for(let d of this.outputNames)if(u.indexOf(d)!==-1){let h=t[d];(h===null||h instanceof oa)&&(c=!0,a=!1,i[d]=h)}if(c){if(typeof r=="object"&&r!==null)s=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else s=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let c of this.inputNames)if(typeof e[c]>"u")throw new Error(`input '${c}' is missing in 'feeds'.`);if(a)for(let c of this.outputNames)i[c]=null;let o=await this.handler.run(e,i,s),l={};for(let c in o)if(Object.hasOwnProperty.call(o,c)){let u=o[c];u instanceof oa?l[c]=u:l[c]=new oa(u.type,u.data,u.dims)}return Os(),l}async release(){return this.handler.dispose()}static async create(e,t,r,i){ha();let s,a={};if(typeof e=="string"){if(s=e,typeof t=="object"&&t!==null)a=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(s=e,typeof t=="object"&&t!==null)a=t;else if(typeof t<"u")throw new TypeError("'options' must be an object.")}else if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer){let u=e,d=0,h=e.byteLength;if(typeof t=="object"&&t!==null)a=t;else if(typeof t=="number"){if(d=t,!Number.isSafeInteger(d))throw new RangeError("'byteOffset' must be an integer.");if(d<0||d>=u.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${u.byteLength}).`);if(h=e.byteLength-d,typeof r=="number"){if(h=r,!Number.isSafeInteger(h))throw new RangeError("'byteLength' must be an integer.");if(h<=0||d+h>u.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${u.byteLength-d}].`);if(typeof i=="object"&&i!==null)a=i;else if(typeof i<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof t<"u")throw new TypeError("'options' must be an object.");s=new Uint8Array(u,d,h)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[o,l]=await a$(a),c=await o.createInferenceSessionHandler(s,l);return Os(),new T$(c)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),iD,SV=nt(()=>{CV(),iD=x$}),PV=nt(()=>{}),kV=nt(()=>{}),FV=nt(()=>{}),IV=nt(()=>{}),E$={};M_(E$,{InferenceSession:()=>iD,TRACE:()=>Hm,TRACE_FUNC_BEGIN:()=>ha,TRACE_FUNC_END:()=>Os,Tensor:()=>oa,env:()=>In,registerBackend:()=>Lc});var pa=nt(()=>{wV(),TV(),SV(),v$(),PV(),kV(),w$(),FV(),IV()}),sD=nt(()=>{}),D$={};M_(D$,{default:()=>M$});var y2,v2,M$,OV=nt(()=>{S8(),rd(),aD(),y2="ort-wasm-proxy-worker",v2=globalThis.self?.name===y2,v2&&(self.onmessage=n=>{let{type:e,in:t}=n.data;try{switch(e){case"init-wasm":oD(t.wasm).then(()=>{DD(t).then(()=>{postMessage({type:e})},r=>{postMessage({type:e,err:r})})},r=>{postMessage({type:e,err:r})});break;case"init-ep":{let{epName:r,env:i}=t;MD(i,r).then(()=>{postMessage({type:e})},s=>{postMessage({type:e,err:s})});break}case"copy-from":{let{buffer:r}=t,i=J0(r);postMessage({type:e,out:i});break}case"create":{let{model:r,options:i}=t;AD(r,i).then(s=>{postMessage({type:e,out:s})},s=>{postMessage({type:e,err:s})});break}case"release":CD(t),postMessage({type:e});break;case"run":{let{sessionId:r,inputIndices:i,inputs:s,outputIndices:a,options:o}=t;SD(r,i,s,a,new Array(a.length).fill(null),o).then(l=>{l.some(c=>c[3]!=="cpu")?postMessage({type:e,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:e,out:l},kD([...s,...l]))},l=>{postMessage({type:e,err:l})});break}case"end-profiling":PD(t),postMessage({type:e});break;default:}}catch(r){postMessage({type:e,err:r})}}),M$=v2?null:n=>new Worker(n??Ki,{type:"module",name:y2})}),A$={};M_(A$,{default:()=>C$});var w2,x2,C$,EF,UV=nt(()=>{x2=(w2=import.meta.url,async function(n={}){var e,t,r=n,i=new Promise((D,P)=>{e=D,t=P}),s=typeof window=="object",a=typeof WorkerGlobalScope<"u",o=a&&self.name?.startsWith("em-pthread");r.mountExternalData=(D,P)=>{D.startsWith("./")&&(D=D.substring(2)),(r.Bd||(r.Bd=new Map)).set(D,P)},r.unmountExternalData=()=>{delete r.Bd};var l=globalThis.SharedArrayBuffer??new WebAssembly.Memory({initial:0,maximum:0,shared:!0}).buffer.constructor;let c=()=>{let D=(N,K,J)=>(..._e)=>{let Ae=hn,Ne=K?.();_e=N(..._e);let Ge=K?.();return Ne!==Ge&&(N=Ge,J(Ne),K=J=null),hn!=Ae?new Promise((et,dt)=>{sr={resolve:et,reject:dt}}):_e},P=N=>async(...K)=>{try{if(r.Cd)throw Error("Session already started");let J=r.Cd={be:K[0],errors:[]},_e=await N(...K);if(r.Cd!==J)throw Error("Session mismatch");r.Dd?.flush();let Ae=J.errors;if(0<Ae.length){let Ne=await Promise.all(Ae);if(Ne=Ne.filter(Ge=>Ge),0<Ne.length)throw Error(Ne.join(`
`))}return _e}finally{r.Cd=null}};r._OrtCreateSession=D(r._OrtCreateSession,()=>r._OrtCreateSession,N=>r._OrtCreateSession=N),r._OrtRun=P(D(r._OrtRun,()=>r._OrtRun,N=>r._OrtRun=N)),r._OrtRunWithBinding=P(D(r._OrtRunWithBinding,()=>r._OrtRunWithBinding,N=>r._OrtRunWithBinding=N)),r._OrtBindInput=D(r._OrtBindInput,()=>r._OrtBindInput,N=>r._OrtBindInput=N),c=void 0};r.jsepInit=(D,P)=>{if(c?.(),D==="webgpu"){[r.Dd,r.Rd,r.Vd,r.Hd,r.Ud,r.hc,r.Wd,r.Zd,r.Sd,r.Td,r.Xd]=P;let N=r.Dd;r.jsepRegisterBuffer=(K,J,_e,Ae)=>N.registerBuffer(K,J,_e,Ae),r.jsepGetBuffer=K=>N.getBuffer(K),r.jsepCreateDownloader=(K,J,_e)=>N.createDownloader(K,J,_e),r.jsepOnCreateSession=K=>{N.onCreateSession(K)},r.jsepOnReleaseSession=K=>{N.onReleaseSession(K)},r.jsepOnRunStart=K=>N.onRunStart(K),r.$d=(K,J)=>{N.upload(K,J)}}else if(D==="webnn"){[r.Dd,r.Yd,r.Id,r.jsepEnsureTensor,r.Jd,r.jsepDownloadTensor]=P,r.jsepReleaseTensorId=r.Id,r.jsepUploadTensor=r.Jd;let N=r.Dd;r.jsepOnRunStart=K=>N.onRunStart(K),r.jsepOnRunEnd=N.onRunEnd.bind(N),r.jsepRegisterMLContext=(K,J)=>{N.registerMLContext(K,J)},r.jsepOnReleaseSession=K=>{N.onReleaseSession(K)},r.jsepCreateMLTensorDownloader=(K,J)=>N.createMLTensorDownloader(K,J),r.jsepRegisterMLTensor=(K,J,_e,Ae)=>N.registerMLTensor(K,J,_e,Ae),r.jsepCreateMLContext=K=>N.createMLContext(K),r.jsepRegisterMLConstant=(K,J,_e,Ae,Ne)=>N.registerMLConstant(K,J,_e,Ae,Ne,r.Bd),r.jsepRegisterGraphInput=N.registerGraphInput.bind(N),r.jsepIsGraphInput=N.isGraphInput.bind(N),r.jsepCreateTemporaryTensor=N.createTemporaryTensor.bind(N)}};var u,d,h=Object.assign({},r),f=(D,P)=>{throw P},p="";(s||a)&&(a?p=self.location.href:typeof document<"u"&&document.currentScript&&(p=document.currentScript.src),w2&&(p=w2),p=p.startsWith("blob:")?"":p.slice(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1),a&&(d=D=>{var P=new XMLHttpRequest;return P.open("GET",D,!1),P.responseType="arraybuffer",P.send(null),new Uint8Array(P.response)}),u=async D=>{if(X(D))return new Promise((N,K)=>{var J=new XMLHttpRequest;J.open("GET",D,!0),J.responseType="arraybuffer",J.onload=()=>{J.status==200||J.status==0&&J.response?N(J.response):K(J.status)},J.onerror=K,J.send(null)});var P=await fetch(D,{credentials:"same-origin"});if(P.ok)return P.arrayBuffer();throw Error(P.status+" : "+P.url)});var g=console.log.bind(console),b=console.error.bind(console),_=g,m=b;Object.assign(r,h),h=null;var v,x,w,T,E,A,M,F,G,S,I,C,H,B=r.wasmBinary,$=!1,X=D=>D.startsWith("file://");function V(){return v.buffer!=T.buffer&&Fe(),T}function Q(){return v.buffer!=T.buffer&&Fe(),E}function R(){return v.buffer!=T.buffer&&Fe(),A}function O(){return v.buffer!=T.buffer&&Fe(),M}function L(){return v.buffer!=T.buffer&&Fe(),F}function ne(){return v.buffer!=T.buffer&&Fe(),G}function de(){return v.buffer!=T.buffer&&Fe(),S}function we(){return v.buffer!=T.buffer&&Fe(),H}if(o){let D=function(P){try{var N=P.data,K=N.yd;if(K==="load"){let J=[];self.onmessage=_e=>J.push(_e),self.startWorker=()=>{postMessage({yd:"loaded"});for(let _e of J)D(_e);self.onmessage=D};for(let _e of N.Od)r[_e]&&!r[_e].proxy||(r[_e]=(...Ae)=>{postMessage({yd:"callHandler",Nd:_e,args:Ae})},_e=="print"&&(_=r[_e]),_e=="printErr"&&(m=r[_e]));v=N.he,Fe(),be(N.ie)}else if(K==="run"){Wt(N.xd),md(N.xd,0,0,1,0,0),tt(),An(N.xd),Ee||(Bf(),Ee=!0);try{Jn(N.de,N.Fd)}catch(J){if(J!="unwind")throw J}}else N.target!=="setimmediate"&&(K==="checkMailbox"?Ee&&Vn():K&&(m(`worker: received unknown command ${K}`),m(N)))}catch(J){throw gd(),J}};var be,Ee=!1;m=function(...P){P=P.join(" "),console.error(P)},self.alert=function(...P){postMessage({yd:"alert",text:P.join(" "),fe:hc()})},self.onunhandledrejection=P=>{throw P.reason||P},self.onmessage=D}function Fe(){var D=v.buffer;r.HEAP8=T=new Int8Array(D),r.HEAP16=A=new Int16Array(D),r.HEAPU8=E=new Uint8Array(D),r.HEAPU16=M=new Uint16Array(D),r.HEAP32=F=new Int32Array(D),r.HEAPU32=G=new Uint32Array(D),r.HEAPF32=S=new Float32Array(D),r.HEAPF64=H=new Float64Array(D),r.HEAP64=I=new BigInt64Array(D),r.HEAPU64=C=new BigUint64Array(D)}function xe(){o?startWorker(r):Qe.Bb()}o||(v=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),Fe());var ce,ue=0,Se=null;function U(){if(--ue==0&&Se){var D=Se;Se=null,D()}}function he(D){throw m(D="Aborted("+D+")"),$=!0,D=new WebAssembly.RuntimeError(D+". Build with -sASSERTIONS for more info."),t(D),D}function pe(){return{a:{Ta:ge,Va:re,W:yr,la:fe,b:Tt,u:rn,R:Un,Za:ur,d:vr,pb:Dn,g:Ie,T:Mn,Ga:ki,lb:gi,nb:ms,Ha:Lo,Ea:Ro,wb:gs,Da:ma,pa:Bo,mb:$o,jb:No,Fa:zo,kb:Rs,Ma:Jl,za:ec,eb:tc,cb:rc,ya:_a,V:sc,N:Le,db:Y,ma:ut,fb:st,zb:Ht,hb:Bn,qb:hr,ab:qi,Aa:Va,yb:An,Ja:Wr,S:fr,Wa:jr,$:A_,H:C_,E:S_,l:Wa,F:P_,B:F_,X:Ef,J:I_,v:Df,O:O_,D:Mf,t:Jv,A:U_,z:Af,w:L_,r:sd,tb:R_,ub:B_,vb:$_,rb:kf,sb:cc,bb:ad,Oa:qa,La:e1,y:j_,ja:Ff,Ba:V_,Ka:z_,qa:G_,Ia:q_,ib:H_,U:N_,fa:K_,Sa:ld,gb:X_,Qa:Y_,Pa:Q_,Ab:dd,Ca:Of,ob:Re,aa:Uf,oa:hd,xb:Lf,na:fd,$a:kp,ia:Mb,sa:Pb,ga:_b,da:Od,ua:Lp,p:gb,e:ib,c:nb,ea:wb,f:Mp,n:ab,k:fb,Y:lb,ka:pb,j:Pp,wa:Fp,Ra:Fb,ca:Db,Ua:Rp,P:xb,K:cb,_:Op,Q:bb,Z:Ab,x:Ap,m:rb,va:Ip,i:tb,h:ob,ra:kb,ta:Sb,o:sb,q:ub,s:hb,I:Cp,C:mb,L:Sp,xa:vb,_a:yb,G:Up,Ya:Tb,ba:Cb,M:db,Xa:Eb,ha:J_,a:v,Na:ve}}}var ie={1320978:()=>typeof wasmOffsetConverter<"u",1321035:(D,P,N,K,J)=>{if(r===void 0||!r.Bd)return 1;if((D=rt(Number(D>>>0))).startsWith("./")&&(D=D.substring(2)),!(D=r.Bd.get(D)))return 2;if(P=Number(P>>>0),N=Number(N>>>0),K=Number(K>>>0),P+N>D.byteLength)return 3;try{let _e=D.subarray(P,P+N);switch(J){case 0:Q().set(_e,K>>>0);break;case 1:r.$d(K,_e);break;default:return 4}return 0}catch{return 4}},1321750:(D,P,N)=>{r.Jd(D,Q().subarray(P>>>0,P+N>>>0))},1321813:()=>r.Yd(),1321854:D=>{r.Id(D)},1321890:()=>{r.Sd()},1321921:()=>{r.Td()},1321950:()=>{r.Xd()},1321975:D=>r.Rd(D),1322008:D=>r.Vd(D),1322040:(D,P,N)=>{r.Hd(Number(D),Number(P),Number(N),!0)},1322103:(D,P,N)=>{r.Hd(Number(D),Number(P),Number(N))},1322160:D=>{r.hc("Abs",D,void 0)},1322211:D=>{r.hc("Neg",D,void 0)},1322262:D=>{r.hc("Floor",D,void 0)},1322315:D=>{r.hc("Ceil",D,void 0)},1322367:D=>{r.hc("Reciprocal",D,void 0)},1322425:D=>{r.hc("Sqrt",D,void 0)},1322477:D=>{r.hc("Exp",D,void 0)},1322528:D=>{r.hc("Erf",D,void 0)},1322579:D=>{r.hc("Sigmoid",D,void 0)},1322634:(D,P,N)=>{r.hc("HardSigmoid",D,{alpha:P,beta:N})},1322713:D=>{r.hc("Log",D,void 0)},1322764:D=>{r.hc("Sin",D,void 0)},1322815:D=>{r.hc("Cos",D,void 0)},1322866:D=>{r.hc("Tan",D,void 0)},1322917:D=>{r.hc("Asin",D,void 0)},1322969:D=>{r.hc("Acos",D,void 0)},1323021:D=>{r.hc("Atan",D,void 0)},1323073:D=>{r.hc("Sinh",D,void 0)},1323125:D=>{r.hc("Cosh",D,void 0)},1323177:D=>{r.hc("Asinh",D,void 0)},1323230:D=>{r.hc("Acosh",D,void 0)},1323283:D=>{r.hc("Atanh",D,void 0)},1323336:D=>{r.hc("Tanh",D,void 0)},1323388:D=>{r.hc("Not",D,void 0)},1323439:(D,P,N)=>{r.hc("Clip",D,{min:P,max:N})},1323508:D=>{r.hc("Clip",D,void 0)},1323560:(D,P)=>{r.hc("Elu",D,{alpha:P})},1323618:D=>{r.hc("Gelu",D,void 0)},1323670:D=>{r.hc("Relu",D,void 0)},1323722:(D,P)=>{r.hc("LeakyRelu",D,{alpha:P})},1323786:(D,P)=>{r.hc("ThresholdedRelu",D,{alpha:P})},1323856:(D,P)=>{r.hc("Cast",D,{to:P})},1323914:D=>{r.hc("Add",D,void 0)},1323965:D=>{r.hc("Sub",D,void 0)},1324016:D=>{r.hc("Mul",D,void 0)},1324067:D=>{r.hc("Div",D,void 0)},1324118:D=>{r.hc("Pow",D,void 0)},1324169:D=>{r.hc("Equal",D,void 0)},1324222:D=>{r.hc("Greater",D,void 0)},1324277:D=>{r.hc("GreaterOrEqual",D,void 0)},1324339:D=>{r.hc("Less",D,void 0)},1324391:D=>{r.hc("LessOrEqual",D,void 0)},1324450:(D,P,N,K,J)=>{r.hc("ReduceMean",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1324625:(D,P,N,K,J)=>{r.hc("ReduceMax",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1324799:(D,P,N,K,J)=>{r.hc("ReduceMin",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1324973:(D,P,N,K,J)=>{r.hc("ReduceProd",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1325148:(D,P,N,K,J)=>{r.hc("ReduceSum",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1325322:(D,P,N,K,J)=>{r.hc("ReduceL1",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1325495:(D,P,N,K,J)=>{r.hc("ReduceL2",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1325668:(D,P,N,K,J)=>{r.hc("ReduceLogSum",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1325845:(D,P,N,K,J)=>{r.hc("ReduceSumSquare",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1326025:(D,P,N,K,J)=>{r.hc("ReduceLogSumExp",D,{keepDims:!!P,noopWithEmptyAxes:!!N,axes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1326205:D=>{r.hc("Where",D,void 0)},1326258:(D,P,N)=>{r.hc("Transpose",D,{perm:P?Array.from(L().subarray(Number(P)>>>0,Number(N)>>>0)):[]})},1326382:(D,P,N,K)=>{r.hc("DepthToSpace",D,{blocksize:P,mode:rt(N),format:K?"NHWC":"NCHW"})},1326515:(D,P,N,K)=>{r.hc("DepthToSpace",D,{blocksize:P,mode:rt(N),format:K?"NHWC":"NCHW"})},1326648:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn,ei)=>{r.hc("ConvTranspose",D,{format:Ge?"NHWC":"NCHW",autoPad:P,dilations:[N],group:K,kernelShape:[J],pads:[_e,Ae],strides:[Ne],wIsConst:()=>!!V()[et>>>0],outputPadding:dt?Array.from(L().subarray(Number(dt)>>>0,Number(wt)>>>0)):[],outputShape:Rt?Array.from(L().subarray(Number(Rt)>>>0,Number(mn)>>>0)):[],activation:rt(ei)})},1327081:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn)=>{r.hc("ConvTranspose",D,{format:Ne?"NHWC":"NCHW",autoPad:P,dilations:Array.from(L().subarray(Number(N)>>>0,2+(Number(N)>>>0)>>>0)),group:K,kernelShape:Array.from(L().subarray(Number(J)>>>0,2+(Number(J)>>>0)>>>0)),pads:Array.from(L().subarray(Number(_e)>>>0,4+(Number(_e)>>>0)>>>0)),strides:Array.from(L().subarray(Number(Ae)>>>0,2+(Number(Ae)>>>0)>>>0)),wIsConst:()=>!!V()[Ge>>>0],outputPadding:et?Array.from(L().subarray(Number(et)>>>0,Number(dt)>>>0)):[],outputShape:wt?Array.from(L().subarray(Number(wt)>>>0,Number(Rt)>>>0)):[],activation:rt(mn)})},1327742:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn,ei)=>{r.hc("ConvTranspose",D,{format:Ge?"NHWC":"NCHW",autoPad:P,dilations:[N],group:K,kernelShape:[J],pads:[_e,Ae],strides:[Ne],wIsConst:()=>!!V()[et>>>0],outputPadding:dt?Array.from(L().subarray(Number(dt)>>>0,Number(wt)>>>0)):[],outputShape:Rt?Array.from(L().subarray(Number(Rt)>>>0,Number(mn)>>>0)):[],activation:rt(ei)})},1328175:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn)=>{r.hc("ConvTranspose",D,{format:Ne?"NHWC":"NCHW",autoPad:P,dilations:Array.from(L().subarray(Number(N)>>>0,2+(Number(N)>>>0)>>>0)),group:K,kernelShape:Array.from(L().subarray(Number(J)>>>0,2+(Number(J)>>>0)>>>0)),pads:Array.from(L().subarray(Number(_e)>>>0,4+(Number(_e)>>>0)>>>0)),strides:Array.from(L().subarray(Number(Ae)>>>0,2+(Number(Ae)>>>0)>>>0)),wIsConst:()=>!!V()[Ge>>>0],outputPadding:et?Array.from(L().subarray(Number(et)>>>0,Number(dt)>>>0)):[],outputShape:wt?Array.from(L().subarray(Number(wt)>>>0,Number(Rt)>>>0)):[],activation:rt(mn)})},1328836:(D,P)=>{r.hc("GlobalAveragePool",D,{format:P?"NHWC":"NCHW"})},1328927:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn)=>{r.hc("AveragePool",D,{format:mn?"NHWC":"NCHW",auto_pad:P,ceil_mode:N,count_include_pad:K,storage_order:J,dilations:_e?Array.from(L().subarray(Number(_e)>>>0,Number(Ae)>>>0)):[],kernel_shape:Ne?Array.from(L().subarray(Number(Ne)>>>0,Number(Ge)>>>0)):[],pads:et?Array.from(L().subarray(Number(et)>>>0,Number(dt)>>>0)):[],strides:wt?Array.from(L().subarray(Number(wt)>>>0,Number(Rt)>>>0)):[]})},1329406:(D,P)=>{r.hc("GlobalAveragePool",D,{format:P?"NHWC":"NCHW"})},1329497:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn)=>{r.hc("AveragePool",D,{format:mn?"NHWC":"NCHW",auto_pad:P,ceil_mode:N,count_include_pad:K,storage_order:J,dilations:_e?Array.from(L().subarray(Number(_e)>>>0,Number(Ae)>>>0)):[],kernel_shape:Ne?Array.from(L().subarray(Number(Ne)>>>0,Number(Ge)>>>0)):[],pads:et?Array.from(L().subarray(Number(et)>>>0,Number(dt)>>>0)):[],strides:wt?Array.from(L().subarray(Number(wt)>>>0,Number(Rt)>>>0)):[]})},1329976:(D,P)=>{r.hc("GlobalMaxPool",D,{format:P?"NHWC":"NCHW"})},1330063:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn)=>{r.hc("MaxPool",D,{format:mn?"NHWC":"NCHW",auto_pad:P,ceil_mode:N,count_include_pad:K,storage_order:J,dilations:_e?Array.from(L().subarray(Number(_e)>>>0,Number(Ae)>>>0)):[],kernel_shape:Ne?Array.from(L().subarray(Number(Ne)>>>0,Number(Ge)>>>0)):[],pads:et?Array.from(L().subarray(Number(et)>>>0,Number(dt)>>>0)):[],strides:wt?Array.from(L().subarray(Number(wt)>>>0,Number(Rt)>>>0)):[]})},1330538:(D,P)=>{r.hc("GlobalMaxPool",D,{format:P?"NHWC":"NCHW"})},1330625:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn)=>{r.hc("MaxPool",D,{format:mn?"NHWC":"NCHW",auto_pad:P,ceil_mode:N,count_include_pad:K,storage_order:J,dilations:_e?Array.from(L().subarray(Number(_e)>>>0,Number(Ae)>>>0)):[],kernel_shape:Ne?Array.from(L().subarray(Number(Ne)>>>0,Number(Ge)>>>0)):[],pads:et?Array.from(L().subarray(Number(et)>>>0,Number(dt)>>>0)):[],strides:wt?Array.from(L().subarray(Number(wt)>>>0,Number(Rt)>>>0)):[]})},1331100:(D,P,N,K,J)=>{r.hc("Gemm",D,{alpha:P,beta:N,transA:K,transB:J})},1331204:D=>{r.hc("MatMul",D,void 0)},1331258:(D,P,N,K)=>{r.hc("ArgMax",D,{keepDims:!!P,selectLastIndex:!!N,axis:K})},1331366:(D,P,N,K)=>{r.hc("ArgMin",D,{keepDims:!!P,selectLastIndex:!!N,axis:K})},1331474:(D,P)=>{r.hc("Softmax",D,{axis:P})},1331537:(D,P)=>{r.hc("Concat",D,{axis:P})},1331597:(D,P,N,K,J)=>{r.hc("Split",D,{axis:P,numOutputs:N,splitSizes:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1331753:D=>{r.hc("Expand",D,void 0)},1331807:(D,P)=>{r.hc("Gather",D,{axis:Number(P)})},1331878:(D,P)=>{r.hc("GatherElements",D,{axis:Number(P)})},1331957:(D,P)=>{r.hc("GatherND",D,{batch_dims:Number(P)})},1332036:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt)=>{r.hc("Resize",D,{antialias:P,axes:N?Array.from(L().subarray(Number(N)>>>0,Number(K)>>>0)):[],coordinateTransformMode:rt(J),cubicCoeffA:_e,excludeOutside:Ae,extrapolationValue:Ne,keepAspectRatioPolicy:rt(Ge),mode:rt(et),nearestMode:rt(dt)})},1332398:(D,P,N,K,J,_e,Ae)=>{r.hc("Slice",D,{starts:P?Array.from(L().subarray(Number(P)>>>0,Number(N)>>>0)):[],ends:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[],axes:_e?Array.from(L().subarray(Number(_e)>>>0,Number(Ae)>>>0)):[]})},1332662:D=>{r.hc("Tile",D,void 0)},1332714:(D,P,N)=>{r.hc("InstanceNormalization",D,{epsilon:P,format:N?"NHWC":"NCHW"})},1332828:(D,P,N)=>{r.hc("InstanceNormalization",D,{epsilon:P,format:N?"NHWC":"NCHW"})},1332942:D=>{r.hc("Range",D,void 0)},1332995:(D,P)=>{r.hc("Einsum",D,{equation:rt(P)})},1333076:(D,P,N,K,J)=>{r.hc("Pad",D,{mode:P,value:N,pads:K?Array.from(L().subarray(Number(K)>>>0,Number(J)>>>0)):[]})},1333219:(D,P,N,K,J,_e)=>{r.hc("BatchNormalization",D,{epsilon:P,momentum:N,spatial:!!J,trainingMode:!!K,format:_e?"NHWC":"NCHW"})},1333388:(D,P,N,K,J,_e)=>{r.hc("BatchNormalization",D,{epsilon:P,momentum:N,spatial:!!J,trainingMode:!!K,format:_e?"NHWC":"NCHW"})},1333557:(D,P,N)=>{r.hc("CumSum",D,{exclusive:Number(P),reverse:Number(N)})},1333654:(D,P,N)=>{r.hc("DequantizeLinear",D,{axis:P,blockSize:N})},1333744:(D,P,N,K,J)=>{r.hc("GridSample",D,{align_corners:P,mode:rt(N),padding_mode:rt(K),format:J?"NHWC":"NCHW"})},1333914:(D,P,N,K,J)=>{r.hc("GridSample",D,{align_corners:P,mode:rt(N),padding_mode:rt(K),format:J?"NHWC":"NCHW"})},1334084:(D,P)=>{r.hc("ScatterND",D,{reduction:rt(P)})},1334169:(D,P,N,K,J,_e,Ae,Ne,Ge)=>{r.hc("Attention",D,{numHeads:P,isUnidirectional:N,maskFilterValue:K,scale:J,doRotary:_e,qkvHiddenSizes:Ae?Array.from(L().subarray(Number(Ne)>>>0,Number(Ne)+Ae>>>0)):[],pastPresentShareBuffer:!!Ge})},1334441:D=>{r.hc("BiasAdd",D,void 0)},1334496:D=>{r.hc("BiasSplitGelu",D,void 0)},1334557:D=>{r.hc("FastGelu",D,void 0)},1334613:(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn,ei,Xo)=>{r.hc("Conv",D,{format:wt?"NHWC":"NCHW",auto_pad:P,dilations:N?Array.from(L().subarray(Number(N)>>>0,Number(K)>>>0)):[],group:J,kernel_shape:_e?Array.from(L().subarray(Number(_e)>>>0,Number(Ae)>>>0)):[],pads:Ne?Array.from(L().subarray(Number(Ne)>>>0,Number(Ge)>>>0)):[],strides:et?Array.from(L().subarray(Number(et)>>>0,Number(dt)>>>0)):[],w_is_const:()=>!!V()[Number(Rt)>>>0],activation:rt(mn),activation_params:ei?Array.from(de().subarray(Number(ei)>>>0,Number(Xo)>>>0)):[]})},1335197:D=>{r.hc("Gelu",D,void 0)},1335249:(D,P,N,K,J,_e,Ae,Ne,Ge)=>{r.hc("GroupQueryAttention",D,{numHeads:P,kvNumHeads:N,scale:K,softcap:J,doRotary:_e,rotaryInterleaved:Ae,smoothSoftmax:Ne,localWindowSize:Ge})},1335466:(D,P,N,K)=>{r.hc("LayerNormalization",D,{axis:P,epsilon:N,simplified:!!K})},1335577:(D,P,N,K)=>{r.hc("LayerNormalization",D,{axis:P,epsilon:N,simplified:!!K})},1335688:(D,P,N,K,J,_e)=>{r.hc("MatMulNBits",D,{k:P,n:N,accuracyLevel:K,bits:J,blockSize:_e})},1335815:(D,P,N,K,J,_e)=>{r.hc("MultiHeadAttention",D,{numHeads:P,isUnidirectional:N,maskFilterValue:K,scale:J,doRotary:_e})},1335974:(D,P)=>{r.hc("QuickGelu",D,{alpha:P})},1336038:(D,P,N,K,J)=>{r.hc("RotaryEmbedding",D,{interleaved:!!P,numHeads:N,rotaryEmbeddingDim:K,scale:J})},1336177:(D,P,N)=>{r.hc("SkipLayerNormalization",D,{epsilon:P,simplified:!!N})},1336279:(D,P,N)=>{r.hc("SkipLayerNormalization",D,{epsilon:P,simplified:!!N})},1336381:(D,P,N,K)=>{r.hc("GatherBlockQuantized",D,{gatherAxis:P,quantizeAxis:N,blockSize:K})},1336502:D=>{r.Wd(D)},1336536:(D,P)=>r.Zd(Number(D),Number(P),r.Cd.be,r.Cd.errors)};function re(D,P,N){return ac(async()=>{await r.Ud(Number(D),Number(P),Number(N))})}function ge(){return typeof wasmOffsetConverter<"u"}class Ce{name="ExitStatus";constructor(P){this.message=`Program terminated with exit(${P})`,this.status=P}}var q=D=>{D.terminate(),D.onmessage=()=>{}},te=[],j=D=>{Oe.length==0&&(ft(),xt(Oe[0]));var P=Oe.pop();if(!P)return 6;ze.push(P),Be[D.xd]=P,P.xd=D.xd;var N={yd:"run",de:D.ce,Fd:D.Fd,xd:D.xd};return P.postMessage(N,D.Ld),0},ee=0,se=(D,P,...N)=>{for(var K=2*N.length,J=Ot(),_e=_d(8*K),Ae=_e>>>3,Ne=0;Ne<N.length;Ne++){var Ge=N[Ne];typeof Ge=="bigint"?(I[Ae+2*Ne]=1n,I[Ae+2*Ne+1]=Ge):(I[Ae+2*Ne]=0n,we()[Ae+2*Ne+1>>>0]=Ge)}return D=$f(D,0,K,_e,P),kt(J),D};function ve(D){if(o)return se(0,1,D);if(w=D,!(0<ee)){for(var P of ze)q(P);for(P of Oe)q(P);Oe=[],ze=[],Be={},$=!0}f(0,new Ce(D))}function ke(D){if(o)return se(1,0,D);Re(D)}var Re=D=>{if(w=D,o)throw ke(D),"unwind";ve(D)},Oe=[],ze=[],Te=[],Be={},qe=D=>{var P=D.xd;delete Be[P],Oe.push(D),ze.splice(ze.indexOf(D),1),D.xd=0,Nf(P)};function tt(){Te.forEach(D=>D())}var xt=D=>new Promise(P=>{D.onmessage=J=>{var _e=(J=J.data).yd;if(J.Ed&&J.Ed!=hc()){var Ae=Be[J.Ed];Ae?Ae.postMessage(J,J.Ld):m(`Internal error! Worker sent a message "${_e}" to target pthread ${J.Ed}, but that thread no longer exists!`)}else _e==="checkMailbox"?Vn():_e==="spawnThread"?j(J):_e==="cleanupThread"?qe(Be[J.ee]):_e==="loaded"?(D.loaded=!0,P(D)):_e==="alert"?alert(`Thread ${J.fe}: ${J.text}`):J.target==="setimmediate"?D.postMessage(J):_e==="callHandler"?r[J.Nd](...J.args):_e&&m(`worker sent an unknown command ${_e}`)},D.onerror=J=>{throw m(`worker sent an error! ${J.filename}:${J.lineno}: ${J.message}`),J};var N,K=[];for(N of[])r.propertyIsEnumerable(N)&&K.push(N);D.postMessage({yd:"load",Od:K,he:v,ie:x})});function ft(){var D=new Worker((()=>{let P=URL;return import.meta.url>"file:"&&import.meta.url<"file;"?new P("ort.bundle.min.mjs",import.meta.url):new URL(import.meta.url)})(),{type:"module",workerData:"em-pthread",name:"em-pthread"});Oe.push(D)}var Wt=D=>{Fe();var P=ne()[D+52>>>2>>>0];D=ne()[D+56>>>2>>>0],jf(P,P-D),kt(P)},Jn=(D,P)=>{ee=0,D=mc(D,P),0<ee?w=D:pc(D)},rr=[];function yr(D){var P=new Me(D>>>=0);if(V()[P.wd+12>>>0]==0){var N=1;V()[P.wd+12>>>0]=N}return N=0,V()[P.wd+13>>>0]=N,rr.push(P),Vf(D),yd(D)}var ae=0,fe=()=>{It(0,0);var D=rr.pop();bd(D.Gd),ae=0};class Me{constructor(P){this.Gd=P,this.wd=P-24}}function Ie(D){throw ae||=D>>>0,ae}var it=D=>{var P=ae;if(!P)return Ko(0),0;var N=new Me(P);ne()[N.wd+16>>>2>>>0]=P;var K=ne()[N.wd+4>>>2>>>0];if(!K)return Ko(0),P;for(var J of D){if(J===0||J===K)break;if(Gf(J,K,N.wd+16))return Ko(J),P}return Ko(K),P};function Tt(){return it([])}function rn(D){return it([D>>>0])}function Un(D,P){return it([D>>>0,P>>>0])}var ur=()=>{var D=rr.pop();D||he("no exception to throw");var P=D.Gd;if(V()[D.wd+13>>>0]==0){rr.push(D);var N=1;V()[D.wd+13>>>0]=N,N=0,V()[D.wd+12>>>0]=N}throw ae=P};function vr(D,P,N){var K=new Me(D>>>=0);throw P>>>=0,N>>>=0,ne()[K.wd+16>>>2>>>0]=0,ne()[K.wd+4>>>2>>>0]=P,ne()[K.wd+8>>>2>>>0]=N,ae=D}function dr(D,P,N,K){return o?se(2,1,D,P,N,K):Dn(D,P,N,K)}function Dn(D,P,N,K){if(D>>>=0,N>>>=0,K>>>=0,l===void 0)return 6;var J=[];return o&&J.length===0?dr(D,P>>>=0,N,K):(D={ce:N,xd:D,Fd:K,Ld:J},o?(D.yd="spawnThread",postMessage(D,J),0):j(D))}var Ze=typeof TextDecoder<"u"?new TextDecoder:void 0,ct=(D,P=0,N=NaN)=>{var K=(P>>>=0)+N;for(N=P;D[N]&&!(N>=K);)++N;if(16<N-P&&D.buffer&&Ze)return Ze.decode(D.buffer instanceof ArrayBuffer?D.subarray(P,N):D.slice(P,N));for(K="";P<N;){var J=D[P++];if(128&J){var _e=63&D[P++];if((224&J)==192)K+=String.fromCharCode((31&J)<<6|_e);else{var Ae=63&D[P++];65536>(J=(240&J)==224?(15&J)<<12|_e<<6|Ae:(7&J)<<18|_e<<12|Ae<<6|63&D[P++])?K+=String.fromCharCode(J):(J-=65536,K+=String.fromCharCode(55296|J>>10,56320|1023&J))}}else K+=String.fromCharCode(J)}return K},rt=(D,P)=>(D>>>=0)?ct(Q(),D,P):"";function Mn(D,P,N){return o?se(3,1,D,P,N):0}function ki(D,P){if(o)return se(4,1,D,P)}var bn=D=>{for(var P=0,N=0;N<D.length;++N){var K=D.charCodeAt(N);127>=K?P++:2047>=K?P+=2:55296<=K&&57343>=K?(P+=4,++N):P+=3}return P},mi=(D,P,N)=>{var K=Q();if(P>>>=0,0<N){var J=P;N=P+N-1;for(var _e=0;_e<D.length;++_e){var Ae=D.charCodeAt(_e);if(55296<=Ae&&57343>=Ae&&(Ae=65536+((1023&Ae)<<10)|1023&D.charCodeAt(++_e)),127>=Ae){if(P>=N)break;K[P++>>>0]=Ae}else{if(2047>=Ae){if(P+1>=N)break;K[P++>>>0]=192|Ae>>6}else{if(65535>=Ae){if(P+2>=N)break;K[P++>>>0]=224|Ae>>12}else{if(P+3>=N)break;K[P++>>>0]=240|Ae>>18,K[P++>>>0]=128|Ae>>12&63}K[P++>>>0]=128|Ae>>6&63}K[P++>>>0]=128|63&Ae}}K[P>>>0]=0,D=P-J}else D=0;return D};function gi(D,P){if(o)return se(5,1,D,P)}function ms(D,P,N){if(o)return se(6,1,D,P,N)}function Lo(D,P,N){return o?se(7,1,D,P,N):0}function Ro(D,P){if(o)return se(8,1,D,P)}function gs(D,P,N){if(o)return se(9,1,D,P,N)}function ma(D,P,N,K){if(o)return se(10,1,D,P,N,K)}function Bo(D,P,N,K){if(o)return se(11,1,D,P,N,K)}function $o(D,P,N,K){if(o)return se(12,1,D,P,N,K)}function No(D){if(o)return se(13,1,D)}function zo(D,P){if(o)return se(14,1,D,P)}function Rs(D,P,N){if(o)return se(15,1,D,P,N)}var Wo,Fi,Jl=()=>he(""),Jr=D=>{for(var P="";Q()[D>>>0];)P+=Wo[Q()[D++>>>0]];return P},_s={},ga={};function _i(D,P,N={}){return function(K,J,_e={}){var Ae=J.name;if(!K)throw new Fi(`type "${Ae}" must have a positive integer typeid pointer`);if(ga.hasOwnProperty(K)){if(_e.Pd)return;throw new Fi(`Cannot register type '${Ae}' twice`)}ga[K]=J,_s.hasOwnProperty(K)&&(J=_s[K],delete _s[K],J.forEach(Ne=>Ne()))}(D,P,N)}var jo=(D,P,N)=>{switch(P){case 1:return N?K=>V()[K>>>0]:K=>Q()[K>>>0];case 2:return N?K=>R()[K>>>1>>>0]:K=>O()[K>>>1>>>0];case 4:return N?K=>L()[K>>>2>>>0]:K=>ne()[K>>>2>>>0];case 8:return N?K=>I[K>>>3]:K=>C[K>>>3];default:throw new TypeError(`invalid integer width (${P}): ${D}`)}};function ec(D,P,N){N>>>=0,_i(D>>>=0,{name:P=Jr(P>>>0),fromWireType:K=>K,toWireType:function(K,J){if(typeof J!="bigint"&&typeof J!="number")throw J=J===null?"null":(K=typeof J)=="object"||K==="array"||K==="function"?J.toString():""+J,new TypeError(`Cannot convert "${J}" to ${this.name}`);return typeof J=="number"&&(J=BigInt(J)),J},zd:kr,readValueFromPointer:jo(P,N,P.indexOf("u")==-1),Ad:null})}var kr=8;function tc(D,P,N,K){_i(D>>>=0,{name:P=Jr(P>>>0),fromWireType:function(J){return!!J},toWireType:function(J,_e){return _e?N:K},zd:kr,readValueFromPointer:function(J){return this.fromWireType(Q()[J>>>0])},Ad:null})}var za=[],bi=[];function Wa(D){9<(D>>>=0)&&--bi[D+1]==0&&(bi[D]=void 0,za.push(D))}var wr=D=>{if(!D)throw new Fi("Cannot use deleted val. handle = "+D);return bi[D]},ir=D=>{switch(D){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let P=za.pop()||bi.length;return bi[P]=D,bi[P+1]=1,P}};function ja(D){return this.fromWireType(ne()[D>>>2>>>0])}var nc={name:"emscripten::val",fromWireType:D=>{var P=wr(D);return Wa(D),P},toWireType:(D,P)=>ir(P),zd:kr,readValueFromPointer:ja,Ad:null};function rc(D){return _i(D>>>0,nc)}var ic=(D,P)=>{switch(P){case 4:return function(N){return this.fromWireType(de()[N>>>2>>>0])};case 8:return function(N){return this.fromWireType(we()[N>>>3>>>0])};default:throw new TypeError(`invalid float width (${P}): ${D}`)}};function _a(D,P,N){N>>>=0,_i(D>>>=0,{name:P=Jr(P>>>0),fromWireType:K=>K,toWireType:(K,J)=>J,zd:kr,readValueFromPointer:ic(P,N),Ad:null})}function sc(D,P,N,K,J){if(D>>>=0,N>>>=0,P=Jr(P>>>0),J===-1&&(J=4294967295),J=Ne=>Ne,K===0){var _e=32-8*N;J=Ne=>Ne<<_e>>>_e}var Ae=P.includes("unsigned")?function(Ne,Ge){return Ge>>>0}:function(Ne,Ge){return Ge};_i(D,{name:P,fromWireType:J,toWireType:Ae,zd:kr,readValueFromPointer:jo(P,N,K!==0),Ad:null})}function Le(D,P,N){function K(_e){var Ae=ne()[_e>>>2>>>0];return _e=ne()[_e+4>>>2>>>0],new J(V().buffer,_e,Ae)}var J=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][P];_i(D>>>=0,{name:N=Jr(N>>>0),fromWireType:K,zd:kr,readValueFromPointer:K},{Pd:!0})}function Y(D,P){_i(D>>>=0,{name:P=Jr(P>>>0),fromWireType:function(N){for(var K,J=ne()[N>>>2>>>0],_e=N+4,Ae=_e,Ne=0;Ne<=J;++Ne){var Ge=_e+Ne;Ne!=J&&Q()[Ge>>>0]!=0||(Ae=rt(Ae,Ge-Ae),K===void 0?K=Ae:(K+="\0",K+=Ae),Ae=Ge+1)}return Oi(N),K},toWireType:function(N,K){K instanceof ArrayBuffer&&(K=new Uint8Array(K));var J=typeof K=="string";if(!(J||K instanceof Uint8Array||K instanceof Uint8ClampedArray||K instanceof Int8Array))throw new Fi("Cannot pass non-string to std::string");var _e=J?bn(K):K.length,Ae=fc(4+_e+1),Ne=Ae+4;if(ne()[Ae>>>2>>>0]=_e,J)mi(K,Ne,_e+1);else if(J)for(J=0;J<_e;++J){var Ge=K.charCodeAt(J);if(255<Ge)throw Oi(Ae),new Fi("String has UTF-16 code units that do not fit in 8 bits");Q()[Ne+J>>>0]=Ge}else for(J=0;J<_e;++J)Q()[Ne+J>>>0]=K[J];return N!==null&&N.push(Oi,Ae),Ae},zd:kr,readValueFromPointer:ja,Ad(N){Oi(N)}})}var ye=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,De=(D,P)=>{for(var N=D>>1,K=N+P/2;!(N>=K)&&O()[N>>>0];)++N;if(32<(N<<=1)-D&&ye)return ye.decode(Q().slice(D,N));for(N="",K=0;!(K>=P/2);++K){var J=R()[D+2*K>>>1>>>0];if(J==0)break;N+=String.fromCharCode(J)}return N},Pe=(D,P,N)=>{if(N??=2147483647,2>N)return 0;var K=P;N=(N-=2)<2*D.length?N/2:D.length;for(var J=0;J<N;++J){var _e=D.charCodeAt(J);R()[P>>>1>>>0]=_e,P+=2}return R()[P>>>1>>>0]=0,P-K},We=D=>2*D.length,Ke=(D,P)=>{for(var N=0,K="";!(N>=P/4);){var J=L()[D+4*N>>>2>>>0];if(J==0)break;++N,65536<=J?(J-=65536,K+=String.fromCharCode(55296|J>>10,56320|1023&J)):K+=String.fromCharCode(J)}return K},ot=(D,P,N)=>{if(P>>>=0,N??=2147483647,4>N)return 0;var K=P;N=K+N-4;for(var J=0;J<D.length;++J){var _e=D.charCodeAt(J);if(55296<=_e&&57343>=_e&&(_e=65536+((1023&_e)<<10)|1023&D.charCodeAt(++J)),L()[P>>>2>>>0]=_e,(P+=4)+4>N)break}return L()[P>>>2>>>0]=0,P-K},lt=D=>{for(var P=0,N=0;N<D.length;++N){var K=D.charCodeAt(N);55296<=K&&57343>=K&&++N,P+=4}return P};function ut(D,P,N){if(D>>>=0,P>>>=0,N=Jr(N>>>=0),P===2)var K=De,J=Pe,_e=We,Ae=Ne=>O()[Ne>>>1>>>0];else P===4&&(K=Ke,J=ot,_e=lt,Ae=Ne=>ne()[Ne>>>2>>>0]);_i(D,{name:N,fromWireType:Ne=>{for(var Ge,et=ne()[Ne>>>2>>>0],dt=Ne+4,wt=0;wt<=et;++wt){var Rt=Ne+4+wt*P;wt!=et&&Ae(Rt)!=0||(dt=K(dt,Rt-dt),Ge===void 0?Ge=dt:(Ge+="\0",Ge+=dt),dt=Rt+P)}return Oi(Ne),Ge},toWireType:(Ne,Ge)=>{if(typeof Ge!="string")throw new Fi(`Cannot pass non-string to C++ string type ${N}`);var et=_e(Ge),dt=fc(4+et+P);return ne()[dt>>>2>>>0]=et/P,J(Ge,dt+4,et+P),Ne!==null&&Ne.push(Oi,dt),dt},zd:kr,readValueFromPointer:ja,Ad(Ne){Oi(Ne)}})}function st(D,P){_i(D>>>=0,{Qd:!0,name:P=Jr(P>>>0),zd:0,fromWireType:()=>{},toWireType:()=>{}})}function Ht(D){md(D>>>0,!a,1,!s,131072,!1),tt()}var Lt=D=>{if(!$)try{if(D(),!(0<ee))try{o?pc(w):Re(w)}catch(P){P instanceof Ce||P=="unwind"||f(0,P)}}catch(P){P instanceof Ce||P=="unwind"||f(0,P)}};function An(D){D>>>=0,typeof Atomics.ge=="function"&&(Atomics.ge(L(),D>>>2,D).value.then(Vn),D+=128,Atomics.store(L(),D>>>2,1))}var Vn=()=>{var D=hc();D&&(An(D),Lt(Wf))};function Bn(D,P){(D>>>=0)==P>>>0?setTimeout(Vn):o?postMessage({Ed:D,yd:"checkMailbox"}):(D=Be[D])&&D.postMessage({yd:"checkMailbox"})}var Gn=[];function hr(D,P,N,K,J){for(P>>>=0,K/=2,Gn.length=K,N=J>>>0>>>3,J=0;J<K;J++)Gn[J]=I[N+2*J]?I[N+2*J+1]:we()[N+2*J+1>>>0];return(P?ie[P]:eb[D])(...Gn)}var qi=()=>{ee=0};function Va(D){D>>>=0,o?postMessage({yd:"cleanupThread",ee:D}):qe(Be[D])}function Wr(D){}var Ii=(D,P)=>{var N=ga[D];if(N===void 0)throw D=pd(D),N=Jr(D),Oi(D),new Fi(`${P} has unknown type ${N}`);return N},Cn=(D,P,N)=>{var K=[];return D=D.toWireType(K,N),K.length&&(ne()[P>>>2>>>0]=ir(K)),D};function fr(D,P,N){return P>>>=0,N>>>=0,D=wr(D>>>0),P=Ii(P,"emval::as"),Cn(P,N,D)}function jr(D,P){return P>>>=0,D=wr(D>>>0),(P=Ii(P,"emval::as")).toWireType(null,D)}var yi=D=>{try{D()}catch(P){he(P)}},Fr=0,hn=null,Hi=0,qn=[],$n={},Hn={},er=0,sr=null,Vo=[];function ac(D){return function(P){if(!$){if(Fr===0){var N=!1,K=!1;P((J=0)=>{if(!$&&(Hi=J,N=!0,K)){Fr=2,yi(()=>Dp(hn)),typeof MainLoop<"u"&&MainLoop.Md&&MainLoop.resume(),J=!1;try{var _e=function(){var Ge=L()[hn+8>>>2>>>0];return Ge=Qe[Hn[Ge]],--ee,Ge()}()}catch(Ge){_e=Ge,J=!0}var Ae=!1;if(!hn){var Ne=sr;Ne&&(sr=null,(J?Ne.reject:Ne.resolve)(_e),Ae=!0)}if(J&&!Ae)throw _e}}),K=!0,N||(Fr=1,hn=function(){var J=fc(65548),_e=J+12;ne()[J>>>2>>>0]=_e,ne()[J+4>>>2>>>0]=_e+65536,_e=qn[0];var Ae=$n[_e];return Ae===void 0&&(Ae=er++,$n[_e]=Ae,Hn[Ae]=_e),_e=Ae,L()[J+8>>>2>>>0]=_e,J}(),typeof MainLoop<"u"&&MainLoop.Md&&MainLoop.pause(),yi(()=>Tp(hn)))}else Fr===2?(Fr=0,yi(Id),Oi(hn),hn=null,Vo.forEach(Lt)):he(`invalid state: ${Fr}`);return Hi}}(P=>{D().then(P)})}function A_(D){return D>>>=0,ac(async()=>{var P=await wr(D);return ir(P)})}var oc=[];function C_(D,P,N,K){return N>>>=0,K>>>=0,(D=oc[D>>>0])(null,P=wr(P>>>0),N,K)}var Go={},lc=D=>{var P=Go[D];return P===void 0?Jr(D):P};function S_(D,P,N,K,J){return N>>>=0,K>>>=0,J>>>=0,(D=oc[D>>>0])(P=wr(P>>>0),P[N=lc(N)],K,J)}var wf=()=>typeof globalThis=="object"?globalThis:Function("return this")();function P_(D){return(D>>>=0)==0?ir(wf()):(D=lc(D),ir(wf()[D]))}var k_=D=>{var P=oc.length;return oc.push(D),P},xf=(D,P)=>{for(var N=Array(D),K=0;K<D;++K)N[K]=Ii(ne()[P+4*K>>>2>>>0],"parameter "+K);return N},Tf=(D,P)=>Object.defineProperty(P,"name",{value:D});function F_(D,P,N){var K=(P=xf(D,P>>>0)).shift();D--;var J=`return function (obj, func, destructorsRef, args) {
`,_e=0,Ae=[];N===0&&Ae.push("obj");for(var Ne=["retType"],Ge=[K],et=0;et<D;++et)Ae.push("arg"+et),Ne.push("argType"+et),Ge.push(P[et]),J+=`  var arg${et} = argType${et}.readValueFromPointer(args${_e?"+"+_e:""});
`,_e+=P[et].zd;return J+=`  var rv = ${N===1?"new func":"func.call"}(${Ae.join(", ")});
`,K.Qd||(Ne.push("emval_returnValue"),Ge.push(Cn),J+=`  return emval_returnValue(retType, destructorsRef, rv);
`),Ne.push(J+`};
`),D=function(dt){var wt=Function;if(!(wt instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof wt} which is not a function`);var Rt=Tf(wt.name||"unknownFunctionName",function(){});return Rt.prototype=wt.prototype,Rt=new Rt,(dt=wt.apply(Rt,dt))instanceof Object?dt:Rt}(Ne)(...Ge),N=`methodCaller<(${P.map(dt=>dt.name).join(", ")}) => ${K.name}>`,k_(Tf(N,D))}function Ef(D){return D=lc(D>>>0),ir(r[D])}function I_(D,P){return P>>>=0,D=wr(D>>>0),P=wr(P),ir(D[P])}function Df(D){9<(D>>>=0)&&(bi[D+1]+=1)}function O_(){return ir([])}function Mf(D){D=wr(D>>>0);for(var P=Array(D.length),N=0;N<D.length;N++)P[N]=D[N];return ir(P)}function Jv(D){return ir(lc(D>>>0))}function U_(){return ir({})}function Af(D){for(var P=wr(D>>>=0);P.length;){var N=P.pop();P.pop()(N)}Wa(D)}function L_(D,P,N){P>>>=0,N>>>=0,D=wr(D>>>0),P=wr(P),N=wr(N),D[P]=N}function sd(D,P){return P>>>=0,D=(D=Ii(D>>>0,"_emval_take_value")).readValueFromPointer(P),ir(D)}function R_(D,P){D=-9007199254740992>D||9007199254740992<D?NaN:Number(D),P>>>=0,D=new Date(1e3*D),L()[P>>>2>>>0]=D.getUTCSeconds(),L()[P+4>>>2>>>0]=D.getUTCMinutes(),L()[P+8>>>2>>>0]=D.getUTCHours(),L()[P+12>>>2>>>0]=D.getUTCDate(),L()[P+16>>>2>>>0]=D.getUTCMonth(),L()[P+20>>>2>>>0]=D.getUTCFullYear()-1900,L()[P+24>>>2>>>0]=D.getUTCDay(),D=(D.getTime()-Date.UTC(D.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,L()[P+28>>>2>>>0]=D}var Cf=D=>D%4==0&&(D%100!=0||D%400==0),Sf=[0,31,60,91,121,152,182,213,244,274,305,335],Pf=[0,31,59,90,120,151,181,212,243,273,304,334];function B_(D,P){D=-9007199254740992>D||9007199254740992<D?NaN:Number(D),P>>>=0,D=new Date(1e3*D),L()[P>>>2>>>0]=D.getSeconds(),L()[P+4>>>2>>>0]=D.getMinutes(),L()[P+8>>>2>>>0]=D.getHours(),L()[P+12>>>2>>>0]=D.getDate(),L()[P+16>>>2>>>0]=D.getMonth(),L()[P+20>>>2>>>0]=D.getFullYear()-1900,L()[P+24>>>2>>>0]=D.getDay();var N=(Cf(D.getFullYear())?Sf:Pf)[D.getMonth()]+D.getDate()-1|0;L()[P+28>>>2>>>0]=N,L()[P+36>>>2>>>0]=-60*D.getTimezoneOffset(),N=new Date(D.getFullYear(),6,1).getTimezoneOffset();var K=new Date(D.getFullYear(),0,1).getTimezoneOffset();D=0|(N!=K&&D.getTimezoneOffset()==Math.min(K,N)),L()[P+32>>>2>>>0]=D}function $_(D){D>>>=0;var P=new Date(L()[D+20>>>2>>>0]+1900,L()[D+16>>>2>>>0],L()[D+12>>>2>>>0],L()[D+8>>>2>>>0],L()[D+4>>>2>>>0],L()[D>>>2>>>0],0),N=L()[D+32>>>2>>>0],K=P.getTimezoneOffset(),J=new Date(P.getFullYear(),6,1).getTimezoneOffset(),_e=new Date(P.getFullYear(),0,1).getTimezoneOffset(),Ae=Math.min(_e,J);return 0>N?L()[D+32>>>2>>>0]=+(J!=_e&&Ae==K):0<N!=(Ae==K)&&(J=Math.max(_e,J),P.setTime(P.getTime()+6e4*((0<N?Ae:J)-K))),L()[D+24>>>2>>>0]=P.getDay(),N=(Cf(P.getFullYear())?Sf:Pf)[P.getMonth()]+P.getDate()-1|0,L()[D+28>>>2>>>0]=N,L()[D>>>2>>>0]=P.getSeconds(),L()[D+4>>>2>>>0]=P.getMinutes(),L()[D+8>>>2>>>0]=P.getHours(),L()[D+12>>>2>>>0]=P.getDate(),L()[D+16>>>2>>>0]=P.getMonth(),L()[D+20>>>2>>>0]=P.getYear(),D=P.getTime(),BigInt(isNaN(D)?-1:D/1e3)}function kf(D,P,N,K,J,_e,Ae){return o?se(16,1,D,P,N,K,J,_e,Ae):-52}function cc(D,P,N,K,J,_e){if(o)return se(17,1,D,P,N,K,J,_e)}var Ga={},N_=()=>performance.timeOrigin+performance.now();function ad(D,P){if(o)return se(18,1,D,P);if(Ga[D]&&(clearTimeout(Ga[D].id),delete Ga[D]),!P)return 0;var N=setTimeout(()=>{delete Ga[D],Lt(()=>zf(D,performance.timeOrigin+performance.now()))},P);return Ga[D]={id:N,ke:P},0}function qa(D,P,N,K){D>>>=0,P>>>=0,N>>>=0,K>>>=0;var J=new Date().getFullYear(),_e=new Date(J,0,1).getTimezoneOffset();J=new Date(J,6,1).getTimezoneOffset();var Ae=Math.max(_e,J);ne()[D>>>2>>>0]=60*Ae,L()[P>>>2>>>0]=+(_e!=J),D=(P=Ne=>{var Ge=Math.abs(Ne);return`UTC${0<=Ne?"-":"+"}${String(Math.floor(Ge/60)).padStart(2,"0")}${String(Ge%60).padStart(2,"0")}`})(_e),P=P(J),J<_e?(mi(D,N,17),mi(P,K,17)):(mi(D,K,17),mi(P,N,17))}var z_=()=>Date.now();function e1(D,P,N){return 0<=D&&3>=D?(D===0?D=Date.now():D=performance.timeOrigin+performance.now(),I[N>>>0>>>3]=BigInt(Math.round(1e6*D)),0):28}var od=[],W_=(D,P)=>{od.length=0;for(var N;N=Q()[D++>>>0];){var K=N!=105;P+=(K&=N!=112)&&P%8?4:0,od.push(N==112?ne()[P>>>2>>>0]:N==106?I[P>>>3]:N==105?L()[P>>>2>>>0]:we()[P>>>3>>>0]),P+=K?8:4}return od};function j_(D,P,N){return D>>>=0,P=W_(P>>>0,N>>>0),ie[D](...P)}function Ff(D,P,N){return D>>>=0,P=W_(P>>>0,N>>>0),ie[D](...P)}var V_=()=>{};function G_(D,P){return m(rt(D>>>0,P>>>0))}var q_=()=>{throw ee+=1,"unwind"};function H_(){return 4294901760}var K_=()=>navigator.hardwareConcurrency;function ld(){return he("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function X_(D){D>>>=0;var P=Q().length;if(D<=P||4294901760<D)return!1;for(var N=1;4>=N;N*=2){var K=P*(1+.2/N);K=Math.min(K,D+100663296);e:{K=(Math.min(4294901760,65536*Math.ceil(Math.max(D,K)/65536))-v.buffer.byteLength+65535)/65536|0;try{v.grow(K),Fe();var J=1;break e}catch{}J=void 0}if(J)return!0}return!1}var uc=()=>(he("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),qo={},cd=D=>{D.forEach(P=>{uc()})};function Y_(){var D=Error().stack.toString().split(`
`);return D[0]=="Error"&&D.shift(),cd(D),qo.Kd=uc(),qo.ae=D,qo.Kd}function Q_(D,P,N){if(D>>>=0,P>>>=0,qo.Kd==D)var K=qo.ae;else(K=Error().stack.toString().split(`
`))[0]=="Error"&&K.shift(),cd(K);for(var J=3;K[J]&&uc()!=D;)++J;for(D=0;D<N&&K[D+J];++D)L()[P+4*D>>>2>>>0]=uc();return D}var dc,ud={},If=()=>{if(!dc){var D,P={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(D in ud)ud[D]===void 0?delete P[D]:P[D]=ud[D];var N=[];for(D in P)N.push(`${D}=${P[D]}`);dc=N}return dc};function dd(D,P){if(o)return se(19,1,D,P);D>>>=0,P>>>=0;var N=0;return If().forEach((K,J)=>{var _e=P+N;for(J=ne()[D+4*J>>>2>>>0]=_e,_e=0;_e<K.length;++_e)V()[J++>>>0]=K.charCodeAt(_e);V()[J>>>0]=0,N+=K.length+1}),0}function Of(D,P){if(o)return se(20,1,D,P);D>>>=0,P>>>=0;var N=If();ne()[D>>>2>>>0]=N.length;var K=0;return N.forEach(J=>K+=J.length+1),ne()[P>>>2>>>0]=K,0}function Uf(D){return o?se(21,1,D):52}function hd(D,P,N,K){return o?se(22,1,D,P,N,K):52}function Lf(D,P,N,K){return o?se(23,1,D,P,N,K):70}var Z_=[null,[],[]];function fd(D,P,N,K){if(o)return se(24,1,D,P,N,K);P>>>=0,N>>>=0,K>>>=0;for(var J=0,_e=0;_e<N;_e++){var Ae=ne()[P>>>2>>>0],Ne=ne()[P+4>>>2>>>0];P+=8;for(var Ge=0;Ge<Ne;Ge++){var et=Q()[Ae+Ge>>>0],dt=Z_[D];et===0||et===10?((D===1?_:m)(ct(dt)),dt.length=0):dt.push(et)}J+=Ne}return ne()[K>>>2>>>0]=J,0}function J_(D){return D>>>0}o||function(){for(var D=r.numThreads-1;D--;)ft();te.unshift(()=>{ue++,function(P){o?P():Promise.all(Oe.map(xt)).then(P)}(()=>U())})}();for(var Rf=Array(256),Ho=0;256>Ho;++Ho)Rf[Ho]=String.fromCharCode(Ho);Wo=Rf,Fi=r.BindingError=class extends Error{constructor(D){super(D),this.name="BindingError"}},r.InternalError=class extends Error{constructor(D){super(D),this.name="InternalError"}},bi.push(0,1,void 0,1,null,1,!0,1,!1,1),r.count_emval_handles=()=>bi.length/2-5-za.length;var Qe,eb=[ve,ke,dr,Mn,ki,gi,ms,Lo,Ro,gs,ma,Bo,$o,No,zo,Rs,kf,cc,ad,dd,Of,Uf,hd,Lf,fd];(async function(){function D(K,J){return Qe=K.exports,Qe=function(){var _e=Qe,Ae={};for(let[Ne,Ge]of Object.entries(_e))Ae[Ne]=typeof Ge=="function"?(...et)=>{qn.push(Ne);try{return Ge(...et)}finally{$||(qn.pop(),hn&&Fr===1&&qn.length===0&&(Fr=0,ee+=1,yi(Ep),typeof Fibers<"u"&&Fibers.le()))}}:Ge;return Ae}(),Qe=function(){var _e=Qe,Ae=Ge=>et=>Ge(et)>>>0,Ne=Ge=>()=>Ge()>>>0;return(_e=Object.assign({},_e)).Cb=Ae(_e.Cb),_e.fc=Ne(_e.fc),_e.ic=Ae(_e.ic),_e.vc=Ae(_e.vc),_e.wc=Ne(_e.wc),_e.Ac=Ae(_e.Ac),_e}(),Te.push(Qe.jc),x=J,U(),Qe}ue++;var P=pe();if(r.instantiateWasm)return new Promise(K=>{r.instantiateWasm(P,(J,_e)=>{D(J,_e),K(J.exports)})});if(o)return new Promise(K=>{be=J=>{var _e=new WebAssembly.Instance(J,pe());K(D(_e,J))}});ce??=r.locateFile?r.locateFile?r.locateFile("ort-wasm-simd-threaded.jsep.wasm",p):p+"ort-wasm-simd-threaded.jsep.wasm":new URL(""+new URL("ort-wasm-simd-threaded.jsep-BAR87mbD.wasm",import.meta.url).href,import.meta.url).href;try{var N=await async function(K){var J=ce;if(!B&&typeof WebAssembly.instantiateStreaming=="function"&&!X(J))try{var _e=fetch(J,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(_e,K)}catch(Ae){m(`wasm streaming compile failed: ${Ae}`),m("falling back to ArrayBuffer instantiation")}return async function(Ae,Ne){try{var Ge=await async function(et){if(!B)try{var dt=await u(et);return new Uint8Array(dt)}catch{}if(et==ce&&B)et=new Uint8Array(B);else{if(!d)throw"both async and sync fetching of the wasm failed";et=d(et)}return et}(Ae);return await WebAssembly.instantiate(Ge,Ne)}catch(et){m(`failed to asynchronously prepare wasm: ${et}`),he(et)}}(J,K)}(P);return D(N.instance,N.module)}catch(K){return t(K),Promise.reject(K)}})();var pd=D=>(pd=Qe.Cb)(D),Bf=()=>(Bf=Qe.Db)();r._OrtInit=(D,P)=>(r._OrtInit=Qe.Eb)(D,P),r._OrtGetLastError=(D,P)=>(r._OrtGetLastError=Qe.Fb)(D,P),r._OrtCreateSessionOptions=(D,P,N,K,J,_e,Ae,Ne,Ge,et)=>(r._OrtCreateSessionOptions=Qe.Gb)(D,P,N,K,J,_e,Ae,Ne,Ge,et),r._OrtAppendExecutionProvider=(D,P)=>(r._OrtAppendExecutionProvider=Qe.Hb)(D,P),r._OrtAddFreeDimensionOverride=(D,P,N)=>(r._OrtAddFreeDimensionOverride=Qe.Ib)(D,P,N),r._OrtAddSessionConfigEntry=(D,P,N)=>(r._OrtAddSessionConfigEntry=Qe.Jb)(D,P,N),r._OrtReleaseSessionOptions=D=>(r._OrtReleaseSessionOptions=Qe.Kb)(D),r._OrtCreateSession=(D,P,N)=>(r._OrtCreateSession=Qe.Lb)(D,P,N),r._OrtReleaseSession=D=>(r._OrtReleaseSession=Qe.Mb)(D),r._OrtGetInputOutputCount=(D,P,N)=>(r._OrtGetInputOutputCount=Qe.Nb)(D,P,N),r._OrtGetInputName=(D,P)=>(r._OrtGetInputName=Qe.Ob)(D,P),r._OrtGetOutputName=(D,P)=>(r._OrtGetOutputName=Qe.Pb)(D,P),r._OrtFree=D=>(r._OrtFree=Qe.Qb)(D),r._OrtCreateTensor=(D,P,N,K,J,_e)=>(r._OrtCreateTensor=Qe.Rb)(D,P,N,K,J,_e),r._OrtGetTensorData=(D,P,N,K,J)=>(r._OrtGetTensorData=Qe.Sb)(D,P,N,K,J),r._OrtReleaseTensor=D=>(r._OrtReleaseTensor=Qe.Tb)(D),r._OrtCreateRunOptions=(D,P,N,K)=>(r._OrtCreateRunOptions=Qe.Ub)(D,P,N,K),r._OrtAddRunConfigEntry=(D,P,N)=>(r._OrtAddRunConfigEntry=Qe.Vb)(D,P,N),r._OrtReleaseRunOptions=D=>(r._OrtReleaseRunOptions=Qe.Wb)(D),r._OrtCreateBinding=D=>(r._OrtCreateBinding=Qe.Xb)(D),r._OrtBindInput=(D,P,N)=>(r._OrtBindInput=Qe.Yb)(D,P,N),r._OrtBindOutput=(D,P,N,K)=>(r._OrtBindOutput=Qe.Zb)(D,P,N,K),r._OrtClearBoundOutputs=D=>(r._OrtClearBoundOutputs=Qe._b)(D),r._OrtReleaseBinding=D=>(r._OrtReleaseBinding=Qe.$b)(D),r._OrtRunWithBinding=(D,P,N,K,J)=>(r._OrtRunWithBinding=Qe.ac)(D,P,N,K,J),r._OrtRun=(D,P,N,K,J,_e,Ae,Ne)=>(r._OrtRun=Qe.bc)(D,P,N,K,J,_e,Ae,Ne),r._OrtEndProfiling=D=>(r._OrtEndProfiling=Qe.cc)(D),r._JsepOutput=(D,P,N)=>(r._JsepOutput=Qe.dc)(D,P,N),r._JsepGetNodeName=D=>(r._JsepGetNodeName=Qe.ec)(D);var hc=()=>(hc=Qe.fc)(),Oi=r._free=D=>(Oi=r._free=Qe.gc)(D),fc=r._malloc=D=>(fc=r._malloc=Qe.ic)(D),md=(D,P,N,K,J,_e)=>(md=Qe.kc)(D,P,N,K,J,_e),gd=()=>(gd=Qe.lc)(),$f=(D,P,N,K,J)=>($f=Qe.mc)(D,P,N,K,J),Nf=D=>(Nf=Qe.nc)(D),pc=D=>(pc=Qe.oc)(D),zf=(D,P)=>(zf=Qe.pc)(D,P),Wf=()=>(Wf=Qe.qc)(),It=(D,P)=>(It=Qe.rc)(D,P),Ko=D=>(Ko=Qe.sc)(D),jf=(D,P)=>(jf=Qe.tc)(D,P),kt=D=>(kt=Qe.uc)(D),_d=D=>(_d=Qe.vc)(D),Ot=()=>(Ot=Qe.wc)(),bd=D=>(bd=Qe.xc)(D),Vf=D=>(Vf=Qe.yc)(D),Gf=(D,P,N)=>(Gf=Qe.zc)(D,P,N),yd=D=>(yd=Qe.Ac)(D),qf=r.dynCall_iii=(D,P,N)=>(qf=r.dynCall_iii=Qe.Bc)(D,P,N),Hf=r.dynCall_vi=(D,P)=>(Hf=r.dynCall_vi=Qe.Cc)(D,P),mc=r.dynCall_ii=(D,P)=>(mc=r.dynCall_ii=Qe.Dc)(D,P),Kf=r.dynCall_vii=(D,P,N)=>(Kf=r.dynCall_vii=Qe.Ec)(D,P,N),Xf=r.dynCall_iiii=(D,P,N,K)=>(Xf=r.dynCall_iiii=Qe.Fc)(D,P,N,K),vd=r.dynCall_viii=(D,P,N,K)=>(vd=r.dynCall_viii=Qe.Gc)(D,P,N,K),Yf=r.dynCall_iiiii=(D,P,N,K,J)=>(Yf=r.dynCall_iiiii=Qe.Hc)(D,P,N,K,J),Qf=r.dynCall_viiii=(D,P,N,K,J)=>(Qf=r.dynCall_viiii=Qe.Ic)(D,P,N,K,J),wd=r.dynCall_viiiiii=(D,P,N,K,J,_e,Ae)=>(wd=r.dynCall_viiiiii=Qe.Jc)(D,P,N,K,J,_e,Ae),Zf=r.dynCall_viiiiiii=(D,P,N,K,J,_e,Ae,Ne)=>(Zf=r.dynCall_viiiiiii=Qe.Kc)(D,P,N,K,J,_e,Ae,Ne),Jf=r.dynCall_ji=(D,P)=>(Jf=r.dynCall_ji=Qe.Lc)(D,P),xd=r.dynCall_v=D=>(xd=r.dynCall_v=Qe.Mc)(D),ep=r.dynCall_viiiii=(D,P,N,K,J,_e)=>(ep=r.dynCall_viiiii=Qe.Nc)(D,P,N,K,J,_e),tp=r.dynCall_i=D=>(tp=r.dynCall_i=Qe.Oc)(D),Td=r.dynCall_fii=(D,P,N)=>(Td=r.dynCall_fii=Qe.Pc)(D,P,N),np=r.dynCall_viiiiiiii=(D,P,N,K,J,_e,Ae,Ne,Ge)=>(np=r.dynCall_viiiiiiii=Qe.Qc)(D,P,N,K,J,_e,Ae,Ne,Ge),rp=r.dynCall_viiiiiiiiii=(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt)=>(rp=r.dynCall_viiiiiiiiii=Qe.Rc)(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt),Ed=r.dynCall_jiii=(D,P,N,K)=>(Ed=r.dynCall_jiii=Qe.Sc)(D,P,N,K),ip=r.dynCall_dii=(D,P,N)=>(ip=r.dynCall_dii=Qe.Tc)(D,P,N),sp=r.dynCall_viiiiiiiii=(D,P,N,K,J,_e,Ae,Ne,Ge,et)=>(sp=r.dynCall_viiiiiiiii=Qe.Uc)(D,P,N,K,J,_e,Ae,Ne,Ge,et),Dd=r.dynCall_viiiiiiiiiii=(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt)=>(Dd=r.dynCall_viiiiiiiiiii=Qe.Vc)(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt),ap=r.dynCall_iiiiii=(D,P,N,K,J,_e)=>(ap=r.dynCall_iiiiii=Qe.Wc)(D,P,N,K,J,_e),op=r.dynCall_iij=(D,P,N)=>(op=r.dynCall_iij=Qe.Xc)(D,P,N),lp=r.dynCall_iiiiiiiiii=(D,P,N,K,J,_e,Ae,Ne,Ge,et)=>(lp=r.dynCall_iiiiiiiiii=Qe.Yc)(D,P,N,K,J,_e,Ae,Ne,Ge,et),cp=r.dynCall_iiiiiiiiiii=(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt)=>(cp=r.dynCall_iiiiiiiiiii=Qe.Zc)(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt),Md=r.dynCall_vij=(D,P,N)=>(Md=r.dynCall_vij=Qe._c)(D,P,N),up=r.dynCall_iiif=(D,P,N,K)=>(up=r.dynCall_iiif=Qe.$c)(D,P,N,K),dp=r.dynCall_iiij=(D,P,N,K)=>(dp=r.dynCall_iiij=Qe.ad)(D,P,N,K),Ad=r.dynCall_fiii=(D,P,N,K)=>(Ad=r.dynCall_fiii=Qe.bd)(D,P,N,K),hp=r.dynCall_viiiiiiiiiiiii=(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn)=>(hp=r.dynCall_viiiiiiiiiiiii=Qe.cd)(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn),fp=r.dynCall_vjiii=(D,P,N,K,J)=>(fp=r.dynCall_vjiii=Qe.dd)(D,P,N,K,J),Cd=r.dynCall_vif=(D,P,N)=>(Cd=r.dynCall_vif=Qe.ed)(D,P,N),pp=r.dynCall_iiiiiii=(D,P,N,K,J,_e,Ae)=>(pp=r.dynCall_iiiiiii=Qe.fd)(D,P,N,K,J,_e,Ae),mp=r.dynCall_iiiij=(D,P,N,K,J)=>(mp=r.dynCall_iiiij=Qe.gd)(D,P,N,K,J),Sd=r.dynCall_iiiiiiii=(D,P,N,K,J,_e,Ae,Ne)=>(Sd=r.dynCall_iiiiiiii=Qe.hd)(D,P,N,K,J,_e,Ae,Ne),gp=r.dynCall_viiiiiiiiiiii=(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt)=>(gp=r.dynCall_viiiiiiiiiiii=Qe.id)(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt),_p=r.dynCall_diii=(D,P,N,K)=>(_p=r.dynCall_diii=Qe.jd)(D,P,N,K),Pd=r.dynCall_jiiii=(D,P,N,K,J)=>(Pd=r.dynCall_jiiii=Qe.kd)(D,P,N,K,J),bp=r.dynCall_viiij=(D,P,N,K,J)=>(bp=r.dynCall_viiij=Qe.ld)(D,P,N,K,J),yp=r.dynCall_fiiii=(D,P,N,K,J)=>(yp=r.dynCall_fiiii=Qe.md)(D,P,N,K,J),kd=r.dynCall_viiif=(D,P,N,K,J)=>(kd=r.dynCall_viiif=Qe.nd)(D,P,N,K,J),vp=r.dynCall_diiii=(D,P,N,K,J)=>(vp=r.dynCall_diiii=Qe.od)(D,P,N,K,J),wp=r.dynCall_viiid=(D,P,N,K,J)=>(wp=r.dynCall_viiid=Qe.pd)(D,P,N,K,J),Fd=r.dynCall_iiiijii=(D,P,N,K,J,_e,Ae)=>(Fd=r.dynCall_iiiijii=Qe.qd)(D,P,N,K,J,_e,Ae),xp=r.dynCall_iiiiiij=(D,P,N,K,J,_e,Ae)=>(xp=r.dynCall_iiiiiij=Qe.rd)(D,P,N,K,J,_e,Ae),Tp=D=>(Tp=Qe.sd)(D),Ep=()=>(Ep=Qe.td)(),Dp=D=>(Dp=Qe.ud)(D),Id=()=>(Id=Qe.vd)();function tb(D,P,N){var K=Ot();try{Kf(D,P,N)}catch(J){if(kt(K),J!==J+0)throw J;It(1,0)}}function nb(D,P,N){var K=Ot();try{return qf(D,P,N)}catch(J){if(kt(K),J!==J+0)throw J;It(1,0)}}function rb(D,P){var N=Ot();try{Hf(D,P)}catch(K){if(kt(N),K!==K+0)throw K;It(1,0)}}function ib(D,P){var N=Ot();try{return mc(D,P)}catch(K){if(kt(N),K!==K+0)throw K;It(1,0)}}function Mp(D,P,N,K){var J=Ot();try{return Xf(D,P,N,K)}catch(_e){if(kt(J),_e!==_e+0)throw _e;It(1,0)}}function sb(D,P,N,K,J){var _e=Ot();try{Qf(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;It(1,0)}}function ab(D,P,N,K,J){var _e=Ot();try{return Yf(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;It(1,0)}}function ob(D,P,N,K){var J=Ot();try{vd(D,P,N,K)}catch(_e){if(kt(J),_e!==_e+0)throw _e;It(1,0)}}function lb(D,P,N,K,J,_e,Ae){var Ne=Ot();try{return pp(D,P,N,K,J,_e,Ae)}catch(Ge){if(kt(Ne),Ge!==Ge+0)throw Ge;It(1,0)}}function Ap(D){var P=Ot();try{xd(D)}catch(N){if(kt(P),N!==N+0)throw N;It(1,0)}}function cb(D,P,N){var K=Ot();try{return op(D,P,N)}catch(J){if(kt(K),J!==J+0)throw J;It(1,0)}}function ub(D,P,N,K,J,_e){var Ae=Ot();try{ep(D,P,N,K,J,_e)}catch(Ne){if(kt(Ae),Ne!==Ne+0)throw Ne;It(1,0)}}function db(D,P,N){var K=Ot();try{Md(D,P,N)}catch(J){if(kt(K),J!==J+0)throw J;It(1,0)}}function hb(D,P,N,K,J,_e,Ae){var Ne=Ot();try{wd(D,P,N,K,J,_e,Ae)}catch(Ge){if(kt(Ne),Ge!==Ge+0)throw Ge;It(1,0)}}function Cp(D,P,N,K,J,_e,Ae,Ne){var Ge=Ot();try{Zf(D,P,N,K,J,_e,Ae,Ne)}catch(et){if(kt(Ge),et!==et+0)throw et;It(1,0)}}function fb(D,P,N,K,J,_e){var Ae=Ot();try{return ap(D,P,N,K,J,_e)}catch(Ne){if(kt(Ae),Ne!==Ne+0)throw Ne;It(1,0)}}function pb(D,P,N,K,J,_e,Ae,Ne){var Ge=Ot();try{return Sd(D,P,N,K,J,_e,Ae,Ne)}catch(et){if(kt(Ge),et!==et+0)throw et;It(1,0)}}function Sp(D,P,N,K,J,_e,Ae,Ne,Ge,et){var dt=Ot();try{sp(D,P,N,K,J,_e,Ae,Ne,Ge,et)}catch(wt){if(kt(dt),wt!==wt+0)throw wt;It(1,0)}}function mb(D,P,N,K,J,_e,Ae,Ne,Ge){var et=Ot();try{np(D,P,N,K,J,_e,Ae,Ne,Ge)}catch(dt){if(kt(et),dt!==dt+0)throw dt;It(1,0)}}function gb(D){var P=Ot();try{return tp(D)}catch(N){if(kt(P),N!==N+0)throw N;It(1,0)}}function Pp(D,P,N,K,J,_e,Ae,Ne,Ge,et){var dt=Ot();try{return lp(D,P,N,K,J,_e,Ae,Ne,Ge,et)}catch(wt){if(kt(dt),wt!==wt+0)throw wt;It(1,0)}}function _b(D,P,N){var K=Ot();try{return Td(D,P,N)}catch(J){if(kt(K),J!==J+0)throw J;It(1,0)}}function bb(D,P,N,K){var J=Ot();try{return Ed(D,P,N,K)}catch(_e){if(kt(J),_e!==_e+0)throw _e;return It(1,0),0n}}function kp(D,P,N){var K=Ot();try{return ip(D,P,N)}catch(J){if(kt(K),J!==J+0)throw J;It(1,0)}}function yb(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt){var Rt=Ot();try{Dd(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt)}catch(mn){if(kt(Rt),mn!==mn+0)throw mn;It(1,0)}}function vb(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt){var wt=Ot();try{rp(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt)}catch(Rt){if(kt(wt),Rt!==Rt+0)throw Rt;It(1,0)}}function Fp(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt){var wt=Ot();try{return cp(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt)}catch(Rt){if(kt(wt),Rt!==Rt+0)throw Rt;It(1,0)}}function wb(D,P,N,K){var J=Ot();try{return up(D,P,N,K)}catch(_e){if(kt(J),_e!==_e+0)throw _e;It(1,0)}}function xb(D,P,N,K){var J=Ot();try{return dp(D,P,N,K)}catch(_e){if(kt(J),_e!==_e+0)throw _e;It(1,0)}}function Od(D,P,N,K){var J=Ot();try{return Ad(D,P,N,K)}catch(_e){if(kt(J),_e!==_e+0)throw _e;It(1,0)}}function Tb(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn){var ei=Ot();try{hp(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt,mn)}catch(Xo){if(kt(ei),Xo!==Xo+0)throw Xo;It(1,0)}}function Eb(D,P,N,K,J){var _e=Ot();try{fp(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;It(1,0)}}function Ip(D,P,N){var K=Ot();try{Cd(D,P,N)}catch(J){if(kt(K),J!==J+0)throw J;It(1,0)}}function Op(D,P){var N=Ot();try{return Jf(D,P)}catch(K){if(kt(N),K!==K+0)throw K;return It(1,0),0n}}function Db(D,P,N,K,J){var _e=Ot();try{return mp(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;It(1,0)}}function Up(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt){var mn=Ot();try{gp(D,P,N,K,J,_e,Ae,Ne,Ge,et,dt,wt,Rt)}catch(ei){if(kt(mn),ei!==ei+0)throw ei;It(1,0)}}function Mb(D,P,N,K){var J=Ot();try{return _p(D,P,N,K)}catch(_e){if(kt(J),_e!==_e+0)throw _e;It(1,0)}}function Ab(D,P,N,K,J){var _e=Ot();try{return Pd(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;return It(1,0),0n}}function Cb(D,P,N,K,J){var _e=Ot();try{bp(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;It(1,0)}}function Lp(D,P,N,K,J){var _e=Ot();try{return yp(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;It(1,0)}}function Sb(D,P,N,K,J){var _e=Ot();try{kd(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;It(1,0)}}function Pb(D,P,N,K,J){var _e=Ot();try{return vp(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;It(1,0)}}function kb(D,P,N,K,J){var _e=Ot();try{wp(D,P,N,K,J)}catch(Ae){if(kt(_e),Ae!==Ae+0)throw Ae;It(1,0)}}function Rp(D,P,N,K,J,_e,Ae){var Ne=Ot();try{return Fd(D,P,N,K,J,_e,Ae)}catch(Ge){if(kt(Ne),Ge!==Ge+0)throw Ge;It(1,0)}}function Fb(D,P,N,K,J,_e,Ae){var Ne=Ot();try{return xp(D,P,N,K,J,_e,Ae)}catch(Ge){if(kt(Ne),Ge!==Ge+0)throw Ge;It(1,0)}}return r.stackSave=()=>Ot(),r.stackRestore=D=>kt(D),r.stackAlloc=D=>_d(D),r.setValue=function(D,P,N="i8"){switch(N.endsWith("*")&&(N="*"),N){case"i1":case"i8":V()[D>>>0]=P;break;case"i16":R()[D>>>1>>>0]=P;break;case"i32":L()[D>>>2>>>0]=P;break;case"i64":I[D>>>3]=BigInt(P);break;case"float":de()[D>>>2>>>0]=P;break;case"double":we()[D>>>3>>>0]=P;break;case"*":ne()[D>>>2>>>0]=P;break;default:he(`invalid type for setValue: ${N}`)}},r.getValue=function(D,P="i8"){switch(P.endsWith("*")&&(P="*"),P){case"i1":case"i8":return V()[D>>>0];case"i16":return R()[D>>>1>>>0];case"i32":return L()[D>>>2>>>0];case"i64":return I[D>>>3];case"float":return de()[D>>>2>>>0];case"double":return we()[D>>>3>>>0];case"*":return ne()[D>>>2>>>0];default:he(`invalid type for getValue: ${P}`)}},r.UTF8ToString=rt,r.stringToUTF8=mi,r.lengthBytesUTF8=bn,function D(){if(0<ue)Se=D;else if(o)e(r),xe();else{for(;0<te.length;)te.shift()(r);0<ue?Se=D:(r.calledRun=!0,$||(xe(),e(r)))}}(),r.PTR_SIZE=4,i}),C$=x2,EF=globalThis.self?.name?.startsWith("em-pthread"),EF&&x2()}),T2,UT,DF,Ki,S$,by,MF,AF,E2,CF,D2,P$,M2,k$,aD=nt(()=>{sD(),T2=typeof location>"u"?void 0:location.origin,UT=import.meta.url>"file:"&&import.meta.url<"file;",DF=()=>{{if(UT){let n=URL;return new URL(new n("ort.bundle.min.mjs",import.meta.url).href,T2).href}return import.meta.url}},Ki=DF(),S$=()=>{if(Ki&&!Ki.startsWith("blob:"))return Ki.substring(0,Ki.lastIndexOf("/")+1)},by=(n,e)=>{try{let t=e??Ki;return(t?new URL(n,t):new URL(n)).origin===T2}catch{return!1}},MF=(n,e)=>{let t=e??Ki;try{return(t?new URL(n,t):new URL(n)).href}catch{return}},AF=(n,e)=>`${e??"./"}${n}`,E2=async n=>{let e=await(await fetch(n,{credentials:"same-origin"})).blob();return URL.createObjectURL(e)},CF=async n=>(await import(n)).default,D2=(OV(),H0(D$)).default,P$=async()=>{if(!Ki)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(by(Ki))return[void 0,D2()];let n=await E2(Ki);return[n,D2(n)]},M2=(UV(),H0(A$)).default,k$=async(n,e,t)=>{if(!n&&!e&&M2&&Ki&&by(Ki))return[void 0,M2];{let r="ort-wasm-simd-threaded.jsep.mjs",i=n??MF(r,e),s=t&&i&&!by(i,e),a=s?await E2(i):i??AF(r,e);return[s?a:void 0,await CF(a)]}}}),A2,yy,im,C2,SF,PF,oD,Ar,rd=nt(()=>{aD(),yy=!1,im=!1,C2=!1,SF=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},PF=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},oD=async n=>{if(yy)return Promise.resolve();if(im)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(C2)throw new Error("previous call to 'initializeWebAssembly()' failed.");im=!0;let e=n.initTimeout,t=n.numThreads;if(!PF())throw new Error("WebAssembly SIMD is not supported in the current environment.");let r=SF();t>1&&!r&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+t+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),n.numThreads=t=1);let i=n.wasmPaths,s=typeof i=="string"?i:void 0,a=i?.mjs,o=a?.href??a,l=i?.wasm,c=l?.href??l,u=n.wasmBinary,[d,h]=await k$(o,s,t>1),f=!1,p=[];if(e>0&&p.push(new Promise(g=>{setTimeout(()=>{f=!0,g()},e)})),p.push(new Promise((g,b)=>{let _={numThreads:t};if(u)_.wasmBinary=u;else if(c||s)_.locateFile=m=>c??s+m;else if(o&&o.indexOf("blob:")!==0)_.locateFile=m=>new URL(m,o).href;else if(d){let m=S$();m&&(_.locateFile=v=>m+v)}h(_).then(m=>{im=!1,yy=!0,A2=m,g(),d&&URL.revokeObjectURL(d)},m=>{im=!1,C2=!0,b(m)})})),await Promise.race(p),f)throw new Error(`WebAssembly backend initializing failed due to timeout: ${e}ms`)},Ar=()=>{if(yy&&A2)return A2;throw new Error("WebAssembly is not initialized yet.")}}),Qr,K0,cn,lD=nt(()=>{rd(),Qr=(n,e)=>{let t=Ar(),r=t.lengthBytesUTF8(n)+1,i=t._malloc(r);return t.stringToUTF8(n,i,r),e.push(i),i},K0=(n,e,t,r)=>{if(typeof n=="object"&&n!==null){if(t.has(n))throw new Error("Circular reference in options");t.add(n)}Object.entries(n).forEach(([i,s])=>{let a=e?e+i:i;if(typeof s=="object")K0(s,a+".",t,r);else if(typeof s=="string"||typeof s=="number")r(a,s.toString());else if(typeof s=="boolean")r(a,s?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof s}`)})},cn=n=>{let e=Ar(),t=e.stackSave();try{let r=e.PTR_SIZE,i=e.stackAlloc(2*r);e._OrtGetLastError(i,i+r);let s=Number(e.getValue(i,r===4?"i32":"i64")),a=e.getValue(i+r,"*"),o=a?e.UTF8ToString(a):"";throw new Error(`${n} ERROR_CODE: ${s}, ERROR_MESSAGE: ${o}`)}finally{e.stackRestore(t)}}}),F$,LV=nt(()=>{rd(),lD(),F$=n=>{let e=Ar(),t=0,r=[],i=n||{};try{if(n?.logSeverityLevel===void 0)i.logSeverityLevel=2;else if(typeof n.logSeverityLevel!="number"||!Number.isInteger(n.logSeverityLevel)||n.logSeverityLevel<0||n.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${n.logSeverityLevel}`);if(n?.logVerbosityLevel===void 0)i.logVerbosityLevel=0;else if(typeof n.logVerbosityLevel!="number"||!Number.isInteger(n.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${n.logVerbosityLevel}`);n?.terminate===void 0&&(i.terminate=!1);let s=0;return n?.tag!==void 0&&(s=Qr(n.tag,r)),t=e._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,s),t===0&&cn("Can't create run options."),n?.extra!==void 0&&K0(n.extra,"",new WeakSet,(a,o)=>{let l=Qr(a,r),c=Qr(o,r);e._OrtAddRunConfigEntry(t,l,c)!==0&&cn(`Can't set a run config entry: ${a} - ${o}.`)}),[t,r]}catch(s){throw t!==0&&e._OrtReleaseRunOptions(t),r.forEach(a=>e._free(a)),s}}}),kF,FF,IF,OF,I$,RV=nt(()=>{rd(),lD(),kF=n=>{switch(n){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${n}`)}},FF=n=>{switch(n){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${n}`)}},IF=n=>{n.extra||(n.extra={}),n.extra.session||(n.extra.session={});let e=n.extra.session;e.use_ort_model_bytes_directly||(e.use_ort_model_bytes_directly="1"),n.executionProviders&&n.executionProviders.some(t=>(typeof t=="string"?t:t.name)==="webgpu")&&(n.enableMemPattern=!1)},OF=(n,e,t)=>{for(let r of e){let i=typeof r=="string"?r:r.name;switch(i){case"webnn":if(i="WEBNN",typeof r!="string"){let a=r?.deviceType;if(a){let o=Qr("deviceType",t),l=Qr(a,t);Ar()._OrtAddSessionConfigEntry(n,o,l)!==0&&cn(`Can't set a session config entry: 'deviceType' - ${a}.`)}}break;case"webgpu":if(i="JS",typeof r!="string"){let a=r;if(a?.preferredLayout){if(a.preferredLayout!=="NCHW"&&a.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${a.preferredLayout}`);let o=Qr("preferredLayout",t),l=Qr(a.preferredLayout,t);Ar()._OrtAddSessionConfigEntry(n,o,l)!==0&&cn(`Can't set a session config entry: 'preferredLayout' - ${a.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${i}`)}let s=Qr(i,t);Ar()._OrtAppendExecutionProvider(n,s)!==0&&cn(`Can't append execution provider: ${i}.`)}},I$=n=>{let e=Ar(),t=0,r=[],i=n||{};IF(i);try{let s=kF(i.graphOptimizationLevel??"all"),a=FF(i.executionMode??"sequential"),o=typeof i.logId=="string"?Qr(i.logId,r):0,l=i.logSeverityLevel??2;if(!Number.isInteger(l)||l<0||l>4)throw new Error(`log serverity level is not valid: ${l}`);let c=i.logVerbosityLevel??0;if(!Number.isInteger(c)||c<0||c>4)throw new Error(`log verbosity level is not valid: ${c}`);let u=typeof i.optimizedModelFilePath=="string"?Qr(i.optimizedModelFilePath,r):0;if(t=e._OrtCreateSessionOptions(s,!!i.enableCpuMemArena,!!i.enableMemPattern,a,!!i.enableProfiling,0,o,l,c,u),t===0&&cn("Can't create session options."),i.executionProviders&&OF(t,i.executionProviders,r),i.enableGraphCapture!==void 0){if(typeof i.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);let d=Qr("enableGraphCapture",r),h=Qr(i.enableGraphCapture.toString(),r);e._OrtAddSessionConfigEntry(t,d,h)!==0&&cn(`Can't set a session config entry: 'enableGraphCapture' - ${i.enableGraphCapture}.`)}if(i.freeDimensionOverrides)for(let[d,h]of Object.entries(i.freeDimensionOverrides)){if(typeof d!="string")throw new Error(`free dimension override name must be a string: ${d}`);if(typeof h!="number"||!Number.isInteger(h)||h<0)throw new Error(`free dimension override value must be a non-negative integer: ${h}`);let f=Qr(d,r);e._OrtAddFreeDimensionOverride(t,f,h)!==0&&cn(`Can't set a free dimension override: ${d} - ${h}.`)}return i.extra!==void 0&&K0(i.extra,"",new WeakSet,(d,h)=>{let f=Qr(d,r),p=Qr(h,r);e._OrtAddSessionConfigEntry(t,f,p)!==0&&cn(`Can't set a session config entry: ${d} - ${h}.`)}),[t,r]}catch(s){throw t!==0&&e._OrtReleaseSessionOptions(t)!==0&&cn("Can't release session options."),r.forEach(a=>e._free(a)),s}}}),Zd,Fc,Ic,cD,X0,uD,dD,LT,Ft=nt(()=>{Zd=n=>{switch(n){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error(`unsupported data type: ${n}`)}},Fc=n=>{switch(n){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error(`unsupported data type: ${n}`)}},Ic=(n,e)=>{let t=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][n],r=typeof e=="number"?e:e.reduce((i,s)=>i*s,1);return t>0?Math.ceil(r*t):void 0},cD=n=>{switch(n){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${n}`)}},X0=n=>{switch(n){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${n}`)}},uD=n=>n==="float32"||n==="float16"||n==="int32"||n==="int64"||n==="uint32"||n==="uint8"||n==="bool"||n==="uint4"||n==="int4",dD=n=>n==="float32"||n==="float16"||n==="int32"||n==="int64"||n==="uint32"||n==="uint64"||n==="int8"||n==="uint8"||n==="bool"||n==="uint4"||n==="int4",LT=n=>{switch(n){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error(`unsupported data location: ${n}`)}}}),hD,O$=nt(()=>{sD(),hD=async n=>{if(typeof n=="string"){let e=await fetch(n);if(!e.ok)throw new Error(`failed to load external data file: ${n}`);let t=e.headers.get("Content-Length"),r=t?parseInt(t,10):0;if(r<1073741824)return new Uint8Array(await e.arrayBuffer());{if(!e.body)throw new Error(`failed to load external data file: ${n}, no response body.`);let i=e.body.getReader(),s;try{s=new ArrayBuffer(r)}catch(o){if(o instanceof RangeError){let l=Math.ceil(r/65536);s=new WebAssembly.Memory({initial:l,maximum:l}).buffer}else throw o}let a=0;for(;;){let{done:o,value:l}=await i.read();if(o)break;let c=l.byteLength;new Uint8Array(s,a,c).set(l),a+=c}return new Uint8Array(s,0,r)}}else return n instanceof Blob?new Uint8Array(await n.arrayBuffer()):n instanceof Uint8Array?n:new Uint8Array(n)}}),UF,LF,RF,BF,fD,$F,nn,Uo=nt(()=>{Ft(),UF=["V","I","W","E","F"],LF=(n,e)=>{console.log(`[${UF[n]},${new Date().toISOString()}]${e}`)},fD=(n,e)=>{RF=n,BF=e},$F=(n,e)=>{let t=X0(n),r=X0(RF);t>=r&&LF(t,typeof e=="function"?e():e)},nn=(...n)=>{BF&&$F(...n)}}),pD,U$=nt(()=>{Ft(),pD=(n,e)=>new(cD(e))(n)}),mD=nt(()=>{}),S2,vy,wy,NF,zF,P2,RT,WF,L$,BV=nt(()=>{Uo(),mD(),S2=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),vy=[],wy=n=>Math.ceil(Number(n)/16)*16,NF=n=>{for(let e=0;e<vy.length;e++){let t=vy[e];if(n<=t)return t}return Math.ceil(n/16)*16},zF=1,P2=()=>zF++,RT=async(n,e,t,r)=>{let i=wy(t),s=n.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let a=n.getCommandEncoder();n.endComputePass(),a.copyBufferToBuffer(e,0,s,0,i),n.flush(),await s.mapAsync(GPUMapMode.READ);let o=s.getMappedRange();if(r){let l=r();return l.set(new Uint8Array(o,0,t)),l}else return new Uint8Array(o.slice(0,t))}finally{s.destroy()}},WF=class{constructor(n){this.backend=n,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[e]of S2)vy.push(e),this.freeBuffers.set(e,[]),this.freeUniformBuffers.set(e,[]);this.sessionCount=0}upload(n,e){let t=e.buffer,r=e.byteOffset,i=e.byteLength,s=wy(i),a=this.storageCache.get(n);if(!a)throw new Error("gpu data for uploading does not exist");if(Number(a.originalSize)!==i)throw new Error(`inconsistent data size. gpu data size=${a.originalSize}, data size=${i}`);let o=this.backend.device.createBuffer({mappedAtCreation:!0,size:s,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),l=o.getMappedRange();new Uint8Array(l).set(new Uint8Array(t,r,i)),o.unmap();let c=this.backend.device.createCommandEncoder();c.copyBufferToBuffer(o,0,a.gpuData.buffer,0,s),this.backend.device.queue.submit([c.finish()]),o.destroy(),nn("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${n})`)}memcpy(n,e){let t=this.storageCache.get(n);if(!t)throw new Error("source gpu data for memcpy does not exist");let r=this.storageCache.get(e);if(!r)throw new Error("destination gpu data for memcpy does not exist");if(t.originalSize!==r.originalSize)throw new Error("inconsistent source and destination gpu data size");let i=wy(t.originalSize),s=this.backend.getCommandEncoder();this.backend.endComputePass(),s.copyBufferToBuffer(t.gpuData.buffer,0,r.gpuData.buffer,0,i)}registerExternalBuffer(n,e,t){let r;if(t){if(r=t[0],n===t[1])return nn("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${e}) => id=${r}, buffer is the same, skip.`),r;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`)}else r=P2();return this.storageCache.set(r,{gpuData:{id:r,type:0,buffer:n},originalSize:e}),nn("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${e}) => id=${r}, registered.`),r}unregisterExternalBuffer(n){n!==void 0&&(this.storageCache.delete(n),nn("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${n}`))}create(n,e=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let t=NF(n),r,i=(e&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,s=(e&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(i||s){let o=(i?this.freeBuffers:this.freeUniformBuffers).get(t);o?o.length>0?r=o.pop():r=this.backend.device.createBuffer({size:t,usage:e}):r=this.backend.device.createBuffer({size:t,usage:e})}else r=this.backend.device.createBuffer({size:t,usage:e});let a={id:P2(),type:0,buffer:r};return this.storageCache.set(a.id,{gpuData:a,originalSize:Number(n)}),nn("verbose",()=>`[WebGPU] GpuDataManager.create(size=${n}) => id=${a.id}`),a}get(n){return this.storageCache.get(n)?.gpuData}release(n){let e=typeof n=="bigint"?Number(n):n,t=this.storageCache.get(e);if(!t){if(this.storageCache.size===0)return 0;throw new Error("releasing data does not exist")}return nn("verbose",()=>`[WebGPU] GpuDataManager.release(id=${e}), gpuDataId=${t.gpuData.id}`),this.storageCache.delete(e),this.buffersPending.push(t.gpuData.buffer),t.originalSize}async download(n,e){let t=this.storageCache.get(Number(n));if(!t)throw new Error("data does not exist");await RT(this.backend,t.gpuData.buffer,t.originalSize,e)}refreshPendingBuffers(){if(this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let n of this.buffersPending){let e=S2.get(n.size);if((n.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let t=this.freeBuffers.get(n.size)||[];e===void 0||t.length>=e?n.destroy():t.push(n)}else if((n.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let t=this.freeUniformBuffers.get(n.size)||[];e===void 0||t.length>=e?n.destroy():t.push(n)}else n.destroy()}this.buffersPending=[]}else{let n=this.capturedPendingBuffers.get(this.backend.currentSessionId);n||(n=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,n));for(let e of this.buffersPending)n.push(e);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(n=>{n.forEach(e=>{e.destroy()})}),this.freeUniformBuffers.forEach(n=>{n.forEach(e=>{e.destroy()})}),this.storageCache.forEach(n=>{n.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(n=>{n.forEach(e=>{e.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(n){let e=this.capturedPendingBuffers.get(n);e&&(e.forEach(t=>{t.destroy()}),this.capturedPendingBuffers.delete(n)),this.sessionCount-=1,this.sessionCount===0&&(nn("warning",()=>"[WebGPU] Clearing webgpu buffer cache"),this.storageCache.forEach(t=>{t.gpuData.buffer.destroy()}),this.storageCache=new Map)}},L$=(...n)=>new WF(...n)}),jF,pn,Zn=nt(()=>{jF=class{constructor(n){Object.assign(this,n)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(n=>`${this[n]}`).join(";")),this.key}},pn=n=>new jF(n)}),VF,gf,Ve,Y0,R$,B$,$$,$t=nt(()=>{VF=class{static calcMatMulShape(n,e){return n[1]!==e[0]?void 0:[n[0],e[1]]}},gf=class{static calcShape(n,e,t=!1){let r=n.length,i=e.length;if(r===0)return e;if(i===0)return n;let s=Math.max(n.length,e.length),a=new Array(s);if(t){if(r<2||i<2)return;let o=VF.calcMatMulShape([n[r-2],n[r-1]],[e[i-2],e[i-1]]);if(o===void 0)return;[a[s-2],a[s-1]]=o}for(let o=t?3:1;o<=s;o++){let l=r-o<0?1:n[r-o],c=i-o<0?1:e[i-o];if(l!==c&&l>1&&c>1)return;let u=Math.max(l,c);if(l&&c)a[s-o]=Math.max(l,c);else{if(u>1)return;a[s-o]=0}}return a}static isValidBroadcast(n,e){let t=n.length,r=e.length;if(t>r)return!1;for(let i=1;i<=t;i++)if(n[t-i]!==1&&n[t-i]!==e[r-i])return!1;return!0}},Ve=class P0{static size(e){return P0.getSizeFromDimensionRange(e,0,e.length)}static convertShape(e,t=4){let r=e.length;if(r===0)return[];let i=new Array(r),s=r-1;for(;s>=0;){if(e[s]%t===0){i[s]=e[s]/t;break}if(t%e[s]!==0)throw new Error("cannot convert shape");i[s]=1,t/=e[s],s--}for(s--;s>=0;s--)i[s]=e[s];return i}static sizeFromDimension(e,t){if(t<0||t>e.length)throw new Error(`invalid dimension of ${t} for sizeFromDimension as Tensor has ${e.length} dimensions.`);return P0.getSizeFromDimensionRange(e,t,e.length)}static sizeToDimension(e,t){if(t<0||t>e.length)throw new Error(`invalid dimension of ${t} for sizeToDimension as Tensor has ${e.length} dimensions.`);return P0.getSizeFromDimensionRange(e,0,t)}static getSizeFromDimensionRange(e,t,r){let i=1;for(let s=t;s<r;s++){if(e[s]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");i*=Number(e[s])}return i}static computeStrides(e){let t=e.length;if(t===0)return[];if(t===1)return[1];let r=new Array(t);r[t-1]=1,r[t-2]=e[t-1];for(let i=t-3;i>=0;--i)r[i]=r[i+1]*e[i+1];return r}static normalizeAxis(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map(r=>this.normalizeAxis(r,t??e.length))}static sortBasedOnPerm(e,t){return t?t.map(r=>e[r]):e.slice().reverse()}static padShape(e,t){let r=e.length;return e.map((i,s)=>i+t[s]+t[s+r])}static areEqual(e,t){return e.length!==t.length?!1:e.every((r,i)=>r===t[i])}},Y0=class Pm{static adjustPoolAttributes(e,t,r,i,s,a){if(!e&&r.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let o=0;o<t.length-2;o++)o>=r.length?r.push(t[o+2]):r[o]=t[o+2];for(let o=0;o<r.length;o++)if(o<i.length){if(i[o]<0)throw new Error("strides should be greater than or equal to 1")}else i.push(1);for(let o=0;o<r.length;o++)if(o<s.length){if(s[o]<0)throw new Error("dilations should be greater than or equal to 1")}else s.push(1);for(let o=0;o<r.length*2;o++)if(o<a.length){if(a[o]<0)throw new Error("pad should be greater than or equal to 1")}else a.push(0);for(let o=0;o<r.length;o++){if(r[o]<=0)throw new Error("kernel shapes need to be greater than 0");if(a[o]>=r[o]||a[o+r.length]>=r[o])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(e,t,r,i,s,a,o){if(o){if(s.length!==2*(e.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(t.length!==e.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==e.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let l=0;l<e.length-2;l++)Pm.adjustPadAndReturnShape(e[l+(a?1:2)],t[l],r[l],i[l],s,l,l+e.length-2,o)}}static computePoolOutputShape(e,t,r,i,s,a,o){if(t.length<=0)throw new Error("input shape must be of size greater than 0");let l=[t[0],t[1]];return Pm.computeShapeHelper(e,t,l,r,i,s,a,o),l}static computeConvOutputShape(e,t,r,i,s,a,o){if(e.length<=0||t.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let l=[e[0],t[0]];return Pm.computeShapeHelper(!1,e,l,r,i,s,a,o),l}static computeShapeHelper(e,t,r,i,s,a,o,l){if(e)for(let c=0;c<t.length-2;c++)r.push(1);else for(let c=0;c<t.length-2;c++)r.push(Pm.adjustPadAndReturnShape(t[c+2],i[c],s[c],a[c],o,c,c+t.length-2,l))}static adjustPadAndReturnShape(e,t,r,i,s,a,o,l){let c=r*(i-1)+1;if(l&&l!=="NOTSET")switch(l){case"VALID":return s[a]=0,s[o]=0,Math.floor((e-c)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(r!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let u=((e+t-1)/t-1)*t+i-e;return s[a]=Math.floor(l==="SAME_LOWER"?(u+1)/2:u/2),s[o]=u-s[a],Math.floor((e+u-i)/t+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((e+s[a]+s[o]-c)/t+1)}},R$=class{static getShapeOfGemmResult(n,e,t,r,i){if(n.length!==2||t.length!==2)throw new Error("shape need to be of size 2");let s,a,o;e?(s=n[1],a=n[0]):(s=n[0],a=n[1]);let l=-1;if(r?(o=t[0],l=1):(o=t[1],l=0),t[l]!==a)throw new Error("dimension mismatch");if(s<=0||o<=0||a<=0)throw new Error("invalid shape specified");if(i&&!gf.isValidBroadcast(i,[s,o]))throw new Error("gemm: invalid bias shape for broadcast");return[s,o,a]}},B$=-34028234663852886e22,$$=34028234663852886e22}),_f,xy,Sr,ui,vt,jn,BT,eh,Vl,yt,sm,He,_t,N$,gD,GF,z$,zt=nt(()=>{Ft(),$t(),_f=64,xy=(n,e)=>{if(e===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(n)){case 10:return e>1?`vec${e}<f16>`:"f16";case 1:return e>1?`vec${e}<f32>`:"f32";case 6:return e>1?`vec${e}<i32>`:"i32";case 12:return e>1?`vec${e}<u32>`:"u32";case 7:if(e>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(e>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(e!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error(`Unknown data type: ${n}`)}},Sr=(n,e=1)=>{let t=xy(n,e);return typeof t=="string"?t:t[0]},ui=(n,e=1)=>{let t=xy(n,e);return typeof t=="string"?t:t[1]},vt=(...n)=>{let e=[];return n.forEach(t=>{t.length!==0&&e.push({type:12,data:t},{type:12,data:Ve.computeStrides(t)})}),e},jn=n=>n%4===0?4:n%2===0?2:1,BT=(n="f32",e,t="0")=>!e||e===1?`${n}(${t})`:`vec${e}<${n}>(${t})`,eh=(n,e,t)=>n==="f32"?t:e===1?`f32(${t})`:`vec${e}<f32>(${t})`,Vl=(n,e)=>e===4?`(${n}.x + ${n}.y + ${n}.z + ${n}.w)`:e===2?`(${n}.x + ${n}.y)`:e===3?`(${n}.x + ${n}.y + ${n}.z)`:n,yt=(n,e,t,r)=>n.startsWith("uniforms.")&&t>4?typeof e=="string"?r==="f16"?`${n}[(${e}) / 8][(${e}) % 8 / 4][(${e}) % 8 % 4]`:`${n}[(${e}) / 4][(${e}) % 4]`:r==="f16"?`${n}[${Math.floor(e/8)}][${Math.floor(e%8/4)}][${e%8%4}]`:`${n}[${Math.floor(e/4)}][${e%4}]`:t>1?`${n}[${e}]`:n,sm=(n,e,t,r,i)=>{let s=typeof t=="number",a=s?t:t.length,o=[...new Array(a).keys()],l=a<2?"u32":a<=4?`vec${a}<u32>`:`array<u32, ${a}>`,c=xy(e,i),u=typeof c=="string"?c:c[1],d=typeof c=="string"?c:c[0],h={indices:l,value:u,storage:d,tensor:e},f=R=>typeof R=="string"?R:`${R}u`,p={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},g=s?"uniforms.":"",b=`${g}${n}_shape`,_=`${g}${n}_strides`,m="";for(let R=0;R<a-1;R++)m+=`
    let dim${R} = current / ${yt(_,R,a)};
    let rest${R} = current % ${yt(_,R,a)};
    indices[${R}] = dim${R};
    current = rest${R};
    `;m+=`indices[${a-1}] = current;`;let v=a<2?"":`
  fn o2i_${n}(offset: u32) -> ${h.indices} {
    var indices: ${h.indices};
    var current = offset;
    ${m}
    return indices;
  }`,x=R=>(p.offsetToIndices=!0,a<2?R:`o2i_${n}(${R})`),w=[];if(a>=2)for(let R=a-1;R>=0;R--)w.push(`${yt(_,R,a)} * (indices[${R}])`);let T=a<2?"":`
  fn i2o_${n}(indices: ${h.indices}) -> u32 {
    return ${w.join("+")};
  }`,E=R=>(p.indicesToOffset=!0,a<2?R:`i2o_${n}(${R})`),A=(...R)=>a===0?"0u":`${h.indices}(${R.map(f).join(",")})`,M=(R,O)=>a<2?`${R}`:`${yt(R,O,a)}`,F=(R,O,L)=>a<2?`${R}=${L};`:`${yt(R,O,a)}=${L};`,G={},S=(R,O)=>{p.broadcastedIndicesToOffset=!0;let L=`${O.name}broadcastedIndicesTo${n}Offset`;if(L in G)return`${L}(${R})`;let ne=[];for(let de=a-1;de>=0;de--){let we=O.indicesGet("outputIndices",de+O.rank-a);ne.push(`${M(_,de)} * (${we} % ${M(b,de)})`)}return G[L]=`fn ${L}(outputIndices: ${O.type.indices}) -> u32 {
             return ${ne.length>0?ne.join("+"):"0u"};
           }`,`${L}(${R})`},I=(R,O)=>(()=>{if(h.storage===h.value)return`${n}[${R}]=${O};`;if(h.storage==="vec2<u32>"&&h.value==="i32")return`${n}[${R}]=vec2<u32>(u32(${O}), select(0u, 0xFFFFFFFFu, ${O} < 0));`;if(h.storage==="vec2<u32>"&&h.value==="u32")return`${n}[${R}]=vec2<u32>(u32(${O}), 0u);`;if(h.storage==="u32"&&h.value==="vec4<bool>")return`${n}[${R}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${O}));`;throw new Error(`not supported combination of storage type ${h.storage} and value type ${h.value} yet`)})(),C=R=>(()=>{if(h.storage===h.value)return`${n}[${R}]`;if(h.storage==="vec2<u32>"&&h.value==="i32")return`i32(${n}[${R}].x)`;if(h.storage==="vec2<u32>"&&h.value==="u32")return`u32(${n}[${R}].x)`;if(h.storage==="u32"&&h.value==="vec4<bool>")return`vec4<bool>(bool(${n}[${R}] & 0xFFu), bool(${n}[${R}] & 0xFF00u), bool(${n}[${R}] & 0xFF0000u), bool(${n}[${R}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${h.storage} and value type ${h.value} yet`)})(),H=a<2?"":`
  fn get_${n}ByIndices(indices: ${h.indices}) -> ${u} {
    return ${C(`i2o_${n}(indices)`)};
  }`,B=a<2?"":(()=>{let R=o.map(L=>`d${L}: u32`).join(", "),O=o.map(L=>`d${L}`).join(", ");return`
  fn get_${n}(${R}) -> ${u} {
    return get_${n}ByIndices(${A(O)});
  }`})(),$=(...R)=>{if(R.length!==a)throw new Error(`indices length must be ${a}`);let O=R.map(f).join(",");return a===0?C("0u"):a===1?C(O[0]):(p.get=!0,p.getByIndices=!0,p.indicesToOffset=!0,`get_${n}(${O})`)},X=R=>a<2?C(R):(p.getByIndices=!0,p.indicesToOffset=!0,`get_${n}ByIndices(${R})`),V=a<2?"":`
  fn set_${n}ByIndices(indices: ${h.indices}, value: ${u}) {
    ${I(`i2o_${n}(indices)`,"value")}
  }`,Q=a<2?"":(()=>{let R=o.map(L=>`d${L}: u32`).join(", "),O=o.map(L=>`d${L}`).join(", ");return`
  fn set_${n}(${R}, value: ${u}) {
    set_${n}ByIndices(${A(O)}, value);
  }`})();return{impl:()=>{let R=[],O=!1;return p.offsetToIndices&&(R.push(v),O=!0),p.indicesToOffset&&(R.push(T),O=!0),p.broadcastedIndicesToOffset&&(Object.values(G).forEach(L=>R.push(L)),O=!0),p.set&&(R.push(Q),O=!0),p.setByIndices&&(R.push(V),O=!0),p.get&&(R.push(B),O=!0),p.getByIndices&&(R.push(H),O=!0),!s&&O&&R.unshift(`const ${b} = ${h.indices}(${t.join(",")});`,`const ${_} = ${h.indices}(${Ve.computeStrides(t).join(",")});`),R.join(`
`)},type:h,offsetToIndices:x,indicesToOffset:E,broadcastedIndicesToOffset:S,indices:A,indicesGet:M,indicesSet:F,set:(...R)=>{if(R.length!==a+1)throw new Error(`indices length must be ${a}`);let O=R[a];if(typeof O!="string")throw new Error("value must be string");let L=R.slice(0,a).map(f).join(",");return a===0?I("0u",O):a===1?I(L[0],O):(p.set=!0,p.setByIndices=!0,p.indicesToOffset=!0,`set_${n}(${L}, ${O})`)},setByOffset:I,setByIndices:(R,O)=>a<2?I(R,O):(p.setByIndices=!0,p.indicesToOffset=!0,`set_${n}ByIndices(${R}, ${O});`),get:$,getByOffset:C,getByIndices:X,usage:r,name:n,strides:_,shape:b,rank:a}},He=(n,e,t,r=1)=>sm(n,e,t,"input",r),_t=(n,e,t,r=1)=>sm(n,e,t,"output",r),N$=(n,e,t)=>sm(n,e,t,"atomicOutput",1),gD=(n,e,t,r=1)=>sm(n,e,t,"internal",r),GF=class{constructor(n,e){this.normalizedDispatchGroup=n,this.limits=e,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(n){return`if (global_idx >= ${typeof n=="number"?`${n}u`:n}) { return; }`}mainStart(n=_f){let e=typeof n=="number"?n:n[0],t=typeof n=="number"?1:n[1],r=typeof n=="number"?1:n[2];if(e>this.limits.maxComputeWorkgroupSizeX||t>this.limits.maxComputeWorkgroupSizeY||r>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${e}, ${t}, ${r}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(e*t*r>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${e}, ${t}, ${r}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let i=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,s=i?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,a=i?`let global_idx = global_id.x;
         let workgroup_index = workgroup_id.x;`:`let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
             workgroup_id.y * num_workgroups[0] + workgroup_id.x;
         let global_idx = workgroup_index * ${e*t*r}u + local_idx;`;return`@compute @workgroup_size(${e}, ${t}, ${r})
  fn main(${s}) {
    ${a}
  `}appendVariableUniforms(n){n.rank!==0&&(n.shape.startsWith("uniforms.")&&this.uniforms.push({name:n.shape.replace("uniforms.",""),type:"u32",length:n.rank}),n.strides.startsWith("uniforms.")&&this.uniforms.push({name:n.strides.replace("uniforms.",""),type:"u32",length:n.rank}))}declareVariable(n,e){if(n.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(n),this.appendVariableUniforms(n);let t=n.usage==="input"?"read":"read_write",r=n.usage==="atomicOutput"?"atomic<i32>":n.type.storage;return`@group(0) @binding(${e}) var<storage, ${t}> ${n.name}: array<${r}>;`}declareVariables(...n){return n.map(e=>this.declareVariable(e,this.variableIndex++)).join(`
`)}registerInternalVariable(n){if(n.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(n),this.appendVariableUniforms(n)}registerInternalVariables(...n){return n.forEach(e=>this.registerInternalVariable(e)),this}registerUniform(n,e,t=1){return this.uniforms.push({name:n,type:e,length:t}),this}registerUniforms(n){return this.uniforms=this.uniforms.concat(n),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let n=[];for(let{name:e,type:t,length:r}of this.uniforms)if(r&&r>4)t==="f16"?n.push(`@align(16) ${e}:array<mat2x4<${t}>, ${Math.ceil(r/8)}>`):n.push(`${e}:array<vec4<${t}>, ${Math.ceil(r/4)}>`);else{let i=r==null||r===1?t:`vec${r}<${t}>`;n.push(`${e}:${i}`)}return`
      struct Uniforms { ${n.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(n=>n.impl()).join(`
`)+this.internalVariables.map(n=>n.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let n=e=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(e)];return this.uniforms.map(e=>[n(e.type),e.length??1])}},z$=(n,e)=>new GF(n,e)}),qF,k2,HF,KF,XF,YF,hs,W$,j$,Zl=nt(()=>{Ft(),$t(),Zn(),zt(),qF=(n,e)=>{if(!n||n.length!==1)throw new Error("Transpose requires 1 input.");if(e.length!==0&&e.length!==n[0].dims.length)throw new Error(`perm size ${e.length} does not match input rank ${n[0].dims.length}`)},k2=(n,e)=>e.length!==0?e:[...new Array(n).keys()].reverse(),HF=(n,e)=>Ve.sortBasedOnPerm(n,k2(n.length,e)),KF=(n,e,t,r)=>{let i=`fn perm(i: ${r.type.indices}) -> ${t.type.indices} {
    var a: ${t.type.indices};`;for(let s=0;s<e;++s)i+=`a[${n[s]}]=i[${s}];`;return i+="return a;}"},XF=(n,e)=>{let t=[],r=[];for(let i=0;i<n.length;++i)n[i]!==1&&t.push(n[i]),n[e[i]]!==1&&r.push(e[i]);return{newShape:t,newPerm:r}},YF=(n,e)=>{let t=0;for(let r=0;r<n.length;++r)if(e[n[r]]!==1){if(n[r]<t)return!1;t=n[r]}return!0},hs=(n,e)=>{let t=n.dataType,r=n.dims.length,i=k2(r,e),s=HF(n.dims,i),a=n.dims,o=s,l=r<2||YF(i,n.dims),c;if(l)return c=p=>{let g=He("input",t,a,4),b=_t("output",t,o,4);return`
  ${p.registerUniform("output_size","u32").declareVariables(g,b)}
  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    output[global_idx] = input[global_idx];
  }`},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let p=Ve.size(s);return{outputs:[{dims:s,dataType:n.dataType}],dispatchGroup:{x:Math.ceil(p/64/4)},programUniforms:[{type:12,data:Math.ceil(p/4)}]}},getShaderSource:c};let{newShape:u,newPerm:d}=XF(n.dims,i),h=Ve.areEqual(d,[2,3,1]),f=Ve.areEqual(d,[3,1,2]);if(u.length===2||h||f){a=h?[u[0],u[1]*u[2]]:f?[u[0]*u[1],u[2]]:u,o=[a[1],a[0]];let p=16;return c=g=>{let b=He("a",t,a.length),_=_t("output",t,o.length);return`
  ${g.registerUniform("output_size","u32").declareVariables(b,_)}
  var<workgroup> tile : array<array<${_.type.value}, ${p+1}>, ${p}>;
  ${g.mainStart([p,p,1])}
    let stride = (uniforms.output_shape[1] - 1) / ${p} + 1;
    let workgroup_id_x = workgroup_index % stride;
    let workgroup_id_y = workgroup_index / stride;
    let input_col = workgroup_id_y * ${p}u + local_id.x;
    let input_row = workgroup_id_x * ${p}u + local_id.y;
    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {
      tile[local_id.y][local_id.x] = ${b.getByIndices(`${b.type.indices}(input_row, input_col)`)};
    }
    workgroupBarrier();

    let output_col = workgroup_id_x * ${p}u + local_id.x;
    let output_row = workgroup_id_y * ${p}u + local_id.y;
    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {
      ${_.setByIndices(`${_.type.indices}(output_row, output_col)`,"tile[local_id.x][local_id.y]")}
    }
  }`},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let g=Ve.size(s);return{outputs:[{dims:s,dataType:n.dataType}],dispatchGroup:{x:Math.ceil(o[1]/p),y:Math.ceil(o[0]/p)},programUniforms:[{type:12,data:g},...vt(a,o)]}},getShaderSource:c}}return c=p=>{let g=He("a",t,a.length),b=_t("output",t,o.length);return`
  ${p.registerUniform("output_size","u32").declareVariables(g,b)}

  ${KF(i,r,g,b)}

  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${b.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${b.setByOffset("global_idx",g.getByIndices("aIndices"))}
  }`},{name:"Transpose",shaderCache:{hint:`${e}`,inputDependencies:["rank"]},getRunData:()=>{let p=Ve.size(s);return{outputs:[{dims:s,dataType:n.dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:12,data:p},...vt(a,o)]}},getShaderSource:c}},W$=(n,e)=>{qF(n.inputs,e.perm),n.compute(hs(n.inputs[0],e.perm))},j$=n=>pn({perm:n.perm})}),QF,ZF,JF,e3,t3,n3,r3,i3,s3,a3,zs,V$,G$,q$,H$,K$,X$,Y$,Q$,Z$,J$,$V=nt(()=>{Ft(),$t(),zt(),_D(),Zl(),QF={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},ZF={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},JF={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},e3={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},t3=(n,e)=>{let t=[];for(let r=e-n;r<e;++r)t.push(r);return t},n3=(n,e)=>{let t=[],r=n.length;for(let s=0;s<r;s++)e.indexOf(s)===-1&&t.push(n[s]);let i=e.map(s=>n[s]);return[t,i]},r3=(n,e)=>{let t=n.length+e.length,r=[],i=0;for(let s=0;s<t;s++)e.indexOf(s)===-1?r.push(n[i++]):r.push(1);return r},i3=(n,e)=>{for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0},s3=(n,e)=>{let t=[];if(!i3(n,e)){for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);n.forEach(r=>t.push(r))}return t},a3=(n,e,t,r,i,s,a)=>{let o=t[0].dims,l=Ve.size(s),c=Ve.size(a),u=He("_A",t[0].dataType,o),d=_t("output",i,s),h=64;l===1&&(h=256);let f=`
          var<workgroup> aBestValues : array<f32, ${h}>;
       `,p=g=>`
        ${g.registerUniform("reduceSize","u32").declareVariables(u,d)}
        ${f}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${g.mainStart(h)}

          let outputIndex = global_idx / ${h};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${JF[r]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${h}) {
           let candidate = f32(${u.getByOffset("offset + k")});
           bestValue = ${QF[r]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${h}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${ZF[r]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${d.setByOffset("outputIndex",`${r==="mean"?`${d.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${d.type.storage}(${e3[r]})`}`)};
         }
        }`;return{name:n,shaderCache:{hint:`${e};${h}`,inputDependencies:["type"]},getShaderSource:p,getRunData:()=>({outputs:[{dims:s,dataType:i}],dispatchGroup:{x:l},programUniforms:[{type:12,data:c}]})}},zs=(n,e,t,r)=>{let i=n.inputs.length===1?t:$T(n.inputs,t),s=i.axes;s.length===0&&!i.noopWithEmptyAxes&&(s=n.inputs[0].dims.map((f,p)=>p));let a=Ve.normalizeAxes(s,n.inputs[0].dims.length),o=a,l=n.inputs[0],c=s3(o,n.inputs[0].dims.length);c.length>0&&(l=n.compute(hs(n.inputs[0],c),{inputs:[0],outputs:[-1]})[0],o=t3(o.length,l.dims.length));let[u,d]=n3(l.dims,o),h=u;i.keepDims&&(h=r3(u,a)),n.compute(a3(e,i.cacheKey,[l],r,n.inputs[0].dataType,h,d),{inputs:[l]})},V$=(n,e)=>{zs(n,"ReduceMeanShared",e,"mean")},G$=(n,e)=>{zs(n,"ReduceL1Shared",e,"l1")},q$=(n,e)=>{zs(n,"ReduceL2Shared",e,"l2")},H$=(n,e)=>{zs(n,"ReduceLogSumExpShared",e,"logSumExp")},K$=(n,e)=>{zs(n,"ReduceMaxShared",e,"max")},X$=(n,e)=>{zs(n,"ReduceMinShared",e,"min")},Y$=(n,e)=>{zs(n,"ReduceProdShared",e,"prod")},Q$=(n,e)=>{zs(n,"ReduceSumShared",e,"sum")},Z$=(n,e)=>{zs(n,"ReduceSumSquareShared",e,"sumSquare")},J$=(n,e)=>{zs(n,"ReduceLogSumShared",e,"logSum")}}),Ws,o3,Q0,$T,js,l3,c3,u3,d3,h3,f3,p3,m3,g3,_3,Vs,eN,tN,nN,rN,iN,sN,aN,oN,lN,cN,_D=nt(()=>{Ft(),$t(),Zn(),zt(),$V(),Ws=n=>{if(!n||n.length===0||n.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(n.length===2&&n[1].dims.length!==1)throw new Error("Invalid axes input dims.")},o3=n=>["","",`var value = ${n.getByIndices("input_indices")};`,""],Q0=(n,e,t,r,i,s,a=!1,o=!1)=>{let l=[],c=t[0].dims,u=c.length,d=Ve.normalizeAxes(i,u),h=!o&&d.length===0;c.forEach((g,b)=>{h||d.indexOf(b)>=0?a&&l.push(1):l.push(g)});let f=l.length,p=Ve.size(l);return{name:n,shaderCache:e,getShaderSource:g=>{let b=[],_=He("_A",t[0].dataType,u),m=_t("output",s,f),v=r(_,m,d),x=v[2];for(let w=0,T=0;w<u;w++)h||d.indexOf(w)>=0?(a&&T++,x=`for(var j${w}: u32 = 0; j${w} < ${c[w]}; j${w}++) {
                  ${v[2].includes("last_index")?`let last_index = j${w};`:""}
                  ${_.indicesSet("input_indices",w,`j${w}`)}
                  ${x}
                }`):(b.push(`${_.indicesSet("input_indices",w,m.indicesGet("output_indices",T))};`),T++);return`

        ${g.registerUniform("output_size","u32").declareVariables(_,m)}

        ${g.mainStart()}
          ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${_.type.indices};
          let output_indices = ${m.offsetToIndices("global_idx")};

          ${b.join(`
`)}
          ${v[0]}       // init ops for reduce max/min
          ${v[1]}
          ${x}
          ${v[3]}
          ${v.length===4?m.setByOffset("global_idx","value"):v.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:l,dataType:s}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:12,data:p},...vt(c,l)]})}},$T=(n,e)=>{let t=[];return n[1].dims[0]>0&&n[1].getBigInt64Array().forEach(r=>t.push(Number(r))),pn({axes:t,keepDims:e.keepDims,noopWithEmptyAxes:e.noopWithEmptyAxes})},js=(n,e,t,r)=>{let i=n.inputs,s=i.length===1?t:$T(i,t);n.compute(Q0(e,{hint:s.cacheKey,inputDependencies:["rank"]},[i[0]],s.noopWithEmptyAxes&&s.axes.length===0?o3:r,s.axes,i[0].dataType,s.keepDims,s.noopWithEmptyAxes),{inputs:[0]})},l3=(n,e)=>{Ws(n.inputs),js(n,"ReduceLogSum",e,(t,r)=>[`var value = ${r.type.storage}(0);`,"",`value += ${t.getByIndices("input_indices")};`,"value = log(value);"])},c3=(n,e)=>{Ws(n.inputs),js(n,"ReduceL1",e,(t,r)=>[`var value = ${r.type.storage}(0);`,"",`value += abs(${t.getByIndices("input_indices")});`,""])},u3=(n,e)=>{Ws(n.inputs),js(n,"ReduceL2",e,(t,r)=>[`var t = ${r.type.value}(0); var value = ${r.type.value}(0);`,"",`t = ${t.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},d3=(n,e)=>{Ws(n.inputs),js(n,"ReduceLogSumExp",e,(t,r)=>[`var value = ${r.type.storage}(0);`,"",`value += exp(${t.getByIndices("input_indices")});`,"value = log(value);"])},h3=(n,e)=>{Ws(n.inputs),js(n,"ReduceMax",e,(t,r,i)=>{let s=[];for(let a=0;a<t.rank;a++)(i.indexOf(a)>=0||i.length===0)&&s.push(t.indicesSet("input_indices",a,0));return[`${s.join(`
`)}`,`var value = ${t.getByIndices("input_indices")};`,`value = max(value, ${t.getByIndices("input_indices")});`,""]})},f3=(n,e)=>{Ws(n.inputs),js(n,"ReduceMean",e,(t,r,i)=>{let s=1;for(let a=0;a<t.rank;a++)(i.indexOf(a)>=0||i.length===0)&&(s*=n.inputs[0].dims[a]);return["var sum = f32(0);","",`sum += f32(${t.getByIndices("input_indices")});`,`let value = ${r.type.value}(sum / ${s});`]})},p3=(n,e)=>{Ws(n.inputs),js(n,"ReduceMin",e,(t,r,i)=>{let s=[];for(let a=0;a<t.rank;a++)(i.indexOf(a)>=0||i.length===0)&&s.push(`input_indices[${a}] = 0;`);return[`${s.join(`
`)}`,`var value = ${t.getByIndices("input_indices")};`,`value = min(value, ${t.getByIndices("input_indices")});`,""]})},m3=(n,e)=>{Ws(n.inputs),js(n,"ReduceProd",e,(t,r)=>[`var value = ${r.type.storage}(1);`,"",`value *= ${t.getByIndices("input_indices")};`,""])},g3=(n,e)=>{Ws(n.inputs),js(n,"ReduceSum",e,(t,r)=>[`var value = ${r.type.storage}(0);`,"",`value += ${t.getByIndices("input_indices")};`,""])},_3=(n,e)=>{Ws(n.inputs),js(n,"ReduceSumSquare",e,(t,r)=>[`var t = ${r.type.value}(0); var value = ${r.type.value}(0);`,"",`t = ${t.getByIndices("input_indices")}; value += t * t;`,""])},Vs=(n,e,t)=>{if(e.length===0)return t;let r=1,i=1;for(let s=0;s<e.length;s++)e.indexOf(s)===-1?r*=n[s]:i*=n[s];return i<32&&r>1024},eN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?f3(n,e):V$(n,e)},tN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?c3(n,e):G$(n,e)},nN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?u3(n,e):q$(n,e)},rN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?d3(n,e):H$(n,e)},iN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?h3(n,e):K$(n,e)},sN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?p3(n,e):X$(n,e)},aN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?m3(n,e):Y$(n,e)},oN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?g3(n,e):Q$(n,e)},lN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?_3(n,e):Z$(n,e)},cN=(n,e)=>{Vs(n.inputs[0].dims,e.axes,e.noopWithEmptyAxes)?l3(n,e):J$(n,e)}}),F2,uN,dN,NT,NV=nt(()=>{Ft(),Zn(),_D(),F2=n=>{if(!n||n.length===0||n.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(n[0].dataType!==1)throw new Error("Invalid input type.")},uN=(n,e)=>{F2(n.inputs);let t=(r,i,s)=>{let a=[];for(let o=0;o<r.rank;o++)(s.indexOf(o)>=0||s.length===0)&&a.push(`input_indices[${o}] = 0;`);return[`${a.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${r.getByIndices("input_indices")} ${e.selectLastIndex>0?"<=":"<"} value) {
         value = ${r.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",i.setByOffset("global_idx","best_index")]};n.compute(Q0("ArgMin",{hint:e.cacheKey,inputDependencies:["rank"]},[n.inputs[0]],t,[e.axis],7,e.keepDims),{inputs:[0]})},dN=(n,e)=>{F2(n.inputs);let t=(r,i,s)=>{let a=[];for(let o=0;o<r.rank;o++)(s.indexOf(o)>=0||s.length===0)&&a.push(`input_indices[${o}] = 0;`);return[`${a.join(`
`)}`,`var value = ${r.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${r.getByIndices("input_indices")} ${e.selectLastIndex>0?">=":">"} value) {
         value = ${r.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",i.setByOffset("global_idx","best_index")]};n.compute(Q0("argMax",{hint:e.cacheKey,inputDependencies:["rank"]},[n.inputs[0]],t,[e.axis],7,e.keepDims),{inputs:[0]})},NT=n=>pn(n)}),b3,Ty,y3,v3,w3,Km,x3,hN,bD=nt(()=>{Ft(),$t(),mD(),zt(),b3=(n,e)=>{let t=n[0],r=n[1],i=n[2],s=n[3],a=n[4],o=n[5];if(a&&o)throw new Error("Attention cannot have both past and attention_bias");if(t.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let l=t.dims[0],c=t.dims[1],u=t.dims[2];if(i.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(r.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(r.dims[0]!==u)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==r.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let d=i.dims[0]/3,h=d,f=h;if(e.qkvHiddenSizes.length>0){if(e.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let v of e.qkvHiddenSizes)if(v%e.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");d=e.qkvHiddenSizes[0],h=e.qkvHiddenSizes[1],f=e.qkvHiddenSizes[2]}let p=c;if(d!==h)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==d+h+f)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let g=0;if(a){if(h!==f)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(a.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(a.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(a.dims[1]!==l)throw new Error('Input "past" second dimension must be batch_size');if(a.dims[2]!==e.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(a.dims[4]!==h/e.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');e.pastPresentShareBuffer||(g=a.dims[3])}let b=p+g,_=-1,m=0;if(s)throw new Error("Mask not supported");if(a)throw new Error("past is not supported");if(o){if(o.dims.length!==4)throw new Error('Input "attention_bias" must have 4 dimensions');if(o.dims[0]!==l||o.dims[1]!==e.numHeads||o.dims[2]!==c||o.dims[3]!==b)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:l,sequenceLength:c,pastSequenceLength:g,kvSequenceLength:p,totalSequenceLength:b,maxSequenceLength:_,inputHiddenSize:u,hiddenSize:d,vHiddenSize:f,headSize:Math.floor(d/e.numHeads),vHeadSize:Math.floor(f/e.numHeads),numHeads:e.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:e.maskFilterValue,maskType:m,scale:e.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},Ty=(n,e,t)=>e&&n?`
      let total_sequence_length_input = u32(${e.getByOffset("0")});
      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);
      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;
      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;
      total_sequence_length = u32(${n?.getByOffset("batchIdx")}) + 1;
      var past_sequence_length: u32 = 0;
      if (is_first_prompt == false) {
        past_sequence_length = total_sequence_length - sequence_length;
      }
       `:`
    ${t?"let past_sequence_length = uniforms.past_sequence_length":""};
    let present_sequence_length = total_sequence_length;
    `,y3=(n,e,t,r,i,s,a,o)=>{let l=jn(a?1:s),c=64,u=s/l;u<c&&(c=32);let d=Math.ceil(s/l/c),h=[{type:12,data:e},{type:12,data:t},{type:12,data:r},{type:12,data:i},{type:12,data:u},{type:12,data:d}],f=Sr(n.dataType,l),p=ui(1,l),g=["type"];a&&g.push("type"),o&&g.push("type");let b=_=>{let m=_t("x",n.dataType,n.dims,l),v=[m],x=a?He("seq_lens",a.dataType,a.dims):void 0;x&&v.push(x);let w=o?He("total_sequence_length_input",o.dataType,o.dims):void 0;w&&v.push(w);let T=ui(n.dataType),E=[{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${c}>;
  var<workgroup> thread_sum: array<f32, ${c}>;
  ${_.registerUniforms(E).declareVariables(...v)}
  ${_.mainStart([c,1,1])}
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let sequence_length = uniforms.sequence_length;
    var total_sequence_length = uniforms.total_sequence_length;
    ${Ty(x,w,!1)}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = (global_idx / ${c}) * uniforms.total_sequence_length + local_offset;
    let seq_causal_length = ${a?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length"};
    var thread_max_vector = ${p}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      thread_max_vector = max(${p}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(l){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${l}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${c}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${p}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
      sum_vector += exp(${p}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(l){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${l}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${c}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        x[offset + i] = ${m.type.value}(${T}(1.0) / ${T}(seq_causal_length));
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {
        var f32input = ${p}(x[offset + i]);
        x[offset + i] = ${m.type.value}(exp(f32input - max_value) / sum);
      }
    }
      ${a?`
        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {
          x[offset + total_seq_id] = ${m.type.value}(${T}(0));
        }`:""};
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${c};${f};${l}`,inputDependencies:g},getShaderSource:b,getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:i,z:e*t},programUniforms:h})}},v3=(n,e,t,r,i,s,a,o,l)=>{let c=a+s.kvSequenceLength,u=[s.batchSize,s.numHeads,s.sequenceLength,c],d=n>1&&r,h=s.kvNumHeads?s.kvNumHeads:s.numHeads,f=d?[s.batchSize,h,c,s.headSize]:void 0,p=s.nReps?s.nReps:1,g=s.scale===0?1/Math.sqrt(s.headSize):s.scale,b=jn(s.headSize),_=s.headSize/b,m=12,v={x:Math.ceil(c/m),y:Math.ceil(s.sequenceLength/m),z:s.batchSize*s.numHeads},x=[{type:12,data:s.sequenceLength},{type:12,data:_},{type:12,data:c},{type:12,data:s.numHeads},{type:12,data:s.headSize},{type:1,data:g},{type:12,data:a},{type:12,data:s.kvSequenceLength},{type:12,data:p}],w=d&&r&&Ve.size(r.dims)>0,T=["type","type"];w&&T.push("type"),i&&T.push("type"),o&&T.push("type"),l&&T.push("type");let E=[{dims:u,dataType:e.dataType,gpuDataType:0}];d&&E.push({dims:f,dataType:e.dataType,gpuDataType:0});let A=M=>{let F=He("q",e.dataType,e.dims,b),G=He("key",t.dataType,t.dims,b),S=[F,G];if(w){let V=He("past_key",r.dataType,r.dims,b);S.push(V)}i&&S.push(He("attention_bias",i.dataType,i.dims));let I=o?He("seq_lens",o.dataType,o.dims):void 0;I&&S.push(I);let C=l?He("total_sequence_length_input",l.dataType,l.dims):void 0;C&&S.push(C);let H=_t("output",e.dataType,u),B=[H];d&&B.push(_t("present_key",e.dataType,f,b));let $=ui(1,b),X=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${m}u;

  var<workgroup> tileQ: array<${F.type.storage}, ${m*m}>;
  var<workgroup> tileK: array<${F.type.storage}, ${m*m}>;
  ${M.registerUniforms(X).declareVariables(...S,...B)}
  ${M.mainStart([m,m,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z % uniforms.num_heads;
    let kvHeadIdx = ${p===1?"headIdx":"headIdx / uniforms.n_reps"};
    let kv_num_heads = ${p===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
    let batchIdx = workgroup_id.z / uniforms.num_heads;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let sequence_length = uniforms.M;
    var total_sequence_length = uniforms.N;
    ${Ty(I,C,!0)}
    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;
    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
    ${w&&d?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":""};
    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;
    ${d?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":""}
    var value = ${$}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
      ${w&&d?`
              if (n + local_id.y < past_sequence_length) {
                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];
              }`:`
          if (n + local_id.y < uniforms.kv_sequence_length) {
            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];
          }`}
      ${d?`if (n + local_id.y < present_sequence_length) {
        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];
      }`:""}
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
          value += ${$}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {
      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(b){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${b}`)}})()};
        output[outputIdx] = ${H.type.value} (sum * uniforms.alpha) + ${i?"attention_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${b};${i!==void 0};${r!==void 0};${n}`,inputDependencies:T},getRunData:()=>({outputs:E,dispatchGroup:v,programUniforms:x}),getShaderSource:A}},w3=(n,e,t,r,i,s,a=void 0,o=void 0)=>{let l=s+i.kvSequenceLength,c=i.nReps?i.nReps:1,u=i.vHiddenSize*c,d=n>1&&r,h=i.kvNumHeads?i.kvNumHeads:i.numHeads,f=d?[i.batchSize,h,l,i.headSize]:void 0,p=[i.batchSize,i.sequenceLength,u],g=12,b={x:Math.ceil(i.vHeadSize/g),y:Math.ceil(i.sequenceLength/g),z:i.batchSize*i.numHeads},_=[{type:12,data:i.sequenceLength},{type:12,data:l},{type:12,data:i.vHeadSize},{type:12,data:i.numHeads},{type:12,data:i.headSize},{type:12,data:u},{type:12,data:s},{type:12,data:i.kvSequenceLength},{type:12,data:c}],m=d&&r&&Ve.size(r.dims)>0,v=["type","type"];m&&v.push("type"),a&&v.push("type"),o&&v.push("type");let x=[{dims:p,dataType:e.dataType,gpuDataType:0}];d&&x.push({dims:f,dataType:e.dataType,gpuDataType:0});let w=T=>{let E=He("probs",e.dataType,e.dims),A=He("v",t.dataType,t.dims),M=[E,A];m&&M.push(He("past_value",r.dataType,r.dims));let F=a?He("seq_lens",a.dataType,a.dims):void 0;a&&M.push(F);let G=o?He("total_sequence_length_input",o.dataType,o.dims):void 0;o&&M.push(G);let S=[_t("output",e.dataType,p)];d&&S.push(_t("present_value",e.dataType,f));let I=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}];return`
  const TILE_SIZE = ${g}u;
  var<workgroup> tileQ: array<${E.type.value}, ${g*g}>;
  var<workgroup> tileV: array<${E.type.value}, ${g*g}>;
  ${T.registerUniforms(I).declareVariables(...M,...S)}
  ${T.mainStart([g,g,1])}
   let headIdx = workgroup_id.z % uniforms.num_heads;
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let kvHeadIdx = ${c===1?"headIdx":"headIdx / uniforms.n_reps"};
   let kv_num_heads = ${c===1?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps"};
   let m = global_id.y;
   let n = global_id.x;
   let sequence_length = uniforms.M;
   var total_sequence_length = uniforms.K;
   ${Ty(F,G,!0)}
   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;
   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch
   ${m&&d?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":""};
   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;
   ${d?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":""}
   var value = ${E.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        var idx = TILE_SIZE * local_id.y + local_id.x;
        ${m&&d?`
        if (w + local_id.y < past_sequence_length) {
          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];
        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {
          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];
        }
      `:`
            if (w + local_id.y < uniforms.kv_sequence_length) {
              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];
            }`}
        ${d?`
            if (w + local_id.y < present_sequence_length) {
          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];
        }`:""}
      }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + headIdx * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`};return{name:"AttentionScore",shaderCache:{hint:`${r!==void 0};${n}`,inputDependencies:v},getRunData:()=>({outputs:x,dispatchGroup:b,programUniforms:_}),getShaderSource:w}},Km=(n,e,t,r,i,s,a,o,l,c,u=void 0,d=void 0)=>{let h=Math.min(n.outputCount,1+(a?1:0)+(o?1:0)),f=h>1?c.pastSequenceLength:0,p=f+c.kvSequenceLength,g=l&&Ve.size(l.dims)>0?l:void 0,b=[e,t];h>1&&a&&Ve.size(a.dims)>0&&b.push(a),g&&b.push(g),u&&b.push(u),d&&b.push(d);let _=n.compute(v3(h,e,t,a,g,c,f,u,d),{inputs:b,outputs:h>1?[-1,1]:[-1]})[0];n.compute(y3(_,c.batchSize,c.numHeads,f,c.sequenceLength,p,u,d),{inputs:u&&d?[_,u,d]:[_],outputs:[]});let m=[_,r];h>1&&o&&Ve.size(o.dims)>0&&m.push(o),u&&m.push(u),d&&m.push(d),n.compute(w3(h,_,r,o,c,f,u,d),{inputs:m,outputs:h>1?[0,2]:[0]})},x3=(n,e)=>{let t=[e.batchSize,e.numHeads,e.sequenceLength,e.headSize],r=e.sequenceLength,i=e.inputHiddenSize,s=e.headSize,a=12,o={x:Math.ceil(e.headSize/a),y:Math.ceil(e.sequenceLength/a),z:e.batchSize*e.numHeads},l=[n.inputs[0],n.inputs[1],n.inputs[2]],c=[{type:12,data:r},{type:12,data:i},{type:12,data:s},{type:12,data:e.numHeads},{type:12,data:e.headSize},{type:12,data:e.hiddenSize},{type:12,data:e.hiddenSize+e.hiddenSize+e.vHiddenSize}],u=d=>{let h=_t("output_q",l[0].dataType,t),f=_t("output_k",l[0].dataType,t),p=_t("output_v",l[0].dataType,t),g=He("input",l[0].dataType,l[0].dims),b=He("weight",l[1].dataType,l[1].dims),_=He("bias",l[2].dataType,l[2].dims),m=g.type.storage,v=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${a}u;
  var<workgroup> tileInput: array<${m}, ${a*a}>;
  var<workgroup> tileWeightQ: array<${m}, ${a*a}>;
  var<workgroup> tileWeightK: array<${m}, ${a*a}>;
  var<workgroup> tileWeightV: array<${m}, ${a*a}>;
  ${d.registerUniforms(v).declareVariables(g,b,_,h,f,p)}
  ${d.mainStart([a,a,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${m}(0);
    var valueK = ${m}(0);
    var valueV = ${m}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return n.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:t,dataType:n.inputs[0].dataType,gpuDataType:0},{dims:t,dataType:n.inputs[0].dataType,gpuDataType:0},{dims:t,dataType:n.inputs[0].dataType,gpuDataType:0}],dispatchGroup:o,programUniforms:c}),getShaderSource:u},{inputs:l,outputs:[-1,-1,-1]})},hN=(n,e)=>{let t=b3(n.inputs,e),[r,i,s]=x3(n,t);return Km(n,r,i,s,n.inputs[4],void 0,void 0,void 0,n.inputs[5],t)}}),T3,E3,D3,fN,zV=nt(()=>{pa(),Ft(),$t(),Zn(),zt(),T3=(n,e)=>{if(!n||n.length!==5)throw new Error("BatchNormalization requires 5 inputs");let t=(r,i,s)=>{let a=i.length;if(a!==r.length)throw new Error(`${s}: num dimensions != ${a}`);i.forEach((o,l)=>{if(o!==r[l])throw new Error(`${s}: dim[${l}] do not match`)})};if(n[0].dims.length>1){let r=e.format==="NHWC"?e.spatial?n[0].dims.slice(-1):n[0].dims.slice(-1).concat(n[0].dims.slice(1,n[0].dims.length-1)):n[0].dims.slice(1,e.spatial?2:void 0);t(n[1].dims,r,"Invalid input scale"),t(n[2].dims,r,"Invalid input B"),t(n[3].dims,r,"Invalid input mean"),t(n[4].dims,r,"Invalid input var")}else t(n[1].dims,[1],"Invalid input scale"),t(n[2].dims,[1],"Invalid input B"),t(n[3].dims,[1],"Invalid input mean"),t(n[4].dims,[1],"Invalid input var")},E3=(n,e)=>{let{epsilon:t,spatial:r,format:i}=e,s=n[0].dims,a=r?jn(s[s.length-1]):1,o=i==="NHWC"&&s.length>1?a:1,l=Ve.size(s)/a,c=r,u=c?s.length:s,d=He("x",n[0].dataType,n[0].dims,a),h=He("scale",n[1].dataType,n[1].dims,o),f=He("bias",n[2].dataType,n[2].dims,o),p=He("inputMean",n[3].dataType,n[3].dims,o),g=He("inputVar",n[4].dataType,n[4].dims,o),b=_t("y",n[0].dataType,u,a),_=()=>{let v="";if(r)v=`let cOffset = ${s.length===1?"0u":i==="NHWC"?`outputIndices[${s.length-1}] / ${a}`:"outputIndices[1]"};`;else if(i==="NCHW")v=`
            ${b.indicesSet("outputIndices","0","0")}
            let cOffset = ${b.indicesToOffset("outputIndices")};`;else{v=`var cIndices = ${h.type.indices}(0);
                       cIndices[0] = outputIndices[${s.length-1}];`;for(let x=1;x<h.rank;x++)v+=`cIndices[${x}] = outputIndices[${x}];`;v+=`let cOffset = ${h.indicesToOffset("cIndices")};`}return v},m=v=>`
  const epsilon = ${t};
  ${v.registerUniform("outputSize","u32").declareVariables(d,h,f,p,g,b)}
  ${v.mainStart()}
  ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${b.offsetToIndices(`global_idx * ${a}`)};
    ${_()}
    let scale = ${h.getByOffset("cOffset")};
    let bias = ${f.getByOffset("cOffset")};
    let inputMean = ${p.getByOffset("cOffset")};
    let inputVar = ${g.getByOffset("cOffset")};
    let x = ${d.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${b.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${e.epsilon}_${e.format}_${r}_${a}`,inputDependencies:c?["rank","type","type","type","type"]:void 0},getShaderSource:m,getRunData:()=>({outputs:[{dims:n[0].dims,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c?[{type:12,data:l},...vt(s)]:[{type:12,data:l}]})}},D3=n=>pn(n),fN=(n,e)=>{let{inputs:t,outputCount:r}=n,i=D3({...e,outputCount:r});if(In.webgpu.validateInputContent&&T3(t,i),e.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");n.compute(E3(t,i))}}),M3,A3,pN,WV=nt(()=>{$t(),zt(),M3=n=>{if(n[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(n[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(n[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(n[0].dims[2]!==n[1].dims[0])throw new Error("last dimension of input and bias are not the same")},A3=n=>{let e=n[0].dims,t=n[0].dims[2],r=Ve.size(e)/4,i=n[0].dataType,s=He("input",i,e,4),a=He("bias",i,[t],4),o=He("residual",i,e,4),l=_t("output",i,e,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:e,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(r/64)}}),getShaderSource:c=>`
  const channels = ${t}u / 4;
  ${c.declareVariables(s,a,o,l)}

  ${c.mainStart()}
    ${c.guardAgainstOutOfBoundsWorkgroupSizes(r)}
    let value = ${s.getByOffset("global_idx")}
      + ${a.getByOffset("global_idx % channels")} + ${o.getByOffset("global_idx")};
    ${l.setByOffset("global_idx","value")}
  }`}},pN=n=>{M3(n.inputs),n.compute(A3(n.inputs))}}),C3,on,mN,gN,_N,bN,yN,vN,wN,xN,TN,S3,EN,DN,MN,AN,km,CN,k0,SN,PN,kN,FN,IN,ON,UN,LN,RN,BN,$N,NN,zN,WN,jN,VN,I2,GN,zT,WT,qN,HN,KN,P3,k3,XN,yD=nt(()=>{Ft(),$t(),Zn(),zt(),C3=(n,e,t,r,i,s,a)=>{let o=Math.ceil(e/4),l="";typeof i=="string"?l=`${i}(a)`:l=i("a");let c=He("inputData",t,[o],4),u=_t("outputData",r,[o],4),d=[{name:"vec_size",type:"u32"}];return a&&d.push(...a),`
      ${n.registerUniforms(d).declareVariables(c,u)}

  ${s??""}

  ${n.mainStart()}
    ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${c.getByOffset("global_idx")};
    ${u.setByOffset("global_idx",l)}
  }`},on=(n,e,t,r,i,s=n.dataType,a,o)=>{let l=[{type:12,data:Math.ceil(Ve.size(n.dims)/4)}];return a&&l.push(...a),{name:e,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:c=>C3(c,Ve.size(n.dims),n.dataType,s,t,r,o),getRunData:c=>({outputs:[{dims:n.dims,dataType:s}],dispatchGroup:{x:Math.ceil(Ve.size(c[0].dims)/64/4)},programUniforms:l})}},mN=n=>{n.compute(on(n.inputs[0],"Abs","abs"))},gN=n=>{n.compute(on(n.inputs[0],"Acos","acos"))},_N=n=>{n.compute(on(n.inputs[0],"Acosh","acosh"))},bN=n=>{n.compute(on(n.inputs[0],"Asin","asin"))},yN=n=>{n.compute(on(n.inputs[0],"Asinh","asinh"))},vN=n=>{n.compute(on(n.inputs[0],"Atan","atan"))},wN=n=>{n.compute(on(n.inputs[0],"Atanh","atanh"))},xN=n=>pn(n),TN=(n,e)=>{let t;switch(e.to){case 10:t="vec4<f16>";break;case 1:t="vec4<f32>";break;case 12:t="vec4<u32>";break;case 6:t="vec4<i32>";break;case 9:t="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${e.to}`)}n.compute(on(n.inputs[0],"Cast",t,void 0,e.cacheKey,e.to))},S3=n=>{let e,t,r=n.length>=2&&n[1].data!==0,i=n.length>=3&&n[2].data!==0;switch(n[0].dataType){case 1:e=r?n[1].getFloat32Array()[0]:-34028234663852886e22,t=i?n[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:e=r?n[1].getUint16Array()[0]:64511,t=i?n[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return pn({min:e,max:t})},EN=(n,e)=>{let t=e||S3(n.inputs),r=ui(n.inputs[0].dataType);n.compute(on(n.inputs[0],"Clip",i=>`clamp(${i}, vec4<${r}>(uniforms.min), vec4<${r}>(uniforms.max))`,void 0,t.cacheKey,void 0,[{type:n.inputs[0].dataType,data:t.min},{type:n.inputs[0].dataType,data:t.max}],[{name:"min",type:r},{name:"max",type:r}]),{inputs:[0]})},DN=n=>{n.compute(on(n.inputs[0],"Ceil","ceil"))},MN=n=>{n.compute(on(n.inputs[0],"Cos","cos"))},AN=n=>{n.compute(on(n.inputs[0],"Cosh","cosh"))},km=n=>pn(n),CN=(n,e)=>{let t=ui(n.inputs[0].dataType);n.compute(on(n.inputs[0],"Elu",r=>`elu_vf32(${r})`,`
  const elu_alpha_ = ${t}(${e.alpha});

  fn elu_f32(a: ${t}) -> ${t} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${t}>) -> vec4<${t}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,e.cacheKey))},k0=(n="f32")=>`
const r0: ${n} = 0.3275911;
const r1: ${n} = 0.254829592;
const r2: ${n} = -0.284496736;
const r3: ${n} = 1.421413741;
const r4: ${n} = -1.453152027;
const r5: ${n} = 1.061405429;

fn erf_vf32(v: vec4<${n}>) -> vec4<${n}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,SN=n=>{let e=ui(n.inputs[0].dataType);n.compute(on(n.inputs[0],"Erf",t=>`erf_vf32(${t})`,k0(e)))},PN=n=>{n.compute(on(n.inputs[0],"Exp","exp"))},kN=n=>{n.compute(on(n.inputs[0],"Floor","floor"))},FN=n=>{let e=ui(n.inputs[0].dataType);n.compute(on(n.inputs[0],"Gelu",t=>`0.5 * ${t} * (1.0 + erf_vf32(${t} * 0.7071067811865475))`,k0(e)))},IN=(n,e)=>{let t=ui(n.inputs[0].dataType);n.compute(on(n.inputs[0],"LeakyRelu",r=>`select(leaky_relu_alpha_ * ${r}, ${r}, ${r} >= vec4<${t}>(0.0))`,`const leaky_relu_alpha_ = ${t}(${e.alpha});`,e.cacheKey))},ON=n=>{n.compute(on(n.inputs[0],"Not",e=>`!${e}`))},UN=n=>{n.compute(on(n.inputs[0],"Neg",e=>`-${e}`))},LN=n=>{n.compute(on(n.inputs[0],"Reciprocal",e=>`1.0/${e}`))},RN=n=>{let e=ui(n.inputs[0].dataType);n.compute(on(n.inputs[0],"Relu",t=>`select(vec4<${e}>(0.0), ${t}, ${t} > vec4<${e}>(0.0))`))},BN=n=>{n.compute(on(n.inputs[0],"Sigmoid",e=>`(1.0 / (1.0 + exp(-${e})))`))},$N=n=>pn(n),NN=(n,e)=>{let t=ui(n.inputs[0].dataType);n.compute(on(n.inputs[0],"HardSigmoid",r=>`max(vec4<${t}>(0.0), min(vec4<${t}>(1.0), ${e.alpha} * ${r} + vec4<${t}>(${e.beta})))`,void 0,e.cacheKey))},zN=n=>{n.compute(on(n.inputs[0],"Sin","sin"))},WN=n=>{n.compute(on(n.inputs[0],"Sinh","sinh"))},jN=n=>{n.compute(on(n.inputs[0],"Sqrt","sqrt"))},VN=n=>{n.compute(on(n.inputs[0],"Tan","tan"))},I2=n=>`sign(${n}) * (1 - exp(-2 * abs(${n}))) / (1 + exp(-2 * abs(${n})))`,GN=n=>{n.compute(on(n.inputs[0],"Tanh",I2))},zT=(n="f32")=>`
const fast_gelu_a: ${n} = 0.5;
const fast_gelu_b: ${n} = 0.7978845608028654;
const fast_gelu_c: ${n} = 0.035677408136300125;

fn tanh_v(v: vec4<${n}>) -> vec4<${n}> {
  return ${I2("v")};
}
`,WT=n=>`(fast_gelu_a + fast_gelu_a * tanh_v(${n} * (fast_gelu_c * ${n} * ${n} + fast_gelu_b))) * ${n}`,qN=n=>{let e=ui(n.inputs[0].dataType);n.compute(on(n.inputs[0],"FastGelu",WT,zT(e),void 0,n.inputs[0].dataType))},HN=(n,e)=>{let t=ui(n.inputs[0].dataType);return n.compute(on(n.inputs[0],"ThresholdedRelu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${t}>(${e.alpha});`,e.cacheKey)),0},KN=n=>{n.compute(on(n.inputs[0],"Log","log"))},P3=(n,e)=>`
const alpha = vec4<${n}>(${e});
const one = ${n}(1.0);
const zero = ${n}(0.0);

fn quick_gelu_impl(x: vec4<${n}>) -> vec4<${n}> {
  let v = x *alpha;
  var x1 : vec4<${n}>;
  for (var i = 0; i < 4; i = i + 1) {
    if (v[i] >= zero) {
      x1[i] = one / (one + exp(-v[i]));
    } else {
      x1[i] = one - one / (one + exp(v[i]));
    }
  }
  return x * x1;
}
`,k3=n=>`quick_gelu_impl(${n})`,XN=(n,e)=>{let t=ui(n.inputs[0].dataType);n.compute(on(n.inputs[0],"QuickGelu",k3,P3(t,e.alpha),e.cacheKey,n.inputs[0].dataType))}}),F3,I3,YN,jV=nt(()=>{$t(),zt(),yD(),F3=n=>{if(n[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(n[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(n[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(n[0].dims[2]!==n[1].dims[0])throw new Error("last dimension of input and bias are not the same")},I3=n=>{let e=n[0].dims.slice();e[2]=e[2]/2;let t=He("input",n[0].dataType,n[0].dims,4),r=He("bias",n[0].dataType,[n[0].dims[2]],4),i=_t("output",n[0].dataType,e,4),s=Ve.size(e)/4,a=Sr(n[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:e,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)}}),getShaderSource:o=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${n[0].dims[2]/4/2}u;

  ${o.declareVariables(t,r,i)}

  ${k0(a)}

  ${o.mainStart()}
    ${o.guardAgainstOutOfBoundsWorkgroupSizes(s)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${i.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},YN=n=>{F3(n.inputs),n.compute(I3(n.inputs))}}),O3,U3,Gs,QN,ZN,JN,e4,t4,n4,r4,i4,s4,a4,VV=nt(()=>{Ft(),$t(),zt(),O3=(n,e,t,r,i,s,a,o,l,c,u,d)=>{let h,f;typeof o=="string"?h=f=(m,v)=>`${o}((${m}),(${v}))`:typeof o=="function"?h=f=o:(h=o.scalar,f=o.vector);let p=_t("outputData",u,r.length,4),g=He("aData",l,e.length,4),b=He("bData",c,t.length,4),_;if(i)if(s){let m=Ve.size(e)===1,v=Ve.size(t)===1,x=e.length>0&&e[e.length-1]%4===0,w=t.length>0&&t[t.length-1]%4===0;m||v?_=p.setByOffset("global_idx",f(m?`${g.type.value}(${g.getByOffset("0")}.x)`:g.getByOffset("global_idx"),v?`${b.type.value}(${b.getByOffset("0")}.x)`:b.getByOffset("global_idx"))):_=`
            let outputIndices = ${p.offsetToIndices("global_idx * 4u")};
            let offsetA = ${g.broadcastedIndicesToOffset("outputIndices",p)};
            let offsetB = ${b.broadcastedIndicesToOffset("outputIndices",p)};
            ${p.setByOffset("global_idx",f(a||x?g.getByOffset("offsetA / 4u"):`${g.type.value}(${g.getByOffset("offsetA / 4u")}[offsetA % 4u])`,a||w?b.getByOffset("offsetB / 4u"):`${b.type.value}(${b.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else _=p.setByOffset("global_idx",f(g.getByOffset("global_idx"),b.getByOffset("global_idx")));else{if(!s)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let m=(v,x,w="")=>{let T=`aData[indexA${x}][componentA${x}]`,E=`bData[indexB${x}][componentB${x}]`;return`
            let outputIndices${x} = ${p.offsetToIndices(`global_idx * 4u + ${x}u`)};
            let offsetA${x} = ${g.broadcastedIndicesToOffset(`outputIndices${x}`,p)};
            let offsetB${x} = ${b.broadcastedIndicesToOffset(`outputIndices${x}`,p)};
            let indexA${x} = offsetA${x} / 4u;
            let indexB${x} = offsetB${x} / 4u;
            let componentA${x} = offsetA${x} % 4u;
            let componentB${x} = offsetB${x} % 4u;
            ${v}[${x}] = ${w}(${h(T,E)});
          `};u===9?_=`
            var data = vec4<u32>(0);
            ${m("data",0,"u32")}
            ${m("data",1,"u32")}
            ${m("data",2,"u32")}
            ${m("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:_=`
            ${m("outputData[global_idx]",0)}
            ${m("outputData[global_idx]",1)}
            ${m("outputData[global_idx]",2)}
            ${m("outputData[global_idx]",3)}
          `}return`
        ${n.registerUniform("vec_size","u32").declareVariables(g,b,p)}

        ${d??""}

        ${n.mainStart()}
        ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${_}
      }`},U3=(n,e,t,r,i,s,a=t.dataType)=>{let o=t.dims.map(g=>Number(g)??1),l=r.dims.map(g=>Number(g)??1),c=!Ve.areEqual(o,l),u=o,d=Ve.size(o),h=!1,f=!1,p=[c];if(c){let g=gf.calcShape(o,l,!1);if(!g)throw new Error("Can't perform binary op on the given tensors");u=g.slice(),d=Ve.size(u);let b=Ve.size(o)===1,_=Ve.size(l)===1,m=o.length>0&&o[o.length-1]%4===0,v=l.length>0&&l[l.length-1]%4===0;p.push(b),p.push(_),p.push(m),p.push(v);let x=1;for(let w=1;w<u.length;w++){let T=o[o.length-w],E=l[l.length-w];if(T===E)x*=T;else break}x%4===0?(f=!0,h=!0):(b||_||m||v)&&(h=!0)}else h=!0;return p.push(h),{name:n,shaderCache:{hint:e+p.map(g=>g.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:g=>O3(g,o,l,u,h,c,f,i,t.dataType,r.dataType,a,s),getRunData:()=>({outputs:[{dims:u,dataType:a}],dispatchGroup:{x:Math.ceil(d/64/4)},programUniforms:[{type:12,data:Math.ceil(Ve.size(u)/4)},...vt(o,l,u)]})}},Gs=(n,e,t,r,i,s)=>{n.compute(U3(e,i??"",n.inputs[0],n.inputs[1],t,r,s))},QN=n=>{Gs(n,"Add",(e,t)=>`${e}+${t}`)},ZN=n=>{Gs(n,"Div",(e,t)=>`${e}/${t}`)},JN=n=>{Gs(n,"Equal",{scalar:(e,t)=>`u32(${e}==${t})`,vector:(e,t)=>`vec4<u32>(${e}==${t})`},void 0,void 0,9)},e4=n=>{Gs(n,"Mul",(e,t)=>`${e}*${t}`)},t4=n=>{let e=He("input",n.inputs[0].dataType,n.inputs[0].dims).type.value;Gs(n,"Pow",{scalar:(t,r)=>`pow_custom(${t},${r})`,vector:(t,r)=>`pow_vector_custom(${t},${r})`},`
    fn pow_custom(a : ${e}, b : ${e}) -> ${e} {
      if (b == ${e}(0.0)) {
        return ${e}(1.0);
      } else if (a < ${e}(0.0) && f32(b) != floor(f32(b))) {
        return ${e}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${e}(1.0), round(f32(abs(b) % ${e}(2.0))) != 1.0) * ${e}(${e==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${e}>, b : vec4<${e}>) -> vec4<${e}> {
      // TODO: implement vectorized pow
      return vec4<${e}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},n4=n=>{Gs(n,"Sub",(e,t)=>`${e}-${t}`)},r4=n=>{Gs(n,"Greater",{scalar:(e,t)=>`u32(${e}>${t})`,vector:(e,t)=>`vec4<u32>(${e}>${t})`},void 0,void 0,9)},i4=n=>{Gs(n,"Less",{scalar:(e,t)=>`u32(${e}<${t})`,vector:(e,t)=>`vec4<u32>(${e}<${t})`},void 0,void 0,9)},s4=n=>{Gs(n,"GreaterOrEqual",{scalar:(e,t)=>`u32(${e}>=${t})`,vector:(e,t)=>`vec4<u32>(${e}>=${t})`},void 0,void 0,9)},a4=n=>{Gs(n,"LessOrEqual",{scalar:(e,t)=>`u32(${e}<=${t})`,vector:(e,t)=>`vec4<u32>(${e}<=${t})`},void 0,void 0,9)}}),L3,R3,B3,$3,o4,l4,GV=nt(()=>{Ft(),$t(),Zn(),zt(),L3=(n,e)=>{if(!n||n.length<1)throw new Error("too few inputs");let t=0,r=n[t],i=r.dataType,s=r.dims.length;n.forEach((a,o)=>{if(o!==t){if(a.dataType!==i)throw new Error("input tensors should be one type");if(a.dims.length!==s)throw new Error("input tensors should have the same shape");a.dims.forEach((l,c)=>{if(c!==e&&l!==r.dims[c])throw new Error("non concat dimensions must match")})}})},R3=(n,e)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${n}u>(${e});
    for (var i: u32 = 0u; i < ${n}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${n}u;
  }`,B3=(n,e)=>{let t=n.length,r=[];for(let i=0;i<t;++i){let s=e.setByOffset("global_idx",n[i].getByIndices("indices"));t===1?r.push(s):i===0?r.push(`if (inputIndex == ${i}u) { ${s} }`):i===t-1?r.push(`else { ${s} }`):r.push(`else if (inputIndex == ${i}) { ${s} }`)}return r.join(`
`)},$3=(n,e,t,r)=>{let i=Ve.size(t),s=new Array(n.length),a=new Array(n.length),o=0,l=[],c=[],u=[{type:12,data:i}];for(let g=0;g<n.length;++g)o+=n[g].dims[e],s[g]=o,c.push(n[g].dims.length),a[g]=He(`input${g}`,r,c[g]),l.push("rank"),u.push({type:12,data:s[g]});for(let g=0;g<n.length;++g)u.push(...vt(n[g].dims));u.push(...vt(t));let d=_t("output",r,t.length),h=d.indicesGet("indices",e),f=Array.from(Array(s.length).keys()).map(g=>`uniforms.sizeInConcatAxis${g}`).join(","),p=g=>`

  ${(()=>{g.registerUniform("outputSize","u32");for(let b=0;b<n.length;b++)g.registerUniform(`sizeInConcatAxis${b}`,"u32");return g.declareVariables(...a,d)})()}

  ${R3(s.length,f)}

  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${d.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${h});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${s.length}u>(${f});
      ${h} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${B3(a,d)}
  }`;return{name:"Concat",shaderCache:{hint:`${e}`,inputDependencies:l},getRunData:()=>({outputs:[{dims:t,dataType:r}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:u}),getShaderSource:p}},o4=(n,e)=>{let t=n.inputs,r=t[0].dims,i=Ve.normalizeAxis(e.axis,r.length);L3(t,i);let s=r.slice();s[i]=t.reduce((o,l)=>o+(l.dims.length>i?l.dims[i]:0),0);let a=t.filter(o=>Ve.size(o.dims)>0);n.compute($3(a,i,s,t[0].dataType),{inputs:a})},l4=n=>pn({axis:n.axis})}),Hu,Ku,Xu,vD,id=nt(()=>{Ft(),$t(),Hu=(n,e,t="f32")=>{switch(n.activation){case"Relu":return`value = max(value, ${e}(0.0));`;case"Sigmoid":return`value = (${e}(1.0) / (${e}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${e}(${t}(uniforms.clip_min)), ${e}(${t}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${e}(0.0), min(${e}(1.0), ${t}(uniforms.alpha) * value + ${t}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${t}(uniforms.alpha) * value, value, value >= ${e}(0.0));`;case"Tanh":return`let e2x = exp(-2.0 * abs(value));
              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);
        `;case"":return"";default:throw new Error(`Unsupported activation ${n.activation}`)}},Ku=(n,e)=>{n.activation==="Clip"?e.push({type:1,data:n.clipMax},{type:1,data:n.clipMin}):n.activation==="HardSigmoid"?e.push({type:1,data:n.alpha},{type:1,data:n.beta}):n.activation==="LeakyRelu"&&e.push({type:1,data:n.alpha})},Xu=(n,e)=>{n.activation==="Clip"?e.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):n.activation==="HardSigmoid"?e.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):n.activation==="LeakyRelu"&&e.push({name:"alpha",type:"f32"})},vD=n=>{let e=n?.activation||"";if(e==="HardSigmoid"){let[t,r]=n?.activation_params||[.2,.5];return{activation:e,alpha:t,beta:r}}else if(e==="Clip"){let[t,r]=n?.activation_params||[B$,$$];return{activation:e,clipMax:r,clipMin:t}}else if(e==="LeakyRelu"){let[t]=n?.activation_params||[.01];return{activation:e,alpha:t}}return{activation:e}}}),zr,c4,wD=nt(()=>{zr=(n,e)=>{switch(n){case 1:return e;case 2:return`vec2<${e}>`;case 3:return`vec3<${e}>`;case 4:return`vec4<${e}>`;default:throw new Error(`${n}-component is not supported.`)}},c4=n=>`
      ${n?"value = value + getBiasByOutputCoords(coords);":""}
      `}),u4,qV=nt(()=>{u4=n=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${n}.x), i32(${n}.y), i32(${n}.z), 1));
}
`}),Um,xD,TD=nt(()=>{Ft(),$t(),zt(),id(),Um=(n,e,t,r,i)=>{let s=r-t;return`
      ${Array.from({length:t}).map((a,o)=>`
      if (${yt(e.shape,o,e.rank)} != 1) {
        ${e.indicesSet(n,o,yt(i,o+s,r))}
      } else {
        ${e.indicesSet(n,o,0)}
      }`).join("")}
`},xD=(n,e,t,r,i=!1,s)=>{let a=n[0].dims,o=n[1].dims,l=a[a.length-2],c=o[o.length-1],u=a[a.length-1],d=jn(c),h=jn(u),f=jn(l),p=Ve.size(t)/d/f,g=n.length>2,b=r?r.slice(0,-2):t.slice(0,-2),_=[Ve.size(b),l,c],m=[{type:12,data:p},{type:12,data:l},{type:12,data:c},{type:12,data:u}];Ku(e,m),m.push(...vt(b,a,o)),g&&m.push(...vt(n[2].dims)),m.push(...vt(_));let v=x=>{let w=gD("batch_dims",n[0].dataType,b.length),T=He("a",n[0].dataType,a.length,h),E=He("b",n[1].dataType,o.length,d),A=_t("output",n[0].dataType,_.length,d),M=Sr(A.type.tensor),F=Hu(e,A.type.value,M),G=[T,E],S="";if(g){let H=i?d:1;G.push(He("bias",n[2].dataType,n[2].dims.length,H)),S=`${i?`value += bias[col / ${H}];`:`value += ${A.type.value}(bias[row + i]);`}`}let I=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];Xu(e,I);let C=()=>{let H=`var a_data: ${T.type.value};`;for(let B=0;B<h;B++)H+=`
              let b_data${B} = b[(b_offset + (k + ${B}) * uniforms.N + col) / ${d}];`;for(let B=0;B<f;B++){H+=`a_data = a[(a_offset + (row + ${B}) * uniforms.K + k) / ${h}];`;for(let $=0;$<h;$++)H+=`
            values[${B}] = fma(${E.type.value}(a_data${h===1?"":`[${$}]`}), b_data${$}, values[${B}]);
`}return H};return`
  ${x.registerUniforms(I).registerInternalVariables(w).declareVariables(...G,A)}
  ${x.mainStart()}
    ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${d})) * ${d};
    var index1 = global_idx / (uniforms.N / ${d});
    let stride1 = uniforms.M / ${f};
    let row = (index1 % stride1) * ${f};
    let batch = index1 / stride1;

    ${t.length===2?"":`let batch_indices = ${w.offsetToIndices("batch")};`}

    var a_indices: ${T.type.indices};
    ${Um("a_indices",T,T.rank-2,w.rank,"batch_indices")}
    ${T.indicesSet("a_indices",T.rank-2,0)}
    ${T.indicesSet("a_indices",T.rank-1,0)}
    let a_offset = ${T.indicesToOffset("a_indices")};

    var b_indices: ${E.type.indices};
    ${Um("b_indices",E,E.rank-2,w.rank,"batch_indices")}
    ${E.indicesSet("b_indices",E.rank-2,0)}
    ${E.indicesSet("b_indices",E.rank-1,0)}
    let b_offset = ${E.indicesToOffset("b_indices")};
    var values: array<${A.type.value}, ${f}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${h}) {
      ${C()}
    }
    for (var i = 0u; i < ${f}u; i++) {
      var value = values[i];
      ${S}
      ${F}
      let cur_indices = ${A.type.indices}(batch, row + i, col);
      let offset = ${A.indicesToOffset("cur_indices")};
      ${A.setByOffset(`offset / ${d}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${e.activation};${d};${h};${f};${i}`,inputDependencies:g?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:s?s(t):t,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:m}),getShaderSource:v}}}),N3,z3,jT,O2,W3,VT,j3,Z0,ED=nt(()=>{Ft(),$t(),zt(),id(),TD(),wD(),N3=(n,e)=>n?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${e?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${e?", batchIndices":""});
        `,z3=(n,e)=>n?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${e===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${e===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${e===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,jT=(n,e,t="f32",r,i=!1,s=32,a=!1,o=32)=>{let l=e[1]*n[1],c=e[0]*n[0],u=i?l:s,d=i?s:l,h=u/e[0],f=s/e[1];if(!((i&&h===4&&n[1]===4||!i&&(h===3||h===4))&&u%e[0]===0&&s%e[1]===0&&n[0]===4))throw new Error(`If transposeA ${i} is true, innerElementSize ${h} and workPerThread[1] ${n[1]} must be 4.
      Otherwise, innerElementSize ${h} must be 3 or 4.
  tileAWidth ${u} must be divisible by workgroupSize[0]${e[0]}. tileInner ${s} must be divisible by workgroupSize[1] ${e[1]}. colPerThread ${n[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${h}<${t}>, ${u/h}>, ${d}>;
var<workgroup> mm_Bsub: array<array<vec4<${t}>, ${c/n[0]}>, ${s}>;

const rowPerThread = ${n[1]};
const colPerThread = ${n[0]};
const innerElementSize = ${h};
const tileInner = ${s};

@compute @workgroup_size(${e[0]}, ${e[1]}, ${e[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${a?"0":"i32(globalId.z)"};
  ${r?`let batchIndices = ${r.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${l};

  let num_tiles = ${a?`${Math.ceil(o/s)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${a?`i32(globalId.z) * ${o}`:"0"};

  var acc: array<vec4<${t}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${f};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${N3(i,r)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${f}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${r?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${h===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${z3(i,h)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},O2=(n,e)=>n?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${e?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${e?", batchIndices":""});
            `,W3=n=>n?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",VT=(n,e,t="f32",r,i=!1,s=32,a=!1,o=32,l=!1)=>{let c=n[1]*e[1],u=n[0]*e[0],d=i?c:s,h=i?s:c;if(!(h%e[1]===0&&d%e[0]===0&&s%e[1]===0))throw new Error(`tileAHight ${h} must be divisible by workgroupSize[1]${e[1]}, tileAWidth ${d} must be divisible by workgroupSize[0]${e[0]}, tileInner ${s} must be divisible by workgroupSize[1]${e[1]}`);let f=h/e[1],p=d/e[0],g=s/e[1],b=l?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${c};
    let globalColStart = i32(workgroupId.x) * ${u};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${h}; inputRow = inputRow + ${e[1]}) {
        for (var inputCol = localCol; inputCol < ${d}; inputCol = inputCol + ${e[0]}) {
          ${O2(i,r)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${s}; inputRow = inputRow + ${e[1]}) {
            for (var inputCol = localCol; inputCol < ${u}; inputCol = inputCol + ${e[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${r?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${t}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${e[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${i?`mm_Asub[k][localRow + innerRow * ${e[1]}];`:`mm_Asub[localRow + innerRow * ${e[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${e[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${e[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${c};

let tileRowA = i32(localId.y) * ${f};
let tileColA = i32(localId.x) * ${p};
let tileRowB = i32(localId.y) * ${g};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${f}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${p}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${O2(i,r)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${g}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${r?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${t}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${W3(i)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${t}, ${d}>, ${h}>;
  var<workgroup> mm_Bsub : array<array<${t}, ${u}>, ${s}>;
  const rowPerThread = ${n[1]};
  const colPerThread = ${n[0]};
  const tileInner = ${s};

@compute @workgroup_size(${e[0]}, ${e[1]}, ${e[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${a?"0":"i32(globalId.z)"};
    ${r?`let batchIndices = ${r.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${a?`${Math.ceil(o/s)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${a?`i32(globalId.z) * ${o}`:"0"};

    var acc : array<array<${t}, colPerThread>, rowPerThread>;
    ${b}
  }
`},j3=(n,e,t,r,i=!1)=>{let[s,a,o,l]=r,c=Sr(r[0].type.tensor);return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${s.type.indices}) -> ${zr(n,c)} {
      var value = ${zr(n,c)}(0.0);
      let col = colIn * ${n};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        var aIndices: ${a.type.indices};
        ${Um("aIndices",a,a.rank-2,s.rank,"batchIndices")}
        ${a.indicesSet("aIndices",a.rank-2,"u32(row)")}
        ${a.indicesSet("aIndices",a.rank-1,"u32(colIn)")}
        value = ${a.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${s.type.indices}) -> ${zr(n,c)} {
      var value = ${zr(n,c)}(0.0);
      let col = colIn * ${n};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        var bIndices: ${o.type.indices};
        ${Um("bIndices",o,o.rank-2,s.rank,"batchIndices")}
        ${o.indicesSet("bIndices",o.rank-2,"u32(row)")}
        ${o.indicesSet("bIndices",o.rank-1,"u32(colIn)")}
        value = ${o.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${zr(n,c)}) {
      let col = colIn * ${n};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${e?`value = value + ${i?"bias[colIn]":`${zr(n,c)}(bias[row])`};`:""}
        ${t}
        ${l.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},Z0=(n,e,t,r,i=!1,s)=>{let a=n[0].dims,o=n[1].dims,l=a.slice(0,-2),c=o.slice(0,-2),u=r?r.slice(0,-2):t.slice(0,-2),d=Ve.size(u),h=a[a.length-2],f=a[a.length-1],p=o[o.length-1],g=f%4===0&&p%4===0,b=h<=8?[4,1,1]:[4,4,1],_=[8,8,1],m=[Math.ceil(p/_[0]/b[0]),Math.ceil(h/_[1]/b[1]),Math.ceil(d/_[2]/b[2])],v=g?4:1,x=[...l,h,f/v],w=x.length,T=[...c,f,p/v],E=T.length,A=[d,h,p/v],M=[{type:6,data:h},{type:6,data:p},{type:6,data:f}];Ku(e,M),M.push(...vt(u,x,T));let F=["rank","rank"],G=n.length>2;G&&(M.push(...vt(n[2].dims)),F.push("rank")),M.push(...vt(A));let S=I=>{let C=u.length,H=gD("batchDims",n[0].dataType,C,1),B=Sr(n[0].dataType),$=He("a",n[0].dataType,w,v),X=He("b",n[1].dataType,E,v),V=_t("result",n[0].dataType,A.length,v),Q=[$,X];if(G){let de=i?v:1;Q.push(He("bias",n[2].dataType,n[2].dims.length,de))}let R=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];Xu(e,R);let O=Sr(V.type.tensor),L=Hu(e,V.type.value,O),ne=j3(v,G,L,[H,$,X,V],i);return`
  ${I.registerUniforms(R).registerInternalVariables(H).declareVariables(...Q,V)}
  ${ne}
  ${g?jT(b,_,B,H):VT(b,_,B,H)}
                   `};return{name:"MatMul",shaderCache:{hint:`${b};${e.activation};${g};${i}`,inputDependencies:F},getRunData:()=>({outputs:[{dims:s?s(t):t,dataType:n[0].dataType}],dispatchGroup:{x:m[0],y:m[1],z:m[2]},programUniforms:M}),getShaderSource:S}}}),V3,d4,HV=nt(()=>{Ft(),Uo(),zt(),id(),wD(),qV(),ED(),V3=(n,e,t,r,i=!1,s,a=4,o=4,l=4,c="f32")=>{let u=M=>{switch(M){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${c}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${M} is not supported.`)}},d=M=>{switch(M){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${M} is not supported.`)}},h=n?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,f=n?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,p=n?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",g=n?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",b=n?"row":"col",_=n?"col":"row",m=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${n?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${b} / outWidth;
    let outCol = ${b} % outWidth;

    let WRow = ${_} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${_} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${_} % inChannels;
    var resData = ${zr(a,c)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${p} && xCol >= 0 && xCol < ${g}) {
      ${h}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${u(a)}
    }
    return resData;`,v=n?e&&r?`
    let col = colIn * ${a};
    ${m}`:`
    let col = colIn * ${a};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${m}
    }
    return ${zr(a,c)}(0.0);`:r&&t?`
    let col = colIn * ${a};
    ${m}`:`
    let col = colIn * ${a};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${m}
    }
    return ${zr(a,c)}(0.0);`,x=n?r&&t?d(o):`
    let col = colIn * ${o};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${d(o)}
    }
    return ${zr(o,c)}(0.0);`:`
    let col = colIn * ${o};
    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {
      ${d(o)}
    }
    return ${zr(o,c)}(0.0);`,w=zr(l,c),T=zr(n?a:o,c),E=zr(n?o:a,c),A=Hu(s,w,c);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${T} {
      ${n?v:x}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${E} {
      ${n?x:v}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${w}) {
      let col = colIn * ${l};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${n?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${f}
      ${c4(i)}
      ${A}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},d4=(n,e,t,r,i,s,a,o,l)=>{let c=e.format==="NHWC",u=c?n[0].dims[3]:n[0].dims[1],d=t[0],h=c?t[2]:t[3],f=c?t[1]:t[2],p=c?t[3]:t[1],g=c&&(u%4===0||u%3===0)&&p%4===0,b=c?p:h*f,_=c?h*f:p,m=[8,8,1],v=r<=8?[4,1,1]:[4,4,1],x=[Math.ceil(b/m[0]/v[0]),Math.ceil(_/m[1]/v[1]),Math.ceil(d/m[2]/v[2])];nn("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${x}`);let w=g?c&&u%4!==0?3:4:1,T=m[1]*v[1],E=m[0]*v[0],A=Math.max(m[0]*w,m[1]),M=r%T===0,F=i%E===0,G=s%A===0,S=g?[w,4,4]:[1,1,1],I=[{type:6,data:r},{type:6,data:i},{type:6,data:s},{type:6,data:[e.pads[0],e.pads[1]]},{type:6,data:e.strides},{type:6,data:e.dilations}];Ku(e,I),I.push(...vt(n[0].dims,n[1].dims));let C=["rank","rank"];a&&(I.push(...vt(n[2].dims)),C.push("rank")),I.push(...vt(t));let H=B=>{let $=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];Xu(e,$);let X=g?4:1,V=Sr(n[0].dataType),Q=`
      fn setOutputAtIndex(flatIndex : i32, value : ${g?`vec4<${V}>`:V}) {
        result[flatIndex] = ${g?`vec4<${V}>`:V}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${g?`vec4<${V}>`:V}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${g?"/ 4":""}, value);
      }`,R=He("x",n[0].dataType,n[0].dims.length,w===3?1:w),O=He("w",n[1].dataType,n[1].dims.length,X),L=[R,O],ne=_t("result",n[0].dataType,t.length,X);if(a){let de=He("bias",n[2].dataType,n[2].dims.length,X);L.push(de),Q+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${g?`vec4<${V}>`:V} {
          return bias[coords.${c?"w":"y"}${g?"/ 4":""}];
        }`}return`
        ${u4("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${B.registerUniforms($).declareVariables(...L,ne)}
        ${Q}
        ${V3(c,M,F,G,a,e,S[0],S[1],S[2],V)}
        ${g?jT(v,m,V,void 0,!c,A):VT(v,m,V,void 0,!c,A,!1,void 0,o)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${e.cacheKey};${w};${g};${M};${F};${G};${T};${E};${A}`,inputDependencies:C},getRunData:()=>({outputs:[{dims:l?l(t):t,dataType:n[0].dataType}],dispatchGroup:{x:x[0],y:x[1],z:x[2]},programUniforms:I}),getShaderSource:H}}}),G3,U2,am,q3,L2,H3,h4,f4,KV=nt(()=>{Ft(),Uo(),$t(),zt(),id(),wD(),G3=n=>{let e=1;for(let t=0;t<n.length;t++)e*=n[t];return e},U2=n=>typeof n=="number"?[n,n,n]:n,am=(n,e)=>e<=1?n:n+(n-1)*(e-1),q3=(n,e,t,r=1)=>{let i=am(e,r);return Math.floor((n[0]*(t-1)-t+i)/2)},L2=(n,e,t,r,i)=>{i==null&&(i=q3(n,e[0],r[0]));let s=[0,0,0,t];for(let a=0;a<3;a++)n[a]+2*i>=e[a]&&(s[a]=Math.trunc((n[a]-e[a]+2*i)/r[a]+1));return s},H3=(n,e,t,r,i,s,a,o,l,c)=>{let u,d,h,f;if(n==="VALID"&&(n=0),typeof n=="number"){u={top:n,bottom:n,left:n,right:n,front:n,back:n};let p=L2([e,t,r,1],[o,l,c],1,[i,s,a],n);d=p[0],h=p[1],f=p[2]}else if(Array.isArray(n)){if(!n.every((g,b,_)=>g===_[0]))throw Error(`Unsupported padding parameter: ${n}`);u={top:n[0],bottom:n[1],left:n[2],right:n[3],front:n[4],back:n[5]};let p=L2([e,t,r,1],[o,l,c],1,[i,s,a],n[0]);d=p[0],h=p[1],f=p[2]}else if(n==="SAME_UPPER"){d=Math.ceil(e/i),h=Math.ceil(t/s),f=Math.ceil(r/a);let p=(d-1)*i+o-e,g=(h-1)*s+l-t,b=(f-1)*a+c-r,_=Math.floor(p/2),m=p-_,v=Math.floor(g/2),x=g-v,w=Math.floor(b/2),T=b-w;u={top:v,bottom:x,left:w,right:T,front:_,back:m}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:u,outDepth:d,outHeight:h,outWidth:f}},h4=(n,e,t,r,i,s=!1,a="channelsLast")=>{let o,l,c,u,d;if(a==="channelsLast")[o,l,c,u,d]=n;else if(a==="channelsFirst")[o,d,l,c,u]=n;else throw new Error(`Unknown dataFormat ${a}`);let[h,,f,p,g]=e,[b,_,m]=U2(t),[v,x,w]=U2(r),T=am(f,v),E=am(p,x),A=am(g,w),{padInfo:M,outDepth:F,outHeight:G,outWidth:S}=H3(i,l,c,u,b,_,m,T,E,A),I=s?h*d:h,C=[0,0,0,0,0];return a==="channelsFirst"?C=[o,I,F,G,S]:a==="channelsLast"&&(C=[o,F,G,S,I]),{batchSize:o,dataFormat:a,inDepth:l,inHeight:c,inWidth:u,inChannels:d,outDepth:F,outHeight:G,outWidth:S,outChannels:I,padInfo:M,strideDepth:b,strideHeight:_,strideWidth:m,filterDepth:f,filterHeight:p,filterWidth:g,effectiveFilterDepth:T,effectiveFilterHeight:E,effectiveFilterWidth:A,dilationDepth:v,dilationHeight:x,dilationWidth:w,inShape:n,outShape:C,filterShape:e}},f4=(n,e,t,r,i,s)=>{let a=s==="channelsLast";a?n[0].dims[3]:n[0].dims[1];let o=[64,1,1],l={x:t.map((b,_)=>_)},c=[Math.ceil(G3(l.x.map(b=>t[b]))/o[0]),1,1];nn("verbose",()=>`[conv3d_naive_webgpu] dispatch = ${c}`);let u=1,d=Ve.size(t),h=[{type:12,data:d},{type:12,data:r},{type:12,data:i},{type:12,data:e.strides},{type:12,data:e.dilations}];Ku(e,h),h.push(...vt(n[0].dims,n[1].dims));let f=["rank","rank"],p=n.length===3;p&&(h.push(...vt(n[2].dims)),f.push("rank")),h.push(...vt(t));let g=b=>{let _=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:r.length},{name:"pads",type:"u32",length:i.length},{name:"strides",type:"u32",length:e.strides.length},{name:"dilations",type:"u32",length:e.dilations.length}];Xu(e,_);let m=1,v=Sr(n[0].dataType),x=He("x",n[0].dataType,n[0].dims.length,u),w=He("W",n[1].dataType,n[1].dims.length,m),T=[x,w],E=_t("result",n[0].dataType,t.length,m),A="";if(p){let G=He("bias",n[2].dataType,n[2].dims.length,m);T.push(G),A+=`
        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ${v} {
          return bias[${a?yt("coords",4,5):yt("coords",1,5)}];
        }`}let M=zr(u,v),F=Hu(e,M,v);return`
            ${A}
            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${x.getByIndices("aIndices")};
            }
            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {
              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);
              return ${w.getByIndices("aIndices")};
            }
          ${b.registerUniforms(_).declareVariables(...T,E)}
          ${b.mainStart()}
          ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
              let coords = ${E.offsetToIndices("global_idx")};
              let batch = ${yt("coords",0,x.rank)};
              let d2 = ${a?yt("coords",x.rank-1,x.rank):yt("coords",1,x.rank)};
              let xFRCCorner = vec3<u32>(${a?yt("coords",1,x.rank):yt("coords",2,x.rank)},
              ${a?yt("coords",2,x.rank):yt("coords",3,x.rank)},
              ${a?yt("coords",3,x.rank):yt("coords",4,x.rank)}) * uniforms.strides - uniforms.pads;
              let xFCorner = xFRCCorner.x;
              let xRCorner = xFRCCorner.y;
              let xCCorner = xFRCCorner.z;
              let xShapeY = ${a?yt("uniforms.x_shape",1,x.rank):yt("uniforms.x_shape",2,x.rank)};
              let xShapeZ = ${a?yt("uniforms.x_shape",2,x.rank):yt("uniforms.x_shape",3,x.rank)};
              let xShapeW = ${a?yt("uniforms.x_shape",3,x.rank):yt("uniforms.x_shape",4,x.rank)};
              let xShapeU = ${a?yt("uniforms.x_shape",4,x.rank):yt("uniforms.x_shape",1,x.rank)};
              let inputDepthNearestVec4 = (xShapeU / 4) * 4;
              let inputDepthVec4Remainder = xShapeU % 4;

              var value = 0.0;
              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {
                let xF = xFCorner + wF * uniforms.dilations[0];
                if (xF < 0 || xF >= xShapeY) {
                  continue;
                }

                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {
                  let xR = xRCorner + wR * uniforms.dilations[1];
                  if (xR < 0 || xR >= xShapeZ) {
                    continue;
                  }

                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {
                    let xC = xCCorner + wC * uniforms.dilations[2];
                    if (xC < 0 || xC >= xShapeW) {
                      continue;
                    }

                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {
                      ${a?`let xValues = vec4<f32>(
                               getX(batch, xF, xR, xC, d1),
                               getX(batch, xF, xR, xC, d1 + 1),
                               getX(batch, xF, xR, xC, d1 + 2),
                               getX(batch, xF, xR, xC, d1 + 3));
                            `:`let xValues = vec4<f32>(
                               getX(batch, d1, xF, xR, xC),
                               getX(batch, d1 + 1, xF, xR, xC),
                               getX(batch, d1 + 2, xF, xR, xC),
                               getX(batch, d1 + 3, xF, xR, xC));
                            `}
                            let wValues = vec4<f32>(
                              getW(d2, d1, wF, wR, wC),
                              getW(d2, d1 + 1, wF, wR, wC),
                              getW(d2, d1 + 2, wF, wR, wC),
                              getW(d2, d1 + 3, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                    if (inputDepthVec4Remainder == 1) {
                        ${a?`value += getX(batch, xF, xR, xC, inputDepthNearestVec4)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`:`value += getX(batch, inputDepthNearestVec4, xF, xR, xC)
                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);`}
                    } else if (inputDepthVec4Remainder == 2) {
                      ${a?`let xValues = vec2<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));
                      `:`let xValues = vec2<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));
                    `}
                    let wValues = vec2<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));
                      value += dot(xValues, wValues);
                    } else if (inputDepthVec4Remainder == 3) {
                      ${a?`let xValues = vec3<f32>(
                        getX(batch, xF, xR, xC, inputDepthNearestVec4),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));
                      `:`let xValues = vec3<f32>(
                        getX(batch, inputDepthNearestVec4, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),
                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));
                    `}
                    let wValues = vec3<f32>(
                      getW(d2, inputDepthNearestVec4, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),
                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));
                      value += dot(xValues, wValues);
                    }
                  }
                }
              }
              ${p?"value = value + getBiasByOutputCoords(coords)":""};
              ${F}
              result[global_idx] = f32(value);
          }`};return{name:"Conv3DNaive",shaderCache:{hint:`${e.cacheKey};${a};${u};${p}`,inputDependencies:f},getRunData:()=>({outputs:[{dims:t,dataType:n[0].dataType}],dispatchGroup:{x:c[0],y:c[1],z:c[2]},programUniforms:h}),getShaderSource:g}}}),p4,m4,XV=nt(()=>{Ft(),$t(),zt(),id(),p4=(n,e,t,r)=>{let i=n.length>2,s=i?"value += b[output_channel];":"",a=n[0].dims,o=n[1].dims,l=e.format==="NHWC",c=l?t[3]:t[1],u=c/e.group,d=l&&u>=4?jn(c):1,h=Ve.size(t)/d,f=[{type:12,data:h},{type:12,data:e.dilations},{type:12,data:[e.strides[0],e.strides[1]]},{type:12,data:[e.pads[0],e.pads[1]]},{type:12,data:u}];Ku(e,f),f.push(...vt(a,[o[0],o[1],o[2],o[3]/d]));let p=i?["rank","rank","rank"]:["rank","rank"];f.push(...vt([t[0],t[1],t[2],t[3]/d]));let g=b=>{let _=_t("output",n[0].dataType,t.length,d),m=Sr(_.type.tensor),v=Hu(e,_.type.value,m),x=He("x",n[0].dataType,a.length),w=He("w",n[1].dataType,o.length,d),T=[x,w];i&&T.push(He("b",n[2].dataType,n[2].dims,d));let E=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:e.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];Xu(e,E);let A=l?`
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {
            let input_channel = in_channel_offset + wInChannel;
            let xVal = ${x.get("batch","xHeight","xWidth","input_channel")};
            let wVal = ${w.get("wHeight","wWidth","wInChannel","output_channel")};
            value += xVal * wVal;
          }
        }
      }
      `:`
      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
        let input_channel = in_channel_offset + wInChannel;
        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {
            continue;
          }

          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {
              continue;
            }

            let xVal = ${x.get("batch","input_channel","xHeight","xWidth")};
            let wVal = ${w.get("output_channel","wInChannel","wHeight","wWidth")};
            value += xVal * wVal;
          }
        }
      }
      `;return`
  ${b.registerUniforms(E).declareVariables(...T,_)}

  ${b.mainStart()}
    ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${_.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${l?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${l?1:2}], outputIndices[${l?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel * ${d} / uniforms.output_channels_per_group;
    var in_channel_offset = group_id * uniforms.w_shape[${l?2:1}];

    var value: ${_.type.value} = ${_.type.value}(0);
    ${A}
    ${s}
    ${v}
    ${_.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:`${e.cacheKey}_${d}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:r?r(t):t,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:f}),getShaderSource:g}},m4=(n,e,t,r)=>{let i=n.length>2,s=jn(t[3]),a=jn(t[2]),o=Ve.size(t)/s/a,l=[n[0].dims[0],n[0].dims[1],n[0].dims[2],n[0].dims[3]/s],c=[n[1].dims[0],n[1].dims[1],n[1].dims[2],n[1].dims[3]/s],u=[t[0],t[1],t[2],t[3]/s],d=[{type:12,data:o},{type:6,data:[e.strides[0],e.strides[1]]},{type:6,data:[e.pads[0],e.pads[1]]}];Ku(e,d),d.push(...vt(l,c,u));let h=(a-1)*e.strides[1]+c[1],f=p=>{let g=_t("output",n[0].dataType,u.length,s),b=Sr(g.type.tensor),_=Hu(e,g.type.value,b),m=He("x",n[0].dataType,l.length,s),v=He("w",n[1].dataType,c.length,s),x=[m,v];i&&x.push(He("b",n[2].dataType,n[2].dims,s));let w=i?"value += b[output_channel];":"",T=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return Xu(e,T),`
  ${p.registerUniforms(T).declareVariables(...x,g)}
  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${a}u;
    let col = (index1 % width1) * ${a}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${m.type.value}, ${h}>;
    var values: array<${g.type.value}, ${a}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${c[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${h}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${m.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${m.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${c[1]}; w_width++) {
          let w_val = ${v.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${a}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${a}u; i++) {
      var value = values[i];
      ${w}
      ${_}
      ${g.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${e.cacheKey};${s};${a};${h};${c[0]};${c[1]}`,inputDependencies:i?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r?r(t):t,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:d}),getShaderSource:f}}}),K3,Ey,X3,Dy,GT,R2,Y3,Q3,qT,YV=nt(()=>{$t(),HV(),KV(),ED(),XV(),id(),TD(),Zl(),K3=(n,e,t,r,i,s)=>{let a=n[0],o=n.slice(s?1:2,s?3:4),l=o.length,c=e[0],u=e.slice(2).map((h,f)=>h+(h-1)*(t[f]-1)),d=o.map((h,f)=>h+r[f]+r[f+l]).map((h,f)=>Math.floor((h-u[f]+i[f])/i[f]));return d.splice(0,0,a),d.splice(s?3:1,0,c),d},Ey=[2,3,1,0],X3=(n,e)=>{if(!n||n.length!==2&&n.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(n[0].dims.length>5)throw new Error("greater than 5D is not supported");if(n[0].dims.length!==n[1].dims.length)throw new Error("filter does not have same dimension as input");let t=n[0].dims[e.format==="NHWC"?n[0].dims.length-1:1],r=n[1].dims[1]*e.group;if(t!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(n.length===3&&(n[2].dims.length!==1||n[1].dims[0]!==n[2].dims[0]))throw new Error("invalid bias");let i=n[0].dims.length-2;if(e.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(e.strides.length!==i)throw new Error(`strides should be ${i}D`);if(e.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(e.kernelShape.length!==0&&e.kernelShape.length!==n[1].dims.length-2)throw new Error("invalid kernel shape")},Dy=(n,e)=>{let t=n.kernelShape.slice();t.length<e[1].dims.length-2&&t.push(...Array(e[1].dims.length-2-t.length).fill(0));for(let s=2;s<e[1].dims.length;++s)t[s-2]===0&&(t[s-2]=e[1].dims[s]);let r=n.pads.slice();Y0.adjustPadsBasedOnAutoPad(e[0].dims,n.strides,n.dilations,t,r,n.format==="NHWC",n.autoPad);let i=Object.assign({},n);return Object.assign(i,{kernelShape:t,pads:r}),i},GT=n=>{let e=vD(n),t=n.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][n.auto_pad],i=n.dilations,s=n.group,a=n.kernel_shape,o=n.pads,l=n.strides,c=n.w_is_const();return{autoPad:r,format:t,dilations:i,group:s,kernelShape:a,pads:o,strides:l,wIsConst:c,...e,cacheKey:`${n.format};${e.activation};`}},R2=(n,e,t,r)=>{let i=t.format==="NHWC",s=K3(e[0].dims,e[1].dims,t.dilations,t.pads,t.strides,i);if(t.group!==1){let T=[e[0]];if(i){let E=n.kernelCustomData.wT??n.compute(hs(e[1],Ey),{inputs:[1],outputs:[t.wIsConst?-2:-1]})[0];t.wIsConst&&!n.kernelCustomData.wT&&(n.kernelCustomData.wT=E),T.push(E)}else T.push(e[1]);e.length===3&&T.push(e[2]),!n.adapterInfo.isArchitecture("ampere")&&i&&e[1].dims[0]===t.group&&e[1].dims[1]===1&&t.dilations[0]===1&&t.dilations[1]===1?n.compute(m4(T,t,s,r),{inputs:T}):n.compute(p4(T,t,s,r),{inputs:T});return}let a=e.length===3,o=e[0].dims[i?1:2],l=e[0].dims[i?2:3],c=e[0].dims[i?3:1],u=e[1].dims[2],d=e[1].dims[3],h=s[i?1:2],f=s[i?2:3],p=s[i?3:1],g=i&&u===o&&d===l&&t.pads[0]===0&&t.pads[1]===0;if(g||u===1&&d===1&&t.dilations[0]===1&&t.dilations[1]===1&&t.strides[0]===1&&t.strides[1]===1&&t.pads[0]===0&&t.pads[1]===0){let T=s[0],E,A,M,F=[];if(i){let I=n.kernelCustomData.wT??n.compute(hs(e[1],Ey),{inputs:[1],outputs:[t.wIsConst?-2:-1]})[0];if(t.wIsConst&&!n.kernelCustomData.wT&&(n.kernelCustomData.wT=I),g){let C=o*l*c;E=e[0].reshape([1,T,C]),A=I.reshape([1,C,p]),M=[1,T,p]}else E=e[0].reshape([T,o*l,c]),A=I.reshape([1,c,p]),M=[T,h*f,p];F.push(E),F.push(A)}else E=e[0].reshape([T,c,o*l]),A=e[1].reshape([1,p,c]),M=[T,p,h*f],F.push(A),F.push(E);a&&F.push(e[2]);let G=M[2],S=F[0].dims[F[0].dims.length-1];G<8&&S<8?n.compute(xD(F,t,s,M,i,r),{inputs:F}):n.compute(Z0(F,t,s,M,i,r),{inputs:F});return}let b=!0,_=n.kernelCustomData.wT??n.compute(hs(e[1],Ey),{inputs:[1],outputs:[t.wIsConst?-2:-1]})[0];t.wIsConst&&!n.kernelCustomData.wT&&(n.kernelCustomData.wT=_);let m=[e[0],_];a&&m.push(e[2]);let v=i?h*f:p,x=i?p:h*f,w=u*d*c;n.compute(d4(m,t,s,v,x,w,a,b,r),{inputs:m})},Y3=(n,e)=>{let t=e.format==="NHWC",r=[n.inputs[0].reshape(t?[n.inputs[0].dims[0],1,n.inputs[0].dims[1],n.inputs[0].dims[2]]:[n.inputs[0].dims[0],n.inputs[0].dims[1],1,n.inputs[0].dims[2]]),n.inputs[1].reshape([n.inputs[1].dims[0],n.inputs[1].dims[1],1,n.inputs[1].dims[2]])];n.inputs.length===3&&r.push(n.inputs[2]);let i=[0,e.pads[0],0,e.pads[1]],s=[1].concat(e.strides),a=[1].concat(e.dilations),o=[1].concat(e.kernelShape),l=Dy({...e,pads:i,strides:s,dilations:a,kernelShape:o},r);R2(n,r,l,c=>t?[c[0],c[2],c[3]]:[c[0],c[1],c[3]])},Q3=(n,e,t)=>{let r=t.format==="NHWC"?"channelsLast":"channelsFirst",i=Dy(t,e),s=t.autoPad==="NOTSET"?t.pads:t.autoPad,a=h4(e[0].dims,e[1].dims,t.strides,t.dilations,s,!1,r);n.compute(f4(e,i,a.outShape,[a.filterDepth,a.filterHeight,a.filterWidth],[a.padInfo.front,a.padInfo.top,a.padInfo.left],r))},qT=(n,e)=>{if(X3(n.inputs,e),n.inputs[0].dims.length===3)Y3(n,e);else if(n.inputs[0].dims.length===5)Q3(n,n.inputs,e);else{let t=Dy(e,n.inputs);R2(n,n.inputs,t)}}}),g4,QV=nt(()=>{Ft(),Uo(),$t(),zt(),g4=(n,e,t)=>{let r=n.length>2,i=e.outputShape,s=e.format==="NHWC",a=e.group,o=n[1].dims,l=o[2]/a,c=o[3],u=s?jn(l):1,d=s&&c===1&&l>=4,h=d?Math.floor(l/4)*4:Math.floor(l/u)*u,f=l-h,p=s?jn(c):1,g=s?c===1?u:p:1,b=Ve.size(i)/p,_=[Math.ceil(b/64),1,1];nn("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${_}`);let m=["rank","rank"],v=[e.strides[0],e.strides[1]],x=[e.kernelShape[s?1:2],e.kernelShape[s?2:3]],w=[e.dilations[0],e.dilations[1]],T=[x[0]+(e.dilations[0]<=1?0:(e.kernelShape[s?1:2]-1)*(e.dilations[0]-1)),x[1]+(e.dilations[1]<=1?0:(e.kernelShape[s?2:3]-1)*(e.dilations[1]-1))],E=[T[0]-1-Math.floor((e.pads[0]+e.pads[2])/2),T[1]-1-Math.floor((e.pads[1]+e.pads[3])/2)],A=[{type:12,data:b},{type:12,data:v},{type:12,data:x},{type:12,data:w},{type:12,data:T},{type:6,data:E},{type:12,data:h},{type:12,data:l},{type:12,data:c},...vt(n[0].dims,n[1].dims)];r&&(A.push(...vt(n[2].dims)),m.push("rank")),A.push(...vt(i));let M=F=>{let G=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:v.length},{name:"filter_dims",type:"u32",length:x.length},{name:"dilations",type:"u32",length:x.length},{name:"effective_filter_dims",type:"u32",length:T.length},{name:"pads",type:"i32",length:E.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],S=Sr(n[0].dataType),I=s?1:2,C=s?2:3,H=s?3:1,B=He("W",n[1].dataType,n[1].dims.length,g),$=He("Dy",n[0].dataType,n[0].dims.length,u),X=[$,B];r&&X.push(He("bias",n[2].dataType,[i[H]].length,p));let V=_t("result",n[0].dataType,i.length,p),Q=()=>{let L="";if(d)u===4?L+=`
        let xValue = ${$.getByOffset("x_offset")};
        let wValue = ${B.getByOffset("w_offset")};
        dotProd = dotProd + dot(xValue, wValue);
        x_offset += 1u;
        w_offset += 1u;`:u===2?L+=`
          dotProd = dotProd + dot(vec4<${S}>(${$.getByOffset("x_offset")}, ${$.getByOffset("x_offset + 1u")}), vec4<${S}>(${B.getByOffset("w_offset")}, ${B.getByOffset("w_offset + 1u")}));
          x_offset += 2u;
          w_offset += 2u;`:u===1&&(L+=`
          dotProd = dotProd + dot(vec4<${S}>(${$.getByOffset("x_offset")}, ${$.getByOffset("x_offset + 1u")}, ${$.getByOffset("x_offset + 2u")}, ${$.getByOffset("x_offset + 3u")}), vec4<${S}>(${B.getByOffset("w_offset")}, ${B.getByOffset("w_offset + 1u")}, ${B.getByOffset("w_offset + 2u")}, ${B.getByOffset("w_offset + 3u")}));
          x_offset += 4u;
          w_offset += 4u;`);else if(L+=`
                  let xValue = ${s?$.getByOffset(`${$.indicesToOffset(`${$.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${u}`):$.get("batch","inputChannel","idyR","idyC")};
        `,u===1)L+=`
          let w_offset = ${B.indicesToOffset(`${B.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)`)};
          let wValue = ${B.getByOffset(`w_offset / ${g}`)};
          dotProd = dotProd + xValue * wValue;`;else for(let ne=0;ne<u;ne++)L+=`
            let wValue${ne} = ${B.getByOffset(`${B.indicesToOffset(`${B.type.indices}(u32(wRPerm), u32(wCPerm), inputChannel + ${ne}, wOutChannel)`)} / ${g}`)};
            dotProd = dotProd + xValue[${ne}] * wValue${ne};`;return L},R=()=>{if(f===0)return"";if(!d)throw new Error(`packInputAs4 ${d} is not true.`);let L="";if(u===1){L+="dotProd = dotProd";for(let ne=0;ne<f;ne++)L+=`
            + ${$.getByOffset(`x_offset + ${ne}`)} * ${B.getByOffset(`w_offset + ${ne}`)}`;L+=";"}else if(u===2){if(f!==2)throw new Error(`Invalid inputChannelsRemainder ${f}.`);L+=`
          let xValue = ${$.getByOffset("x_offset")};
          let wValue = ${B.getByOffset("w_offset")};
          dotProd = dotProd + dot(xValue, wValue);`}return L},O=`
            let outputIndices = ${V.offsetToIndices(`global_idx * ${p}`)};
            let batch = ${V.indicesGet("outputIndices",0)};
            let d1 = ${V.indicesGet("outputIndices",H)};
            let r = ${V.indicesGet("outputIndices",I)};
            let c = ${V.indicesGet("outputIndices",C)};
            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
            let dyRCorner = dyCorner.x;
            let dyCCorner = dyCorner.y;
            let groupId = d1 / uniforms.output_channels_per_group;
            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
            // ? = to be determined. : = across all values in that axis.
            var dotProd = ${V.type.value}(0.0);
            var wR: u32 = 0;
            if (uniforms.dilations.x == 1) {
              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0
              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);
            }
            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
              if (wR % uniforms.dilations.x != 0) {
                continue;
              }
              let dyR = (${S}(dyRCorner) + ${S}(wR)) / ${S}(uniforms.strides[0]);
              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
              if (dyR < 0.0 || dyR >= ${S}(uniforms.Dy_shape[${I}]) || fract(dyR) > 0.0 ||
                  wRPerm < 0) {
                continue;
              }
              let idyR: u32 = u32(dyR);
              var wC: u32 = 0;
              if (uniforms.dilations.y == 1) {
                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0
                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);
              }
              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
                if (wC % uniforms.dilations.y != 0) {
                  continue;
                }
                let dyC = (${S}(dyCCorner) + ${S}(wC)) / ${S}(uniforms.strides.y);
                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
                if (dyC < 0.0 || dyC >= ${S}(uniforms.Dy_shape[${C}]) ||
                    fract(dyC) > 0.0 || wCPerm < 0) {
                  continue;
                }
                let idyC: u32 = u32(dyC);
                var inputChannel = groupId * uniforms.input_channels_per_group;
                ${d?`
                var x_offset = ${$.indicesToOffset(`${$.type.indices}(batch, idyR, idyC, inputChannel)`)} / ${u};
                var w_offset = ${B.indicesToOffset(`${B.type.indices}(wRPerm, wCPerm, inputChannel, wOutChannel)`)} / ${g};
                  `:""}
                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ${d?4:u}) {
                  ${Q()}
                  inputChannel = inputChannel + ${d?4:u};
                }
                ${R()}
                wC = wC + uniforms.strides.y - 1;
              }
              wR = wR + uniforms.strides[0] - 1;
            }
            let value = dotProd${r?` + bias[d1 / ${p}]`:""};
            ${V.setByOffset("global_idx","value")};
          `;return`
    ${F.registerUniforms(G).declareVariables(...X,V)}
      ${F.mainStart()}
      ${F.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
    ${O}}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${e.cacheKey};${u}${g}${p}${d}${f}`,inputDependencies:m},getRunData:()=>({dispatchGroup:{x:_[0],y:_[1],z:_[2]},outputs:[{dims:t?t(i):i,dataType:n[0].dataType}],programUniforms:A}),getShaderSource:M}}}),Z3,J3,eI,B2,_4,tI,$2,nI,b4,ZV=nt(()=>{QV(),id(),Zl(),Z3=(n,e,t,r,i,s)=>(n-1)*e+t+(r-1)*i+1-s,J3=(n,e,t,r,i)=>{let s=Math.floor(n/2);e==="SAME_UPPER"?(t[r]=s,t[i]=n-s):e==="SAME_LOWER"&&(t[r]=n-s,t[i]=s)},eI=(n,e,t,r,i,s,a,o,l,c)=>{let u=n.length-2,d=c.length===0;l.length<u&&l.push(...Array(u-l.length).fill(0));let h=n[0],f=e[o?3:1]*i;for(let p=0,g=n.length-u-(o?1:0);p<u;++p,++g){let b=n[g],_=d?b*a[p]:c[p],m=Z3(b,a[p],s[p],e[g],t[p],_);J3(m,r,s,p,p+u),d&&c.push(a[p]*(b-1)+l[p]+(e[g]-1)*t[p]+1-s[p]-s[p+u])}c.splice(0,0,h),c.splice(o?3:1,0,f)},B2=(n,e)=>{let t=n.kernelShape.slice();if(n.kernelShape.length===0||n.kernelShape.reduce((d,h)=>d*h,1)===0){t.length=0;for(let d=2;d<e[1].dims.length;++d)t.push(e[1].dims[d])}let r=n.format==="NHWC";t.splice(0,0,e[1].dims[0]),t.splice(r?3:1,0,e[1].dims[1]);let i=n.pads.slice(),s=n.outputShape.slice(),a=n.outputPadding.slice(),o=e[0].dims,l=n.dilations.slice();if(l.reduce((d,h)=>d+h,0)===0){let d=e[0].dims.length-2;l=new Array(d).fill(1)}let c=n.strides.slice();if(c.reduce((d,h)=>d+h,0)===0){let d=e[0].dims.length-2;c=new Array(d).fill(1)}eI(o,t,l,n.autoPad,n.group,i,c,r,a,s);let u=Object.assign({},n);return Object.assign(u,{kernelShape:t,pads:i,outputPadding:a,outputShape:s,dilations:l,strides:c}),u},_4=n=>{let e=vD(n),t=n.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof n.autoPad>"u"?0:n.autoPad],i=n.dilations,s=n.group,a=n.kernelShape,o=n.pads,l=n.strides,c=n.wIsConst(),u=n.outputPadding,d=n.outputShape;return{autoPad:r,format:t,dilations:i,group:s,kernelShape:a,outputPadding:u,outputShape:d,pads:o,strides:l,wIsConst:c,...e,cacheKey:`${n.format};${e.activation};`}},tI=(n,e)=>{if(!n||n.length!==2&&n.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(n[0].dims.length!==4&&n[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(n[0].dims.length!==n[1].dims.length)throw new Error("filter does not have same dimension as input");let t=n[0].dims[e.format==="NHWC"?n[0].dims.length-1:1],r=n[1].dims[0];if(t!==r)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let i=n[1].dims[1]*e.group;if(n.length===3&&(n[2].dims.length!==1||n[2].dims[0]!==i))throw new Error("invalid bias");let s=n[0].dims.length-2;if(e.dilations.reduce((a,o)=>a+o,0)>0&&e.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(e.strides.reduce((a,o)=>a+o,0)>0&&e.strides.length!==s)throw new Error(`strides should be ${s}D`);if(e.pads.reduce((a,o)=>a+o,0)>0&&e.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(e.outputPadding.length!==s&&e.outputPadding.length!==0)throw new Error(`output_padding should be ${s}D`);if(e.kernelShape.reduce((a,o)=>a+o,0)>0&&e.kernelShape.length!==0&&e.kernelShape.length!==n[1].dims.length-2)throw new Error("invalid kernel shape");if(e.outputShape.length!==0&&e.outputShape.length!==n[0].dims.length-2)throw new Error("invalid output shape")},$2=(n,e,t,r)=>{let i=n.kernelCustomData.wT??n.compute(hs(e[1],[2,3,0,1]),{inputs:[1],outputs:[t.wIsConst?-2:-1]})[0];t.wIsConst&&!n.kernelCustomData.wT&&(n.kernelCustomData.wT=i);let s=[e[0],i];e.length===3&&s.push(e[2]),n.compute(g4(s,t,r),{inputs:s})},nI=(n,e)=>{let t=e.format==="NHWC",r=[n.inputs[0].reshape(t?[n.inputs[0].dims[0],1,n.inputs[0].dims[1],n.inputs[0].dims[2]]:[n.inputs[0].dims[0],n.inputs[0].dims[1],1,n.inputs[0].dims[2]]),n.inputs[1].reshape([n.inputs[1].dims[0],n.inputs[1].dims[1],1,n.inputs[1].dims[2]])];n.inputs.length===3&&r.push(n.inputs[2]);let i=e.kernelShape;(i.length===0||i[0]===0)&&(i=[n.inputs[1].dims[2]]);let s=e.dilations;(s.length===0||s[0]===0)&&(s=[1]);let a=e.strides;(a.length===0||a[0]===0)&&(a=[1]);let o=e.pads;o.length===0&&(o=[0,0]),o=[0,o[0],0,o[1]],a=[1].concat(a),s=[1].concat(s),i=[1].concat(i);let l=e.outputPadding;l=[0].concat(l);let c=B2({...e,pads:o,strides:a,dilations:s,kernelShape:i,outputPadding:l},r);$2(n,r,c,u=>t?[u[0],u[2],u[3]]:[u[0],u[1],u[3]])},b4=(n,e)=>{if(tI(n.inputs,e),n.inputs[0].dims.length===3)nI(n,e);else{let t=B2(e,n.inputs);$2(n,n.inputs,t)}}}),rI,y4,v4,JV=nt(()=>{Ft(),$t(),Zn(),zt(),rI=(n,e,t,r)=>{let i=Ve.size(e),s=e.length,a=He("input",n,s),o=_t("output",n,s),l=t.dataType===6?t.getInt32Array()[0]:Number(t.getBigInt64Array()[0]),c=Ve.normalizeAxis(l,s),u=d=>{let h=` i32(${a.indicesGet("inputIndices","uniforms.axis")}) `,f=yt("uniforms.input_shape","uniforms.axis",s),p=r.reverse?h+(r.exclusive?" + 1":""):"0",g=r.reverse?f:h+(r.exclusive?"":" + 1");return`
                ${d.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(a,o)}
                ${d.mainStart()}
                  ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${o.offsetToIndices("global_idx")};
                  var sum = ${o.type.value}(0);
                  let first : i32 = ${p};
                  let last : i32 = ${g};
                  for (var i : i32 = first; i < last; i++) {
                    ${a.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${a.getByIndices("inputIndices")};
                  }
                  ${o.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:r.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:e,dataType:n}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},{type:12,data:c},...vt(e,e)]}),getShaderSource:u}},y4=(n,e)=>{let t=n.inputs[0].dims,r=n.inputs[0].dataType,i=n.inputs[1];n.compute(rI(r,t,i,e),{inputs:[0]})},v4=n=>{let e=n.exclusive===1,t=n.reverse===1;return pn({exclusive:e,reverse:t})}}),iI,sI,aI,w4,x4,e7=nt(()=>{Ft(),$t(),Zn(),zt(),iI=n=>{if(!n||n.length!==1)throw new Error("DepthToSpace requires 1 input.");if(n[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},sI=(n,e,t,r)=>{let i=[];i.push(`fn perm(i: ${r.type.indices}) -> ${t.type.indices} {
    var a: ${t.type.indices};`);for(let s=0;s<e;++s)i.push(t.indicesSet("a",n[s],`i[${s}]`));return i.push("return a;}"),i.join(`
`)},aI=(n,e)=>{let t,r,i,s,a,o,l=e.format==="NHWC",c=e.blocksize,u=e.mode==="DCR";l?([t,r,i,s]=n.dims,a=u?[t,r,i,c,c,s/c**2]:[t,r,i,s/c**2,c,c],o=u?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([t,r,i,s]=[n.dims[0],n.dims[2],n.dims[3],n.dims[1]],a=u?[t,c,c,s/c**2,r,i]:[t,s/c**2,c,c,r,i],o=u?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let d=n.reshape(a),h=d.dims.length,f=n.dataType,p=He("a",f,h),g=_t("output",f,h),b=_=>`
  ${_.registerUniform("output_size","u32").declareVariables(p,g)}

  ${sI(o,h,p,g)}

  ${_.mainStart()}
    ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${g.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${g.setByOffset("global_idx",p.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${n.dims};${e.blocksize};${e.mode}`,inputDependencies:["rank"]},getRunData:_=>{let m=l?[t,r*c,i*c,s/c**2]:[t,s/c**2,r*c,i*c],v=Ve.size(m),x=d.dims,w=Ve.sortBasedOnPerm(x,o);return{outputs:[{dims:m,dataType:_[0].dataType}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:[{type:12,data:v},...vt(x,w)]}},getShaderSource:b}},w4=(n,e)=>{iI(n.inputs),n.compute(aI(n.inputs[0],e))},x4=n=>pn({blocksize:n.blocksize,mode:n.mode,format:n.format})}),My,om,N2,oI,lI,cI,uI,z2,dI,T4,E4,t7=nt(()=>{Ft(),$t(),Zn(),zt(),My="[a-zA-Z]|\\.\\.\\.",om="("+My+")+",N2="^"+om+"$",oI="("+om+",)*"+om,lI="^"+oI+"$",cI=class{constructor(n=-1){this.symbolToIndices=new Map,this.inputIndex=n}addSymbol(n,e){let t=this.symbolToIndices.get(n);t===void 0?t=[e]:t.push(e),this.symbolToIndices.set(n,t)}},uI=class{constructor(n,e){this.equation=e,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[t,r]=e.includes("->")?e.split("->",2):[e,""];if(!t.match(RegExp(lI)))throw new Error("Invalid LHS term");if(t.split(",").forEach((i,s)=>{let a=n[s].dims.slice();if(!i.match(RegExp(N2)))throw new Error("Invalid LHS term");let o=this.processTerm(i,!0,a,s);this.lhs.push(o)}),r==="")r+=[...this.symbolToInfo.entries()].filter(([i,s])=>s.count===1||i==="...").map(([i])=>i).join("");else if(!r.match(RegExp(om)))throw new Error("Invalid RHS");r.match(RegExp(My,"g"))?.forEach(i=>{if(i==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let s=this.symbolToInfo.get(i);if(s===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(s.dimValue)}}),this.rhs=this.processTerm(r,!1,this.outputDims)}addSymbol(n,e,t){let r=this.symbolToInfo.get(n);if(r!==void 0){if(r.dimValue!==e&&r.count!==1)throw new Error("Dimension mismatch");r.count++,r.inputIndices.push(t)}else r={count:1,dimValue:e,inputIndices:[t]};this.symbolToInfo.set(n,r)}processTerm(n,e,t,r=-1){let i=t.length,s=!1,a=[],o=0;if(!n.match(RegExp(N2))&&!e&&n!=="")throw new Error("Invalid LHS term");let l=n.match(RegExp(My,"g")),c=new cI(r);return l?.forEach((u,d)=>{if(u==="..."){if(s)throw new Error("Only one ellipsis is allowed per input term");s=!0;let h=i-l.length+1;if(h<0)throw new Error("Ellipsis out of bounds");if(a=t.slice(o,o+h),this.hasEllipsis){if(this.ellipsisDims.length!==a.length||this.ellipsisDims.toString()!==a.toString())throw new Error("Ellipsis dimensions mismatch")}else if(e)this.hasEllipsis=!0,this.ellipsisDims=a;else throw new Error("Ellipsis must be specified in the LHS");for(let f=0;f<a.length;f++){let p=String.fromCharCode(48+f);c.addSymbol(p,d+f),this.addSymbol(p,t[o++],r)}}else c.addSymbol(u,d+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(u,t[o++],r)}),c}},z2=n=>n+"_max",dI=(n,e,t,r)=>{let i=n.map(c=>c.length).map((c,u)=>He(`input${u}`,e,c)),s=Ve.size(r),a=_t("output",e,r.length),o=[...t.symbolToInfo.keys()].filter(c=>!t.rhs.symbolToIndices.has(c)),l=c=>{let u=[],d="var prod = 1.0;",h="var sum = 0.0;",f="sum += prod;",p=[],g=[],b=[],_=[],m=t.symbolToInfo.size===t.rhs.symbolToIndices.size;t.symbolToInfo.forEach((x,w)=>{if(t.rhs.symbolToIndices.has(w)){let T=t.rhs.symbolToIndices.get(w)?.[0];T!==void 0&&t.lhs.forEach((E,A)=>{if(x.inputIndices.includes(A)){let M=E.symbolToIndices.get(w);if(M===void 0)throw new Error("Invalid symbol error");M.forEach(F=>{u.push(`${i[A].indicesSet(`input${A}Indices`,F,a.indicesGet("outputIndices",T))}`)})}})}else t.lhs.forEach((T,E)=>{if(x.inputIndices.includes(E)){let A=T.symbolToIndices.get(w);if(A===void 0)throw new Error("Invalid symbol error");A.forEach(M=>{p.push(`${i[E].indicesSet(`input${E}Indices`,M,`${w}`)}`)}),_.push(`prod *= ${i[E].getByIndices(`input${E}Indices`)};`)}}),g.push(`for(var ${w}: u32 = 0; ${w} < uniforms.${z2(w)}; ${w}++) {`),b.push("}")});let v=m?[...u,`let sum = ${i.map((x,w)=>x.getByIndices(`input${w}Indices`)).join(" * ")};`]:[...u,h,...g,...p,d,..._,f,...b];return`
            ${c.registerUniforms(o.map(x=>({name:`${z2(x)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...i,a)}

            ${c.mainStart()}
            ${c.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${a.offsetToIndices("global_idx")};
            ${i.map((x,w)=>`var input${w}Indices: ${i[w].type.indices};`).join(`
`)}
            ${v.join(`
`)};
            ${a.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:t.equation,inputDependencies:n.map(()=>"rank")},getRunData:()=>{let c=o.filter(d=>t.symbolToInfo.has(d)).map(d=>({type:12,data:t.symbolToInfo.get(d)?.dimValue||0}));c.push({type:12,data:s});let u=n.map((d,h)=>[...vt(d)]).reduce((d,h)=>d.concat(h),c);return u.push(...vt(r)),{outputs:[{dims:r,dataType:e}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:u}},getShaderSource:l}},T4=(n,e)=>{let t=new uI(n.inputs,e.equation),r=t.outputDims,i=n.inputs.map((s,a)=>s.dims);n.compute(dI(i,n.inputs[0].dataType,t,r))},E4=n=>{let e=n.equation.replace(/\s+/g,"");return pn({equation:e})}}),hI,W2,fI,pI,D4,n7=nt(()=>{Ft(),$t(),zt(),hI=n=>{if(!n||n.length!==2)throw new Error("Expand requires 2 input.");let e=n[0].dims,t=Array.from(n[1].getBigInt64Array(),Number),r=t.length<e.length?0:t.length-e.length,i=e.length<t.length?0:e.length-t.length;for(;r<t.length&&i<e.length;++r,++i)if(t[r]!==e[i]&&t[r]!==1&&e[i]!==1)throw new Error("Expand requires shape to be broadcastable to input")},W2=(n,e)=>{let t=n.length-e.length,r=[];for(let i=0;i<t;++i)r.push(n[i]);for(let i=0;i<e.length;++i)r.push(e[i]===1?n[i+t]:e[i]);return r},fI=(n,e)=>n.length>e.length?W2(n,e):W2(e,n),pI=n=>{let e=n[0].dims,t=Array.from(n[1].getBigInt64Array(),Number),r=fI(e,t),i=n[0].dataType,s=i===9||Ve.size(e)===1,a=i===9||e.length>0&&e[e.length-1]%4===0?4:1,o=s||r.length>0&&r[r.length-1]%4===0?4:1,l=Math.ceil(Ve.size(r)/o),c=d=>{let h=He("input",i,e.length,a),f=_t("output",i,r.length,o),p;if(i===9){let g=(b,_,m="")=>`
          let outputIndices${_} = ${f.offsetToIndices(`outputOffset + ${_}u`)};
          let offset${_} = ${h.broadcastedIndicesToOffset(`outputIndices${_}`,f)};
          let index${_} = offset${_} / 4u;
          let component${_} = offset${_} % 4u;
          ${b}[${_}] = ${m}(${h.getByOffset(`index${_}`)}[component${_}]);
        `;p=`
        let outputOffset = global_idx * ${o};
        var data = vec4<u32>(0);
        ${g("data",0,"u32")}
        ${g("data",1,"u32")}
        ${g("data",2,"u32")}
        ${g("data",3,"u32")}
        ${f.setByOffset("global_idx","data")}
      }`}else p=`
        let outputIndices = ${f.offsetToIndices(`global_idx * ${o}`)};
        let inputOffset = ${h.broadcastedIndicesToOffset("outputIndices",f)};
        let data = ${f.type.value}(${h.getByOffset(`inputOffset / ${a}`)});
        ${f.setByOffset("global_idx","data")}
      }`;return`
    ${d.registerUniform("vec_size","u32").declareVariables(h,f)}
    ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${p}`},u=[{type:12,data:l},...vt(e,r)];return{name:"Expand",shaderCache:{hint:`${r.length};${a}${o}`,inputDependencies:["rank"]},getShaderSource:c,getRunData:()=>({outputs:[{dims:r,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:u})}},D4=n=>{hI(n.inputs),n.compute(pI(n.inputs),{inputs:[0]})}}),mI,M4,r7=nt(()=>{Ft(),$t(),zt(),yD(),mI=n=>{let e=n[0].dataType,t=Ve.size(n[0].dims),r=Ve.size(n[1].dims),i=r%4===0,s=a=>{let o=He("x",e,[1],4),l=He("bias",e,[1],4),c=_t("y",e,[1],4),u=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],d=f=>`
      let bias${f}_offset: u32 = (global_idx * 4 + ${f}) % uniforms.bias_size;
      let bias${f} = ${l.getByOffset(`bias${f}_offset / 4`)}[bias${f}_offset % 4];`,h=i?`
      let bias = ${l.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${d(0)}${d(1)}${d(2)}${d(3)}
      let bias = ${o.type.value}(bias0, bias1, bias2, bias3);`;return`${a.registerUniforms(u).declareVariables(o,l,c)}

    ${zT(ui(e))}

    ${a.mainStart(_f)}
      ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${o.getByOffset("global_idx")};
      ${h}
      let x_in = x + bias;
      ${c.setByOffset("global_idx",WT("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${i}`,inputDependencies:["type","type"]},getShaderSource:s,getRunData:a=>({outputs:[{dims:a[0].dims,dataType:a[0].dataType}],programUniforms:[{type:12,data:Math.ceil(t/4)},{type:12,data:r}],dispatchGroup:{x:Math.ceil(t/_f/4)}})}},M4=n=>{n.inputs.length<2||Ve.size(n.inputs[1].dims)===0?qN(n):n.compute(mI(n.inputs))}}),gI,_I,A4,C4,i7=nt(()=>{Ft(),$t(),Zn(),zt(),gI=n=>{if(!n||n.length!==2)throw new Error("Gather requires 2 inputs.")},_I=(n,e)=>{let t=n[0].dims,r=n[1].dims,i=t.length,s=Ve.normalizeAxis(e.axis,i),a=t.slice(0);a.splice(s,1,...r);let o=t[s],l=n[0].dataType===9?4:1,c=Math.ceil(Ve.size(a)/l),u=[{type:12,data:c},{type:6,data:o},{type:12,data:s},...vt(n[0].dims,n[1].dims,a)],d=h=>{let f=He("data",n[0].dataType,n[0].dims.length,l),p=He("inputIndices",n[1].dataType,n[1].dims.length),g=_t("output",n[0].dataType,a.length,l),b=m=>{let v=r.length,x=`var indicesIndices${m}  = ${p.type.indices}(0);`;for(let w=0;w<v;w++)x+=`${v>1?`indicesIndices${m}[${w}]`:`indicesIndices${m}`} = ${a.length>1?`outputIndices${m}[uniforms.axis + ${w}]`:`outputIndices${m}`};`;x+=`
          var idx${m} = ${p.getByIndices(`indicesIndices${m}`)};
          if (idx${m} < 0) {
            idx${m} = idx${m} + uniforms.axisDimLimit;
          }
          var dataIndices${m} : ${f.type.indices};
        `;for(let w=0,T=0;w<i;w++)w===s?(x+=`${i>1?`dataIndices${m}[${w}]`:`dataIndices${m}`} = u32(idx${m});`,T+=v):(x+=`${i>1?`dataIndices${m}[${w}]`:`dataIndices${m}`} = ${a.length>1?`outputIndices${m}[${T}]`:`outputIndices${m}`};`,T++);return x},_;if(n[0].dataType===9){let m=(v,x,w="")=>`
          let outputIndices${x} = ${g.offsetToIndices(`outputOffset + ${x}u`)};
          ${b(x)};
          let offset${x} = ${f.indicesToOffset(`dataIndices${x}`)};
          let index${x} = offset${x} / 4u;
          let component${x} = offset${x} % 4u;
          ${v}[${x}] = ${w}(${f.getByOffset(`index${x}`)}[component${x}]);
        `;_=`
        let outputOffset = global_idx * ${l};
        var value = vec4<u32>(0);
        ${m("value",0,"u32")}
        ${m("value",1,"u32")}
        ${m("value",2,"u32")}
        ${m("value",3,"u32")}
        ${g.setByOffset("global_idx","value")}
      `}else _=`
      let outputIndices = ${g.offsetToIndices("global_idx")};
      ${b("")};
      let value = ${f.getByIndices("dataIndices")};
      ${g.setByOffset("global_idx","value")};
      `;return`
      ${h.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(f,p,g)}
      ${h.mainStart()}
        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${_}
      }`};return{name:"Gather",shaderCache:{hint:e.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:a,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u}),getShaderSource:d}},A4=n=>pn({axis:n.axis}),C4=(n,e)=>{let t=n.inputs;gI(t),n.compute(_I(n.inputs,e))}}),bI,S4,P4,s7=nt(()=>{Ft(),$t(),zt(),bI=(n,e,t,r,i,s,a,o,l)=>{let c=[{type:12,data:s},{type:12,data:r},{type:12,data:i},{type:12,data:t},{type:12,data:a},{type:12,data:o},{type:12,data:l}],u=[s];c.push(...vt(e.dims,u));let d=h=>{let f=He("indices_data",e.dataType,e.dims.length),p=_t("input_slice_offsets_data",12,1,1),g=[f,p],b=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:i.length},{name:"sizes_from_slice_dims_data",type:"u32",length:t.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return`
  ${h.registerUniforms(b).declareVariables(...g)}
  ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let batch_idx = global_idx / uniforms.num_slices_per_batch;
    let base_offset = batch_idx * uniforms.input_batch_stride;

    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;
    var relative_slice_offset = 0;
    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {
      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);
      let input_dim_idx = uniforms.batch_dims + dim_idx;
      if (index < 0) {
        ${i.length===1?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);"}
      }
      ${t.length===1?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);"}
    }

    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);
  }`};return n.compute({name:"computeSliceOffsets",shaderCache:{hint:`${i.length}_${t.length}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:u,dataType:n.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:c}),getShaderSource:d},{inputs:[e],outputs:[-1]})[0]},S4=(n,e)=>{let t=n.inputs,r=t[0].dims,i=t[0].dataType,s=t[1].dims,a=s[s.length-1],o=Ve.sizeToDimension(s,s.length-1),l=Ve.sizeFromDimension(r,e.batchDims+a),c=Ve.sizeToDimension(r,e.batchDims),u=Ve.sizeFromDimension(r,e.batchDims),d=o/c,h=new Array(a),f=l;for(let x=0;x<a;++x)h[a-1-x]=f,f*=r[e.batchDims+a-1-x];let p=bI(n,t[1],h,e.batchDims,r,o,d,u,a),g=e.batchDims+a;if(g>r.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let b=s.slice(0,-1).concat(r.slice(g)),_=Ve.size(b),m=[{type:12,data:_},{type:12,data:l},...vt(t[0].dims,p.dims,b)],v=x=>{let w=He("data",t[0].dataType,t[0].dims.length),T=He("slice_offsets",12,p.dims.length),E=_t("output",t[0].dataType,b.length);return`
          ${x.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(w,T,E)}
            ${x.mainStart()}
            ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];
          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];
        }`};n.compute({name:"GatherND",shaderCache:{hint:e.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:b,dataType:i}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:m}),getShaderSource:v},{inputs:[t[0],p]})},P4=n=>({batchDims:n.batch_dims,cacheKey:""})}),yI,vI,k4,F4,a7=nt(()=>{Ft(),$t(),Zn(),zt(),yI=(n,e)=>{if(n.length<3||n.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let t=Ve.normalizeAxis(e.quantizeAxis,n[0].dims.length),r=e.blockSize,i=n[0],s=n[2],a=n.length===4?n[3]:void 0;if(s.dims.length!==i.dims.length||!i.dims.map((o,l)=>l===t?Math.ceil(o/r)===s.dims[l]:o===s.dims[l]).reduce((o,l)=>o&&l,!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(a){if(a.dataType!==i.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(a.dims.length!==s.dims.length||!a.dims.map((o,l)=>o===s.dims[l]).reduce((o,l)=>o&&l,!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},vI=(n,e)=>{let t=n[0].dims,r=n[1].dims,i=t.length,s=Ve.normalizeAxis(e.gatherAxis,i),a=Ve.normalizeAxis(e.quantizeAxis,i),o=t.slice(0);o.splice(s,1,...r);let l=Ve.size(o),c=n[2].dataType,u=n[0].dataType===22,d=[{type:12,data:l},{type:12,data:a},{type:12,data:s},{type:12,data:e.blockSize},...vt(...n.map((f,p)=>f.dims),o)],h=f=>{let p=He("data",n[0].dataType,n[0].dims.length),g=He("inputIndices",n[1].dataType,n[1].dims.length),b=He("scales",n[2].dataType,n[2].dims.length),_=n.length>3?He("zeroPoint",n[3].dataType,n[3].dims.length):void 0,m=_t("output",c,o.length),v=[p,g,b];_&&v.push(_);let x=[{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}];return`
        ${f.registerUniforms(x).declareVariables(...v,m)}
        ${f.mainStart()}
        let output_indices = ${m.offsetToIndices("global_idx")};
        var indices_indices = ${g.type.indices}(0);
        ${r.length>1?`
          for (var i: u32 = 0; i < ${r.length}; i++) {
            let index = ${m.indicesGet("output_indices","uniforms.gather_axis + i")};
            ${g.indicesSet("indices_indices","i","index")};
          }`:`indices_indices = ${m.indicesGet("output_indices","uniforms.gather_axis")};`};
        var data_indices = ${p.type.indices}(0);
        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {
          let index = ${m.indicesGet("output_indices","i")};
          ${p.indicesSet("data_indices","i","index")};
        }
        var index_from_indices = ${g.getByIndices("indices_indices")};
        if (index_from_indices < 0) {
          index_from_indices += ${t[s]};
        }
        ${p.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)")};
        for (var i = uniforms.gather_axis + 1; i < ${o.length}; i++) {
          let index = ${m.indicesGet("output_indices",`i + ${r.length} - 1`)};
          ${p.indicesSet("data_indices","i","index")};
        }
        let data_offset = ${p.indicesToOffset("data_indices")};
        let data_index = data_offset % 8;
        // Convert 4-bit packed data to 8-bit packed data.
        let packed_4bit_quantized_data = ${p.getByOffset("data_offset / 8")};
        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;
        let quantized_data_vec = ${u?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_quantized_data));
        let quantized_data = quantized_data_vec[data_index / 2];
        var scale_indices = data_indices;
        let quantize_axis_index = ${b.indicesGet("data_indices","uniforms.quantize_axis")} / uniforms.block_size;
        ${b.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index")};
        var scale = ${b.getByIndices("scale_indices")};
        ${_?`
              let zero_point_indices = scale_indices;
              let zero_point_offset = ${_.indicesToOffset("zero_point_indices")};
              let zero_point_index = zero_point_offset % 8;
              let packed_4bit_zero_points = ${_.getByOffset("zero_point_offset / 8")};
              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;
              let zero_point_vec = ${u?"unpack4xI8":"unpack4xU8"}(u32(packed_8bit_zero_points));
              let zero_point = zero_point_vec[zero_point_index / 2];`:"var zero_point = 0"};
        let dequantized_data = ${ui(c)}(quantized_data - zero_point) * scale;
        ${m.setByOffset("global_idx","dequantized_data")};
    }`};return{name:"GatherBlockQuantized",shaderCache:{hint:`${e.cacheKey};${n.filter((f,p)=>p!==1).map(f=>f.dims.join("_")).join(";")}`,inputDependencies:Array.from({length:n.length},(f,p)=>"rank")},getRunData:()=>({outputs:[{dims:o,dataType:c}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:d}),getShaderSource:h}},k4=(n,e)=>{let t=n.inputs;yI(t,e),n.compute(vI(n.inputs,e))},F4=n=>pn({blockSize:n.blockSize,gatherAxis:n.gatherAxis,quantizeAxis:n.quantizeAxis})}),wI,xI,I4,O4,o7=nt(()=>{Ft(),$t(),Zn(),zt(),wI=n=>{if(!n||n.length!==2)throw new Error("GatherElements requires 2 inputs.");if(n[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(n[0].dims.length!==n[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},xI=(n,e)=>{let t=n[0].dims,r=n[0].dataType,i=t.length,s=n[1].dims,a=n[1].dataType,o=Ve.normalizeAxis(e.axis,i),l=t[o],c=s.slice(0),u=Ve.size(c),d=He("input",r,i),h=He("indicesInput",a,s.length),f=_t("output",r,c.length),p=[{type:12,data:u},{type:6,data:l},{type:12,data:o}];return p.push(...vt(t,s,c)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:c,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:p}),getShaderSource:g=>`
      ${g.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(d,h,f)}
      ${g.mainStart()}
      ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${f.offsetToIndices("global_idx")};

      var idx = ${h.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${d.type.indices}(outputIndices);
      ${d.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${d.getByIndices("inputIndices")};

      ${f.setByOffset("global_idx","value")};
  }`}},I4=n=>pn({axis:n.axis}),O4=(n,e)=>{let t=n.inputs;wI(t),n.compute(xI(n.inputs,e))}}),TI,EI,U4,L4,l7=nt(()=>{Ft(),$t(),zt(),TI=n=>{if(!n)throw new Error("Input is missing");if(n.length<2||n.length>3)throw new Error("Invaid input number.");if(n.length===3&&n[2].dims.length>2)throw new Error("Invalid input shape of C");if(n[0].dataType!==n[1].dataType||n.length===3&&n[0].dataType!==n[2].dataType)throw new Error("Input types are mismatched")},EI=(n,e)=>{let t=n[0].dims.slice(),r=n[1].dims.slice(),[i,s,a]=R$.getShapeOfGemmResult(t,e.transA,r,e.transB,n.length===3?n[2].dims:void 0),o=[i,s];if(!o)throw new Error("Can't use gemm on the given tensors");let l=16,c=Math.ceil(s/l),u=Math.ceil(i/l),d=!0,h=Ve.size(o),f=[{type:12,data:d?c:h},{type:12,data:i},{type:12,data:s},{type:12,data:a},{type:1,data:e.alpha},{type:1,data:e.beta}],p=["type","type"];n.length===3&&(f.push(...vt(n[2].dims)),p.push("rank")),f.push(...vt(o));let g=_=>{let m="";e.transA&&e.transB?m="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":e.transA&&!e.transB?m="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!e.transA&&e.transB?m="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!e.transA&&!e.transB&&(m="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let v=e.alpha===1?"":"value *= uniforms.alpha;",x=He("a",n[0].dataType,n[0].dims),w=He("b",n[1].dataType,n[1].dims),T=x.type.value,E=null,A=[x,w];n.length===3&&(E=He("c",n[2].dataType,n[2].dims.length),A.push(E));let M=_t("output",n[0].dataType,o.length);A.push(M);let F=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${_.registerUniforms(F).declareVariables(...A)}

  ${_.mainStart()}
    ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${T}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${m}
    }

    ${v}
    ${E!=null?`let cOffset = ${E.broadcastedIndicesToOffset("vec2(m, n)",M)}; value += ${T}(uniforms.beta) * ${E.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`},b=_=>{let m=He("a",n[0].dataType,n[0].dims),v=He("b",n[1].dataType,n[1].dims),x=null,w=[m,v];n.length===3&&(x=He("c",n[2].dataType,n[2].dims.length),w.push(x));let T=_t("output",n[0].dataType,o.length);w.push(T);let E=[{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}],A="",M="";e.transA&&e.transB?(M=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${m.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${v.type.value}(0);
      }
      `,A="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):e.transA&&!e.transB?(M=`
      var col = tile_row_start + local_id.x;
      var row = k_start + local_id.y;
      if (col < uniforms.M && row < uniforms.K) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${m.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${v.type.value}(0);
      }
      `,A="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!e.transA&&e.transB?(M=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${m.type.value}(0);
      }

      col = k_start + local_id.x;
      row = tile_col_start + local_id.y;
      if (col < uniforms.K && row < uniforms.N) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${v.type.value}(0);
      }
      `,A="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!e.transA&&!e.transB&&(M=`
      var col = k_start + local_id.x;
      var row = tile_row_start + local_id.y;
      if (col < uniforms.K && row < uniforms.M) {
        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];
      } else {
        tile_a[local_id.y][local_id.x] = ${m.type.value}(0);
      }

      col = tile_col_start + local_id.x;
      row = k_start + local_id.y;
      if (col < uniforms.N && row < uniforms.K) {
        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];
      } else {
        tile_b[local_id.y][local_id.x] = ${v.type.value}(0);
      }
      `,A="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let F=e.alpha===1?"":"value *= uniforms.alpha;";return`
  ${_.registerUniforms(E).declareVariables(...w)}
  var<workgroup> tile_a: array<array<${m.type.storage}, ${l}>, ${l}>;
  var<workgroup> tile_b: array<array<${v.type.storage}, ${l}>, ${l}>;
  ${_.mainStart([l,l,1])}
    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ${l};
    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ${l};
    let num_tiles = (uniforms.K - 1) / ${l} + 1;
    var k_start = 0u;
    var value = ${T.type.value}(0);
    for (var t: u32 = 0u; t < num_tiles; t++) {
      ${M}
      k_start = k_start + ${l};
      workgroupBarrier();

      for (var k: u32 = 0u; k < ${l}; k++) {
        ${A}
      }
      workgroupBarrier();
    }

    ${F}
    let m = tile_row_start + local_id.y;
    let n = tile_col_start + local_id.x;
    ${x!=null?`let cOffset = ${x.broadcastedIndicesToOffset("vec2(m, n)",T)}; value += ${T.type.value}(uniforms.beta) * ${x.getByOffset("cOffset")};`:""}
    if (m < uniforms.M && n < uniforms.N) {
      output[m * uniforms.N + n] = value;
    }
  }`};return d?{name:"GemmShared",shaderCache:{hint:`${e.cacheKey}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:o,dataType:n[0].dataType}],dispatchGroup:{x:c*u},programUniforms:f}),getShaderSource:b}:{name:"Gemm",shaderCache:{hint:`${e.cacheKey}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:o,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:f}),getShaderSource:g}},U4=n=>{let e=n.transA,t=n.transB,r=n.alpha,i=n.beta;return{transA:e,transB:t,alpha:r,beta:i,cacheKey:`${n.transA};${n.transB};${n.alpha===1}`}},L4=(n,e)=>{TI(n.inputs),n.compute(EI(n.inputs,e))}}),wa,Qa,Tc,Ec,DI,MI,AI,CI,SI,PI,kI,FI,R4,B4,c7=nt(()=>{Ft(),$t(),Zn(),zt(),[wa,Qa,Tc,Ec]=[0,1,2,3],DI=n=>{if(n[0].dims.length!==4)throw new Error("only 4-D tensor is supported.");if(n[0].dims.length!==n[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(n[0].dims.length-2!==n[1].dims[n[1].dims.length-1])throw new Error(`last dimension of grid must be equal to ${n[0].dims.length-2}`);if(n[0].dims[0]!==n[1].dims[0])throw new Error("grid batch size must match input batch size")},MI=`
  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {
    let cubic_alpha = -0.75f;
    let x_abs = abs(x);
    var coeffs: vec4<f32>;
    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);
    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);
    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);
    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);
    return coeffs;
  }
`,AI=n=>`
  fn gs_bicubic_interpolate(p: mat4x4<${n}>, x: f32, y: f32) -> ${n} {
    var v: vec4<f32>;
    var coeffs = gs_get_cubic_coeffs(x);
    for (var i = 0; i < 4; i++) {
      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];
    }
    coeffs = gs_get_cubic_coeffs(y);
    let pixel = ${n}(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);
    return pixel;
  }
`,CI=n=>`
  fn gs_denormalize(n: f32, length: i32) -> f32 {
    ${n.alignCorners===0?`
    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]
    return ((n + 1.0) * f32(length) - 1.0) / 2.0;
    `:`
    // alignCorners: true => [-1, 1] to [0, length - 1]
    return (n + 1.0) / 2.0 * (f32(length - 1));
    `}
  }
`,SI=n=>`
  ${n.paddingMode==="reflection"?`
      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {
        var dx = 0.0;
        var fx = f32(x);
        let range = x_max - x_min;
        if (fx < x_min) {
          dx = x_min - fx;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_min + r;
          } else {
            fx = x_max - r;
          }
        } else if (fx > x_max) {
          dx = fx - x_max;
          let n = u32(dx / range);
          let r = dx - f32(n) * range;
          if (n % 2 == 0) {
            fx = x_max - r;
          } else {
            fx = x_min + r;
          }
        }
        return u32(fx);
      }`:""}
`,PI=(n,e,t)=>`
  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ${e} {
     var pixel = ${e}(0);
     var indices = vec4<u32>(0);
     indices[${wa}] = batch;
     indices[${Qa}] = channel;`+(()=>{switch(t.paddingMode){case"zeros":return`
          if (r >= 0 && r < H && c >=0 && c < W) {
            indices[${Tc}] = u32(r);
            indices[${Ec}] = u32(c);
          }
        `;case"border":return`
          indices[${Tc}] = u32(clamp(r, 0, H - 1));
          indices[${Ec}] = u32(clamp(c, 0, W - 1));
        `;case"reflection":return`
          indices[${Tc}] = gs_reflect(r, border[1], border[3]);
          indices[${Ec}] = gs_reflect(c, border[0], border[2]);
        `;default:throw new Error(`padding mode ${t.paddingMode} is not supported`)}})()+`
    return ${n.getByIndices("indices")};
  }
`,kI=(n,e,t)=>(()=>{switch(t.mode){case"nearest":return`
          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[${wa}], indices[${Qa}], border);
        `;case"bilinear":return`
          let x1 = i32(floor(x));
          let y1 = i32(floor(y));
          let x2 = x1 + 1;
          let y2 = y1 + 1;

          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[${wa}], indices[${Qa}], border);
          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[${wa}], indices[${Qa}], border);
          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[${wa}], indices[${Qa}], border);
          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[${wa}], indices[${Qa}], border);

          let dx2 = ${e}(f32(x2) - x);
          let dx1 = ${e}(x - f32(x1));
          let dy2 = ${e}(f32(y2) - y);
          let dy1 = ${e}(y - f32(y1));
          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);
        `;case"bicubic":return`
          let x0 = i32(floor(x)) - 1;
          let y0 = i32(floor(y)) - 1;
          var p: mat4x4<${e}>;
          for (var h = 0; h < 4; h++) {
            for (var w = 0; w < 4; w++) {
              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[${wa}], indices[${Qa}], border);
            }
          }

          let dx = x - f32(x0 + 1);
          let dy = y - f32(y0 + 1);
          let result = gs_bicubic_interpolate(p, dx, dy);
        `;default:throw new Error(`mode ${t.mode} is not supported`)}})()+`${n.setByOffset("global_idx","result")}`,FI=(n,e)=>{let t=He("x",n[0].dataType,n[0].dims.length),r=[n[1].dims[0],n[1].dims[1],n[1].dims[2]],i=He("grid",n[1].dataType,r.length,2),s=[n[0].dims[0],n[0].dims[1],n[1].dims[1],n[1].dims[2]];e.format==="NHWC"&&(s=[n[0].dims[0],n[1].dims[1],n[1].dims[2],n[0].dims[3]],[wa,Qa,Tc,Ec]=[0,3,1,2]);let a=_t("output",n[0].dataType,s.length),o=t.type.value,l=Ve.size(s),c=[{type:12,data:l},...vt(n[0].dims,r,s)],u=d=>`
  ${d.registerUniform("output_size","u32").declareVariables(t,i,a)}
  ${MI}
  ${AI(o)}
  ${CI(e)}
  ${SI(e)}
  ${PI(t,o,e)}

  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let H_in = i32(uniforms.x_shape[${Tc}]);
      let W_in = i32(uniforms.x_shape[${Ec}]);

      ${e.alignCorners===0?`
      let x_min = -0.5;
      let x_max = f32(W_in) - 0.5;
      let y_min = -0.5;
      let y_max = f32(H_in) - 0.5;
      `:`
      let x_min = 0.0;
      let x_max = f32(W_in) - 1.0;
      let y_min = 0.0;
      let y_max = f32(H_in) - 1.0;
      `};
      let border = vec4<f32>(x_min, y_min, x_max, y_max);

      let indices = ${a.offsetToIndices("global_idx")};
      var grid_indices = vec3<u32>(indices[${wa}], indices[${Tc}], indices[${Ec}]);
      let nxy = ${i.getByIndices("grid_indices")};
      var x = gs_denormalize(f32(nxy[0]), W_in);
      var y = gs_denormalize(f32(nxy[1]), H_in);

      ${kI(a,o,e)}
  }`;return{name:"GridSample",shaderCache:{hint:`${e.cacheKey}`,inputDependencies:["type","type"]},getRunData:d=>{let h=Ve.size(s);return{outputs:[{dims:s,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:c}},getShaderSource:u}},R4=(n,e)=>{DI(n.inputs),n.compute(FI(n.inputs,e))},B4=n=>pn({alignCorners:n.align_corners,mode:n.mode,paddingMode:n.padding_mode,format:n.format})}),wi,II,$4,j2,OI,Fm,N4,z4=nt(()=>{Ft(),$t(),Zn(),mD(),bD(),zt(),Zl(),wi=(n,e)=>n.length>e&&n[e].dims.length>0?n[e]:void 0,II=(n,e)=>{let t=n[0],r=wi(n,1),i=wi(n,2),s=wi(n,3),a=wi(n,4),o=wi(n,5),l=wi(n,6),c=wi(n,7);if(t.dims.length!==3&&t.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let u=t.dims[0],d=t.dims[1],h=t.dims.length===3?t.dims[2]:e.numHeads*t.dims[4],f=d,p=0,g=0,b=Math.floor(h/e.numHeads);if(l&&c&&Ve.size(l.dims)&&Ve.size(c.dims)){if(l.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(l.dims[0]!==u||l.dims[1]!==e.numHeads||l.dims[3]!==b)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(c.dims[0]!==u||c.dims[1]!==e.numHeads||c.dims[3]!==b)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(l.dims[2]!==c.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(c.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');p=l.dims[2],g=l.dims[2]}else if(l&&Ve.size(l.dims)||c&&Ve.size(c.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let _;if(r&&Ve.size(r.dims)>0){if(t.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(t.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(r.dims.length===3){if(r.dims[2]!==t.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');_=2,f=r.dims[1]}else if(r.dims.length===5){if(r.dims[2]!==e.numHeads||r.dims[3]!==2||r.dims[4]!==b)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');_=5,f=r.dims[1]}else{if(r.dims[1]!==e.numHeads||r.dims[3]!==b)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');_=0,f=r.dims[2]}}else{if(t.dims.length!==5)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(t.dims[2]!==e.numHeads||t.dims[3]!==3)throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');_=3}if(s&&Ve.size(s.dims)>0){if(s.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(r&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let m=p+f,v=0;if(a&&Ve.size(a.dims)>0){v=8;let E=a.dims;throw E.length===1?E[0]===u?v=1:E[0]===3*u+2&&(v=3):E.length===2&&E[0]===u&&E[1]===m&&(v=5),v===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let x=!1,w=h;if(i&&Ve.size(i.dims)>0){if(i.dims.length!==3&&i.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(t.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(i.dims.length===3){if(f!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');w=i.dims[2]}else{if(f!==i.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');w=i.dims[1]*i.dims[3],x=!0}}let T=!1;if(a&&Ve.size(a.dims)>0)throw new Error("Key padding mask is not supported");if(o&&Ve.size(o.dims)>0){if(o.dims.length!==4)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(o.dims[0]!==u||o.dims[1]!==e.numHeads||o.dims[2]!==d||o.dims[3]!==m)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:u,sequenceLength:d,pastSequenceLength:p,kvSequenceLength:f,totalSequenceLength:m,maxSequenceLength:g,inputHiddenSize:0,hiddenSize:h,vHiddenSize:w,headSize:b,vHeadSize:Math.floor(w/e.numHeads),numHeads:e.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:e.maskFilterValue,maskType:v,scale:e.scale,broadcastResPosBias:T,passPastInKv:x,qkvFormat:_}},$4=n=>pn({...n}),j2=pn({perm:[0,2,1,3]}),OI=(n,e,t,r,i,s,a)=>{let o=[r,i,s],l=Ve.size(o),c=[{type:12,data:l},{type:12,data:a},{type:12,data:s}],u=d=>{let h=_t("qkv_with_bias",e.dataType,o),f=He("qkv",e.dataType,o),p=He("bias",t.dataType,o),g=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${d.registerUniforms(g).declareVariables(f,p,h)}
  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return n.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:o,dataType:e.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c}),getShaderSource:u},{inputs:[e,t],outputs:[-1]})[0]},Fm=(n,e,t,r,i,s,a,o)=>{let l=s;if(a&&Ve.size(a.dims)>0){if(r===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return l=OI(n,s,a,e,r,t*i,o),l=l.reshape([e,r,t,i]),t===1||r===1?l:n.compute(hs(l,j2.perm),{inputs:[l],outputs:[-1]})[0]}else return s.dims.length===3&&(l=s.reshape([e,r,t,i])),t===1||r===1?l:n.compute(hs(l,j2.perm),{inputs:[l],outputs:[-1]})[0]},N4=(n,e)=>{let t=II(n.inputs,e),r=n.inputs[0],i=wi(n.inputs,1),s=wi(n.inputs,2),a=wi(n.inputs,3),o=wi(n.inputs,4),l=wi(n.inputs,5),c=wi(n.inputs,6),u=wi(n.inputs,7);if(r.dims.length===5)throw new Error("Packed QKV is not implemented");if(i?.dims.length===5)throw new Error("Packed KV is not implemented");let d=i&&s&&i.dims.length===4&&s.dims.length===4,h=Fm(n,t.batchSize,t.numHeads,t.sequenceLength,t.headSize,r,a,0);if(d)return Km(n,h,i,s,o,void 0,c,u,l,t);if(!i||!s)throw new Error("key and value must be provided");let f=Fm(n,t.batchSize,t.numHeads,t.kvSequenceLength,t.headSize,i,a,t.hiddenSize),p=Fm(n,t.batchSize,t.numHeads,t.kvSequenceLength,t.vHeadSize,s,a,2*t.hiddenSize);Km(n,h,f,p,o,void 0,c,u,l,t)}}),UI,LI,RI,BI,HT,W4,j4,V4=nt(()=>{Ft(),$t(),Zn(),zt(),UI=n=>{if(!n||n.length<1)throw new Error("too few inputs")},LI=(n,e)=>{let t=[],r=e.numOutputs;return n[1].dims[0]>0&&(n[1].getBigInt64Array().forEach(i=>t.push(Number(i))),r=t.length),pn({numOutputs:r,axis:e.axis,splitSizes:t})},RI=n=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${n}u; i += 1u ) {
    if (index < ${yt("uniforms.size_in_split_axis","i",n)}) {
        return i;
    }
    }
    return ${n}u;
}`,BI=n=>{let e=n.length,t=[];for(let r=0;r<e;++r){let i=n[r].setByIndices("indices","input[global_idx]");e===1?t.push(i):r===0?t.push(`if (output_number == ${r}u) { ${i} }`):r===e-1?t.push(`else { ${i} }`):t.push(`else if (output_number == ${r}) { ${i} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${n[0].type.indices}, global_idx: u32) {
        ${t.join(`
`)}
      }`},HT=(n,e)=>{let t=n[0].dims,r=Ve.size(t),i=n[0].dataType,s=Ve.normalizeAxis(e.axis,t.length),a=new Array(e.numOutputs),o=He("input",i,t.length),l=new Array(e.numOutputs),c=[],u=[],d=0,h=[{type:12,data:r}];for(let p=0;p<e.numOutputs;p++){d+=e.splitSizes[p],l[p]=d;let g=t.slice();g[s]=e.splitSizes[p],u.push(g),a[p]=_t(`output${p}`,i,g.length),c.push({dims:u[p],dataType:n[0].dataType})}h.push({type:12,data:l},...vt(t,...u));let f=p=>`
  ${p.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",l.length).declareVariables(o,...a)}
  ${RI(l.length)}
  ${BI(a)}

  ${p.mainStart()}
    ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${o.offsetToIndices("global_idx")};
    var index = ${o.indicesGet("indices",s)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${yt("uniforms.size_in_split_axis","output_number - 1u",l.length)};
      ${o.indicesSet("indices",s,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:e.cacheKey,inputDependencies:["rank"]},getShaderSource:f,getRunData:()=>({outputs:c,dispatchGroup:{x:Math.ceil(r/64)},programUniforms:h})}},W4=(n,e)=>{UI(n.inputs);let t=n.inputs.length===1?e:LI(n.inputs,e);n.compute(HT(n.inputs,t),{inputs:[0]})},j4=n=>{let e=n.axis,t=n.splitSizes,r=n.numOutputs<0?t.length:n.numOutputs;if(r!==t.length)throw new Error("numOutputs and splitSizes lengh must be equal");return pn({axis:e,numOutputs:r,splitSizes:t})}}),$I,NI,V2,G4,u7=nt(()=>{Zn(),bD(),z4(),V4(),Zl(),$I=(n,e)=>{if(e.doRotary)throw new Error("GroupQuerryAttention do_rotary attribute is not supported");if(e.doRotary&&n.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let t=n[0],r=n[1],i=n[2],s=n[3],a=n[4];if(e.localWindowSize!==-1)throw new Error("Local attention is not supported");if(e.softcap!==0)throw new Error("Softcap is not supported");if(e.rotaryInterleaved!==0)throw new Error("Rotary interleaved is not supported");if(e.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(t.dims.length!==3&&t.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let o=!1,l=t.dims[0],c=t.dims[1],u=t.dims.length===3?o?t.dims[2]/3:t.dims[2]:e.numHeads*t.dims[4],d=c,h=0,f=!r||r.dims.length===0,p=Math.floor(f?u/(e.numHeads+2*e.kvNumHeads):u/e.numHeads);f&&(u=p*e.numHeads);let g=s&&s.dims.length!==0,b=a&&a.dims.length!==0;if(g&&s.dims.length===4&&s.dims[0]===l&&s.dims[1]!==e.kvNumHeads&&s.dims[2]===e.kvNumHeads&&s.dims[3]===p)throw new Error("BSNH pastKey/pastValue is not supported");if(g&&b){if(s.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(a.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');h=s.dims[2]}else if(g||b)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let _=1;if(r&&r.dims.length>0){if(t.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(t.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(r.dims.length===3){if(t.dims[2]%r.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');d=r.dims[1]}else if(r.dims.length===5){if(r.dims[2]!==e.numHeads||r.dims[3]!==2||r.dims[4]!==p)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(i)throw new Error('Expect "value" be none when "key" has packed kv format.');d=r.dims[1]}else{if(r.dims[1]!==e.numHeads||r.dims[3]!==p)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');d=r.dims[2]}}else{if(t.dims.length!==3&&t.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(t.dims.length===5&&(t.dims[2]!==e.numHeads||t.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');_=3}let m=0,v=!1,x=e.kvNumHeads?p*e.kvNumHeads:u;if(i&&i.dims.length>0){if(i.dims.length!==3&&i.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(t.dims[0]!==i.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(i.dims.length===3){if(d!==i.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');x=i.dims[2]}else{if(d!==i.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');x=i.dims[1]*i.dims[3],v=!0}}let w=n.length>4?n[5]:void 0;if(w&&w.dims.length!==1&&w.dims[0]!==l)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:l,sequenceLength:c,pastSequenceLength:h,kvSequenceLength:d,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:u,vHiddenSize:x,headSize:p,vHeadSize:Math.floor(x/e.kvNumHeads),numHeads:e.numHeads,kvNumHeads:e.kvNumHeads,nReps:e.numHeads/e.kvNumHeads,pastPresentShareBuffer:!1,maskType:m,scale:e.scale,broadcastResPosBias:!1,passPastInKv:v,qkvFormat:_}},NI=pn({perm:[0,2,1,3]}),V2=(n,e,t)=>{let r=e,i=t.kvNumHeads;return e.dims.length===3&&t.kvSequenceLength!==0&&(r=e.reshape([t.batchSize,t.kvSequenceLength,i,t.headSize]),r=n.compute(hs(r,NI.perm),{inputs:[r],outputs:[-1]})[0]),r},G4=(n,e)=>{let t=$I(n.inputs,e);if(n.inputs[0].dims.length===5)throw new Error("Packed QKV is not implemented");if(n.inputs[1]?.dims.length===5)throw new Error("Packed KV is not implemented");let r=n.inputs[0],i=n.inputs[1]&&n.inputs[1].dims.length>0?n.inputs[1]:void 0,s=n.inputs[2]&&n.inputs[2].dims.length>0?n.inputs[2]:void 0,a=n.inputs[3]&&n.inputs[3].dims.length!==0?n.inputs[3]:void 0,o=n.inputs[4]&&n.inputs[4].dims.length!==0?n.inputs[4]:void 0,l=n.inputs.length>4?n.inputs[5]:void 0,c=n.inputs.length>5?n.inputs[6]:void 0,u=t.kvNumHeads?t.kvNumHeads:t.numHeads,d=pn({axis:2,numOutputs:3,splitSizes:[t.numHeads*t.headSize,u*t.headSize,u*t.headSize]}),[h,f,p]=!i&&!s?n.compute(HT([r],d),{inputs:[r],outputs:[-1,-1,-1]}):[r,i,s],g=Fm(n,t.batchSize,t.numHeads,t.sequenceLength,t.headSize,h,void 0,0);Km(n,g,V2(n,f,t),V2(n,p,t),void 0,void 0,a,o,void 0,t,l,c)}}),G2,zI,WI,q4,d7=nt(()=>{Ft(),$t(),Zl(),zt(),G2=(n,e,t,r,i,s,a,o)=>{let l=jn(s),c=l===1?"f32":`vec${l}f`,u=l===1?"vec2f":`mat2x${l}f`,d=i*a,h=64;d===1&&(h=256);let f=[i,a,s/l],p=[i,a,2],g=["rank","type","type"],b=[];b.push(...vt(f,p));let _=m=>{let v=He("x",e.dataType,3,l),x=He("scale",t.dataType,t.dims),w=He("bias",r.dataType,r.dims),T=_t("output",1,3,2),E=[v,x,w,T];return`
  var<workgroup> workgroup_shared : array<${u}, ${h}>;
  const workgroup_size = ${h}u;
  ${m.declareVariables(...E)}
  ${m.mainStart(h)}
    let batch = workgroup_index / uniforms.x_shape[1];
    let channel = workgroup_index % uniforms.x_shape[1];
    let hight = uniforms.x_shape[2];
    // initialize workgroup memory
    var sum = ${c}(0);
    var squared_sum = ${c}(0);
    for (var h = local_idx; h < hight; h += workgroup_size) {
      let value = ${c}(${v.get("batch","channel","h")});
      sum += value;
      squared_sum += value * value;
    }
    workgroup_shared[local_idx] = ${u}(sum, squared_sum);
    workgroupBarrier();

    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (local_idx < currSize) {
        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];
      }
      workgroupBarrier();
    }
    if (local_idx == 0) {
      let sum_final = ${Vl("workgroup_shared[0][0]",l)} / f32(hight * ${l});
      let squared_sum_final = ${Vl("workgroup_shared[0][1]",l)} / f32(hight * ${l});

      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(${o}));
      let channel_scale = inv_std_dev * f32(scale[channel]);
      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;
      output[workgroup_index] = vec2f(channel_scale, channel_shift);
    }
  }`};return n.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${l};${o};${h}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:p,dataType:1}],dispatchGroup:{x:d},programUniforms:b}),getShaderSource:_},{inputs:[e,t,r],outputs:[-1]})[0]},zI=(n,e,t)=>{let r=e[0].dims,i=r,s=2,a=r[0],o=r[1],l=Ve.sizeFromDimension(r,s),c=jn(l),u=Ve.size(i)/c,d=G2(n,e[0],e[1],e[2],a,l,o,t.epsilon),h=[a,o,l/c],f=[a,o],p=["type","none"],g=b=>{let _=He("x",e[0].dataType,h.length,c),m=He("scale_shift",1,f.length,2),v=_t("output",e[0].dataType,h.length,c),x=[_,m,v];return`
  ${b.registerUniform("output_size","u32").declareVariables(...x)}
  ${b.mainStart()}
  ${b.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let outputIndices = ${v.offsetToIndices("global_idx")};
      let batch = outputIndices[0];
      let channel = outputIndices[1];
      let scale_shift = ${m.getByIndices("vec2<u32>(batch, channel)")};
      let value = ${_.getByOffset("global_idx")} * ${v.type.value}(scale_shift.x) + ${v.type.value}(scale_shift.y);
      ${v.setByOffset("global_idx","value")};
  }`};n.compute({name:"InstanceNormalization",shaderCache:{hint:`${c}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:[{type:12,data:u},...vt(h,f,h)]}),getShaderSource:g},{inputs:[e[0],d]})},WI=(n,e,t)=>{let r=e[0].dims,i=r,s=r[0],a=r[r.length-1],o=Ve.sizeFromDimension(r,1)/a,l=jn(a),c=Ve.size(i)/l,u=[{type:12,data:o},{type:12,data:Math.floor(a/l)}],d=["type","type"],h=!1,f=[0,r.length-1];for(let _=0;_<r.length-2;_++)h=h||r[_+1]!==1,f.push(_+1);h=h&&r[r.length-1]!==1;let p=h?n.compute(hs(n.inputs[0],f),{inputs:[n.inputs[0]],outputs:[-1]})[0]:n.inputs[0].reshape(Array.from({length:r.length},(_,m)=>r[f[m]])),g=G2(n,p,e[1],e[2],s,o,a,t.epsilon),b=_=>{let m=Sr(e[0].dataType),v=l===1?"vec2f":`mat${l}x2f`,x=E=>{let A=E===0?"x":"y",M=l===1?"f32":`vec${l}f`;switch(l){case 1:return`${m}(${M}(scale.${A}))`;case 2:return`vec2<${m}>(${M}(scale[0].${A}, scale[1].${A}))`;case 4:return`vec4<${m}>(${M}(scale[0].${A}, scale[1].${A}, scale[2].${A}, scale[3].${A}))`;default:throw new Error(`Not supported compoents ${l}`)}},w=He("input",e[0].dataType,e[0].dims,l),T=_t("output",e[0].dataType,i,l);return`
  @group(0) @binding(0) var<storage, read> input : array<${w.type.storage}>;
  @group(0) @binding(1) var<storage, read> scale_input : array<${v}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${T.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${_.mainStart()}
    let current_image_number = global_idx / (uniforms.C * uniforms.H);
    let current_channel_number = global_idx % uniforms.C;

    let scale_offset = current_image_number * uniforms.C + current_channel_number;
    let scale = scale_input[scale_offset];
    output[global_idx] = fma(input[global_idx], ${x(0)}, ${x(1)});
  }`};n.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${l}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u}),getShaderSource:b},{inputs:[e[0],g]})},q4=(n,e)=>{e.format==="NHWC"?WI(n,n.inputs,e):zI(n,n.inputs,e)}}),jI,VI,H4,h7=nt(()=>{Ft(),$t(),zt(),jI=n=>{if(!n||n.length<2)throw new Error("layerNorm requires at least 2 inputs.")},VI=(n,e,t)=>{let r=e.simplified,i=n[0].dims,s=n[1],a=!r&&n[2],o=i,l=Ve.normalizeAxis(e.axis,i.length),c=Ve.sizeToDimension(i,l),u=Ve.sizeFromDimension(i,l),d=Ve.size(s.dims),h=a?Ve.size(a.dims):0;if(d!==u||a&&h!==u)throw new Error(`Size of X.shape()[axis:] == ${u}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${d} and bias size of ${h}`);let f=[];for(let w=0;w<i.length;++w)w<l?f.push(i[w]):f.push(1);let p=jn(u),g=["type","type"],b=[{type:12,data:c},{type:1,data:u},{type:12,data:Math.floor(u/p)},{type:1,data:e.epsilon}];a&&g.push("type");let _=t>1,m=t>2,v=w=>{let T=Sr(n[0].dataType),E=[He("x",n[0].dataType,n[0].dims,p),He("scale",s.dataType,s.dims,p)];a&&E.push(He("bias",a.dataType,a.dims,p)),E.push(_t("output",n[0].dataType,o,p)),_&&E.push(_t("mean_data_output",1,f)),m&&E.push(_t("inv_std_output",1,f));let A=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${w.registerUniforms(A).declareVariables(...E)}
  ${w.mainStart()}
    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${BT("f32",p)};
    var mean_square_vector = ${BT("f32",p)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${eh(T,p,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${Vl("mean_vector",p)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${Vl("mean_square_vector",p)} / uniforms.norm_size ${r?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${eh(T,p,"x[j + offset]")};
      let f32scale = ${eh(T,p,"scale[j]")};
      output[j + offset] = ${E[0].type.value}((f32input ${r?"":"- mean"}) * inv_std_dev * f32scale
        ${a?`+ ${eh(T,p,"bias[j]")}`:""}
      );
    }

    ${_?"mean_data_output[global_idx] = mean":""};
    ${m?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},x=[{dims:o,dataType:n[0].dataType}];return _&&x.push({dims:f,dataType:1}),m&&x.push({dims:f,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${p};${t};${r}`,inputDependencies:g},getRunData:()=>({outputs:x,dispatchGroup:{x:Math.ceil(c/64)},programUniforms:b}),getShaderSource:v}},H4=(n,e)=>{jI(n.inputs),n.compute(VI(n.inputs,e,n.outputCount))}}),GI,K4,f7=nt(()=>{$t(),TD(),ED(),GI=n=>{if(!n||n.length!==2)throw new Error("MatMul requires 2 inputs.");if(n[0].dims[n[0].dims.length-1]!==n[1].dims[n[1].dims.length-2])throw new Error("shared dimension does not match.")},K4=n=>{GI(n.inputs);let e=gf.calcShape(n.inputs[0].dims,n.inputs[1].dims,!0);if(!e)throw new Error("Can't use matmul on the given tensors");let t=e[e.length-1],r=n.inputs[0].dims[n.inputs[0].dims.length-1];if(t<8&&r<8)n.compute(xD(n.inputs,{activation:""},e));else{let i=e[e.length-2],s=Ve.size(n.inputs[0].dims.slice(0,-2)),a=Ve.size(n.inputs[1].dims.slice(0,-2));if(s!==1&&i===1&&a===1){let o=n.inputs[0].reshape([1,s,r]),l=n.inputs[1].reshape([1,r,t]),c=[1,s,t],u=[o,l];n.compute(Z0(u,{activation:""},e,c),{inputs:u})}else n.compute(Z0(n.inputs,{activation:""},e))}}}),qI,HI,KI,X4,Y4,p7=nt(()=>{Ft(),$t(),Zn(),zt(),qI=(n,e)=>{if(n.length<3||n.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let t=n[0],r=t.dims.length;if(t.dims[r-1]!==e.k)throw new Error("The last dim of input shape does not match the k value");let i=Math.floor((e.k+e.blockSize-1)/e.blockSize),s=e.blockSize/8*e.bits,a=n[1];if(!Ve.areEqual(a.dims,[e.n,i,s]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let o=n[2].dims;if(Ve.size(o)!==e.n*i)throw new Error("scales input size error.");if(n.length===4){let l=n[3].dims,c=e.bits>4?e.n*i:e.n*Math.floor((i+1)/2);if(Ve.size(l)!==c)throw new Error("zeroPoints input size error.")}},HI=(n,e)=>{let t=n[0].dims,r=t.length,i=t[r-2],s=e.k,a=e.n,o=t.slice(0,r-2),l=Ve.size(o),c=n[1].dims[2]/4,u=n[0].dataType,d=jn(e.k),h=jn(c),f=jn(a),p=o.concat([i,a]),g=i>1&&a/f%2===0?2:1,b=Ve.size(p)/f/g,_=64,m=[],v=[l,i,s/d],x=Ve.convertShape(n[1].dims).slice();x.splice(-1,1,c/h),m.push(...vt(v)),m.push(...vt(x)),m.push(...vt(n[2].dims)),n.length===4&&m.push(...vt(Ve.convertShape(n[3].dims)));let w=[l,i,a/f];m.push(...vt(w));let T=E=>{let A=v.length,M=He("a",n[0].dataType,A,d),F=He("b",12,x.length,h),G=He("scales",n[2].dataType,n[2].dims.length),S=[M,F,G],I=n.length===4?He("zero_points",12,n[3].dims.length):void 0;I&&S.push(I);let C=w.length,H=_t("output",n[0].dataType,C,f),B=Sr(n[0].dataType),$=(()=>{switch(d){case 1:return`array<${B}, 8>`;case 2:return`mat4x2<${B}>`;case 4:return`mat2x4<${B}>`;default:throw new Error(`${d}-component is not supported.`)}})(),X=()=>{let R=`
          // reuse a data
            var input_offset = ${M.indicesToOffset(`${M.type.indices}(batch, row, word_offset)`)};
            var a_data: ${$};
            for (var j: u32 = 0; j < ${8/d}; j++) {
              a_data[j] = ${M.getByOffset("input_offset")};
              input_offset++;
            }
          `;for(let O=0;O<f*g;O++)R+=`
            b_value = ${h===1?`b${O}_data`:`b${O}_data[i]`};
            b_value_lower = unpack4xU8(b_value & b_mask);
            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);
            b_quantized_values = ${$}(${Array.from({length:4},(L,ne)=>`${B}(b_value_lower[${ne}]), ${B}(b_value_upper[${ne}])`).join(", ")});
            b_dequantized_values = ${d===1?`${$}(${Array.from({length:8},(L,ne)=>`(b_quantized_values[${ne}] - ${I?`zero_point${O}`:"zero_point"}) * scale${O}`).join(", ")});`:`(b_quantized_values - ${$}(${Array(8).fill(`${I?`zero_point${O}`:"zero_point"}`).join(",")})) * scale${O};`};
            workgroup_shared[local_id.x * ${g} + ${Math.floor(O/f)}]${f>1?`[${O%f}]`:""} += ${Array.from({length:8/d},(L,ne)=>`${d===1?`a_data[${ne}] * b_dequantized_values[${ne}]`:`dot(a_data[${ne}], b_dequantized_values[${ne}])`}`).join(" + ")};
          `;return R},V=()=>{let R=`
            var col_index = col * ${f};
            ${I?`
            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;
            var zero_point_byte_count: u32;
            var zero_point_word_index: u32;
            var zero_point_byte_offset: u32;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32;
            var zero_point_word: u32;`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${B}(8);`}
            `;for(let O=0;O<f*g;O++)R+=`
            let scale${O} = ${G.getByOffset("col_index * nBlocksPerCol + block")};
            ${I?`
            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);
            zero_point_word_index = zero_point_byte_count >> 0x2u;
            zero_point_byte_offset = zero_point_byte_count & 0x3u;
            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            zero_point_word = ${I.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point${O} = ${B}((zero_point_word) & 0xFu);`:""}
            col_index += 1;`;return R},Q=()=>{let R=`col_index = col * ${f};`;for(let O=0;O<f*g;O++)R+=`
            let b${O}_data = ${F.getByIndices(`${F.type.indices}(col_index, block, word)`)};
            col_index += 1;`;return R+=`
            var b_value: u32;
            let b_mask: u32 = 0x0F0F0F0Fu;
            var b_value_lower: vec4<u32>;
            var b_value_upper: vec4<u32>;
            var b_quantized_values: ${$};
            var b_dequantized_values: ${$};`,R};return`
        var<workgroup> workgroup_shared: array<${H.type.value}, ${g*_}>;
        ${E.declareVariables(...S,H)}
        ${E.mainStart([_,1,1])}
          let output_indices = ${H.offsetToIndices(`(global_idx / ${_}) * ${g}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let nBlocksPerCol = uniforms.b_shape[1];

          for (var block = local_id.x; block < nBlocksPerCol; block += ${_}) {
            //process one block
            var word_offset: u32 = block * ${e.blockSize/d};
            ${V()}
            for (var word: u32 = 0; word < ${c}; word += ${h}) {
              ${Q()}
              for (var i: u32 = 0; i < ${h}; i++) {
                ${X()}
                word_offset += ${8/d};
              }
            }
          }
          workgroupBarrier();

          if (local_id.x < ${g}) {
            var output_value: ${H.type.value} = ${H.type.value}(0);
            var workgroup_shared_offset: u32 = local_id.x;
            for (var b: u32 = 0u; b < ${_}u; b++) {
              output_value += workgroup_shared[workgroup_shared_offset];
              workgroup_shared_offset += ${g};
            }
            ${H.setByIndices(`${H.type.indices}(batch, row, col + local_id.x)`,"output_value")};
          }
        }`};return{name:"MatMulNBits",shaderCache:{hint:`${e.blockSize};${e.bits};${d};${h};${f};${g};${_}`,inputDependencies:Array(n.length).fill("rank")},getRunData:()=>({outputs:[{dims:p,dataType:u}],dispatchGroup:{x:b},programUniforms:m}),getShaderSource:T}},KI=(n,e)=>{let t=n[0].dims,r=t.length,i=t[r-2],s=e.k,a=e.n,o=t.slice(0,r-2),l=Ve.size(o),c=n[1].dims[2]/4,u=n[0].dataType,d=jn(e.k),h=jn(c),f=o.concat([i,a]),p=128,g=a%8===0?8:a%4===0?4:1,b=p/g,_=b*h*8,m=_/d,v=_/e.blockSize,x=Ve.size(f)/g,w=[],T=[l,i,s/d],E=Ve.convertShape(n[1].dims).slice();E.splice(-1,1,c/h),w.push(...vt(T)),w.push(...vt(E)),w.push(...vt(n[2].dims)),n.length===4&&w.push(...vt(Ve.convertShape(n[3].dims)));let A=[l,i,a];w.push(...vt(A));let M=F=>{let G=T.length,S=He("a",n[0].dataType,G,d),I=He("b",12,E.length,h),C=He("scales",n[2].dataType,n[2].dims.length),H=[S,I,C],B=n.length===4?He("zero_points",12,n[3].dims.length):void 0;B&&H.push(B);let $=A.length,X=_t("output",n[0].dataType,$),V=Sr(n[0].dataType),Q=()=>{switch(d){case 1:return`
          let a_data0 = vec4<${V}>(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);
          let a_data1 = vec4<${V}>(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);`;case 2:return`
          let a_data0 = vec4<${V}>(sub_a[word_offset], sub_a[word_offset + 1]);
          let a_data1 = vec4<${V}>(sub_a[word_offset + 2], sub_a[word_offset + 3]);`;case 4:return`
          let a_data0 = sub_a[word_offset];
          let a_data1 = sub_a[word_offset + 1];`;default:throw new Error(`${d}-component is not supported.`)}};return`
        var<workgroup> sub_a: array<${S.type.value}, ${m}>;
        var<workgroup> inter_results: array<array<${X.type.value}, ${b}>, ${g}>;
        ${F.declareVariables(...H,X)}
        ${F.mainStart([b,g,1])}
          let output_indices = ${X.offsetToIndices(`workgroup_index * ${g}`)};
          let col = output_indices[2];
          let row = output_indices[1];
          let batch = output_indices[0];
          let n_blocks_per_col = uniforms.b_shape[1];
          let num_tiles =  (n_blocks_per_col - 1) / ${v} + 1;

          // Loop over shared dimension.
          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {
            let a_col_start = tile * ${m};
            // load one tile A data into shared memory.
            for (var a_offset = local_idx; a_offset < ${m}; a_offset += ${p})
            {
              let a_col = a_col_start + a_offset;
              if (a_col < uniforms.a_shape[2])
              {
                sub_a[a_offset] = ${S.getByIndices(`${S.type.indices}(batch, row, a_col)`)};
              } else {
                sub_a[a_offset] = ${S.type.value}(0);
              }
            }
            workgroupBarrier();

            // each thread process one block
            let b_row = col + local_id.y;
            let block = tile * ${v} + local_id.x;
            ${B?`
            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;
            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);
            let zero_point_word_index = zero_point_byte_count >> 0x2u;
            let zero_point_byte_offset = zero_point_byte_count & 0x3u;
            let zero_point_nibble_offset: u32 = block & 0x1u;
            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            let zero_point_word = ${B.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;
            let zero_point = ${V}((zero_point_word) & 0xFu);`:`
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${V}(8);`}
            let scale = ${C.getByOffset("b_row * n_blocks_per_col + block")};
            let b_data = ${I.getByIndices(`${I.type.indices}(b_row, block, 0)`)};
            var word_offset = local_id.x * ${e.blockSize/d};
            for (var i: u32 = 0; i < ${h}; i++) {
              ${Q()}
              let b_value = ${h===1?"b_data":"b_data[i]"};
              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);
              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);
              let b_quantized_values = mat2x4<${V}>(${Array.from({length:4},(R,O)=>`${V}(b_value_lower[${O}]), ${V}(b_value_upper[${O}])`).join(", ")});
              let b_dequantized_values = (b_quantized_values - mat2x4<${V}>(${Array(8).fill("zero_point").join(",")})) * scale;
              inter_results[local_id.y][local_id.x] += ${Array.from({length:2},(R,O)=>`${`dot(a_data${O}, b_dequantized_values[${O}])`}`).join(" + ")};
              word_offset += ${8/d};
            }
            workgroupBarrier();
          }

          if (local_idx < ${g}) {
            var output_value: ${X.type.value} = ${X.type.value}(0);
            for (var b = 0u; b < ${b}; b++) {
              output_value += inter_results[local_idx][b];
            }
            if (col + local_idx < uniforms.output_shape[2])
            {
              ${X.setByIndices(`${X.type.indices}(batch, row, col + local_idx)`,"output_value")}
            }
          }
        }`};return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:`${e.blockSize};${d};${h};${b};${g}`,inputDependencies:Array(n.length).fill("rank")},getRunData:()=>({outputs:[{dims:f,dataType:u}],dispatchGroup:{x},programUniforms:w}),getShaderSource:M}},X4=(n,e)=>{qI(n.inputs,e),e.blockSize===32&&n.adapterInfo.isVendor("intel")&&n.adapterInfo.isArchitecture("gen-12lp")?n.compute(KI(n.inputs,e)):n.compute(HI(n.inputs,e))},Y4=n=>pn(n)}),XI,YI,QI,ZI,JI,eO,tO,nO,Q4,m7=nt(()=>{Ft(),$t(),zt(),XI=n=>{if(!n||n.length<1)throw new Error("Too few inputs");if(n[0].dataType!==1&&n[0].dataType!==10)throw new Error("Input type must be float or float16.");if(n.length>=2){let e=n[0].dims.length*2===n[1].dims[0];if(n.length===4&&(e=n[3].dims[0]*2===n[1].dims[0]),!e)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},YI=(n,e,t)=>{let r="";for(let i=e-1;i>=0;--i)r+=`
            k = i32(${n.indicesGet("indices",i)}) - ${yt("uniforms.pads",i,t)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${yt("uniforms.x_shape",i,e)})) {
              break;
            }
            offset += k * i32(${yt("uniforms.x_strides",i,e)});
        `;return`
          value = ${n.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${r}
            value = x[offset];
          }
      `},QI=(n,e,t)=>{let r="";for(let i=e-1;i>=0;--i)r+=`
                k = i32(${n.indicesGet("indices",i)}) - ${yt("uniforms.pads",i,t)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${yt("uniforms.x_shape",i,e)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${yt("uniforms.x_shape",i,e)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${yt("uniforms.x_strides",i,e)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},ZI=(n,e,t)=>{let r="";for(let i=e-1;i>=0;--i)r+=`
                k = i32(${n.indicesGet("indices",i)}) - ${yt("uniforms.pads",i,t)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${yt("uniforms.x_shape",i,e)})) {
                  k = i32(${yt("uniforms.x_shape",i,e)}) - 1;
                }
                offset += k * i32(${yt("uniforms.x_strides",i,e)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},JI=(n,e,t)=>{let r="";for(let i=e-1;i>=0;--i)r+=`
                k = i32(${n.indicesGet("indices",i)}) - ${yt("uniforms.pads",i,t)};
                if (k < 0)  {
                  k += i32(${yt("uniforms.x_shape",i,e)}]);
                }
                if (k >= i32(${yt("uniforms.x_shape",i,e)})) {
                  k -= i32(${yt("uniforms.x_shape",i,e)});
                }
                offset += k * i32(${yt("uniforms.x_strides",i,e)});
            `;return`
              var offset = 0;
              var k = 0;
              ${r}
              value = x[offset];
          `},eO=(n,e,t)=>{switch(t.mode){case 0:return YI(n,e,t.pads.length);case 1:return QI(n,e,t.pads.length);case 2:return ZI(n,e,t.pads.length);case 3:return JI(n,e,t.pads.length);default:throw new Error("Invalid mode")}},tO=(n,e)=>{let t=Ve.padShape(n[0].dims.slice(),e.pads),r=n[0].dims,i=Ve.size(t),s=[{type:12,data:i},{type:6,data:e.pads}],a=n.length>=3&&n[2].data;e.mode===0&&s.push({type:a?n[2].dataType:1,data:e.value}),s.push(...vt(n[0].dims,t));let o=["rank"],l=c=>{let u=_t("output",n[0].dataType,t.length),d=He("x",n[0].dataType,r.length),h=d.type.value,f=eO(u,r.length,e),p=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:e.pads.length}];return e.mode===0&&p.push({name:"constant_value",type:a?h:"f32"}),`
            ${c.registerUniforms(p).declareVariables(d,u)}
            ${c.mainStart()}
            ${c.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${u.offsetToIndices("global_idx")};

            var value = ${h}(0);
            ${f}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${e.mode}${a}`,inputDependencies:o},getRunData:()=>({outputs:[{dims:t,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(Ve.size(t)/64)},programUniforms:s}),getShaderSource:l}},nO=(n,e)=>{if(n.length>1){let t=n[1].getBigInt64Array(),r=n.length>=3&&n[2].data?n[2].dataType===10?n[2].getUint16Array()[0]:n[2].getFloat32Array()[0]:0,i=n[0].dims.length,s=new Int32Array(2*i).fill(0);if(n.length>=4){let o=n[3].getBigInt64Array();for(let l=0;l<o.length;l++)s[Number(o[l])]=Number(t[l]),s[Number(o[l])+i]=Number(t[l+o.length])}else t.forEach((o,l)=>s[Number(l)]=Number(o));let a=[];return s.forEach(o=>a.push(o)),{mode:e.mode,value:r,pads:a}}else return e},Q4=(n,e)=>{XI(n.inputs);let t=nO(n.inputs,e);n.compute(tO(n.inputs,t),{inputs:[0]})}}),lm,q2,H2,K2,X2,rO,iO,Y2,Q2,Z4,J4,Z2,e8,t8,J2,n8,r8,i8,s8,g7=nt(()=>{pa(),Ft(),$t(),zt(),lm=n=>{if(In.webgpu.validateInputContent&&(!n||n.length!==1))throw new Error("Pool ops requires 1 input.")},q2=(n,e,t)=>{let r=e.format==="NHWC",i=n.dims.slice();r&&i.splice(1,0,i.pop());let s=Object.hasOwnProperty.call(e,"dilations"),a=e.kernelShape.slice(),o=e.strides.slice(),l=s?e.dilations.slice():[],c=e.pads.slice();Y0.adjustPoolAttributes(t,i,a,o,l,c);let u=Y0.computePoolOutputShape(t,i,o,l,a,c,e.autoPad),d=Object.assign({},e);s?Object.assign(d,{kernelShape:a,strides:o,pads:c,dilations:l,cacheKey:e.cacheKey}):Object.assign(d,{kernelShape:a,strides:o,pads:c,cacheKey:e.cacheKey});let h=u.slice();return h.push(h.splice(1,1)[0]),[d,r?h:u]},H2=(n,e)=>{let t=e.format==="NHWC",r=Ve.size(n),i=Ve.size(e.kernelShape),s=[{type:12,data:r},{type:12,data:i}],a=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(e.kernelShape.length<=2){let o=e.kernelShape[e.kernelShape.length-1],l=e.strides[e.strides.length-1],c=e.pads[e.pads.length/2-1],u=e.pads[e.pads.length-1],d=!!(c+u);s.push({type:12,data:o},{type:12,data:l},{type:12,data:c},{type:12,data:u}),a.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let h=!1;if(e.kernelShape.length===2){let f=e.kernelShape[e.kernelShape.length-2],p=e.strides[e.strides.length-2],g=e.pads[e.pads.length/2-2],b=e.pads[e.pads.length-2];h=!!(g+b),s.push({type:12,data:f},{type:12,data:p},{type:12,data:g},{type:12,data:b}),a.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[s,a,!0,d,h]}else{if(t)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let o=Ve.computeStrides(e.kernelShape);s.push({type:12,data:o},{type:12,data:e.pads},{type:12,data:e.strides}),a.push({name:"kernelStrides",type:"u32",length:o.length},{name:"pads",type:"u32",length:e.pads.length},{name:"strides",type:"u32",length:e.strides.length});let l=e.pads.reduce((c,u)=>c+u);return[s,a,!!l,!1,!1]}},K2=(n,e,t,r,i,s,a,o,l,c,u,d)=>{let h=i.format==="NHWC",f=e.type.value,p=_t("output",e.type.tensor,r);if(i.kernelShape.length<=2){let g="",b="",_="",m=t-(h?2:1);if(u?g=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${m}] = indices[${m}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${m}] < 0 || xIndices[${m}]
                      >= uniforms.x_shape[${m}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${e.indicesToOffset("xIndices")}];
                  ${s}
                }`:g=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${m}] = indices[${m}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${e.indicesToOffset("xIndices")}];
                  ${s}
                }`,i.kernelShape.length===2){let v=t-(h?3:2);d?b=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${v}] = indices[${v}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${v}] < 0 || xIndices[${v}] >= uniforms.x_shape[${v}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:b=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${v}] = indices[${v}] * uniforms.sh - uniforms.phStart + j;
                `,_=`
              }
            `}return`
            ${n.registerUniforms(l).declareVariables(e,p)}

            ${n.mainStart()}
              ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${p.offsetToIndices("global_idx")};
              var xIndices = ${p.offsetToIndices("global_idx")};

              var value = ${f}(${o});
              var pad = 0;
              ${b}
              ${g}
              ${_}
              ${a}

              output[global_idx] = value;
            }`}else{if(h)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let g=i.kernelShape.length,b=i.pads.length,_="";return c?_=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${e.indicesToOffset("xIndices")}];
                ${s}
              }`:_=`
              }
              let x_val = x[${e.indicesToOffset("xIndices")}];
              ${s}
            `,`
            ${n.registerUniforms(l).declareVariables(e,p)}

            ${n.mainStart()}
              ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${p.offsetToIndices("global_idx")};
              var xIndices = ${p.offsetToIndices("global_idx")};

              var offsets: array<u32, ${g}>;

              var value = ${f}(${o});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${g-1}u; j++) {
                  offsets[j] = offset / ${yt("uniforms.kernelStrides","j",g)};
                  offset -= offsets[j] * ${yt("uniforms.kernelStrides","j",g)};
                }
                offsets[${g-1}] = offset;

                isPad = false;
                for (var j = ${t-g}u; j < ${t}u; j++) {
                  xIndices[j] = indices[j] * ${yt("uniforms.strides",`j - ${t-g}u`,g)}
                    + offsets[j - ${t-g}u] - ${yt("uniforms.pads","j - 2u",b)};
                  ${_}
              }
              ${a}

              output[global_idx] = value;
            }`}},X2=n=>`${n.format};${n.ceilMode};${n.autoPad};${n.kernelShape.length}`,rO=n=>`${X2(n)};${n.countIncludePad}`,iO=n=>`${X2(n)};${n.storageOrder};${n.dilations}`,Y2=n=>({format:n.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][n.auto_pad],ceilMode:n.ceil_mode,kernelShape:n.kernel_shape,strides:n.strides,pads:n.pads}),Q2=(n,e,t,r)=>{let[i,s]=q2(e,r,t),a=He("x",e.dataType,e.dims.length),o=a.type.value,l="value += x_val;",c="";i.countIncludePad?c+=`value /= ${o}(uniforms.kernelSize);`:c+=`value /= ${o}(i32(uniforms.kernelSize) - pad);`;let[u,d,h,f,p]=H2(s,i);u.push(...vt(e.dims,s));let g=["rank"];return{name:n,shaderCache:{hint:`${r.cacheKey};${h};${f};${p}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:s,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(Ve.size(s)/64)},programUniforms:u}),getShaderSource:b=>K2(b,a,e.dims.length,s.length,i,l,c,0,d,h,f,p)}},Z4=n=>{let e=n.count_include_pad!==0,t=Y2(n);if(t.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let r={countIncludePad:e,...t,cacheKey:""};return{...r,cacheKey:rO(r)}},J4=(n,e)=>{lm(n.inputs),n.compute(Q2("AveragePool",n.inputs[0],!1,e))},Z2={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},e8=n=>{let e=n.format;return{format:e,...Z2,cacheKey:e}},t8=(n,e)=>{lm(n.inputs),n.compute(Q2("GlobalAveragePool",n.inputs[0],!0,e))},J2=(n,e,t,r)=>{let[i,s]=q2(e,r,t),a=`
      value = max(x_val, value);
    `,o="",l=He("x",e.dataType,e.dims.length),c=["rank"],[u,d,h,f,p]=H2(s,i);return u.push(...vt(e.dims,s)),{name:n,shaderCache:{hint:`${r.cacheKey};${h};${f};${p}`,inputDependencies:c},getRunData:()=>({outputs:[{dims:s,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(Ve.size(s)/64)},programUniforms:u}),getShaderSource:g=>K2(g,l,e.dims.length,s.length,i,a,o,e.dataType===10?-65504:-1e5,d,h,f,p)}},n8=(n,e)=>{lm(n.inputs),n.compute(J2("MaxPool",n.inputs[0],!1,e))},r8=n=>{let e=n.storage_order,t=n.dilations,r=Y2(n);if(e!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let i={storageOrder:e,dilations:t,...r,cacheKey:""};return{...i,cacheKey:iO(i)}},i8=n=>{let e=n.format;return{format:e,...Z2,cacheKey:e}},s8=(n,e)=>{lm(n.inputs),n.compute(J2("GlobalMaxPool",n.inputs[0],!0,e))}}),sO,aO,a8,o8,_7=nt(()=>{Ft(),$t(),Zn(),zt(),sO=(n,e)=>{if(n.length<2||n.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(n.length===3&&n[1].dims===n[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(n.length===3&&n[0].dataType!==n[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(n[0].dataType===6&&n.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(n[1].dims.length!==0&&n[1].dims.length!==1&&n[1].dims.length!==n[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(n.length>2){if(n[0].dataType!==n[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(n[1].dims.length!==n[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!n[1].dims.map((t,r)=>t===n[2].dims[r]).reduce((t,r)=>t&&r,!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(e.blockSize>0){if(n[1].dims.length===0||n[1].dims.length===1&&n[1].dims[0]===1)throw new Error("blockSize must be set only for block quantization.");if(!n[1].dims.map((i,s)=>s===e.axis||i===n[0].dims[s]).reduce((i,s)=>i&&s,!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(n[1].dims.length!==n[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let t=n[0].dims[e.axis],r=n[1].dims[e.axis];if(e.blockSize<Math.ceil(t/r)||e.blockSize>Math.ceil(t/(r-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},aO=(n,e)=>{let t=Ve.normalizeAxis(e.axis,n[0].dims.length),r=n[0].dataType,i=r===3,s=n[0].dims,a=n[1].dataType,o=Ve.size(s),l=r===3||r===2,c=l?[Math.ceil(Ve.size(n[0].dims)/4)]:n[0].dims,u=n[1].dims,d=n.length>2?n[2]:void 0,h=d?l?[Math.ceil(Ve.size(d.dims)/4)]:d.dims:void 0,f=u.length===0||u.length===1&&u[0]===1,p=f===!1&&u.length===1,g=jn(o),b=f&&(!l||g===4),_=b?g:1,m=b&&!l?g:1,v=He("input",l?12:r,c.length,m),x=He("scale",a,u.length),w=d?He("zero_point",l?12:r,h.length):void 0,T=_t("output",a,s.length,_),E=[v,x];w&&E.push(w);let A=[c,u];d&&A.push(h);let M=[{type:12,data:o/_},{type:12,data:t},{type:12,data:e.blockSize},...vt(...A,s)],F=G=>{let S=[{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}];return`
      ${G.registerUniforms(S).declareVariables(...E,T)}
      ${G.mainStart()}
          ${G.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          let output_indices = ${T.offsetToIndices("global_idx")};

          // Set input x
          ${l?`
            let input = ${v.getByOffset("global_idx / 4")};
            let x_vec = ${i?"unpack4xI8(input)":"unpack4xU8(input)"};
            let x_value = ${_===1?"x_vec[global_idx % 4]":"x_vec"};`:`let x_value = ${v.getByOffset("global_idx")};`};

          // Set scale input
          ${f?`let scale_value= ${x.getByOffset("0")}`:p?`
            let scale_index = ${T.indicesGet("output_indices","uniforms.axis")};
            let scale_value= ${x.getByOffset("scale_index")};`:`
            var scale_indices: ${x.type.indices} = output_indices;
            let index = ${x.indicesGet("scale_indices","uniforms.axis")} / uniforms.block_size;
            ${x.indicesSet("scale_indices","uniforms.axis","index")};
            let scale_value= ${x.getByIndices("scale_indices")};`};

          // Set zero-point input
          ${w?f?l?`
                let zero_point_input = ${w.getByOffset("0")};
                let zero_point_vec =  ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value= zero_point_vec[0]`:`let zero_point_value = ${w.getByOffset("0")}`:p?l?`
                let zero_point_index = ${T.indicesGet("output_indices","uniforms.axis")};
                let zero_point_input = ${w.getByOffset("zero_point_index / 4")};
                let zero_point_vec =  ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_index % 4]`:`
                let zero_point_index = ${T.indicesGet("output_indices","uniforms.axis")};
                let zero_point_value = ${w.getByOffset("zero_point_index")};`:l?`
                let zero_point_offset = ${x.indicesToOffset("scale_indices")};
                let zero_point_input = ${w.getByOffset("zero_point_offset / 4")};
                let zero_point_vec = ${i?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)"};
                let zero_point_value = zero_point_vec[zero_point_offset % 4];`:`let zero_point_value = ${w.getByIndices("scale_indices")};`:`let zero_point_value = ${l?i?"i32":"u32":v.type.value}(0);`};
      // Compute and write output
      ${T.setByOffset("global_idx",`${T.type.value}(x_value - zero_point_value) * scale_value`)};
      }`};return{name:"DequantizeLinear",shaderCache:{hint:e.cacheKey,inputDependencies:w?["rank","rank","rank"]:["rank","rank"]},getShaderSource:F,getRunData:()=>({outputs:[{dims:s,dataType:a}],dispatchGroup:{x:Math.ceil(o/_/64),y:1,z:1},programUniforms:M})}},a8=(n,e)=>{sO(n.inputs,e),n.compute(aO(n.inputs,e))},o8=n=>pn({axis:n.axis,blockSize:n.blockSize})}),oO,lO,l8,b7=nt(()=>{pa(),Ft(),zt(),oO=(n,e,t)=>{let r=n===e,i=n<e&&t<0,s=n>e&&t>0;if(r||i||s)throw new Error("Range these inputs' contents are invalid.")},lO=(n,e,t,r)=>{let i=Math.abs(Math.ceil((e-n)/t)),s=[i],a=i,o=[{type:12,data:a},{type:r,data:n},{type:r,data:t},...vt(s)],l=c=>{let u=_t("output",r,s.length),d=u.type.value,h=[{name:"outputSize",type:"u32"},{name:"start",type:d},{name:"delta",type:d}];return`
        ${c.registerUniforms(h).declareVariables(u)}
        ${c.mainStart()}
        ${c.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${d}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${r}`},getShaderSource:l,getRunData:()=>({outputs:[{dims:s,dataType:r}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:o})}},l8=n=>{let e=0,t=0,r=0;n.inputs[0].dataType===6?(e=n.inputs[0].getInt32Array()[0],t=n.inputs[1].getInt32Array()[0],r=n.inputs[2].getInt32Array()[0]):n.inputs[0].dataType===1&&(e=n.inputs[0].getFloat32Array()[0],t=n.inputs[1].getFloat32Array()[0],r=n.inputs[2].getFloat32Array()[0]),In.webgpu.validateInputContent&&oO(e,t,r),n.compute(lO(e,t,r,n.inputs[0].dataType),{inputs:[]})}}),cO,uO,c8,u8,y7=nt(()=>{Ft(),$t(),Zn(),zt(),cO=(n,e,t,r)=>{if(n!=="none"&&r!=="i32"&&r!=="u32"&&r!=="f32")throw new Error(`Input ${r} is not supported with reduction ${n}.`);let i=`{
                var oldValue = 0;
                loop {
                  let newValueF32 =`,s=`;
                  let newValue = bitcast<i32>(newValueF32);
                  let res = atomicCompareExchangeWeak(&${e}, oldValue, newValue);
                  if res.exchanged {
                    break;
                  }
                  oldValue = res.old_value;
                }
              }`;switch(n){case"none":return`${e}=${t};`;case"add":return r==="i32"||r==="u32"?`atomicAdd(&${e}, bitcast<${r}>(${t}));`:`
              ${i}bitcast<${r}>(oldValue) + (${t})${s}`;case"max":return r==="i32"||r==="u32"?`atomicMax(&${e}, bitcast<${r}>(${t}));`:`
                ${i}max(bitcast<f32>(oldValue), (${t}))${s}`;case"min":return r==="i32"||r==="u32"?`atomicMin(&${e}, bitcast<${r}>(${t}));`:`${i}min(bitcast<${r}>(oldValue), (${t}))${s}`;case"mul":return`${i}(bitcast<${r}>(oldValue) * (${t}))${s}`;default:throw new Error(`Reduction ${n} is not supported.`)}},uO=(n,e)=>{let t=n[0].dims,r=n[1].dims,i=t,s=1,a=Math.ceil(Ve.size(r)/s),o=r[r.length-1],l=Ve.sizeFromDimension(t,o),c=[{type:12,data:a},{type:12,data:o},{type:12,data:l},...vt(n[1].dims,n[2].dims,i)],u=d=>{let h=He("indices",n[1].dataType,n[1].dims.length),f=He("updates",n[2].dataType,n[2].dims.length,s),p=e.reduction!=="none"&&e.reduction!==""?N$("output",n[0].dataType,i.length):_t("output",n[0].dataType,i.length,s);return`
      ${d.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(h,f,p)}
      ${d.mainStart()}
        ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
  var hasDuplicates = false;
  if (${e.reduction==="none"}) {
    let n = ${Ve.size(r)};
    for (var i = 0; i < n; i = i + 1) {
      for (var j = i + 1; j < n; j = j + 1) {
        var index_i = i32(indices[i].x);
        var index_j = i32(indices[j].x);
        if (index_i == index_j) {
          hasDuplicates = true;
          break;
        }
      }
      if (hasDuplicates) {
        break;
      }
    }
  }

  var data_offset = 0u;
  var indices_start = uniforms.last_index_dimension * global_idx;
  if (${e.reduction==="none"} && hasDuplicates) {
    if (global_idx != 0u) {
      return;
    }
    indices_start = 0u;
  }
  let indices_end = indices_start + uniforms.last_index_dimension;
  for (var i = indices_start; i < indices_end; i++) {
    var index = i32(indices[i].x);
    ${n[0].dims.length===1?`
    let element_count_dim = uniforms.output_strides;
    let dim_value = uniforms.output_shape;`:`
    let element_count_dim = uniforms.output_strides[i - indices_start];
    let dim_value = uniforms.output_shape[i - indices_start + uniforms.last_index_dimension];`}
    if (index >= 0) {
      if (index >= i32(dim_value)) {
        index = i32(dim_value - 1);
      }
    } else {
      if (index < -i32(dim_value)) {
        index = 0;
      } else {
        index += i32(dim_value);
      }
    }
    data_offset += u32((u32(index) * element_count_dim));
  }

  for (var i = 0u; i < uniforms.num_updates_elements; i++) {
    let value = updates[uniforms.num_updates_elements * global_idx + i];
    ${cO(e.reduction,"output[data_offset + i]","value",p.type.value)}
  }

      }`};return{name:"ScatterND",shaderCache:{hint:`${e.cacheKey}_${e.reduction}`,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:i,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:c}),getShaderSource:u}},c8=n=>pn({reduction:n.reduction}),u8=(n,e)=>{n.compute(uO(n.inputs,e),{inputs:[n.inputs[1],n.inputs[2]],outputs:[]})}}),dO,hO,fO,ex,pO,mO,gO,_O,bO,yO,vO,wO,tx,xO,TO,EO,DO,MO,d8,h8,v7=nt(()=>{Ft(),$t(),Zn(),zt(),dO=(n,e)=>{if(n.every(t=>t>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),n.length>0){if(e.mode==="linear"){if(!(n.length===2||n.length===3||n.length===4&&n[0]===1&&n[1]===1||n.length===4&&n[0]===1&&n[3]===1||n.length===5&&n[0]===1&&n[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(e.mode==="cubic"&&!(n.length===2||n.length===4&&n[0]===1&&n[1]===1||n.length===4&&n[0]===1&&n[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},hO=(n,e,t)=>{e.every(i=>i>=0&&i<t||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let r=new Array(t).fill(1);return e.forEach((i,s)=>r[i]=n[s]),r},fO=(n,e,t,r,i,s)=>{let[a,o,l]=t>10?[1,2,3]:[-1,n.length>1?1:-1,-1],c=n[0].dims.length;if(a>0&&n.length>a&&n[a].dims.length>0)n[a].getFloat32Array().forEach(u=>s.push(u));else if(e.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(o>0&&n.length>o&&n[o].dims.length===1&&n[o].dims[0]>0){if(n[o].getFloat32Array().forEach(u=>r.push(u)),r.length!==0&&r.length!==c&&t>=18&&r.length!==e.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");dO(r,e),e.axes.length>0&&hO(r,e.axes,c).forEach((u,d)=>r[d]=u)}if(l>0&&n.length>l&&n[l].dims.length===1&&n[l].dims[0]>0&&(n[l].getBigInt64Array().forEach(u=>i.push(Number(u))),i.length!==0&&i.length!==c&&t>=18&&i.length!==e.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(e.axes.length>0){if(r.length!==0&&r.length!==e.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(i.length!==0&&i.length!==e.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof r<"u"&&typeof i<"u"&&r.length>0&&i.length>c)throw new Error("Resize requires only of scales or sizes to be specified")},ex=(n,e,t,r)=>`
  // The whole part and the fractional part are calculated separately due to inaccuracy of floating
  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
  // offset-by-one error later in floor().
  let big = (${n}) * (${e});
  let whole = ${r}(big / (${t}));
  let fract = ${r}(big % (${t})) / ${r}(${t});
  return whole + fract;
`,pO=(n,e)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${e} { `+(()=>{switch(n){case"asymmetric":return`
          if (xScale < 1.0 || floor(xScale) != xScale) {
            return ${e}(xResized) / ${e}(xScale);
          } else {
            ${ex("xResized","lengthOriginal","lengthResized",e)}
          }
        `;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${e}(xResized) + 0.5) / ${e}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${e}(xResized) + 0.5) / ${e}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    ${ex("xResized","lengthOriginal - 1","lengthResized - 1",e)}
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${e}(roiStart) * ${e}(lengthOriginal - 1) +
                        (${e}(xResized) * ${e}(roiEnd - roiStart) * ${e}(lengthOriginal - 1)) /
                        ${e}(lengthResized - 1);
                  } else {
                    return 0.5 * ${e}(roiStart + roiEnd) * ${e}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${e}xScale * ${e}(lengthResized);
                  const adjustment = ${e}(lengthResized) / outputWidth;
                  const center = ${e}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${e}(xResized) + 0.5) / ${e}(xScale)) - 0.5;`;case"half_pixel":return`return ((${e}(xResized) + 0.5) / ${e}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${n} is not supported`)}})()+"}",mO=(n,e,t)=>`fn getNearestPixelFromOriginal(xOriginal: ${t}, isDownSample: bool) -> ${t} {`+(()=>{switch(n){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(e<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${n} is not supported`)}})()+"}",gO=(n,e,t)=>{let r=new Array(t).fill(0).concat(new Array(t).fill(1)),i=n.length===0?r:n.slice();return e.length>0?(e.forEach((s,a)=>{r[s]=i[a],r[a+t]=i[e.length+a]}),r):i},_O=(n,e,t,r)=>{let i=[];if(t.length>0)if(r.length>0){if(n.forEach(s=>i.push(s)),Math.max(...r)>n.length)throw new Error("axes is out of bound");r.forEach((s,a)=>i[s]=t[a])}else t.forEach(s=>i.push(s));else{if(e.length===0)throw new Error("Resize requires either scales or sizes.");i=n.map((s,a)=>Math.round(s*e[a]))}return i},bO=(n,e,t)=>{let r=(()=>{switch(t.keepAspectRatioPolicy){case"not_larger":return t.axes.length>0?Math.min(...t.axes.map(s=>e[s]),Number.MAX_VALUE):Math.min(...e,Number.MAX_VALUE);case"not_smaller":return t.axes.length>0?Math.max(...t.axes.map(s=>e[s]),Number.MIN_VALUE):Math.max(...e,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${t.keepAspectRatioPolicy} is not supported`)}})();e.fill(1,0,e.length);let i=n.slice();return t.axes.length>0?(t.axes.forEach(s=>e[s]=r),t.axes.forEach(s=>i[s]=Math.round(n[s]*e[s]))):(e.fill(r,0,e.length),i.forEach((s,a)=>i[a]=Math.round(s*e[a]))),i},yO=(n,e,t,r,i)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${n.type.indices}) -> array<${n.type.value}, ${t.length}> {
      var original_indices: array<${n.type.value}, ${t.length}>;
      for (var i:u32 = 0; i < ${t.length}; i++) {
        var output_index = ${n.indicesGet("output_indices","i")};
        var scale = ${yt("uniforms.scales","i",r)};
        var roi_low = ${yt("uniforms.roi","i",i)};
        var roi_hi = ${yt("uniforms.roi",`i + ${e.length}`,i)};
        if (scale == 1.0) {
          original_indices[i] = ${n.type.value}(output_index);
        } else {
          var input_shape_i = ${yt("uniforms.input_shape","i",e.length)};
          var output_shape_i = ${yt("uniforms.output_shape","i",t.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,vO=(n,e,t,r,i,s,a)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> ${n.type.indices} {
      var input_indices: ${n.type.indices};
      for (var i:u32 = 0; i < ${r.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${yt("uniforms.scales","i",i)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${yt("uniforms.roi","i",s)};
          var roi_hi = ${yt("uniforms.roi",`i + ${t.length}`,s)};
          var input_shape_i = ${yt("uniforms.input_shape","i",t.length)};
          var output_shape_i = ${yt("uniforms.output_shape","i",r.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${a} || (original_idx >= 0 && original_idx < ${e.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${e.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${n.indicesSet("input_indices","i","input_index")}
      }
      return input_indices;
    }`,wO=(n,e)=>`
    fn checkInputIndices(input_indices: ${n.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${e.length}; i++) {
        var input_index = ${n.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${yt("uniforms.input_shape","i",e.length)}) {
          return false;
        }
      }
      return true;
    }`,tx=(n,e,t,r)=>n.rank>r?`
    ${n.indicesSet("input_indices",e,"channel")};
    ${n.indicesSet("input_indices",t,"batch")};
`:"",xO=(n,e,t,r,i)=>{let[s,a,o,l]=t.length===2?[-1,0,1,-1]:[0,2,3,1],c=n.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${c} {
      var input_indices: ${n.type.indices};
      ${n.indicesSet("input_indices",a,`max(0, min(row, ${t[a]} - 1))`)};
      ${n.indicesSet("input_indices",o,`max(0, min(col, ${t[o]} - 1))`)};
      ${tx(n,l,s,2)}
      return ${n.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${e.type.indices}) -> ${c} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${c} = originalIndices[${a}];
      var col:${c} = originalIndices[${o}];
      ${r?`if (row < 0 || row > (${t[a]} - 1) || col < 0 || col > (${t[o]} - 1)) {
        return ${i};
      }`:""};
      row = max(0, min(row, ${t[a]} - 1));
      col = max(0, min(col, ${t[o]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${t.length>2?`u32(originalIndices[${l}])`:"0"};
      var batch: u32 =  ${t.length>2?`u32(originalIndices[${s}])`:"0"};
      var x11: ${c} = getInputValue(batch, channel, row1, col1);
      var x12: ${c} = getInputValue(batch, channel, row1, col2);
      var x21: ${c} = getInputValue(batch, channel, row2, col1);
      var x22: ${c} = getInputValue(batch, channel, row2, col2);
      var dx1: ${c} = abs(row - ${c}(row1));
      var dx2: ${c} = abs(${c}(row2) - row);
      var dy1: ${c} = abs(col - ${c}(col1));
      var dy2: ${c} = abs(${c}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},TO=(n,e,t,r,i,s,a,o,l,c)=>{let u=t.length===2,[d,h]=u?[0,1]:[2,3],f=n.type.value,p=g=>{let b=g===d?"row":"col";return`
      fn ${b}CubicInterpolation(input_indices: ${n.type.indices}, output_indices: ${e.type.indices}) -> ${f} {
        var output_index = ${e.indicesGet("output_indices",g)};
        var originalIdx: ${f} = getOriginalCoordinateFromResizedCoordinate(output_index, ${i[g]},
        ${r[g]}, ${t[g]}, ${s[g]}, ${s[g]} + ${t.length});
        var fractOriginalIdx: ${f} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${o} && (originalIdx < 0 || originalIdx > (${t[g]} - 1))) {
          return ${l};
        }
        var data: array<${f}, 4> = array<${f}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${b}: ${f} = originalIdx + ${f}(i);
          if (${b} < 0 || ${b} >= ${t[g]}) {
            ${c?`coefs[i + 1] = 0.0;
                        continue;`:o?`return ${l};`:`${b} = max(0, min(${b}, ${t[g]} - 1));`};
          }
        var input_indices_copy: ${n.type.indices} = input_indices;
          ${n.indicesSet("input_indices_copy",g,`u32(${b})`)};
          data[i + 1] = ${g===d?n.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${p(d)};
    ${p(h)};
  fn getCubicInterpolationCoefs(s: ${f}) -> array<${f}, 4> {
    var absS = abs(s);
    var coeffs: array<${f}, 4> = array<${f}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${f} = 1.0 - absS;
    var twoMinusAbsS: ${f} = 2.0 - absS;
    var onePlusAbsS: ${f} = 1.0 + absS;
    coeffs[0] = ((${a} * onePlusAbsS - 5 * ${a}) * onePlusAbsS + 8 * ${a}) * onePlusAbsS - 4 * ${a};
    coeffs[1] = ((${a} + 2) * absS - (${a} + 3)) * absS * absS + 1;
    coeffs[2] = ((${a} + 2) * oneMinusAbsS - (${a} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${a} * twoMinusAbsS - 5 * ${a}) * twoMinusAbsS + 8 * ${a}) * twoMinusAbsS - 4 * ${a};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${f}, 4>, coefs: array<${f}, 4>) -> ${f} {
    var coefsSum: ${f} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${e.type.indices}) -> ${f} {
    var input_indices: ${n.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},EO=(n,e,t,r,i)=>{let[s,a,o,l,c]=t.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],u=n.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${u} {
      var input_indices: ${n.type.indices};
      ${n.indicesSet("input_indices",a,`max(0, min(depth, ${t[a]} - 1))`)};
      ${n.indicesSet("input_indices",o,`max(0, min(height, ${t[o]} - 1))`)};
      ${n.indicesSet("input_indices",l,`max(0, min(width, ${t[l]} - 1))`)};
      ${tx(n,c,s,3)}
      return ${n.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${e.type.indices}) -> ${u} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${u} = originalIndices[${a}];
      var height:${u} = originalIndices[${o}];
      var width:${u} = originalIndices[${l}];
      ${r?`if (depth < 0 || depth > (${t[a]} - 1) || height < 0 || height > (${t[o]} - 1) || width < 0 || (width > ${t[l]} - 1)) {
      return ${i};
        }`:""};

    depth = max(0, min(depth, ${t[a]} - 1));
      height = max(0, min(height, ${t[o]} - 1));
      width = max(0, min(width, ${t[l]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${t.length>3?`u32(originalIndices[${c}])`:"0"};
      var batch: u32 =  ${t.length>3?`u32(originalIndices[${s}])`:"0"};

      var x111: ${u} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${u} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${u} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${u} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${u} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${u} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${u} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${u} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${u} = abs(depth - ${u}(depth1));
      var dx2: ${u} = abs(${u}(depth2) - depth);
      var dy1: ${u} = abs(height - ${u}(height1));
      var dy2: ${u} = abs(${u}(height2) - height);
      var dz1: ${u} = abs(width - ${u}(width1));
      var dz2: ${u} = abs(${u}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},DO=(n,e,t,r,i,s)=>{let a=n.dims,o=gO(s,e.axes,a.length),l=_O(a,r,i,e.axes),c=r.slice();r.length===0&&(c=a.map((m,v)=>m===0?1:l[v]/m),e.keepAspectRatioPolicy!=="stretch"&&(l=bO(a,c,e)));let u=_t("output",n.dataType,l.length),d=He("input",n.dataType,a.length),h=Ve.size(l),f=a.length===l.length&&a.every((m,v)=>m===l[v]),p=e.coordinateTransformMode==="tf_crop_and_resize",g=e.extrapolationValue,b=d.type.value,_=m=>`
      ${f?"":`
      ${pO(e.coordinateTransformMode,b)};
      ${(()=>{switch(e.mode){case"nearest":return`
              ${wO(d,a)};
              ${mO(e.nearestMode,t,b)};
              ${vO(d,u,a,l,c.length,o.length,p)};
              `;case"linear":return`
              ${yO(u,a,l,c.length,o.length)};
              ${(()=>{if(a.length===2||a.length===4)return`${xO(d,u,a,p,g)}`;if(a.length===3||a.length===5)return`${EO(d,u,a,p,g)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(a.length===2||a.length===4)return`${TO(d,u,a,l,c,o,e.cubicCoeffA,p,e.extrapolationValue,e.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${m.registerUniform("output_size","u32").registerUniform("scales","f32",c.length).registerUniform("roi","f32",o.length).declareVariables(d,u)}
      ${m.mainStart()}
        ${m.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${f?"output[global_idx] = input[global_idx];":`
        let output_indices = ${u.offsetToIndices("global_idx")};
        var input_indices: ${d.type.indices};
        ${(()=>{switch(e.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${d.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${e.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${a.length===2||a.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${e.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${e.cacheKey}|${t}|${c.length>0?e.mode==="cubic"?c:c.length:""}|${i.length>0?i:""}|${o.length>0?o:""}|${f}|${e.mode==="nearest"?a.length:a}`,inputDependencies:["rank"]},getShaderSource:_,getRunData:()=>({outputs:[{dims:l,dataType:n.dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:[{type:12,data:h},{type:1,data:c},{type:1,data:o},...vt(a,l)]})}},MO=n=>{let e=n.customDataBuffer;return new Uint32Array(e,e.byteOffset,1)[0]},d8=(n,e)=>{let t=[],r=[],i=[],s=MO(n);if(e.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");fO(n.inputs,e,s,t,r,i),n.compute(DO(n.inputs[0],e,s,t,r,i),{inputs:[0]})},h8=n=>{let e=n.antialias,t=n.axes,r=n.coordinateTransformMode,i=n.cubicCoeffA,s=n.excludeOutside!==0,a=n.extrapolationValue,o=n.keepAspectRatioPolicy,l=n.mode,c=n.nearestMode===""?"simple":n.nearestMode;return pn({antialias:e,axes:t,coordinateTransformMode:r,cubicCoeffA:i,excludeOutside:s,extrapolationValue:a,keepAspectRatioPolicy:o,mode:l,nearestMode:c})}}),AO,CO,f8,w7=nt(()=>{Ft(),$t(),Zn(),zt(),AO=(n,e)=>{let[t,r,i,s]=n,{numHeads:a,rotaryEmbeddingDim:o}=e;if(t.dims.length!==3&&t.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${t.dims.length}`);if(!Ve.areEqual(r.dims,[])&&!Ve.areEqual(r.dims,[1])&&r.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${r.dims.length}`);if(i.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${i.dims.length}`);if(s.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${s.dims.length}`);if(!Ve.areEqual(i.dims,s.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(o>0&&a===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let l=t.dims[0],c=t.dims[t.dims.length-2],u=i.dims[0],d=Ve.sizeFromDimension(t.dims,1)/c,h=o===0?i.dims[1]*2:d/a;if(o>h)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(r.dims.length===2){if(l!==r.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${r.dims[0]}`);if(c!==r.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${r.dims[1]}`)}if(h/2!==i.dims[1]&&o/2!==i.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${i.dims[1]}`);if(c>u)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},CO=(n,e)=>{let{interleaved:t,numHeads:r,rotaryEmbeddingDim:i,scale:s}=e,a=n[0].dims[0],o=Ve.sizeFromDimension(n[0].dims,1),l=n[0].dims[n[0].dims.length-2],c=o/l,u=n[2].dims[1],d=i===0?u*2:c/r,h=new Array(a,l,c/d,d-u),f=Ve.computeStrides(h),p=[{type:1,data:s},{type:12,data:h},{type:12,data:f},...n[0].dims.length===3?new Array({type:12,data:[o,c,d,1]}):[],...n[0].dims.length===4?new Array({type:12,data:[o,d,l*d,1]}):[],...vt(n[0].dims,n[1].dims,n[2].dims,n[3].dims,n[0].dims)],g=b=>{let _=He("input",n[0].dataType,n[0].dims.length),m=He("position_ids",n[1].dataType,n[1].dims.length),v=He("cos_cache",n[2].dataType,n[2].dims.length),x=He("sin_cache",n[3].dataType,n[3].dims.length),w=_t("output",n[0].dataType,n[0].dims.length);return b.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:h.length},{name:"global_strides",type:"u32",length:f.length},{name:"input_output_strides",type:"u32",length:f.length}]),`
        ${b.declareVariables(_,m,v,x,w)}

        ${b.mainStart(_f)}
          let half_rotary_emb_dim = uniforms.${v.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${b.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${m.broadcastedIndicesToOffset("bsnh.xy",_t("",m.type.tensor,2))};
            let position_id =
                u32(${m.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${t});
            let j = i + select(half_rotary_emb_dim, 1, ${t});
            let re = ${_.getByOffset("i")} * ${v.get("position_id","bsnh[3]")} -
                ${_.getByOffset("j")} * ${x.get("position_id","bsnh[3]")};
            ${w.setByOffset("i","re")}
            let im = ${_.getByOffset("i")} * ${x.get("position_id","bsnh[3]")} +
                ${_.getByOffset("j")} * ${v.get("position_id","bsnh[3]")};
            ${w.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${w.setByOffset("k",_.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:pn({interleaved:t}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:g,getRunData:()=>({outputs:[{dims:n[0].dims,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(Ve.size(h)/_f)},programUniforms:p})}},f8=(n,e)=>{AO(n.inputs,e),n.compute(CO(n.inputs,e))}}),SO,PO,p8,x7=nt(()=>{Ft(),$t(),zt(),SO=n=>{if(!n||n.length<3)throw new Error("layerNorm requires at least 3 inputs.");let e=n[0],t=n[1],r=n[2];if(e.dataType!==t.dataType||e.dataType!==r.dataType)throw new Error("All inputs must have the same data type");if(e.dims.length!==3&&e.dims.length!==2)throw new Error("Input must be 2D or 3D");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Skip must be 2D or 3D");let i=e.dims[e.dims.length-1],s=e.dims[e.dims.length-2];if(t.dims[t.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(t.dims[t.dims.length-2]!==s)throw new Error("Skip must have the same sequence length as input");if(r.dims.length!==1)throw new Error("Gamma must be 1D");if(r.dims[r.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(n.length>3){let a=n[3];if(a.dims.length!==1)throw new Error("Beta must be 1D");if(a.dims[a.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input")}if(n.length>4){let a=n[4];if(a.dims.length!==1)throw new Error("Bias must be 1D");if(a.dims[a.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input")}},PO=(n,e,t,r)=>{let i=e.simplified,s=n[0].dims,a=Ve.size(s),o=s,l=a,c=s.slice(-1)[0],u=r?s.slice(0,-1).concat(1):[],d=!i&&n.length>3,h=n.length>4,f=r&&t>1,p=r&&t>2,g=t>3,b=64,_=jn(c),m=[{type:12,data:l},{type:12,data:_},{type:12,data:c},{type:1,data:e.epsilon}],v=w=>{let T=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],E=[He("x",n[0].dataType,n[0].dims,_),He("skip",n[1].dataType,n[1].dims,_),He("gamma",n[2].dataType,n[2].dims,_)];d&&E.push(He("beta",n[3].dataType,n[3].dims,_)),h&&E.push(He("bias",n[4].dataType,n[4].dims,_)),E.push(_t("output",n[0].dataType,o,_)),f&&E.push(_t("mean_output",1,u)),p&&E.push(_t("inv_std_output",1,u)),g&&E.push(_t("input_skip_bias_sum",n[0].dataType,o,_));let A=Sr(n[0].dataType),M=Sr(1,_);return`

      ${w.registerUniforms(T).declareVariables(...E)}
      var<workgroup> sum_shared : array<${M}, ${b}>;
      var<workgroup> sum_squared_shared : array<${M}, ${b}>;

      ${w.mainStart([b,1,1])}
        let ix = local_id.x;
        let iy = global_id.x / ${b};

        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        var stride = hidden_size_vectorized / ${b};
        let offset = ix * stride + iy * hidden_size_vectorized;
        let offset1d = stride * ix;
        if (ix == ${b-1}) {
          stride = hidden_size_vectorized - stride * ix;
        }
        for (var i: u32 = 0; i < stride; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${h?"bias[offset1d + i]":A+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${g?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${eh(A,_,"value")};
          sum_shared[ix] += f32_value;
          sum_squared_shared[ix] += f32_value * f32_value;
        }
        workgroupBarrier();

        var reduce_size : u32 = ${b};
        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {
          reduce_size = curr_size + (reduce_size & 1);
          if (ix < curr_size) {
            sum_shared[ix] += sum_shared[ix + reduce_size];
            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];
          }
          workgroupBarrier();
        }

        let sum = sum_shared[0];
        let square_sum = sum_squared_shared[0];
        let mean = ${Vl("sum",_)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${Vl("square_sum",_)} / f32(uniforms.hidden_size) ${i?"":"- mean * mean"} + uniforms.epsilon);
        ${f?"mean_output[global_idx] = mean;":""}
        ${p?"inv_std_output[global_idx] = inv_std_dev;":""}

        for (var i: u32 = 0; i < stride; i++) {
          output[offset + i] = (output[offset + i] ${i?"":`- ${A}(mean)`}) *
            ${A}(inv_std_dev) * gamma[offset1d + i]
            ${d?"+ beta[offset1d + i]":""};
        }
      }`},x=[{dims:o,dataType:n[0].dataType}];return t>1&&x.push({dims:u,dataType:1}),t>2&&x.push({dims:u,dataType:1}),t>3&&x.push({dims:s,dataType:n[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${_};${f};${p};${g}`,inputDependencies:n.map((w,T)=>"type")},getShaderSource:v,getRunData:()=>({outputs:x,dispatchGroup:{x:Math.ceil(l/c)},programUniforms:m})}},p8=(n,e)=>{SO(n.inputs);let t=[0];n.outputCount>1&&t.push(-3),n.outputCount>2&&t.push(-3),n.outputCount>3&&t.push(3),n.compute(PO(n.inputs,e,n.outputCount,!1),{outputs:t})}}),kO,cm,FO,nx,IO,OO,m8,g8,T7=nt(()=>{Ft(),$t(),Zn(),zt(),kO=(n,e)=>{if(!n||n.length<1)throw new Error("too few inputs");if(e.axes.length!==0){if(e.axes.length!==e.starts.length||e.axes.length!==e.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(e.starts.length!==e.ends.length)throw new Error("starts and ends must have the same length");n.slice(1).forEach((t,r)=>{if(n[r+1].dataType!==6&&n[r+1].dataType!==7)throw new Error(`Input ${r} must be an array of int32 or int64`)})},cm=(n,e)=>{let t=[];if(n.length>e)if(n[e].dataType===7)n[e].getBigInt64Array().forEach(r=>t.push(Number(r)));else if(n[e].dataType===6)n[e].getInt32Array().forEach(r=>t.push(Number(r)));else throw new Error(`Input ${e} must be an array of int32 or int64`);return t},FO=(n,e)=>{if(n.length>1){let t=cm(n,1),r=cm(n,2),i=cm(n,3);return i.length===0&&(i=[...Array(n[0].dims.length).keys()]),pn({starts:t,ends:r,axes:i})}else return e},nx=(n,e,t,r,i)=>{let s=n;return n<0&&(s+=t[r[e]]),i[e]<0?Math.max(0,Math.min(s,t[r[e]]-1)):Math.max(0,Math.min(s,t[r[e]]))},IO=(n,e,t)=>`fn calculateInputIndices(output_indices: ${e.type.indices}) -> ${n.type.indices} {
          var input_indices: ${n.type.indices};
          var carry = 0u;
          for (var i = ${t.length}; i >= 0; i--) {
            let input_shape_i = ${yt("uniforms.input_shape","i",t.length)};
            let steps_i = ${yt("uniforms.steps","i",t.length)};
            let signs_i = ${yt("uniforms.signs","i",t.length)};
            let starts_i = ${yt("uniforms.starts","i",t.length)};
            var output_index = ${e.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${n.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,OO=(n,e)=>{let t=n[0].dims,r=Ve.size(t),i=e.axes.length>0?Ve.normalizeAxes(e.axes,t.length):[...Array(t.length).keys()],s=cm(n,4);s.forEach(_=>_!==0||(()=>{throw new Error("step cannot be 0")})),s.length===0&&(s=Array(i.length).fill(1));let a=e.starts.map((_,m)=>nx(_,m,t,i,s)),o=e.ends.map((_,m)=>nx(_,m,t,i,s));if(i.length!==a.length||i.length!==o.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==t.length)for(let _=0;_<t.length;++_)i.includes(_)||(a.splice(_,0,0),o.splice(_,0,t[_]),s.splice(_,0,1));let l=s.map(_=>Math.sign(_));s.forEach((_,m,v)=>{if(_<0){let x=(o[m]-a[m])/_,w=a[m],T=w+x*s[m];a[m]=T,o[m]=w,v[m]=-_}});let c=t.slice(0);i.forEach((_,m)=>{c[_]=Math.ceil((o[_]-a[_])/s[_])});let u={dims:c,dataType:n[0].dataType},d=_t("output",n[0].dataType,c.length),h=He("input",n[0].dataType,n[0].dims.length),f=Ve.size(c),p=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:a.length},{name:"signs",type:"i32",length:l.length},{name:"steps",type:"u32",length:s.length}],g=[{type:12,data:f},{type:12,data:a},{type:6,data:l},{type:12,data:s},...vt(n[0].dims,c)],b=_=>`
      ${_.registerUniforms(p).declareVariables(h,d)}
        ${IO(h,d,t)}
        ${_.mainStart()}
          ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${d.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${d.setByOffset("global_idx",h.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${l.length}_${a.length}_${s.length}`,inputDependencies:["rank"]},getShaderSource:b,getRunData:()=>({outputs:[u],dispatchGroup:{x:Math.ceil(r/64)},programUniforms:g})}},m8=(n,e)=>{kO(n.inputs,e);let t=FO(n.inputs,e);n.compute(OO(n.inputs,t),{inputs:[0]})},g8=n=>{let e=n.starts,t=n.ends,r=n.axes;return pn({starts:e,ends:t,axes:r})}}),UO,LO,_8,b8,E7=nt(()=>{Ft(),$t(),Zn(),Zl(),zt(),UO=n=>{if(!n||n.length!==1)throw new Error("Softmax op requires 1 input.")},LO=(n,e)=>{let t=n.inputs[0],r=t.dims,i=Ve.size(r),s=r.length,a=Ve.normalizeAxis(e.axis,s),o=a<r.length-1,l,c=[];o?(c=Array.from({length:s},(E,A)=>A),c[a]=s-1,c[s-1]=a,l=n.compute(hs(t,c),{inputs:[t],outputs:[-1]})[0]):l=t;let u=l.dims,d=u[s-1],h=i/d,f=jn(d),p=d/f,g=64;h===1&&(g=256);let b=(E,A)=>A===4?`max(max(${E}.x, ${E}.y), max(${E}.z, ${E}.w))`:A===2?`max(${E}.x, ${E}.y)`:A===3?`max(max(${E}.x, ${E}.y), ${E}.z)`:E,_=He("x",l.dataType,l.dims,f),m=_t("result",l.dataType,l.dims,f),v=_.type.value,x=Sr(l.dataType)==="f32"?`var threadMax = ${v}(-3.402823e+38f);`:`var threadMax = ${v}(-65504.0h);`,w=E=>`
      var<workgroup> rowMaxShared : ${v};
      var<workgroup> rowSumShared : ${v};
      var<workgroup> threadShared : array<${v}, ${g}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${v} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${v}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${E.registerUniform("packedCols","i32").declareVariables(_,m)}
      ${E.mainStart(g)}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${g};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${x}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${v}(${b("threadShared[0]",f)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${v}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${v}(${Vl("threadShared[0]",f)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`,T=n.compute({name:"Softmax",shaderCache:{hint:`${f};${g}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:u,dataType:l.dataType}],dispatchGroup:{x:h},programUniforms:[{type:6,data:p}]}),getShaderSource:w},{inputs:[l],outputs:[o?-1:0]})[0];o&&n.compute(hs(T,c),{inputs:[T]})},_8=(n,e)=>{UO(n.inputs),LO(n,e)},b8=n=>pn({axis:n.axis})}),rx,RO,BO,$O,y8,D7=nt(()=>{Ft(),$t(),zt(),rx=n=>Array.from(n.getBigInt64Array(),Number),RO=n=>{if(!n||n.length!==2)throw new Error("Tile requires 2 inputs.");if(n[0].dataType!==1&&n[0].dataType!==10&&n[0].dataType!==6&&n[0].dataType!==12)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(n[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(n[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(rx(n[1]).length!==n[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},BO=(n,e)=>{let t=[];for(let r=0;r<n.length;++r)t.push(n[r]*e[r]);return t},$O=(n,e)=>{let t=n[0].dims,r=e??rx(n[1]),i=BO(t,r),s=Ve.size(i),a=n[0].dataType,o=He("input",a,t.length),l=_t("output",a,i.length),c=u=>`
      const inputShape = ${o.indices(...t)};
      ${u.registerUniform("output_size","u32").declareVariables(o,l)}
      ${u.mainStart()}
      ${u.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${l.offsetToIndices("global_idx")};
      var input_indices: ${o.type.indices};
      for (var i = 0; i < ${t.length}; i++) {
        let input_dim_i = ${o.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${l.indicesGet("output_indices","i")}  % input_dim_i;

        ${o.indicesSet("input_indices","i","input_dim_value")}
      }
      ${l.setByOffset("global_idx",o.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:i,dataType:n[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:[{type:12,data:s},...vt(n[0].dims,i)]}),getShaderSource:c}},y8=n=>{RO(n.inputs),n.compute($O(n.inputs),{inputs:[0]})}}),NO,zO,v8,M7=nt(()=>{Ft(),$t(),zt(),NO=(n,e,t,r,i)=>{let s=_t("output_data",i,t.length,4),a=He("a_data",e[1].dataType,e[1].dims.length,4),o=He("b_data",e[2].dataType,e[2].dims.length,4),l=He("c_data",e[0].dataType,e[0].dims.length,4),c,u=(d,h,f)=>`select(${h}, ${d}, ${f})`;if(!r)c=s.setByOffset("global_idx",u(a.getByOffset("global_idx"),o.getByOffset("global_idx"),l.getByOffset("global_idx")));else{let d=(h,f,p="")=>{let g=`a_data[index_a${f}][component_a${f}]`,b=`b_data[index_b${f}][component_b${f}]`,_=`bool(c_data[index_c${f}] & (0xffu << (component_c${f} * 8)))`;return`
            let output_indices${f} = ${s.offsetToIndices(`global_idx * 4u + ${f}u`)};
            let offset_a${f} = ${a.broadcastedIndicesToOffset(`output_indices${f}`,s)};
            let offset_b${f} = ${o.broadcastedIndicesToOffset(`output_indices${f}`,s)};
            let offset_c${f} = ${l.broadcastedIndicesToOffset(`output_indices${f}`,s)};
            let index_a${f} = offset_a${f} / 4u;
            let index_b${f} = offset_b${f} / 4u;
            let index_c${f} = offset_c${f} / 4u;
            let component_a${f} = offset_a${f} % 4u;
            let component_b${f} = offset_b${f} % 4u;
            let component_c${f} = offset_c${f} % 4u;
            ${h}[${f}] = ${p}(${u(g,b,_)});
          `};i===9?c=`
            var data = vec4<u32>(0);
            ${d("data",0,"u32")}
            ${d("data",1,"u32")}
            ${d("data",2,"u32")}
            ${d("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:c=`
            ${d("output_data[global_idx]",0)}
            ${d("output_data[global_idx]",1)}
            ${d("output_data[global_idx]",2)}
            ${d("output_data[global_idx]",3)}
          `}return`
        ${n.registerUniform("vec_size","u32").declareVariables(l,a,o,s)}
        ${n.mainStart()}
        ${n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${c}
      }`},zO=n=>{let e=n[1].dims,t=n[2].dims,r=n[0].dims,i=n[1].dataType,s=!(Ve.areEqual(e,t)&&Ve.areEqual(t,r)),a=e,o=Ve.size(e);if(s){let c=gf.calcShape(gf.calcShape(e,t,!1),r,!1);if(!c)throw new Error("Can't perform where op on the given tensors");a=c,o=Ve.size(a)}let l=Math.ceil(o/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:c=>NO(c,n,a,s,i),getRunData:()=>({outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(o/64/4)},programUniforms:[{type:12,data:l},...vt(r,e,t,a)]})}},v8=n=>{n.compute(zO(n.inputs))}}),w8,A7=nt(()=>{NV(),bD(),zV(),WV(),jV(),VV(),GV(),YV(),ZV(),JV(),e7(),t7(),n7(),r7(),i7(),s7(),a7(),o7(),l7(),c7(),u7(),d7(),h7(),f7(),p7(),z4(),m7(),g7(),_7(),b7(),y7(),_D(),v7(),w7(),x7(),T7(),E7(),V4(),D7(),Zl(),yD(),M7(),w8=new Map([["Abs",[mN]],["Acos",[gN]],["Acosh",[_N]],["Add",[QN]],["ArgMax",[dN,NT]],["ArgMin",[uN,NT]],["Asin",[bN]],["Asinh",[yN]],["Atan",[vN]],["Atanh",[wN]],["Attention",[hN]],["AveragePool",[J4,Z4]],["BatchNormalization",[fN]],["BiasAdd",[pN]],["BiasSplitGelu",[YN]],["Cast",[TN,xN]],["Ceil",[DN]],["Clip",[EN]],["Concat",[o4,l4]],["Conv",[qT,GT]],["ConvTranspose",[b4,_4]],["Cos",[MN]],["Cosh",[AN]],["CumSum",[y4,v4]],["DepthToSpace",[w4,x4]],["DequantizeLinear",[a8,o8]],["Div",[ZN]],["Einsum",[T4,E4]],["Elu",[CN,km]],["Equal",[JN]],["Erf",[SN]],["Exp",[PN]],["Expand",[D4]],["FastGelu",[M4]],["Floor",[kN]],["FusedConv",[qT,GT]],["Gather",[C4,A4]],["GatherElements",[O4,I4]],["GatherBlockQuantized",[k4,F4]],["GatherND",[S4,P4]],["Gelu",[FN]],["Gemm",[L4,U4]],["GlobalAveragePool",[t8,e8]],["GlobalMaxPool",[s8,i8]],["Greater",[r4]],["GreaterOrEqual",[s4]],["GridSample",[R4,B4]],["GroupQueryAttention",[G4]],["HardSigmoid",[NN,$N]],["InstanceNormalization",[q4]],["LayerNormalization",[H4]],["LeakyRelu",[IN,km]],["Less",[i4]],["LessOrEqual",[a4]],["Log",[KN]],["MatMul",[K4]],["MatMulNBits",[X4,Y4]],["MaxPool",[n8,r8]],["Mul",[e4]],["MultiHeadAttention",[N4,$4]],["Neg",[UN]],["Not",[ON]],["Pad",[Q4]],["Pow",[t4]],["QuickGelu",[XN,km]],["Range",[l8]],["Reciprocal",[LN]],["ReduceMin",[sN]],["ReduceMean",[eN]],["ReduceMax",[iN]],["ReduceSum",[oN]],["ReduceProd",[aN]],["ReduceL1",[tN]],["ReduceL2",[nN]],["ReduceLogSum",[cN]],["ReduceLogSumExp",[rN]],["ReduceSumSquare",[lN]],["Relu",[RN]],["Resize",[d8,h8]],["RotaryEmbedding",[f8]],["ScatterND",[u8,c8]],["Sigmoid",[BN]],["Sin",[zN]],["Sinh",[WN]],["Slice",[m8,g8]],["SkipLayerNormalization",[p8]],["Split",[W4,j4]],["Sqrt",[jN]],["Softmax",[_8,b8]],["Sub",[n4]],["Tan",[VN]],["Tanh",[GN]],["ThresholdedRelu",[HN,km]],["Tile",[y8]],["Transpose",[W$,j$]],["Where",[v8]]])}),x8,C7=nt(()=>{pa(),Uo(),zt(),x8=class{constructor(n){this.backend=n,this.repo=new Map,this.attributesBound=!1}getArtifact(n){return this.repo.get(n)}setArtifact(n,e){this.repo.set(n,e)}run(n,e,t,r,i){ha(n.programInfo.name);let s=this.backend.device,a=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let o=[];for(let c of e)o.push({binding:o.length,resource:{buffer:c.buffer}});for(let c of t)o.push({binding:o.length,resource:{buffer:c.buffer}});i&&o.push({binding:o.length,resource:i});let l=s.createBindGroup({layout:n.computePipeline.getBindGroupLayout(0),entries:o,label:n.programInfo.name});if(this.backend.sessionStatus==="capturing"){let c={kernelId:this.backend.currentKernelId,computePipeline:n.computePipeline,bindGroup:l,dispatchGroup:r};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(c)}a.setPipeline(n.computePipeline),a.setBindGroup(0,l),a.dispatchWorkgroups(...r),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Os(n.programInfo.name)}dispose(){}build(n,e){ha(n.name);let t=this.backend.device,r=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach(c=>{t.features.has(c.feature)&&r.push(`enable ${c.extension};`)});let i=z$(e,this.backend.device.limits),s=n.getShaderSource(i),a=`${r.join(`
`)}
${i.additionalImplementations}
${s}`,o=t.createShaderModule({code:a,label:n.name});nn("verbose",()=>`[WebGPU] ${n.name} shader code: ${a}`);let l=t.createComputePipeline({compute:{module:o,entryPoint:"main"},layout:"auto",label:n.name});return Os(n.name),{programInfo:n,computePipeline:l,uniformVariablesInfo:i.variablesInfo}}normalizeDispatchGroupSize(n){let e=typeof n=="number"?n:n.x,t=typeof n=="number"?1:n.y||1,r=typeof n=="number"?1:n.z||1,i=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(e<=i&&t<=i&&r<=i)return[e,t,r];let s=e*t*r,a=Math.ceil(Math.sqrt(s));if(a>i){if(a=Math.ceil(Math.cbrt(s)),a>i)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[a,a,a]}else return[a,a,1]}}}),WO,jO,VO,T8,S7=nt(()=>{pa(),Ft(),Uo(),U$(),BV(),A7(),C7(),WO=(n,e)=>{if(e.length!==n.length)throw new Error(`inputDependencies length ${e.length} is not equal to inputTensors length ${n.length}.`);let t=[];for(let r=0;r<n.length;++r){let i=n[r].dataType;switch(e[r]){case"none":{t.push("");break}case"type":{t.push(`${i}`);break}case"rank":{let s=n[r].dims.length;t.push(`${i};${s}`);break}case"dims":{let s=n[r].dims.join(",");t.push(`${i};${s}`);break}default:throw new Error(`unsupported input dependency: ${e[r]}`)}}return t.join("|")},jO=(n,e,t)=>{let r=n.name;return n.shaderCache?.hint&&(r+="["+n.shaderCache.hint+"]"),r+=":"+t+`:${WO(e,n.shaderCache?.inputDependencies??new Array(e.length).fill("dims"))}`,r},VO=class{constructor(n){n&&(this.architecture=n.architecture,this.vendor=n.vendor)}isArchitecture(n){return this.architecture===n}isVendor(n){return this.vendor===n}},T8=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let n=this.kernelCustomData.get(this.currentKernelId);return n||(n={},this.kernelCustomData.set(this.currentKernelId,n)),n}async initialize(n,e){this.env=n;let t=[],r={requiredLimits:{maxComputeWorkgroupStorageSize:e.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:e.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:e.limits.maxStorageBufferBindingSize,maxBufferSize:e.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:e.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:e.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:e.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:e.limits.maxComputeWorkgroupSizeZ},requiredFeatures:t},i=s=>e.features.has(s)&&t.push(s)&&!0;i("chromium-experimental-timestamp-query-inside-passes")||i("timestamp-query"),i("shader-f16"),i("subgroups"),this.device=await e.requestDevice(r),this.adapterInfo=new VO(e.info||await e.requestAdapterInfo()),this.gpuDataManager=L$(this),this.programManager=new x8(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,fD(n.logLevel,!!n.debug),this.device.onuncapturederror=s=>{s.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${s.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:e,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let n=this.getCommandEncoder(),e={};this.queryType==="at-passes"&&(e.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=n.beginComputePass(e)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;ha(),this.endComputePass();let n;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),n=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(n,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,n,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&n.mapAsync(GPUMapMode.READ).then(()=>{let e=new BigUint64Array(n.getMappedRange()),t=this.pendingQueries.get(n);for(let r=0;r<e.length/2;r++){let i=t[r],s=i.kernelId,a=this.kernels.get(s),o=a.kernelType,l=a.kernelName,c=i.programName,u=i.inputTensorViews,d=i.outputTensorViews,h=e[r*2],f=e[r*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=h);let p=Number(h-this.queryTimeBase),g=Number(f-this.queryTimeBase);if(!Number.isSafeInteger(p)||!Number.isSafeInteger(g))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:u.map(b=>({dims:b.dims,dataType:Fc(b.dataType)})),outputsMetadata:d.map(b=>({dims:b.dims,dataType:Fc(b.dataType)})),kernelId:s,kernelType:o,kernelName:l,programName:c,startTime:p,endTime:g});else{let b="";u.forEach((m,v)=>{b+=`input[${v}]: [${m.dims}] | ${Fc(m.dataType)}, `});let _="";d.forEach((m,v)=>{_+=`output[${v}]: [${m.dims}] | ${Fc(m.dataType)}, `}),console.log(`[profiling] kernel "${s}|${o}|${l}|${c}" ${b}${_}execution time: ${g-p} ns`)}Hm("GPU",`${c}::${h}::${f}`)}n.unmap(),this.pendingQueries.delete(n)}),Os()}run(n,e,t,r,i,s){ha(n.name);let a=[];for(let m=0;m<e.length;++m){let v=e[m].data;if(v===0)continue;let x=this.gpuDataManager.get(v);if(!x)throw new Error(`no GPU data for input: ${v}`);a.push(x)}let{outputs:o,dispatchGroup:l,programUniforms:c}=n.getRunData(e),u=t.length===0?o.map((m,v)=>v):t;if(u.length!==o.length)throw new Error(`Output size ${u.length} must be equal to ${o.length}.`);let d=[],h=[];for(let m=0;m<o.length;++m){if(!Number.isInteger(u[m])||u[m]<-3||u[m]>=s)throw new Error(`Invalid output index: ${u[m]}`);if(u[m]===-3)continue;let v=u[m]===-1,x=u[m]===-2,w=v||x?i(o[m].dataType,o[m].dims):r(u[m],o[m].dataType,o[m].dims);if(d.push(w),w.data===0)continue;let T=this.gpuDataManager.get(w.data);if(!T)throw new Error(`no GPU data for output: ${w.data}`);if(v&&this.temporaryData.push(T),x){let E=this.kernelPersistentData.get(this.currentKernelId);E||(E=[],this.kernelPersistentData.set(this.currentKernelId,E)),E.push(T)}h.push(T)}if(a.length!==e.length||h.length!==d.length){if(h.length===0)return Os(n.name),d;throw new Error(`Program ${n.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let f;if(c){let m=0,v=[];c.forEach(E=>{let A=typeof E.data=="number"?[E.data]:E.data;if(A.length===0)return;let M=E.type===10?2:4,F,G;E.type===10?(G=A.length>4?16:A.length>2?8:A.length*M,F=A.length>4?16:M*A.length):(G=A.length<=2?A.length*M:16,F=16),m=Math.ceil(m/G)*G,v.push(m);let S=E.type===10?8:4;m+=A.length>4?Math.ceil(A.length/S)*F:A.length*M});let x=16;m=Math.ceil(m/x)*x;let w=new ArrayBuffer(m);c.forEach((E,A)=>{let M=v[A],F=typeof E.data=="number"?[E.data]:E.data;if(E.type===6)new Int32Array(w,M,F.length).set(F);else if(E.type===12)new Uint32Array(w,M,F.length).set(F);else if(E.type===10)new Uint16Array(w,M,F.length).set(F);else if(E.type===1)new Float32Array(w,M,F.length).set(F);else throw new Error(`Unsupported uniform type: ${Fc(E.type)}`)});let T=this.gpuDataManager.create(m,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(T.buffer,0,w,0,m),this.gpuDataManager.release(T.id),f={offset:0,size:m,buffer:T.buffer}}let p=this.programManager.normalizeDispatchGroupSize(l),g=p[1]===1&&p[2]===1,b=jO(n,e,g),_=this.programManager.getArtifact(b);if(_||(_=this.programManager.build(n,p),this.programManager.setArtifact(b,_),nn("info",()=>`[artifact] key: ${b}, programName: ${n.name}`)),c&&_.uniformVariablesInfo){if(c.length!==_.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${_.uniformVariablesInfo.length}, got ${c.length} in program "${_.programInfo.name}".`);for(let m=0;m<c.length;m++){let v=c[m],x=v.type,w=typeof v.data=="number"?1:v.data.length,[T,E]=_.uniformVariablesInfo[m];if(x!==T||w!==E)throw new Error(`Uniform variable ${m} mismatch: expect type ${T} with size ${E}, got type ${x} with size ${w} in program "${_.programInfo.name}".`)}}if(nn("info",()=>`[ProgramManager] run "${n.name}" (key=${b}) with ${p[0]}x${p[1]}x${p[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let m={kernelId:this.currentKernelId,programName:_.programInfo.name,inputTensorViews:e,outputTensorViews:d};this.pendingKernels.push(m),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(m)}return this.programManager.run(_,a,h,p,f),Os(n.name),d}upload(n,e){this.gpuDataManager.upload(n,e)}memcpy(n,e){this.gpuDataManager.memcpy(n,e)}async download(n,e){await this.gpuDataManager.download(n,e)}alloc(n){return this.gpuDataManager.create(n).id}free(n){return this.gpuDataManager.release(n)}createKernel(n,e,t,r){let i=w8.get(n);if(!i)throw new Error(`kernel not implemented: ${n}`);let s={kernelType:n,kernelName:r,kernelEntry:i[0],attributes:[i[1],t]};this.kernels.set(e,s)}releaseKernel(n){let e=this.kernelPersistentData.get(n);if(e){for(let t of e)this.gpuDataManager.release(t.id);this.kernelPersistentData.delete(n)}this.kernelCustomData.delete(n),this.kernels.delete(n)}computeKernel(n,e,t){let r=this.kernels.get(n);if(!r)throw new Error(`kernel not created: ${n}`);let i=r.kernelType,s=r.kernelName,a=r.kernelEntry,o=r.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${i}] ${s}" is not allowed to be called recursively`);this.currentKernelId=n,o[0]&&(o[1]=o[0](o[1]),o[0]=void 0),nn("info",()=>`[WebGPU] Start to run kernel "[${i}] ${s}"...`);let l=this.env.debug;this.temporaryData=[];try{return l&&this.device.pushErrorScope("validation"),a(e,o[1]),0}catch(c){return t.push(Promise.resolve(`[WebGPU] Kernel "[${i}] ${s}" failed. ${c}`)),1}finally{l&&t.push(this.device.popErrorScope().then(c=>c?`GPU validation error for kernel "[${i}] ${s}": ${c.message}`:null));for(let c of this.temporaryData)this.gpuDataManager.release(c.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(n,e,t,r){let i=this.sessionExternalDataMapping.get(n);i||(i=new Map,this.sessionExternalDataMapping.set(n,i));let s=i.get(e),a=this.gpuDataManager.registerExternalBuffer(t,r,s);return i.set(e,[a,t]),a}unregisterBuffers(n){let e=this.sessionExternalDataMapping.get(n);e&&(e.forEach(t=>this.gpuDataManager.unregisterExternalBuffer(t[0])),this.sessionExternalDataMapping.delete(n))}getBuffer(n){let e=this.gpuDataManager.get(n);if(!e)throw new Error(`no GPU data for buffer: ${n}`);return e.buffer}createDownloader(n,e,t){return async()=>{let r=await RT(this,n,e);return pD(r.buffer,t)}}writeTimestamp(n){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,n)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){nn("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){nn("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){nn("info","replay"),this.sessionStatus="replaying";let n=this.capturedCommandList.get(this.currentSessionId),e=this.capturedPendingKernels.get(this.currentSessionId),t=n.length;this.pendingKernels=[];for(let r=0;r<t;r++){let i=this.getComputePassEncoder(),s=n[r];this.writeTimestamp(this.pendingDispatchNumber*2),i.setPipeline(s.computePipeline),i.setBindGroup(0,s.bindGroup),i.dispatchWorkgroups(...s.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(e[r]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(n){this.unregisterBuffers(n),this.capturedCommandList.has(n)&&this.capturedCommandList.delete(n),this.capturedPendingKernels.has(n)&&this.capturedPendingKernels.delete(n),this.gpuDataManager.onReleaseSession(n)}onRunStart(n){this.currentSessionId=n,this.setQueryType()}}}),GO,ix,qO,sx,ax,ox,HO,E8,P7=nt(()=>{Uo(),GO=1,ix=()=>GO++,qO=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),sx=(n,e)=>{let t=qO.get(n);if(!t)throw new Error("Unsupported data type.");return e.length>0?Math.ceil(e.reduce((r,i)=>r*i)*t/8):0},ax=class{constructor(n){this.sessionId=n.sessionId,this.mlContext=n.context,this.mlTensor=n.tensor,this.dataType=n.dataType,this.tensorShape=n.shape}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return sx(this.dataType,this.tensorShape)}destroy(){nn("verbose",()=>"[WebNN] TensorWrapper.destroy"),this.mlTensor.destroy()}write(n){this.mlContext.writeTensor(this.mlTensor,n)}async read(n){return n?this.mlContext.readTensor(this.mlTensor,n):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(n,e,t){return this.mlContext===n&&this.dataType===e&&this.tensorShape.length===t.length&&this.tensorShape.every((r,i)=>r===t[i])}},ox=class{constructor(n,e){this.tensorManager=n,this.wrapper=e}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(n,e,t,r){let i=this.tensorManager.getMLContext(n);if(this.wrapper){if(this.wrapper.canReuseTensor(i,e,t))return this.wrapper.tensor;if(r){if(this.wrapper.byteLength!==sx(e,t))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let s=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(n,e,t,s,!0,!0),r&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(n){if(this.wrapper)if(n.byteLength===this.wrapper.byteLength){this.wrapper.write(n);return}else nn("verbose",()=>"Data size does not match tensor size. Releasing tensor."),this.releaseTensor();this.activeUpload?this.activeUpload.set(n):this.activeUpload=new Uint8Array(n)}async download(n){if(this.activeUpload)if(n){n instanceof ArrayBuffer?new Uint8Array(n).set(this.activeUpload):new Uint8Array(n.buffer,n.byteOffset,n.byteLength).set(this.activeUpload);return}else return this.activeUpload.buffer;if(!this.wrapper)throw new Error("Tensor has not been created.");return n?this.wrapper.read(n):this.wrapper.read()}},HO=class{constructor(n){this.backend=n,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(n){let e=this.backend.getMLContext(n);if(!e)throw new Error("MLContext not found for session.");return e}reserveTensorId(){let n=ix();return this.tensorTrackersById.set(n,new ox(this)),n}releaseTensorId(n){let e=this.tensorTrackersById.get(n);e&&(this.tensorTrackersById.delete(n),e.tensorWrapper&&this.releaseTensor(e.tensorWrapper))}async ensureTensor(n,e,t,r,i){nn("verbose",()=>`[WebNN] TensorManager.ensureTensor {tensorId: ${e}, dataType: ${t}, shape: ${r}, copyOld: ${i}}`);let s=this.tensorTrackersById.get(e);if(!s)throw new Error("Tensor not found.");return s.ensureTensor(n,t,r,i)}upload(n,e){let t=this.tensorTrackersById.get(n);if(!t)throw new Error("Tensor not found.");t.upload(e)}async download(n,e){nn("verbose",()=>`[WebNN] TensorManager.download {tensorId: ${n}, dstBuffer: ${e?.byteLength}}`);let t=this.tensorTrackersById.get(n);if(!t)throw new Error("Tensor not found.");return t.download(e)}releaseTensorsForSession(n){for(let e of this.freeTensors)e.sessionId===n&&e.destroy();this.freeTensors=this.freeTensors.filter(e=>e.sessionId!==n)}registerTensor(n,e,t,r){let i=this.getMLContext(n),s=ix(),a=new ax({sessionId:n,context:i,tensor:e,dataType:t,shape:r});return this.tensorTrackersById.set(s,new ox(this,a)),this.externalTensors.add(a),s}async getCachedTensor(n,e,t,r,i,s){let a=this.getMLContext(n);for(let[l,c]of this.freeTensors.entries())if(c.canReuseTensor(a,e,t)){nn("verbose",()=>`[WebNN] Reusing tensor {dataType: ${e}, shape: ${t}}`);let u=this.freeTensors.splice(l,1)[0];return u.sessionId=n,u}nn("verbose",()=>`[WebNN] MLContext.createTensor {dataType: ${e}, shape: ${t}}`);let o=await a.createTensor({dataType:e,shape:t,dimensions:t,usage:r,writable:i,readable:s});return new ax({sessionId:n,context:a,tensor:o,dataType:e,shape:t})}releaseTensor(n){this.externalTensors.has(n)&&this.externalTensors.delete(n),this.freeTensors.push(n)}},E8=(...n)=>new HO(...n)}),Ay,KO,D8,k7=nt(()=>{Ft(),rd(),U$(),P7(),Uo(),Ay=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),KO=(n,e)=>{if(n===e)return!0;if(n===void 0||e===void 0)return!1;let t=Object.keys(n).sort(),r=Object.keys(e).sort();return t.length===r.length&&t.every((i,s)=>i===r[s]&&n[i]===e[i])},D8=class{constructor(n){this.tensorManager=E8(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.temporaryGraphInputs=[],this.temporarySessionTensorIds=new Map,fD(n.logLevel,!!n.debug)}get currentSessionId(){if(this.activeSessionId===void 0)throw new Error("No active session");return this.activeSessionId}onRunStart(n){nn("verbose",()=>`[WebNN] onRunStart {sessionId: ${n}}`),this.activeSessionId=n}onRunEnd(n){nn("verbose",()=>`[WebNN] onRunEnd {sessionId: ${n}}`);let e=this.temporarySessionTensorIds.get(n);if(e){for(let t of e)nn("verbose",()=>`[WebNN] releasing temporary tensor {tensorId: ${t}}`),this.tensorManager.releaseTensorId(t);this.temporarySessionTensorIds.delete(n),this.activeSessionId=void 0}}async createMLContext(n){if(n instanceof GPUDevice){let t=this.mlContextCache.findIndex(r=>r.gpuDevice===n);if(t!==-1)return this.mlContextCache[t].mlContext;{let r=await navigator.ml.createContext(n);return this.mlContextCache.push({gpuDevice:n,mlContext:r}),r}}else if(n===void 0){let t=this.mlContextCache.findIndex(r=>r.options===void 0&&r.gpuDevice===void 0);if(t!==-1)return this.mlContextCache[t].mlContext;{let r=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:r}),r}}let e=this.mlContextCache.findIndex(t=>KO(t.options,n));if(e!==-1)return this.mlContextCache[e].mlContext;{let t=await navigator.ml.createContext(n);return this.mlContextCache.push({options:n,mlContext:t}),t}}registerMLContext(n,e){this.mlContextBySessionId.set(n,e);let t=this.sessionIdsByMLContext.get(e);t||(t=new Set,this.sessionIdsByMLContext.set(e,t)),t.add(n),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(n,this.temporaryGraphInputs),this.temporaryGraphInputs=[])}onReleaseSession(n){this.sessionGraphInputs.delete(n);let e=this.mlContextBySessionId.get(n);if(!e)return;this.tensorManager.releaseTensorsForSession(n),this.mlContextBySessionId.delete(n);let t=this.sessionIdsByMLContext.get(e);if(t.delete(n),t.size===0){this.sessionIdsByMLContext.delete(e);let r=this.mlContextCache.findIndex(i=>i.mlContext===e);r!==-1&&this.mlContextCache.splice(r,1)}}getMLContext(n){return this.mlContextBySessionId.get(n)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(n){nn("verbose",()=>`[WebNN] releaseTensorId {tensorId: ${n}}`),this.tensorManager.releaseTensorId(n)}async ensureTensor(n,e,t,r,i){let s=Ay.get(t);if(!s)throw new Error(`Unsupported ONNX data type: ${t}`);return this.tensorManager.ensureTensor(n??this.currentSessionId,e,s,r,i)}async createTemporaryTensor(n,e,t){nn("verbose",()=>`[WebNN] createTemporaryTensor {onnxDataType: ${e}, shape: ${t}}`);let r=Ay.get(e);if(!r)throw new Error(`Unsupported ONNX data type: ${e}`);let i=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(n,i,r,t,!1);let s=this.temporarySessionTensorIds.get(n);return s?s.push(i):this.temporarySessionTensorIds.set(n,[i]),i}uploadTensor(n,e){if(!Ar().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");nn("verbose",()=>`[WebNN] uploadTensor {tensorId: ${n}, data: ${e.byteLength}}`),this.tensorManager.upload(n,e)}async downloadTensor(n,e){return this.tensorManager.download(n,e)}createMLTensorDownloader(n,e){return async()=>{let t=await this.tensorManager.download(n);return pD(t,e)}}registerMLTensor(n,e,t,r){let i=Ay.get(t);if(!i)throw new Error(`Unsupported ONNX data type: ${t}`);let s=this.tensorManager.registerTensor(n,e,i,r);return nn("verbose",()=>`[WebNN] registerMLTensor {tensor: ${e}, dataType: ${i}, dimensions: ${r}} -> {tensorId: ${s}}`),s}registerMLConstant(n,e,t,r,i,s){if(!s)throw new Error("External mounted files are not available.");let a=n;n.startsWith("./")&&(a=n.substring(2));let o=s.get(a);if(!o)throw new Error(`File with name ${a} not found in preloaded files.`);if(e+t>o.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let l=o.slice(e,e+t).buffer,c;switch(i.dataType){case"float32":c=new Float32Array(l);break;case"float16":c=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(l):new Uint16Array(l);break;case"int32":c=new Int32Array(l);break;case"uint32":c=new Uint32Array(l);break;case"int64":c=new BigInt64Array(l);break;case"uint64":c=new BigUint64Array(l);break;case"int8":c=new Int8Array(l);break;case"int4":case"uint4":case"uint8":c=new Uint8Array(l);break;default:throw new Error(`Unsupported data type: ${i.dataType} in creating WebNN Constant from external data.`)}return nn("verbose",()=>`[WebNN] registerMLConstant {dataType: ${i.dataType}, shape: ${i.shape}}}`),r.constant(i,c)}registerGraphInput(n){this.temporaryGraphInputs.push(n)}isGraphInput(n,e){let t=this.sessionGraphInputs.get(n);return t?t.includes(e):!1}flush(){}}}),M8={};M_(M8,{init:()=>A8});var Cy,XO,A8,F7=nt(()=>{Ft(),S7(),Uo(),$t(),k7(),Cy=class C8{constructor(e,t,r,i){this.module=e,this.dataType=t,this.data=r,this.dims=i}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let e=Ve.size(this.dims);return e===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,e)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let e=Ve.size(this.dims);return e===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,e)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let e=Ve.size(this.dims);return e===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,e)}getUint16Array(){if(this.dataType!==10&&this.dataType!==4)throw new Error("Invalid data type");let e=Ve.size(this.dims);return e===0?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,e)}reshape(e){if(Ve.size(e)!==Ve.size(this.dims))throw new Error("Invalid new shape");return new C8(this.module,this.dataType,this.data,e)}},XO=class{constructor(n,e,t){this.module=n,this.backend=e,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=e.adapterInfo;let r=n.PTR_SIZE,i=t/n.PTR_SIZE,s=r===4?"i32":"i64";this.opKernelContext=Number(n.getValue(r*i++,s));let a=Number(n.getValue(r*i++,s));this.outputCount=Number(n.getValue(r*i++,s)),this.customDataOffset=Number(n.getValue(r*i++,"*")),this.customDataSize=Number(n.getValue(r*i++,s));let o=[];for(let l=0;l<a;l++){let c=Number(n.getValue(r*i++,s)),u=Number(n.getValue(r*i++,"*")),d=Number(n.getValue(r*i++,s)),h=[];for(let f=0;f<d;f++)h.push(Number(n.getValue(r*i++,s)));o.push(new Cy(n,c,u,h))}this.inputs=o}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(n,e){let t=e?.inputs?.map(a=>typeof a=="number"?this.inputs[a]:a)??this.inputs,r=e?.outputs??[],i=(a,o,l)=>new Cy(this.module,o,this.output(a,l),l),s=(a,o)=>{let l=Ic(a,o);if(!l)throw new Error(`Unsupported data type: ${a}`);let c=l>0?this.backend.gpuDataManager.create(l).id:0;return new Cy(this.module,a,c,o)};return this.backend.run(n,t,r,i,s,this.outputCount)}output(n,e){let t=this.module.stackSave();try{let r=this.module.PTR_SIZE,i=r===4?"i32":"i64",s=this.module.stackAlloc((1+e.length)*r);this.module.setValue(s,e.length,i);for(let a=0;a<e.length;a++)this.module.setValue(s+r*(a+1),e[a],i);return this.module._JsepOutput(this.opKernelContext,n,s)}catch(r){throw new Error(`Failed to generate kernel's output[${n}] with dims [${e}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${r}`)}finally{this.module.stackRestore(t)}}},A8=async(n,e,t,r)=>{let i=e.jsepInit;if(!i)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(n==="webgpu"){let s=new T8;await s.initialize(t,r),i("webgpu",[s,a=>s.alloc(Number(a)),a=>s.free(a),(a,o,l,c=!1)=>{if(c)nn("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Number(a)}, dst=${Number(o)}, size=${Number(l)}`),s.memcpy(Number(a),Number(o));else{nn("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Number(a)}, gpuDataId=${Number(o)}, size=${Number(l)}`);let u=e.HEAPU8.subarray(Number(a>>>0),Number(a>>>0)+Number(l));s.upload(Number(o),u)}},async(a,o,l)=>{nn("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${a}, dataOffset=${o}, size=${l}`),await s.download(Number(a),()=>e.HEAPU8.subarray(Number(o)>>>0,Number(o+l)>>>0))},(a,o,l)=>s.createKernel(a,Number(o),l,e.UTF8ToString(e._JsepGetNodeName(Number(o)))),a=>s.releaseKernel(a),(a,o,l,c)=>{nn("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${l}, kernel=${a}, contextDataOffset=${o}`);let u=new XO(e,s,Number(o));return s.computeKernel(Number(a),u,c)},()=>s.captureBegin(),()=>s.captureEnd(),()=>s.replay()])}else{let s=new D8(t);i("webnn",[s,()=>s.reserveTensorId(),a=>s.releaseTensorId(a),async(a,o,l,c,u)=>s.ensureTensor(a,o,l,c,u),(a,o)=>{s.uploadTensor(a,o)},async(a,o)=>s.downloadTensor(a,o)])}}}),YO,DD,MD,nl,QO,J0,AD,CD,lx,SD,PD,kD,S8=nt(()=>{LV(),RV(),Ft(),rd(),lD(),O$(),YO=(n,e)=>{Ar()._OrtInit(n,e)!==0&&cn("Can't initialize onnxruntime.")},DD=async n=>{YO(n.wasm.numThreads,X0(n.logLevel))},MD=async(n,e)=>{{let t=(F7(),H0(M8)).init;if(e==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let r=n.webgpu.adapter;if(r){if(typeof r.limits!="object"||typeof r.features!="object"||typeof r.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let i=n.webgpu.powerPreference;if(i!==void 0&&i!=="low-power"&&i!=="high-performance")throw new Error(`Invalid powerPreference setting: "${i}"`);let s=n.webgpu.forceFallbackAdapter;if(s!==void 0&&typeof s!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${s}"`);if(r=await navigator.gpu.requestAdapter({powerPreference:i,forceFallbackAdapter:s}),!r)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await t("webgpu",Ar(),n,r)}if(e==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await t("webnn",Ar(),n)}}},nl=new Map,QO=n=>{let e=Ar(),t=e.stackSave();try{let r=e.PTR_SIZE,i=e.stackAlloc(2*r);e._OrtGetInputOutputCount(n,i,i+r)!==0&&cn("Can't get session input/output count.");let s=r===4?"i32":"i64";return[Number(e.getValue(i,s)),Number(e.getValue(i+r,s))]}finally{e.stackRestore(t)}},J0=n=>{let e=Ar(),t=e._malloc(n.byteLength);if(t===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${n.byteLength}.`);return e.HEAPU8.set(n,t),[t,n.byteLength]},AD=async(n,e)=>{let t,r,i=Ar();Array.isArray(n)?[t,r]=n:n.buffer===i.HEAPU8.buffer?[t,r]=[n.byteOffset,n.byteLength]:[t,r]=J0(n);let s=0,a=0,o=0,l=[],c=[],u=[];try{if([a,l]=I$(e),e?.externalData&&i.mountExternalData){let m=[];for(let v of e.externalData){let x=typeof v=="string"?v:v.path;m.push(hD(typeof v=="string"?v:v.data).then(w=>{i.mountExternalData(x,w)}))}await Promise.all(m)}for(let m of e?.executionProviders??[])if((typeof m=="string"?m:m.name)==="webnn"){if(i.shouldTransferToMLTensor=!1,typeof m!="string"){let v=m,x=v?.context,w=v?.gpuDevice,T=v?.deviceType,E=v?.powerPreference;x?i.currentContext=x:w?i.currentContext=await i.jsepCreateMLContext(w):i.currentContext=await i.jsepCreateMLContext({deviceType:T,powerPreference:E})}else i.currentContext=await i.jsepCreateMLContext();break}s=await i._OrtCreateSession(t,r,a),s===0&&cn("Can't create a session."),i.jsepOnCreateSession?.(),i.currentContext&&(i.jsepRegisterMLContext(s,i.currentContext),i.currentContext=void 0,i.shouldTransferToMLTensor=!0);let[d,h]=QO(s),f=!!e?.enableGraphCapture,p=[],g=[],b=[];for(let m=0;m<d;m++){let v=i._OrtGetInputName(s,m);v===0&&cn("Can't get an input name."),c.push(v),p.push(i.UTF8ToString(v))}for(let m=0;m<h;m++){let v=i._OrtGetOutputName(s,m);v===0&&cn("Can't get an output name."),u.push(v);let x=i.UTF8ToString(v);g.push(x);{if(f&&e?.preferredOutputLocation===void 0){b.push("gpu-buffer");continue}let w=typeof e?.preferredOutputLocation=="string"?e.preferredOutputLocation:e?.preferredOutputLocation?.[x]??"cpu";if(w!=="cpu"&&w!=="cpu-pinned"&&w!=="gpu-buffer"&&w!=="ml-tensor")throw new Error(`Not supported preferred output location: ${w}.`);if(f&&w!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${w}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);b.push(w)}}let _=null;return b.some(m=>m==="gpu-buffer"||m==="ml-tensor")&&(o=i._OrtCreateBinding(s),o===0&&cn("Can't create IO binding."),_={handle:o,outputPreferredLocations:b,outputPreferredLocationsEncoded:b.map(m=>LT(m))}),nl.set(s,[s,c,u,_,f,!1]),[s,p,g]}catch(d){throw c.forEach(h=>i._OrtFree(h)),u.forEach(h=>i._OrtFree(h)),o!==0&&i._OrtReleaseBinding(o)!==0&&cn("Can't release IO binding."),s!==0&&i._OrtReleaseSession(s)!==0&&cn("Can't release session."),d}finally{i._free(t),a!==0&&i._OrtReleaseSessionOptions(a)!==0&&cn("Can't release session options."),l.forEach(d=>i._free(d)),i.unmountExternalData?.()}},CD=n=>{let e=Ar(),t=nl.get(n);if(!t)throw new Error(`cannot release session. invalid session id: ${n}`);let[r,i,s,a,o]=t;a&&(o&&e._OrtClearBoundOutputs(a.handle)!==0&&cn("Can't clear bound outputs."),e._OrtReleaseBinding(a.handle)!==0&&cn("Can't release IO binding.")),e.jsepOnReleaseSession?.(n),i.forEach(l=>e._OrtFree(l)),s.forEach(l=>e._OrtFree(l)),e._OrtReleaseSession(r)!==0&&cn("Can't release session."),nl.delete(n)},lx=async(n,e,t,r,i,s=!1)=>{if(!n){e.push(0);return}let a=Ar(),o=a.PTR_SIZE,l=n[0],c=n[1],u=n[3],d=u,h,f;if(l==="string"&&(u==="gpu-buffer"||u==="ml-tensor"))throw new Error("String tensor is not supported on GPU.");if(s&&u!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if(u==="gpu-buffer"){let b=n[2].gpuBuffer;f=Ic(Zd(l),c);let _=a.jsepRegisterBuffer;if(!_)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');h=_(r,i,b,f)}else if(u==="ml-tensor"){let b=n[2].mlTensor;f=Ic(Zd(l),c);let _=a.jsepRegisterMLTensor;if(!_)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');h=_(r,b,Zd(l),c)}else{let b=n[2];if(Array.isArray(b)){f=o*b.length,h=a._malloc(f),t.push(h);for(let _=0;_<b.length;_++){if(typeof b[_]!="string")throw new TypeError(`tensor data at index ${_} is not a string`);a.setValue(h+_*o,Qr(b[_],t),"*")}}else{let _=a.jsepIsGraphInput;if(l!=="string"&&_){let m=a._OrtGetInputName(r,i),v=a.UTF8ToString(m);if(_(r,v)){let x=Zd(l);f=Ic(x,c),d="ml-tensor";let w=a.jsepCreateTemporaryTensor,T=a.jsepUploadTensor;if(!w||!T)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let E=await w(r,x,c);T(E,new Uint8Array(b.buffer,b.byteOffset,b.byteLength)),h=E}else f=b.byteLength,h=a._malloc(f),t.push(h),a.HEAPU8.set(new Uint8Array(b.buffer,b.byteOffset,f),h)}else f=b.byteLength,h=a._malloc(f),t.push(h),a.HEAPU8.set(new Uint8Array(b.buffer,b.byteOffset,f),h)}}let p=a.stackSave(),g=a.stackAlloc(4*c.length);try{c.forEach((_,m)=>a.setValue(g+m*o,_,o===4?"i32":"i64"));let b=a._OrtCreateTensor(Zd(l),h,f,g,c.length,LT(d));b===0&&cn(`Can't create tensor for input/output. session=${r}, index=${i}.`),e.push(b)}finally{a.stackRestore(p)}},SD=async(n,e,t,r,i,s)=>{let a=Ar(),o=a.PTR_SIZE,l=nl.get(n);if(!l)throw new Error(`cannot run inference. invalid session id: ${n}`);let c=l[0],u=l[1],d=l[2],h=l[3],f=l[4],p=l[5],g=e.length,b=r.length,_=0,m=[],v=[],x=[],w=[],T=a.stackSave(),E=a.stackAlloc(g*o),A=a.stackAlloc(g*o),M=a.stackAlloc(b*o),F=a.stackAlloc(b*o);try{[_,m]=F$(s);for(let I=0;I<g;I++)await lx(t[I],v,w,n,e[I],f);for(let I=0;I<b;I++)await lx(i[I],x,w,n,g+r[I],f);for(let I=0;I<g;I++)a.setValue(E+I*o,v[I],"*"),a.setValue(A+I*o,u[e[I]],"*");for(let I=0;I<b;I++)a.setValue(M+I*o,x[I],"*"),a.setValue(F+I*o,d[r[I]],"*");if(h&&!p){let{handle:I,outputPreferredLocations:C,outputPreferredLocationsEncoded:H}=h;if(u.length!==g)throw new Error(`input count from feeds (${g}) is expected to be always equal to model's input count (${u.length}).`);for(let B=0;B<g;B++){let $=e[B];await a._OrtBindInput(I,u[$],v[B])!==0&&cn(`Can't bind input[${B}] for session=${n}.`)}for(let B=0;B<b;B++){let $=r[B];i[B]?.[3]?a._OrtBindOutput(I,d[$],x[B],0)!==0&&cn(`Can't bind pre-allocated output[${B}] for session=${n}.`):a._OrtBindOutput(I,d[$],0,H[$])!==0&&cn(`Can't bind output[${B}] to ${C[B]} for session=${n}.`)}nl.set(n,[c,u,d,h,f,!0])}a.jsepOnRunStart?.(c);let G;h?G=await a._OrtRunWithBinding(c,h.handle,b,M,_):G=await a._OrtRun(c,A,E,g,F,b,M,_),G!==0&&cn("failed to call OrtRun().");let S=[];for(let I=0;I<b;I++){let C=Number(a.getValue(M+I*o,"*"));if(C===x[I]){S.push(i[I]);continue}let H=a.stackSave(),B=a.stackAlloc(4*o),$=!1,X,V=0;try{a._OrtGetTensorData(C,B,B+o,B+2*o,B+3*o)!==0&&cn(`Can't access output tensor data on index ${I}.`);let Q=o===4?"i32":"i64",R=Number(a.getValue(B,Q));V=a.getValue(B+o,"*");let O=a.getValue(B+o*2,"*"),L=Number(a.getValue(B+o*3,Q)),ne=[];for(let be=0;be<L;be++)ne.push(Number(a.getValue(O+be*o,Q)));a._OrtFree(O)!==0&&cn("Can't free memory for tensor dims.");let de=ne.reduce((be,Ee)=>be*Ee,1);X=Fc(R);let we=h?.outputPreferredLocations[r[I]];if(X==="string"){if(we==="gpu-buffer"||we==="ml-tensor")throw new Error("String tensor is not supported on GPU.");let be=[];for(let Ee=0;Ee<de;Ee++){let Fe=a.getValue(V+Ee*o,"*"),xe=a.getValue(V+(Ee+1)*o,"*"),ce=Ee===de-1?void 0:xe-Fe;be.push(a.UTF8ToString(Fe,ce))}S.push([X,ne,be,"cpu"])}else if(we==="gpu-buffer"&&de>0){let be=a.jsepGetBuffer;if(!be)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let Ee=be(V),Fe=Ic(R,de);if(Fe===void 0||!uD(X))throw new Error(`Unsupported data type: ${X}`);$=!0,S.push([X,ne,{gpuBuffer:Ee,download:a.jsepCreateDownloader(Ee,Fe,X),dispose:()=>{a._OrtReleaseTensor(C)!==0&&cn("Can't release tensor.")}},"gpu-buffer"])}else if(we==="ml-tensor"&&de>0){let be=a.jsepEnsureTensor;if(!be)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(Ic(R,de)===void 0||!dD(X))throw new Error(`Unsupported data type: ${X}`);let Ee=await be(n,V,R,ne,!1);$=!0,S.push([X,ne,{mlTensor:Ee,download:a.jsepCreateMLTensorDownloader(V,X),dispose:()=>{a.jsepReleaseTensorId(V),a._OrtReleaseTensor(C)}},"ml-tensor"])}else{let be=cD(X),Ee=new be(de);new Uint8Array(Ee.buffer,Ee.byteOffset,Ee.byteLength).set(a.HEAPU8.subarray(V,V+Ee.byteLength)),S.push([X,ne,Ee,"cpu"])}}finally{a.stackRestore(H),X==="string"&&V&&a._free(V),$||a._OrtReleaseTensor(C),a.jsepOnRunEnd?.(c)}}return h&&!f&&(a._OrtClearBoundOutputs(h.handle)!==0&&cn("Can't clear bound outputs."),nl.set(n,[c,u,d,h,f,!1])),S}finally{a.stackRestore(T),v.forEach(G=>a._OrtReleaseTensor(G)),x.forEach(G=>a._OrtReleaseTensor(G)),w.forEach(G=>a._free(G)),_!==0&&a._OrtReleaseRunOptions(_),m.forEach(G=>a._free(G))}},PD=n=>{let e=Ar(),t=nl.get(n);if(!t)throw new Error("invalid session id");let r=t[0],i=e._OrtEndProfiling(r);i===0&&cn("Can't get an profile file name."),e._OrtFree(i)},kD=n=>{let e=[];for(let t of n){let r=t[2];!Array.isArray(r)&&"buffer"in r&&e.push(r.buffer)}return e}}),rl,ws,jd,um,dm,Sy,cx,Py,Dc,Mc,ZO,P8,k8,F8,I8,O8,U8,L8,R8=nt(()=>{pa(),S8(),rd(),aD(),rl=()=>!!In.wasm.proxy&&typeof document<"u",jd=!1,um=!1,dm=!1,Py=new Map,Dc=(n,e)=>{let t=Py.get(n);t?t.push(e):Py.set(n,[e])},Mc=()=>{if(jd||!um||dm||!ws)throw new Error("worker not ready")},ZO=n=>{switch(n.data.type){case"init-wasm":jd=!1,n.data.err?(dm=!0,cx[1](n.data.err)):(um=!0,cx[0]()),Sy&&(URL.revokeObjectURL(Sy),Sy=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let e=Py.get(n.data.type);n.data.err?e.shift()[1](n.data.err):e.shift()[0](n.data.out);break}}},P8=async()=>{if(!um){if(jd)throw new Error("multiple calls to 'initWasm()' detected.");if(dm)throw new Error("previous call to 'initWasm()' failed.");if(jd=!0,rl())return new Promise((n,e)=>{ws?.terminate(),P$().then(([t,r])=>{try{ws=r,ws.onerror=s=>e(s),ws.onmessage=ZO,cx=[n,e];let i={type:"init-wasm",in:In};!i.in.wasm.wasmPaths&&(t||UT)&&(i.in.wasm.wasmPaths={wasm:new URL(""+new URL("ort-wasm-simd-threaded.jsep-BAR87mbD.wasm",import.meta.url).href,import.meta.url).href}),ws.postMessage(i),Sy=t}catch(i){e(i)}},e)});try{await oD(In.wasm),await DD(In),um=!0}catch(n){throw dm=!0,n}finally{jd=!1}}},k8=async n=>{if(rl())return Mc(),new Promise((e,t)=>{Dc("init-ep",[e,t]);let r={type:"init-ep",in:{epName:n,env:In}};ws.postMessage(r)});await MD(In,n)},F8=async n=>rl()?(Mc(),new Promise((e,t)=>{Dc("copy-from",[e,t]);let r={type:"copy-from",in:{buffer:n}};ws.postMessage(r,[n.buffer])})):J0(n),I8=async(n,e)=>{if(rl()){if(e?.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Mc(),new Promise((t,r)=>{Dc("create",[t,r]);let i={type:"create",in:{model:n,options:{...e}}},s=[];n instanceof Uint8Array&&s.push(n.buffer),ws.postMessage(i,s)})}else return AD(n,e)},O8=async n=>{if(rl())return Mc(),new Promise((e,t)=>{Dc("release",[e,t]);let r={type:"release",in:n};ws.postMessage(r)});CD(n)},U8=async(n,e,t,r,i,s)=>{if(rl()){if(t.some(a=>a[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(i.some(a=>a))throw new Error("pre-allocated output tensor is not supported for proxy.");return Mc(),new Promise((a,o)=>{Dc("run",[a,o]);let l=t,c={type:"run",in:{sessionId:n,inputIndices:e,inputs:l,outputIndices:r,options:s}};ws.postMessage(c,kD(l))})}else return SD(n,e,t,r,i,s)},L8=async n=>{if(rl())return Mc(),new Promise((e,t)=>{Dc("end-profiling",[e,t]);let r={type:"end-profiling",in:n};ws.postMessage(r)});PD(n)}}),ux,JO,B8,I7=nt(()=>{pa(),R8(),Ft(),sD(),O$(),ux=(n,e)=>{switch(n.location){case"cpu":return[n.type,n.dims,n.data,"cpu"];case"gpu-buffer":return[n.type,n.dims,{gpuBuffer:n.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[n.type,n.dims,{mlTensor:n.mlTensor},"ml-tensor"];default:throw new Error(`invalid data location: ${n.location} for ${e()}`)}},JO=n=>{switch(n[3]){case"cpu":return new oa(n[0],n[2],n[1]);case"gpu-buffer":{let e=n[0];if(!uD(e))throw new Error(`not supported data type: ${e} for deserializing GPU tensor`);let{gpuBuffer:t,download:r,dispose:i}=n[2];return oa.fromGpuBuffer(t,{dataType:e,dims:n[1],download:r,dispose:i})}case"ml-tensor":{let e=n[0];if(!dD(e))throw new Error(`not supported data type: ${e} for deserializing MLTensor tensor`);let{mlTensor:t,download:r,dispose:i}=n[2];return oa.fromMLTensor(t,{dataType:e,dims:n[1],download:r,dispose:i})}default:throw new Error(`invalid data location: ${n[3]}`)}},B8=class{async fetchModelAndCopyToWasmMemory(n){return F8(await hD(n))}async loadModel(n,e){ha();let t;typeof n=="string"?t=await this.fetchModelAndCopyToWasmMemory(n):t=n,[this.sessionId,this.inputNames,this.outputNames]=await I8(t,e),Os()}async dispose(){return O8(this.sessionId)}async run(n,e,t){ha();let r=[],i=[];Object.entries(n).forEach(d=>{let h=d[0],f=d[1],p=this.inputNames.indexOf(h);if(p===-1)throw new Error(`invalid input '${h}'`);r.push(f),i.push(p)});let s=[],a=[];Object.entries(e).forEach(d=>{let h=d[0],f=d[1],p=this.outputNames.indexOf(h);if(p===-1)throw new Error(`invalid output '${h}'`);s.push(f),a.push(p)});let o=r.map((d,h)=>ux(d,()=>`input "${this.inputNames[i[h]]}"`)),l=s.map((d,h)=>d?ux(d,()=>`output "${this.outputNames[a[h]]}"`):null),c=await U8(this.sessionId,i,o,a,l,t),u={};for(let d=0;d<c.length;d++)u[this.outputNames[a[d]]]=s[d]??JO(c[d]);return Os(),u}startProfiling(){}endProfiling(){L8(this.sessionId)}}}),$8={};M_($8,{OnnxruntimeWebAssemblyBackend:()=>XT,initializeFlags:()=>KT,wasmBackend:()=>N8});var KT,XT,N8,O7=nt(()=>{pa(),R8(),I7(),KT=()=>{if((typeof In.wasm.initTimeout!="number"||In.wasm.initTimeout<0)&&(In.wasm.initTimeout=0),In.wasm.simd===!1&&console.warn('Deprecated property "env.wasm.simd" is set to false. non-SIMD build is no longer provided, and this setting will be ignored.'),typeof In.wasm.proxy!="boolean"&&(In.wasm.proxy=!1),typeof In.wasm.trace!="boolean"&&(In.wasm.trace=!1),typeof In.wasm.numThreads!="number"||!Number.isInteger(In.wasm.numThreads)||In.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)In.wasm.numThreads=1;else{let n=typeof navigator>"u"?yV("node:os").cpus().length:navigator.hardwareConcurrency;In.wasm.numThreads=Math.min(4,Math.ceil((n||1)/2))}},XT=class{async init(n){KT(),await P8(),await k8(n)}async createInferenceSessionHandler(n,e){let t=new B8;return await t.loadModel(n,e),Promise.resolve(t)}},N8=new XT});pa();pa();pa();var U7="1.22.0-dev.20250306-ccf8fdd9ea",L7=E$;{let n=(O7(),H0($8)).wasmBackend;Lc("webgpu",n,5),Lc("webnn",n,5),Lc("cpu",n,10),Lc("wasm",n,10)}Object.defineProperty(In.versions,"web",{value:U7,enumerable:!0});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R7=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return iD},get TRACE(){return Hm},get TRACE_FUNC_BEGIN(){return ha},get TRACE_FUNC_END(){return Os},get Tensor(){return oa},default:L7,get env(){return In},get registerBackend(){return Lc}},Symbol.toStringTag,{value:"Module"}));var dx={},B7={"onnxruntime-common":n=>{n.exports=mV},"onnxruntime-web":n=>{n.exports=R7},"?2ce3":()=>{},"?7a2c":()=>{},"?a42a":()=>{},"?2b25":()=>{},"?569f":()=>{},"?3f59":()=>{},"?154a":()=>{},"./node_modules/@huggingface/jinja/dist/index.js":(n,e,t)=>{t.r(e),t.d(e,{Environment:()=>pe,Interpreter:()=>ie,Template:()=>Ce,parse:()=>R,tokenize:()=>d});var r=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",BooleanLiteral:"BooleanLiteral",NullLiteral:"NullLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Set:"Set",If:"If",For:"For",In:"In",Is:"Is",NotIn:"NotIn",Else:"Else",EndIf:"EndIf",ElseIf:"ElseIf",EndFor:"EndFor",And:"And",Or:"Or",Not:"UnaryOperator",Macro:"Macro",EndMacro:"EndMacro"}),i=Object.freeze({set:r.Set,for:r.For,in:r.In,is:r.Is,if:r.If,else:r.Else,endif:r.EndIf,elif:r.ElseIf,endfor:r.EndFor,and:r.And,or:r.Or,not:r.Not,"not in":r.NotIn,macro:r.Macro,endmacro:r.EndMacro,true:r.BooleanLiteral,false:r.BooleanLiteral,none:r.NullLiteral,True:r.BooleanLiteral,False:r.BooleanLiteral,None:r.NullLiteral}),s=class{constructor(q,te){this.value=q,this.type=te}};function a(q){return/\w/.test(q)}function o(q){return/[0-9]/.test(q)}var l=[["{%",r.OpenStatement],["%}",r.CloseStatement],["{{",r.OpenExpression],["}}",r.CloseExpression],["(",r.OpenParen],[")",r.CloseParen],["{",r.OpenCurlyBracket],["}",r.CloseCurlyBracket],["[",r.OpenSquareBracket],["]",r.CloseSquareBracket],[",",r.Comma],[".",r.Dot],[":",r.Colon],["|",r.Pipe],["<=",r.ComparisonBinaryOperator],[">=",r.ComparisonBinaryOperator],["==",r.ComparisonBinaryOperator],["!=",r.ComparisonBinaryOperator],["<",r.ComparisonBinaryOperator],[">",r.ComparisonBinaryOperator],["+",r.AdditiveBinaryOperator],["-",r.AdditiveBinaryOperator],["*",r.MultiplicativeBinaryOperator],["/",r.MultiplicativeBinaryOperator],["%",r.MultiplicativeBinaryOperator],["=",r.Equals]],c=new Map([["n",`
`],["t","	"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function u(q,te={}){return q.endsWith(`
`)&&(q=q.slice(0,-1)),q=q.replace(/{#.*?#}/gs,"{##}"),te.lstrip_blocks&&(q=q.replace(/^[ \t]*({[#%])/gm,"$1")),te.trim_blocks&&(q=q.replace(/([#%]})\n/g,"$1")),q.replace(/{##}/g,"").replace(/-%}\s*/g,"%}").replace(/\s*{%-/g,"{%").replace(/-}}\s*/g,"}}").replace(/\s*{{-/g,"{{")}function d(q,te={}){const j=[],ee=u(q,te);let se=0;const ve=ke=>{let Re="";for(;ke(ee[se]);){if(ee[se]==="\\"){if(++se,se>=ee.length)throw new SyntaxError("Unexpected end of input");const Oe=ee[se++],ze=c.get(Oe);if(ze===void 0)throw new SyntaxError(`Unexpected escaped character: ${Oe}`);Re+=ze;continue}if(Re+=ee[se++],se>=ee.length)throw new SyntaxError("Unexpected end of input")}return Re};e:for(;se<ee.length;){const ke=j.at(-1)?.type;if(ke===void 0||ke===r.CloseStatement||ke===r.CloseExpression){let Oe="";for(;se<ee.length&&!(ee[se]==="{"&&(ee[se+1]==="%"||ee[se+1]==="{"));)Oe+=ee[se++];if(Oe.length>0){j.push(new s(Oe,r.Text));continue}}ve(Oe=>/\s/.test(Oe));const Re=ee[se];if(Re==="-"||Re==="+"){const Oe=j.at(-1)?.type;if(Oe===r.Text||Oe===void 0)throw new SyntaxError(`Unexpected character: ${Re}`);switch(Oe){case r.Identifier:case r.NumericLiteral:case r.BooleanLiteral:case r.NullLiteral:case r.StringLiteral:case r.CloseParen:case r.CloseSquareBracket:break;default:{++se;const ze=ve(o);j.push(new s(`${Re}${ze}`,ze.length>0?r.NumericLiteral:r.UnaryOperator));continue}}}for(const[Oe,ze]of l)if(ee.slice(se,se+Oe.length)===Oe){j.push(new s(Oe,ze)),se+=Oe.length;continue e}if(Re==="'"||Re==='"'){++se;const Oe=ve(ze=>ze!==Re);j.push(new s(Oe,r.StringLiteral)),++se;continue}if(o(Re)){const Oe=ve(o);j.push(new s(Oe,r.NumericLiteral));continue}if(a(Re)){const Oe=ve(a),ze=Object.hasOwn(i,Oe)?i[Oe]:r.Identifier;ze===r.In&&j.at(-1)?.type===r.Not?(j.pop(),j.push(new s("not in",r.NotIn))):j.push(new s(Oe,ze));continue}throw new SyntaxError(`Unexpected character: ${Re}`)}return j}var h=class{type="Statement"},f=class extends h{constructor(q){super(),this.body=q}type="Program"},p=class extends h{constructor(q,te,j){super(),this.test=q,this.body=te,this.alternate=j}type="If"},g=class extends h{constructor(q,te,j,ee){super(),this.loopvar=q,this.iterable=te,this.body=j,this.defaultBlock=ee}type="For"},b=class extends h{constructor(q,te){super(),this.assignee=q,this.value=te}type="Set"},_=class extends h{constructor(q,te,j){super(),this.name=q,this.args=te,this.body=j}type="Macro"},m=class extends h{type="Expression"},v=class extends m{constructor(q,te,j){super(),this.object=q,this.property=te,this.computed=j}type="MemberExpression"},x=class extends m{constructor(q,te){super(),this.callee=q,this.args=te}type="CallExpression"},w=class extends m{constructor(q){super(),this.value=q}type="Identifier"},T=class extends m{constructor(q){super(),this.value=q}type="Literal"},E=class extends T{type="NumericLiteral"},A=class extends T{type="StringLiteral"},M=class extends T{type="BooleanLiteral"},F=class extends T{type="NullLiteral"},G=class extends T{type="ArrayLiteral"},S=class extends T{type="TupleLiteral"},I=class extends T{type="ObjectLiteral"},C=class extends m{constructor(q,te,j){super(),this.operator=q,this.left=te,this.right=j}type="BinaryExpression"},H=class extends m{constructor(q,te){super(),this.operand=q,this.filter=te}type="FilterExpression"},B=class extends m{constructor(q,te){super(),this.iterable=q,this.test=te}type="SelectExpression"},$=class extends m{constructor(q,te,j){super(),this.operand=q,this.negate=te,this.test=j}type="TestExpression"},X=class extends m{constructor(q,te){super(),this.operator=q,this.argument=te}type="UnaryExpression"},V=class extends m{constructor(q=void 0,te=void 0,j=void 0){super(),this.start=q,this.stop=te,this.step=j}type="SliceExpression"},Q=class extends m{constructor(q,te){super(),this.key=q,this.value=te}type="KeywordArgumentExpression"};function R(q){const te=new f([]);let j=0;function ee(Ze,ct){const rt=q[j++];if(!rt||rt.type!==Ze)throw new Error(`Parser Error: ${ct}. ${rt.type} !== ${Ze}.`);return rt}function se(){switch(q[j].type){case r.Text:return Re();case r.OpenStatement:return Oe();case r.OpenExpression:return ze();default:throw new SyntaxError(`Unexpected token type: ${q[j].type}`)}}function ve(...Ze){return j+Ze.length<=q.length&&Ze.some((ct,rt)=>ct!==q[j+rt].type)}function ke(...Ze){return j+Ze.length<=q.length&&Ze.every((ct,rt)=>ct===q[j+rt].type)}function Re(){return new A(ee(r.Text,"Expected text token").value)}function Oe(){ee(r.OpenStatement,"Expected opening statement token");let Ze;switch(q[j].type){case r.Set:++j,Ze=Te(),ee(r.CloseStatement,"Expected closing statement token");break;case r.If:++j,Ze=Be(),ee(r.OpenStatement,"Expected {% token"),ee(r.EndIf,"Expected endif token"),ee(r.CloseStatement,"Expected %} token");break;case r.Macro:++j,Ze=qe(),ee(r.OpenStatement,"Expected {% token"),ee(r.EndMacro,"Expected endmacro token"),ee(r.CloseStatement,"Expected %} token");break;case r.For:++j,Ze=xt(),ee(r.OpenStatement,"Expected {% token"),ee(r.EndFor,"Expected endfor token"),ee(r.CloseStatement,"Expected %} token");break;default:throw new SyntaxError(`Unknown statement type: ${q[j].type}`)}return Ze}function ze(){ee(r.OpenExpression,"Expected opening expression token");const Ze=ft();return ee(r.CloseExpression,"Expected closing expression token"),Ze}function Te(){const Ze=ft();if(ke(r.Equals)){++j;const ct=Te();return new b(Ze,ct)}return Ze}function Be(){const Ze=ft();ee(r.CloseStatement,"Expected closing statement token");const ct=[],rt=[];for(;!(q[j]?.type===r.OpenStatement&&(q[j+1]?.type===r.ElseIf||q[j+1]?.type===r.Else||q[j+1]?.type===r.EndIf));)ct.push(se());if(q[j]?.type===r.OpenStatement&&q[j+1]?.type!==r.EndIf)if(++j,ke(r.ElseIf))ee(r.ElseIf,"Expected elseif token"),rt.push(Be());else for(ee(r.Else,"Expected else token"),ee(r.CloseStatement,"Expected closing statement token");!(q[j]?.type===r.OpenStatement&&q[j+1]?.type===r.EndIf);)rt.push(se());return new p(Ze,ct,rt)}function qe(){const Ze=Dn();if(Ze.type!=="Identifier")throw new SyntaxError("Expected identifier following macro statement");const ct=it();ee(r.CloseStatement,"Expected closing statement token");const rt=[];for(;ve(r.OpenStatement,r.EndMacro);)rt.push(se());return new _(Ze,ct,rt)}function tt(Ze=!1){const ct=Ze?Dn:ft,rt=[ct()],Mn=ke(r.Comma);for(;Mn&&(++j,rt.push(ct()),!!ke(r.Comma)););return Mn?new S(rt):rt[0]}function xt(){const Ze=tt(!0);if(!(Ze instanceof w||Ze instanceof S))throw new SyntaxError(`Expected identifier/tuple for the loop variable, got ${Ze.type} instead`);ee(r.In,"Expected `in` keyword following loop variable");const ct=ft();ee(r.CloseStatement,"Expected closing statement token");const rt=[];for(;ve(r.OpenStatement,r.EndFor)&&ve(r.OpenStatement,r.Else);)rt.push(se());const Mn=[];if(ke(r.OpenStatement,r.Else))for(++j,++j,ee(r.CloseStatement,"Expected closing statement token");ve(r.OpenStatement,r.EndFor);)Mn.push(se());return new g(Ze,ct,rt,Mn)}function ft(){return Wt()}function Wt(){const Ze=Jn();if(ke(r.If)){++j;const ct=Jn();if(ke(r.Else)){++j;const rt=Jn();return new p(ct,[Ze],[rt])}else return new B(Ze,ct)}return Ze}function Jn(){let Ze=rr();for(;ke(r.Or);){const ct=q[j];++j;const rt=rr();Ze=new C(ct,Ze,rt)}return Ze}function rr(){let Ze=yr();for(;ke(r.And);){const ct=q[j];++j;const rt=yr();Ze=new C(ct,Ze,rt)}return Ze}function yr(){let Ze;for(;ke(r.Not);){const ct=q[j];++j;const rt=yr();Ze=new X(ct,rt)}return Ze??ae()}function ae(){let Ze=fe();for(;ke(r.ComparisonBinaryOperator)||ke(r.In)||ke(r.NotIn);){const ct=q[j];++j;const rt=fe();Ze=new C(ct,Ze,rt)}return Ze}function fe(){let Ze=ur();for(;ke(r.AdditiveBinaryOperator);){const ct=q[j];++j;const rt=ur();Ze=new C(ct,Ze,rt)}return Ze}function Me(){const Ze=Un(Dn());return ke(r.OpenParen)?Ie(Ze):Ze}function Ie(Ze){let ct=new x(Ze,it());return ct=Un(ct),ke(r.OpenParen)&&(ct=Ie(ct)),ct}function it(){ee(r.OpenParen,"Expected opening parenthesis for arguments list");const Ze=Tt();return ee(r.CloseParen,"Expected closing parenthesis for arguments list"),Ze}function Tt(){const Ze=[];for(;!ke(r.CloseParen);){let ct=ft();if(ke(r.Equals)){if(++j,!(ct instanceof w))throw new SyntaxError("Expected identifier for keyword argument");const rt=ft();ct=new Q(ct,rt)}Ze.push(ct),ke(r.Comma)&&++j}return Ze}function rn(){const Ze=[];let ct=!1;for(;!ke(r.CloseSquareBracket);)ke(r.Colon)?(Ze.push(void 0),++j,ct=!0):(Ze.push(ft()),ke(r.Colon)&&(++j,ct=!0));if(Ze.length===0)throw new SyntaxError("Expected at least one argument for member/slice expression");if(ct){if(Ze.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new V(...Ze)}return Ze[0]}function Un(Ze){for(;ke(r.Dot)||ke(r.OpenSquareBracket);){const ct=q[j];++j;let rt;const Mn=ct.type!==r.Dot;if(Mn)rt=rn(),ee(r.CloseSquareBracket,"Expected closing square bracket");else if(rt=Dn(),rt.type!=="Identifier")throw new SyntaxError("Expected identifier following dot operator");Ze=new v(Ze,rt,Mn)}return Ze}function ur(){let Ze=vr();for(;ke(r.MultiplicativeBinaryOperator);){const ct=q[j];++j;const rt=vr();Ze=new C(ct,Ze,rt)}return Ze}function vr(){let Ze=dr();for(;ke(r.Is);){++j;const ct=ke(r.Not);ct&&++j;let rt=Dn();if(rt instanceof M?rt=new w(rt.value.toString()):rt instanceof F&&(rt=new w("none")),!(rt instanceof w))throw new SyntaxError("Expected identifier for the test");Ze=new $(Ze,ct,rt)}return Ze}function dr(){let Ze=Me();for(;ke(r.Pipe);){++j;let ct=Dn();if(!(ct instanceof w))throw new SyntaxError("Expected identifier for the filter");ke(r.OpenParen)&&(ct=Ie(ct)),Ze=new H(Ze,ct)}return Ze}function Dn(){const Ze=q[j];switch(Ze.type){case r.NumericLiteral:return++j,new E(Number(Ze.value));case r.StringLiteral:return++j,new A(Ze.value);case r.BooleanLiteral:return++j,new M(Ze.value.toLowerCase()==="true");case r.NullLiteral:return++j,new F(null);case r.Identifier:return++j,new w(Ze.value);case r.OpenParen:{++j;const ct=tt();if(q[j].type!==r.CloseParen)throw new SyntaxError(`Expected closing parenthesis, got ${q[j].type} instead`);return++j,ct}case r.OpenSquareBracket:{++j;const ct=[];for(;!ke(r.CloseSquareBracket);)ct.push(ft()),ke(r.Comma)&&++j;return++j,new G(ct)}case r.OpenCurlyBracket:{++j;const ct=new Map;for(;!ke(r.CloseCurlyBracket);){const rt=ft();ee(r.Colon,"Expected colon between key and value in object literal");const Mn=ft();ct.set(rt,Mn),ke(r.Comma)&&++j}return++j,new I(ct)}default:throw new SyntaxError(`Unexpected token: ${Ze.type}`)}}for(;j<q.length;)te.body.push(se());return te}function O(q,te,j=1){te===void 0&&(te=q,q=0);const ee=[];for(let se=q;se<te;se+=j)ee.push(se);return ee}function L(q,te,j,ee=1){const se=Math.sign(ee);se>=0?(te=(te??=0)<0?Math.max(q.length+te,0):Math.min(te,q.length),j=(j??=q.length)<0?Math.max(q.length+j,0):Math.min(j,q.length)):(te=(te??=q.length-1)<0?Math.max(q.length+te,-1):Math.min(te,q.length-1),j=(j??=-1)<-1?Math.max(q.length+j,-1):Math.min(j,q.length-1));const ve=[];for(let ke=te;se*ke<se*j;ke+=ee)ve.push(q[ke]);return ve}function ne(q){return q.replace(/\b\w/g,te=>te.toUpperCase())}var de=class{type="RuntimeValue";value;builtins=new Map;constructor(q=void 0){this.value=q}__bool__(){return new Ee(!!this.value)}},we=class extends de{type="NumericValue"},be=class extends de{type="StringValue";builtins=new Map([["upper",new Se(()=>new be(this.value.toUpperCase()))],["lower",new Se(()=>new be(this.value.toLowerCase()))],["strip",new Se(()=>new be(this.value.trim()))],["title",new Se(()=>new be(ne(this.value)))],["length",new we(this.value.length)],["rstrip",new Se(()=>new be(this.value.trimEnd()))],["lstrip",new Se(()=>new be(this.value.trimStart()))],["split",new Se(q=>{const te=q[0]??new U;if(!(te instanceof be||te instanceof U))throw new Error("sep argument must be a string or null");const j=q[1]??new we(-1);if(!(j instanceof we))throw new Error("maxsplit argument must be a number");let ee=[];if(te instanceof U){const se=this.value.trimStart();for(const{0:ve,index:ke}of se.matchAll(/\S+/g)){if(j.value!==-1&&ee.length>=j.value&&ke!==void 0){ee.push(ve+se.slice(ke+ve.length));break}ee.push(ve)}}else{if(te.value==="")throw new Error("empty separator");ee=this.value.split(te.value),j.value!==-1&&ee.length>j.value&&ee.push(ee.splice(j.value).join(te.value))}return new ce(ee.map(se=>new be(se)))})]])},Ee=class extends de{type="BooleanValue"},Fe=class extends de{type="ObjectValue";__bool__(){return new Ee(this.value.size>0)}builtins=new Map([["get",new Se(([q,te])=>{if(!(q instanceof be))throw new Error(`Object key must be a string: got ${q.type}`);return this.value.get(q.value)??te??new U})],["items",new Se(()=>new ce(Array.from(this.value.entries()).map(([q,te])=>new ce([new be(q),te]))))]])},xe=class extends Fe{type="KeywordArgumentsValue"},ce=class extends de{type="ArrayValue";builtins=new Map([["length",new we(this.value.length)]]);__bool__(){return new Ee(this.value.length>0)}},ue=class extends ce{type="TupleValue"},Se=class extends de{type="FunctionValue"},U=class extends de{type="NullValue"},he=class extends de{type="UndefinedValue"},pe=class{constructor(q){this.parent=q}variables=new Map([["namespace",new Se(q=>{if(q.length===0)return new Fe(new Map);if(q.length!==1||!(q[0]instanceof Fe))throw new Error("`namespace` expects either zero arguments or a single object argument");return q[0]})]]);tests=new Map([["boolean",q=>q.type==="BooleanValue"],["callable",q=>q instanceof Se],["odd",q=>{if(q.type!=="NumericValue")throw new Error(`Cannot apply test "odd" to type: ${q.type}`);return q.value%2!==0}],["even",q=>{if(q.type!=="NumericValue")throw new Error(`Cannot apply test "even" to type: ${q.type}`);return q.value%2===0}],["false",q=>q.type==="BooleanValue"&&!q.value],["true",q=>q.type==="BooleanValue"&&q.value],["none",q=>q.type==="NullValue"],["string",q=>q.type==="StringValue"],["number",q=>q.type==="NumericValue"],["integer",q=>q.type==="NumericValue"&&Number.isInteger(q.value)],["iterable",q=>q.type==="ArrayValue"||q.type==="StringValue"],["mapping",q=>q.type==="ObjectValue"],["lower",q=>{const te=q.value;return q.type==="StringValue"&&te===te.toLowerCase()}],["upper",q=>{const te=q.value;return q.type==="StringValue"&&te===te.toUpperCase()}],["none",q=>q.type==="NullValue"],["defined",q=>q.type!=="UndefinedValue"],["undefined",q=>q.type==="UndefinedValue"],["equalto",(q,te)=>q.value===te.value],["eq",(q,te)=>q.value===te.value]]);set(q,te){return this.declareVariable(q,re(te))}declareVariable(q,te){if(this.variables.has(q))throw new SyntaxError(`Variable already declared: ${q}`);return this.variables.set(q,te),te}setVariable(q,te){return this.variables.set(q,te),te}resolve(q){if(this.variables.has(q))return this;if(this.parent)return this.parent.resolve(q);throw new Error(`Unknown variable: ${q}`)}lookupVariable(q){try{return this.resolve(q).variables.get(q)??new he}catch{return new he}}},ie=class{global;constructor(q){this.global=q??new pe}run(q){return this.evaluate(q,this.global)}evaluateBinaryExpression(q,te){const j=this.evaluate(q.left,te);switch(q.operator.value){case"and":return j.__bool__().value?this.evaluate(q.right,te):j;case"or":return j.__bool__().value?j:this.evaluate(q.right,te)}const ee=this.evaluate(q.right,te);switch(q.operator.value){case"==":return new Ee(j.value==ee.value);case"!=":return new Ee(j.value!=ee.value)}if(j instanceof he||ee instanceof he)throw new Error("Cannot perform operation on undefined values");if(j instanceof U||ee instanceof U)throw new Error("Cannot perform operation on null values");if(j instanceof we&&ee instanceof we)switch(q.operator.value){case"+":return new we(j.value+ee.value);case"-":return new we(j.value-ee.value);case"*":return new we(j.value*ee.value);case"/":return new we(j.value/ee.value);case"%":return new we(j.value%ee.value);case"<":return new Ee(j.value<ee.value);case">":return new Ee(j.value>ee.value);case">=":return new Ee(j.value>=ee.value);case"<=":return new Ee(j.value<=ee.value)}else if(j instanceof ce&&ee instanceof ce)switch(q.operator.value){case"+":return new ce(j.value.concat(ee.value))}else if(ee instanceof ce){const se=ee.value.find(ve=>ve.value===j.value)!==void 0;switch(q.operator.value){case"in":return new Ee(se);case"not in":return new Ee(!se)}}if(j instanceof be||ee instanceof be)switch(q.operator.value){case"+":return new be(j.value.toString()+ee.value.toString())}if(j instanceof be&&ee instanceof be)switch(q.operator.value){case"in":return new Ee(ee.value.includes(j.value));case"not in":return new Ee(!ee.value.includes(j.value))}if(j instanceof be&&ee instanceof Fe)switch(q.operator.value){case"in":return new Ee(ee.value.has(j.value));case"not in":return new Ee(!ee.value.has(j.value))}throw new SyntaxError(`Unknown operator "${q.operator.value}" between ${j.type} and ${ee.type}`)}evaluateArguments(q,te){const j=[],ee=new Map;for(const se of q)if(se.type==="KeywordArgumentExpression"){const ve=se;ee.set(ve.key.value,this.evaluate(ve.value,te))}else{if(ee.size>0)throw new Error("Positional arguments must come before keyword arguments");j.push(this.evaluate(se,te))}return[j,ee]}evaluateFilterExpression(q,te){const j=this.evaluate(q.operand,te);if(q.filter.type==="Identifier"){const ee=q.filter;if(ee.value==="tojson")return new be(ge(j));if(j instanceof ce)switch(ee.value){case"list":return j;case"first":return j.value[0];case"last":return j.value[j.value.length-1];case"length":return new we(j.value.length);case"reverse":return new ce(j.value.reverse());case"sort":return new ce(j.value.sort((se,ve)=>{if(se.type!==ve.type)throw new Error(`Cannot compare different types: ${se.type} and ${ve.type}`);switch(se.type){case"NumericValue":return se.value-ve.value;case"StringValue":return se.value.localeCompare(ve.value);default:throw new Error(`Cannot compare type: ${se.type}`)}}));case"join":return new be(j.value.map(se=>se.value).join(""));default:throw new Error(`Unknown ArrayValue filter: ${ee.value}`)}else if(j instanceof be)switch(ee.value){case"length":return new we(j.value.length);case"upper":return new be(j.value.toUpperCase());case"lower":return new be(j.value.toLowerCase());case"title":return new be(ne(j.value));case"capitalize":return new be(j.value.charAt(0).toUpperCase()+j.value.slice(1));case"trim":return new be(j.value.trim());case"indent":return new be(j.value.split(`
`).map((se,ve)=>ve===0||se.length===0?se:"    "+se).join(`
`));case"join":case"string":return j;default:throw new Error(`Unknown StringValue filter: ${ee.value}`)}else if(j instanceof we)switch(ee.value){case"abs":return new we(Math.abs(j.value));default:throw new Error(`Unknown NumericValue filter: ${ee.value}`)}else if(j instanceof Fe)switch(ee.value){case"items":return new ce(Array.from(j.value.entries()).map(([se,ve])=>new ce([new be(se),ve])));case"length":return new we(j.value.size);default:throw new Error(`Unknown ObjectValue filter: ${ee.value}`)}throw new Error(`Cannot apply filter "${ee.value}" to type: ${j.type}`)}else if(q.filter.type==="CallExpression"){const ee=q.filter;if(ee.callee.type!=="Identifier")throw new Error(`Unknown filter: ${ee.callee.type}`);const se=ee.callee.value;if(se==="tojson"){const[,ve]=this.evaluateArguments(ee.args,te),ke=ve.get("indent")??new U;if(!(ke instanceof we||ke instanceof U))throw new Error("If set, indent must be a number");return new be(ge(j,ke.value))}else if(se==="join"){let ve;if(j instanceof be)ve=Array.from(j.value);else if(j instanceof ce)ve=j.value.map(ze=>ze.value);else throw new Error(`Cannot apply filter "${se}" to type: ${j.type}`);const[ke,Re]=this.evaluateArguments(ee.args,te),Oe=ke.at(0)??Re.get("separator")??new be("");if(!(Oe instanceof be))throw new Error("separator must be a string");return new be(ve.join(Oe.value))}if(j instanceof ce){switch(se){case"selectattr":case"rejectattr":{const ve=se==="selectattr";if(j.value.some(Be=>!(Be instanceof Fe)))throw new Error(`\`${se}\` can only be applied to array of objects`);if(ee.args.some(Be=>Be.type!=="StringLiteral"))throw new Error(`arguments of \`${se}\` must be strings`);const[ke,Re,Oe]=ee.args.map(Be=>this.evaluate(Be,te));let ze;if(Re){const Be=te.tests.get(Re.value);if(!Be)throw new Error(`Unknown test: ${Re.value}`);ze=Be}else ze=(...Be)=>Be[0].__bool__().value;const Te=j.value.filter(Be=>{const qe=Be.value.get(ke.value),tt=qe?ze(qe,Oe):!1;return ve?tt:!tt});return new ce(Te)}case"map":{const[,ve]=this.evaluateArguments(ee.args,te);if(ve.has("attribute")){const ke=ve.get("attribute");if(!(ke instanceof be))throw new Error("attribute must be a string");const Re=ve.get("default"),Oe=j.value.map(ze=>{if(!(ze instanceof Fe))throw new Error("items in map must be an object");return ze.value.get(ke.value)??Re??new he});return new ce(Oe)}else throw new Error("`map` expressions without `attribute` set are not currently supported.")}}throw new Error(`Unknown ArrayValue filter: ${se}`)}else if(j instanceof be){switch(se){case"indent":{const[ve,ke]=this.evaluateArguments(ee.args,te),Re=ve.at(0)??ke.get("width")??new we(4);if(!(Re instanceof we))throw new Error("width must be a number");const Oe=ve.at(1)??ke.get("first")??new Ee(!1),ze=ve.at(2)??ke.get("blank")??new Ee(!1),Te=j.value.split(`
`),Be=" ".repeat(Re.value),qe=Te.map((tt,xt)=>!Oe.value&&xt===0||!ze.value&&tt.length===0?tt:Be+tt);return new be(qe.join(`
`))}}throw new Error(`Unknown StringValue filter: ${se}`)}else throw new Error(`Cannot apply filter "${se}" to type: ${j.type}`)}throw new Error(`Unknown filter: ${q.filter.type}`)}evaluateTestExpression(q,te){const j=this.evaluate(q.operand,te),ee=te.tests.get(q.test.value);if(!ee)throw new Error(`Unknown test: ${q.test.value}`);const se=ee(j);return new Ee(q.negate?!se:se)}evaluateUnaryExpression(q,te){const j=this.evaluate(q.argument,te);switch(q.operator.value){case"not":return new Ee(!j.value);default:throw new SyntaxError(`Unknown operator: ${q.operator.value}`)}}evalProgram(q,te){return this.evaluateBlock(q.body,te)}evaluateBlock(q,te){let j="";for(const ee of q){const se=this.evaluate(ee,te);se.type!=="NullValue"&&se.type!=="UndefinedValue"&&(j+=se.value)}return new be(j)}evaluateIdentifier(q,te){return te.lookupVariable(q.value)}evaluateCallExpression(q,te){const[j,ee]=this.evaluateArguments(q.args,te);ee.size>0&&j.push(new xe(ee));const se=this.evaluate(q.callee,te);if(se.type!=="FunctionValue")throw new Error(`Cannot call something that is not a function: got ${se.type}`);return se.value(j,te)}evaluateSliceExpression(q,te,j){if(!(q instanceof ce||q instanceof be))throw new Error("Slice object must be an array or string");const ee=this.evaluate(te.start,j),se=this.evaluate(te.stop,j),ve=this.evaluate(te.step,j);if(!(ee instanceof we||ee instanceof he))throw new Error("Slice start must be numeric or undefined");if(!(se instanceof we||se instanceof he))throw new Error("Slice stop must be numeric or undefined");if(!(ve instanceof we||ve instanceof he))throw new Error("Slice step must be numeric or undefined");return q instanceof ce?new ce(L(q.value,ee.value,se.value,ve.value)):new be(L(Array.from(q.value),ee.value,se.value,ve.value).join(""))}evaluateMemberExpression(q,te){const j=this.evaluate(q.object,te);let ee;if(q.computed){if(q.property.type==="SliceExpression")return this.evaluateSliceExpression(j,q.property,te);ee=this.evaluate(q.property,te)}else ee=new be(q.property.value);let se;if(j instanceof Fe){if(!(ee instanceof be))throw new Error(`Cannot access property with non-string: got ${ee.type}`);se=j.value.get(ee.value)??j.builtins.get(ee.value)}else if(j instanceof ce||j instanceof be)if(ee instanceof we)se=j.value.at(ee.value),j instanceof be&&(se=new be(j.value.at(ee.value)));else if(ee instanceof be)se=j.builtins.get(ee.value);else throw new Error(`Cannot access property with non-string/non-number: got ${ee.type}`);else{if(!(ee instanceof be))throw new Error(`Cannot access property with non-string: got ${ee.type}`);se=j.builtins.get(ee.value)}return se instanceof de?se:new he}evaluateSet(q,te){const j=this.evaluate(q.value,te);if(q.assignee.type==="Identifier"){const ee=q.assignee.value;te.setVariable(ee,j)}else if(q.assignee.type==="MemberExpression"){const ee=q.assignee,se=this.evaluate(ee.object,te);if(!(se instanceof Fe))throw new Error("Cannot assign to member of non-object");if(ee.property.type!=="Identifier")throw new Error("Cannot assign to member with non-identifier property");se.value.set(ee.property.value,j)}else throw new Error(`Invalid LHS inside assignment expression: ${JSON.stringify(q.assignee)}`);return new U}evaluateIf(q,te){const j=this.evaluate(q.test,te);return this.evaluateBlock(j.__bool__().value?q.body:q.alternate,te)}evaluateFor(q,te){const j=new pe(te);let ee,se;if(q.iterable.type==="SelectExpression"){const ze=q.iterable;se=this.evaluate(ze.iterable,j),ee=ze.test}else se=this.evaluate(q.iterable,j);if(!(se instanceof ce))throw new Error(`Expected iterable type in for loop: got ${se.type}`);const ve=[],ke=[];for(let ze=0;ze<se.value.length;++ze){const Te=new pe(j),Be=se.value[ze];let qe;if(q.loopvar.type==="Identifier")qe=tt=>tt.setVariable(q.loopvar.value,Be);else if(q.loopvar.type==="TupleLiteral"){const tt=q.loopvar;if(Be.type!=="ArrayValue")throw new Error(`Cannot unpack non-iterable type: ${Be.type}`);const xt=Be;if(tt.value.length!==xt.value.length)throw new Error(`Too ${tt.value.length>xt.value.length?"few":"many"} items to unpack`);qe=ft=>{for(let Wt=0;Wt<tt.value.length;++Wt){if(tt.value[Wt].type!=="Identifier")throw new Error(`Cannot unpack non-identifier type: ${tt.value[Wt].type}`);ft.setVariable(tt.value[Wt].value,xt.value[Wt])}}}else throw new Error(`Invalid loop variable(s): ${q.loopvar.type}`);ee&&(qe(Te),!this.evaluate(ee,Te).__bool__().value)||(ve.push(Be),ke.push(qe))}let Re="",Oe=!0;for(let ze=0;ze<ve.length;++ze){const Te=new Map([["index",new we(ze+1)],["index0",new we(ze)],["revindex",new we(ve.length-ze)],["revindex0",new we(ve.length-ze-1)],["first",new Ee(ze===0)],["last",new Ee(ze===ve.length-1)],["length",new we(ve.length)],["previtem",ze>0?ve[ze-1]:new he],["nextitem",ze<ve.length-1?ve[ze+1]:new he]]);j.setVariable("loop",new Fe(Te)),ke[ze](j);const Be=this.evaluateBlock(q.body,j);Re+=Be.value,Oe=!1}if(Oe){const ze=this.evaluateBlock(q.defaultBlock,j);Re+=ze.value}return new be(Re)}evaluateMacro(q,te){return te.setVariable(q.name.value,new Se((j,ee)=>{const se=new pe(ee);j=j.slice();let ve;j.at(-1)?.type==="KeywordArgumentsValue"&&(ve=j.pop());for(let ke=0;ke<q.args.length;++ke){const Re=q.args[ke],Oe=j[ke];if(Re.type==="Identifier"){const ze=Re;if(!Oe)throw new Error(`Missing positional argument: ${ze.value}`);se.setVariable(ze.value,Oe)}else if(Re.type==="KeywordArgumentExpression"){const ze=Re,Te=Oe??ve?.value.get(ze.key.value)??this.evaluate(ze.value,se);se.setVariable(ze.key.value,Te)}else throw new Error(`Unknown argument type: ${Re.type}`)}return this.evaluateBlock(q.body,se)})),new U}evaluate(q,te){if(q===void 0)return new he;switch(q.type){case"Program":return this.evalProgram(q,te);case"Set":return this.evaluateSet(q,te);case"If":return this.evaluateIf(q,te);case"For":return this.evaluateFor(q,te);case"Macro":return this.evaluateMacro(q,te);case"NumericLiteral":return new we(Number(q.value));case"StringLiteral":return new be(q.value);case"BooleanLiteral":return new Ee(q.value);case"NullLiteral":return new U(q.value);case"ArrayLiteral":return new ce(q.value.map(j=>this.evaluate(j,te)));case"TupleLiteral":return new ue(q.value.map(j=>this.evaluate(j,te)));case"ObjectLiteral":{const j=new Map;for(const[ee,se]of q.value){const ve=this.evaluate(ee,te);if(!(ve instanceof be))throw new Error(`Object keys must be strings: got ${ve.type}`);j.set(ve.value,this.evaluate(se,te))}return new Fe(j)}case"Identifier":return this.evaluateIdentifier(q,te);case"CallExpression":return this.evaluateCallExpression(q,te);case"MemberExpression":return this.evaluateMemberExpression(q,te);case"UnaryExpression":return this.evaluateUnaryExpression(q,te);case"BinaryExpression":return this.evaluateBinaryExpression(q,te);case"FilterExpression":return this.evaluateFilterExpression(q,te);case"TestExpression":return this.evaluateTestExpression(q,te);default:throw new SyntaxError(`Unknown node type: ${q.type}`)}}};function re(q){switch(typeof q){case"number":return new we(q);case"string":return new be(q);case"boolean":return new Ee(q);case"undefined":return new he;case"object":return q===null?new U:Array.isArray(q)?new ce(q.map(re)):new Fe(new Map(Object.entries(q).map(([te,j])=>[te,re(j)])));case"function":return new Se((te,j)=>{const ee=q(...te.map(se=>se.value))??null;return re(ee)});default:throw new Error(`Cannot convert to runtime value: ${q}`)}}function ge(q,te,j){const ee=j??0;switch(q.type){case"NullValue":case"UndefinedValue":return"null";case"NumericValue":case"StringValue":case"BooleanValue":return JSON.stringify(q.value);case"ArrayValue":case"ObjectValue":{const se=te?" ".repeat(te):"",ve=`
`+se.repeat(ee),ke=ve+se;if(q.type==="ArrayValue"){const Re=q.value.map(Oe=>ge(Oe,te,ee+1));return te?`[${ke}${Re.join(`,${ke}`)}${ve}]`:`[${Re.join(", ")}]`}else{const Re=Array.from(q.value.entries()).map(([Oe,ze])=>{const Te=`"${Oe}": ${ge(ze,te,ee+1)}`;return te?`${ke}${Te}`:Te});return te?`{${Re.join(",")}${ve}}`:`{${Re.join(", ")}}`}}default:throw new Error(`Cannot convert to JSON: ${q.type}`)}}var Ce=class{parsed;constructor(q){const te=d(q,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=R(te)}render(q){const te=new pe;if(te.set("false",!1),te.set("true",!0),te.set("raise_exception",se=>{throw new Error(se)}),te.set("range",O),q)for(const[se,ve]of Object.entries(q))te.set(se,ve);return new ie(te).run(this.parsed).value}}},"./src/backends/onnx.js":(n,e,t)=>{var r;t.r(e),t.d(e,{Tensor:()=>o.Tensor,createInferenceSession:()=>b,deviceToExecutionProviders:()=>p,isONNXProxy:()=>v,isONNXTensor:()=>_});var i=t("./src/env.js"),s=t("?2ce3"),a=t("onnxruntime-web"),o=t("onnxruntime-common");const l=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),c=[];let u,d;const h=Symbol.for("onnxruntime");if(h in globalThis)d=globalThis[h];else if(i.apis.IS_NODE_ENV){switch(d=s??(r||(r=t.t(s,2))),process.platform){case"win32":c.push("dml");break;case"linux":process.arch==="x64"&&c.push("cuda");break}c.push("cpu"),u=["cpu"]}else d=a,i.apis.IS_WEBNN_AVAILABLE&&c.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),i.apis.IS_WEBGPU_AVAILABLE&&c.push("webgpu"),c.push("wasm"),u=["wasm"];const f=d.InferenceSession;function p(x=null){if(!x)return u;switch(x){case"auto":return c;case"gpu":return c.filter(w=>["webgpu","cuda","dml","webnn-gpu"].includes(w))}if(c.includes(x))return[l[x]??x];throw new Error(`Unsupported device: "${x}". Should be one of: ${c.join(", ")}.`)}let g=null;async function b(x,w,T){g&&await g;const E=f.create(x,w);g??=E;const A=await E;return A.config=T,A}function _(x){return x instanceof d.Tensor}const m=d?.env;m?.wasm&&(!(typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)&&!m.wasm.wasmPaths&&(m.wasm.wasmPaths=`https://cdn.jsdelivr.net/npm/@huggingface/transformers@${i.env.version}/dist/`),m.wasm.proxy=!1),m?.webgpu&&(m.webgpu.powerPreference="high-performance");function v(){return m?.wasm?.proxy}i.env.backends.onnx=m},"./src/base/feature_extraction_utils.js":(n,e,t)=>{t.r(e),t.d(e,{FeatureExtractor:()=>a,validate_audio_inputs:()=>o});var r=t("./src/utils/constants.js"),i=t("./src/utils/generic.js"),s=t("./src/utils/hub.js");class a extends i.Callable{constructor(c){super(),this.config=c}static async from_pretrained(c,u){const d=await(0,s.getModelJSON)(c,r.FEATURE_EXTRACTOR_NAME,!0,u);return new this(d)}}function o(l,c){if(!(l instanceof Float32Array||l instanceof Float64Array))throw new Error(`${c} expects input to be a Float32Array or a Float64Array, but got ${l?.constructor?.name??typeof l} instead. If using the feature extractor directly, remember to use \`read_audio(url, sampling_rate)\` to obtain the raw audio data of the file/url.`)}},"./src/base/image_processors_utils.js":(n,e,t)=>{t.r(e),t.d(e,{ImageProcessor:()=>x,center_to_corners_format:()=>d,post_process_instance_segmentation:()=>v,post_process_object_detection:()=>h,post_process_panoptic_segmentation:()=>m,post_process_semantic_segmentation:()=>f});var r=t("./src/utils/generic.js"),i=t("./src/utils/tensor.js"),s=t("./src/utils/maths.js");t("./src/utils/image.js");var a=t("./src/utils/core.js"),o=t("./src/utils/hub.js"),l=t("./src/utils/constants.js");function c(w,T,E=0,A=null){const M=w/T;let F=(0,s.bankers_round)(M)*T;return A!==null&&F>A&&(F=Math.floor(M)*T),F<E&&(F=Math.ceil(M)*T),F}function u([w,T],E){return[Math.max(Math.floor(w/E),1)*E,Math.max(Math.floor(T/E),1)*E]}function d([w,T,E,A]){return[w-E/2,T-A/2,w+E/2,T+A/2]}function h(w,T=.5,E=null,A=!1){const M=w.logits,F=w.pred_boxes,[G,S,I]=M.dims;if(E!==null&&E.length!==G)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let C=[];for(let H=0;H<G;++H){let B=E!==null?E[H]:null,$={boxes:[],classes:[],scores:[]},X=M[H],V=F[H];for(let Q=0;Q<S;++Q){let R=X[Q],O=[],L;if(A){L=R.sigmoid().data;for(let ne=0;ne<L.length;++ne)L[ne]>T&&O.push(ne)}else{let ne=(0,s.max)(R.data)[1];if(ne===I-1||(L=(0,s.softmax)(R.data),L[ne]<T))continue;O.push(ne)}for(const ne of O){let de=V[Q].data;de=d(de),B!==null&&(de=de.map((we,be)=>we*B[(be+1)%2])),$.boxes.push(de),$.classes.push(ne),$.scores.push(L[ne])}}C.push($)}return C}function f(w,T=null){const E=w.logits,A=E.dims[0];if(T!==null&&T.length!==A)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const M=[];for(let F=0;F<A;++F){const G=T!==null?T[F]:null;let S=E[F];G!==null&&(S=(0,i.interpolate)(S,G,"bilinear",!1));const[I,C]=G??S.dims.slice(-2),H=new i.Tensor("int32",new Int32Array(I*C),[I,C]),B=S[0].data,$=H.data;for(let Q=1;Q<S.dims[0];++Q){const R=S[Q].data;for(let O=0;O<R.length;++O)R[O]>B[O]&&(B[O]=R[O],$[O]=Q)}const X=new Array(S.dims[0]);for(let Q=0;Q<$.length;++Q){const R=$[Q];X[R]=R}const V=X.filter(Q=>Q!==void 0);M.push({segmentation:H,labels:V})}return M}function p(w,T,E,A){const M=[],F=[],G=[];for(let S=0;S<w.dims[0];++S){const I=w[S],C=T[S],H=(0,s.max)(I.data)[1];if(H===A)continue;const $=(0,s.softmax)(I.data)[H];$>E&&(M.push(C),F.push($),G.push(H))}return[M,F,G]}function g(w,T,E,A=.5,M=.8){const F=[];let G=0,S=0;const I=T[E].data;for(let H=0;H<w.length;++H)w[H]===E&&(F.push(H),++G),I[H]>=A&&++S;let C=G>0&&S>0;return C&&(C=G/S>M),[C,F]}function b(w,T,E,A,M,F=null,G=null){const[S,I]=G??w[0].dims,C=new i.Tensor("int32",new Int32Array(S*I),[S,I]),H=[];if(G!==null)for(let Q=0;Q<w.length;++Q)w[Q]=(0,i.interpolate)(w[Q],G,"bilinear",!1);const B=new Int32Array(w[0].data.length),$=new Float32Array(w[0].data.length);for(let Q=0;Q<w.length;++Q){let R=T[Q];const O=w[Q].data;for(let L=0;L<O.length;++L)O[L]*=R,O[L]>$[L]&&(B[L]=Q,$[L]=O[L])}let X=0;const V=C.data;for(let Q=0;Q<E.length;++Q){const R=E[Q],[O,L]=g(B,w,Q,A,M);if(O){++X;for(const ne of L)V[ne]=X;H.push({id:X,label_id:R,score:T[Q]})}}return[C,H]}function _(w,T,E=28,A=56*56,M=14*14*4*1280){if(w<E||T<E)throw new Error(`height:${w} or width:${T} must be larger than factor:${E}`);if(Math.max(w,T)/Math.min(w,T)>200)throw new Error(`absolute aspect ratio must be smaller than 200, got ${Math.max(w,T)/Math.min(w,T)}`);let F=Math.round(w/E)*E,G=Math.round(T/E)*E;if(F*G>M){const S=Math.sqrt(w*T/M);F=Math.floor(w/S/E)*E,G=Math.floor(T/S/E)*E}else if(F*G<A){const S=Math.sqrt(A/(w*T));F=Math.ceil(w*S/E)*E,G=Math.ceil(T*S/E)*E}return[F,G]}function m(w,T=.5,E=.5,A=.8,M=null,F=null){M===null&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),M=new Set);const G=w.class_queries_logits??w.logits,I=(w.masks_queries_logits??w.pred_masks).sigmoid();let[C,H,B]=G.dims;if(B-=1,F!==null&&F.length!==C)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let $=[];for(let X=0;X<C;++X){let V=F!==null?F[X]:null,Q=G[X],R=I[X],[O,L,ne]=p(Q,R,T,B);if(ne.length===0){let[be,Ee]=V??R.dims.slice(-2),Fe=new i.Tensor("int32",new Int32Array(be*Ee).fill(-1),[be,Ee]);$.push({segmentation:Fe,segments_info:[]});continue}let[de,we]=b(O,L,ne,E,A,M,V);$.push({segmentation:de,segments_info:we})}return $}function v(w,T=.5,E=null){throw new Error("`post_process_instance_segmentation` is not yet implemented.")}class x extends r.Callable{constructor(T){super(),this.image_mean=T.image_mean??T.mean,this.image_std=T.image_std??T.std,this.resample=T.resample??2,this.do_rescale=T.do_rescale??!0,this.rescale_factor=T.rescale_factor??1/255,this.do_normalize=T.do_normalize,this.do_thumbnail=T.do_thumbnail,this.size=T.size??T.image_size,this.do_resize=T.do_resize??this.size!==void 0,this.size_divisibility=T.size_divisibility??T.size_divisor,this.do_center_crop=T.do_center_crop,this.crop_size=T.crop_size,this.do_convert_rgb=T.do_convert_rgb??!0,this.do_crop_margin=T.do_crop_margin,this.pad_size=T.pad_size,this.do_pad=T.do_pad,this.do_pad&&!this.pad_size&&this.size&&this.size.width!==void 0&&this.size.height!==void 0&&(this.pad_size=this.size),this.do_flip_channel_order=T.do_flip_channel_order??!1,this.config=T}async thumbnail(T,E,A=2){const M=T.height,F=T.width,G=E.height,S=E.width;let I=Math.min(M,G),C=Math.min(F,S);return I===M&&C===F?T:(M>F?C=Math.floor(F*I/M):F>M&&(I=Math.floor(M*C/F)),await T.resize(C,I,{resample:A}))}async crop_margin(T,E=200){const A=T.clone().grayscale(),M=(0,s.min)(A.data)[0],G=(0,s.max)(A.data)[0]-M;if(G===0)return T;const S=E/255;let I=A.width,C=A.height,H=0,B=0;const $=A.data;for(let X=0;X<A.height;++X){const V=X*A.width;for(let Q=0;Q<A.width;++Q)($[V+Q]-M)/G<S&&(I=Math.min(I,Q),C=Math.min(C,X),H=Math.max(H,Q),B=Math.max(B,X))}return T=await T.crop([I,C,H,B]),T}pad_image(T,E,A,{mode:M="constant",center:F=!1,constant_values:G=0}={}){const[S,I,C]=E;let H,B;if(typeof A=="number"?(H=A,B=A):A==="square"?H=B=Math.max(S,I):(H=A.width,B=A.height),H!==I||B!==S){const $=new Float32Array(H*B*C);if(Array.isArray(G))for(let Q=0;Q<$.length;++Q)$[Q]=G[Q%C];else G!==0&&$.fill(G);const[X,V]=F?[Math.floor((H-I)/2),Math.floor((B-S)/2)]:[0,0];for(let Q=0;Q<S;++Q){const R=(Q+V)*H,O=Q*I;for(let L=0;L<I;++L){const ne=(R+L+X)*C,de=(O+L)*C;for(let we=0;we<C;++we)$[ne+we]=T[de+we]}}if(M==="symmetric"){if(F)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const Q=S-1,R=I-1;for(let O=0;O<B;++O){const L=O*H,ne=(0,a.calculateReflectOffset)(O,Q)*I;for(let de=0;de<H;++de){if(O<S&&de<I)continue;const we=(L+de)*C,be=(ne+(0,a.calculateReflectOffset)(de,R))*C;for(let Ee=0;Ee<C;++Ee)$[we+Ee]=T[be+Ee]}}}T=$,E=[B,H,C]}return[T,E]}rescale(T){for(let E=0;E<T.length;++E)T[E]=this.rescale_factor*T[E]}get_resize_output_image_size(T,E){const[A,M]=T.size;let F,G;if(this.do_thumbnail){const{height:S,width:I}=E;F=Math.min(S,I)}else Number.isInteger(E)?(F=E,G=this.config.max_size??F):E!==void 0&&(F=E.shortest_edge,G=E.longest_edge);if(F!==void 0||G!==void 0){const S=F===void 0?1:Math.max(F/A,F/M),I=A*S,C=M*S,H=G===void 0?1:Math.min(G/I,G/C);let B=Math.floor(Number((I*H).toFixed(2))),$=Math.floor(Number((C*H).toFixed(2)));return this.size_divisibility!==void 0&&([B,$]=u([B,$],this.size_divisibility)),[B,$]}else if(E!==void 0&&E.width!==void 0&&E.height!==void 0){let S=E.width,I=E.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let C=I/M,H=S/A;Math.abs(1-H)<Math.abs(1-C)?C=H:H=C,I=c(C*M,this.config.ensure_multiple_of),S=c(H*A,this.config.ensure_multiple_of)}return[S,I]}else{if(this.size_divisibility!==void 0)return u([A,M],this.size_divisibility);if(E.min_pixels!==void 0&&E.max_pixels!==void 0){const{min_pixels:S,max_pixels:I}=E,C=this.config.patch_size*this.config.merge_size;return _(M,A,C,S,I)}else throw new Error(`Could not resize image due to unsupported \`this.size\` option in config: ${JSON.stringify(E)}`)}}async resize(T){const[E,A]=this.get_resize_output_image_size(T,this.size);return await T.resize(E,A,{resample:this.resample})}async preprocess(T,{do_normalize:E=null,do_pad:A=null,do_convert_rgb:M=null,do_convert_grayscale:F=null,do_flip_channel_order:G=null}={}){this.do_crop_margin&&(T=await this.crop_margin(T));const[S,I]=T.size;if(M??this.do_convert_rgb?T=T.rgb():F&&(T=T.grayscale()),this.do_resize&&(T=await this.resize(T)),this.do_thumbnail&&(T=await this.thumbnail(T,this.size,this.resample)),this.do_center_crop){let X,V;Number.isInteger(this.crop_size)?(X=this.crop_size,V=this.crop_size):(X=this.crop_size.width,V=this.crop_size.height),T=await T.center_crop(X,V)}const C=[T.height,T.width];let H=Float32Array.from(T.data),B=[T.height,T.width,T.channels];if(this.do_rescale&&this.rescale(H),E??this.do_normalize){let X=this.image_mean;Array.isArray(this.image_mean)||(X=new Array(T.channels).fill(X));let V=this.image_std;if(Array.isArray(this.image_std)||(V=new Array(T.channels).fill(X)),X.length!==T.channels||V.length!==T.channels)throw new Error(`When set to arrays, the length of \`image_mean\` (${X.length}) and \`image_std\` (${V.length}) must match the number of channels in the image (${T.channels}).`);for(let Q=0;Q<H.length;Q+=T.channels)for(let R=0;R<T.channels;++R)H[Q+R]=(H[Q+R]-X[R])/V[R]}if(A??this.do_pad){if(this.pad_size)[H,B]=this.pad_image(H,[T.height,T.width,T.channels],this.pad_size);else if(this.size_divisibility){const[X,V]=u([B[1],B[0]],this.size_divisibility);[H,B]=this.pad_image(H,B,{width:X,height:V})}}if(G??this.do_flip_channel_order){if(B[2]!==3)throw new Error("Flipping channel order is only supported for RGB images.");for(let X=0;X<H.length;X+=3){const V=H[X];H[X]=H[X+2],H[X+2]=V}}const $=new i.Tensor("float32",H,B).permute(2,0,1);return{original_size:[I,S],reshaped_input_size:C,pixel_values:$}}async _call(T,...E){Array.isArray(T)||(T=[T]);const A=await Promise.all(T.map(F=>this.preprocess(F)));return{pixel_values:(0,i.stack)(A.map(F=>F.pixel_values),0),original_sizes:A.map(F=>F.original_size),reshaped_input_sizes:A.map(F=>F.reshaped_input_size)}}static async from_pretrained(T,E){const A=await(0,o.getModelJSON)(T,l.IMAGE_PROCESSOR_NAME,!0,E);return new this(A)}}},"./src/base/processing_utils.js":(n,e,t)=>{t.r(e),t.d(e,{Processor:()=>a});var r=t("./src/utils/constants.js"),i=t("./src/utils/generic.js"),s=t("./src/utils/hub.js");class a extends i.Callable{constructor(l,c){super(),this.config=l,this.components=c}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template(l,c={}){if(!this.tokenizer)throw new Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template(l,{tokenize:!1,...c})}batch_decode(...l){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...l)}decode(...l){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...l)}async _call(l,...c){for(const u of[this.image_processor,this.feature_extractor,this.tokenizer])if(u)return u(l,...c);throw new Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained(l,c){const[u,d]=await Promise.all([this.uses_processor_config?(0,s.getModelJSON)(l,r.PROCESSOR_NAME,!0,c):{},Promise.all(this.classes.filter(h=>h in this).map(async h=>{const f=await this[h].from_pretrained(l,c);return[h.replace(/_class$/,""),f]})).then(Object.fromEntries)]);return new this(u,d)}}Xe(a,"classes",["image_processor_class","tokenizer_class","feature_extractor_class"]),Xe(a,"uses_processor_config",!1)},"./src/configs.js":(n,e,t)=>{t.r(e),t.d(e,{AutoConfig:()=>c,PretrainedConfig:()=>l,getKeyValueShapes:()=>o});var r=t("./src/utils/core.js"),i=t("./src/utils/hub.js");async function s(u,d){return await(0,i.getModelJSON)(u,"config.json",!0,d)}function a(u){const d={};let h={};switch(u.model_type){case"llava":case"paligemma":case"florence2":case"llava_onevision":case"idefics3":case"ultravox":case"smolvlm":h=a(u.text_config);break;case"moondream1":h=a(u.phi_config);break;case"musicgen":h=a(u.decoder);break;case"multi_modality":h=a(u.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":d.num_heads="n_head",d.num_layers="n_layer",d.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":d.num_heads="num_attention_heads",d.num_layers="num_hidden_layers",d.hidden_size="hidden_size";break;case"llama":case"olmo":case"olmo2":case"mobilellm":case"granite":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":d.num_heads="num_key_value_heads",d.num_layers="num_hidden_layers",d.hidden_size="hidden_size",d.num_attention_heads="num_attention_heads";break;case"gemma":case"gemma2":case"glm":case"helium":d.num_heads="num_key_value_heads",d.num_layers="num_hidden_layers",d.dim_kv="head_dim";break;case"openelm":d.num_heads="num_kv_heads",d.num_layers="num_transformer_layers",d.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":d.num_heads="num_heads",d.num_layers="num_layers",d.hidden_size="hidden_size";break;case"bloom":d.num_heads="n_head",d.num_layers="n_layer",d.hidden_size="hidden_size";break;case"mpt":d.num_heads="n_heads",d.num_layers="n_layers",d.hidden_size="d_model";break;case"exaone":d.num_heads="num_key_value_heads",d.num_layers="num_layers",d.dim_kv="head_dim",d.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":d.num_decoder_layers="num_decoder_layers",d.num_decoder_heads="num_heads",d.decoder_dim_kv="d_kv",d.num_encoder_layers="num_layers",d.num_encoder_heads="num_heads",d.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"lite-whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":d.num_decoder_layers="decoder_layers",d.num_decoder_heads="decoder_attention_heads",d.decoder_hidden_size="d_model",d.num_encoder_layers="encoder_layers",d.num_encoder_heads="encoder_attention_heads",d.encoder_hidden_size="d_model";break;case"speecht5":d.num_decoder_layers="decoder_layers",d.num_decoder_heads="decoder_attention_heads",d.decoder_hidden_size="hidden_size",d.num_encoder_layers="encoder_layers",d.num_encoder_heads="encoder_attention_heads",d.encoder_hidden_size="hidden_size";break;case"trocr":d.num_encoder_layers=d.num_decoder_layers="decoder_layers",d.num_encoder_heads=d.num_decoder_heads="decoder_attention_heads",d.encoder_hidden_size=d.decoder_hidden_size="d_model";break;case"musicgen_decoder":d.num_encoder_layers=d.num_decoder_layers="num_hidden_layers",d.num_encoder_heads=d.num_decoder_heads="num_attention_heads",d.encoder_hidden_size=d.decoder_hidden_size="hidden_size";break;case"moonshine":d.num_decoder_layers="decoder_num_hidden_layers",d.num_decoder_heads="decoder_num_key_value_heads",d.num_encoder_layers="encoder_num_hidden_layers",d.num_encoder_heads="encoder_num_key_value_heads",d.encoder_hidden_size=d.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":const p=a(u.decoder),g="num_decoder_layers"in p,b=(0,r.pick)(u,["model_type","is_encoder_decoder"]);return g?(b.num_decoder_layers=p.num_decoder_layers,b.num_decoder_heads=p.num_decoder_heads,b.decoder_hidden_size=p.decoder_hidden_size,b.num_encoder_layers=p.num_encoder_layers,b.num_encoder_heads=p.num_encoder_heads,b.encoder_hidden_size=p.encoder_hidden_size):(b.num_layers=p.num_layers,b.num_heads=p.num_heads,b.hidden_size=p.hidden_size),b}const f={...h,...(0,r.pick)(u,["model_type","multi_query","is_encoder_decoder"])};for(const p in d)f[p]=u[d[p]];return f}function o(u,{prefix:d="past_key_values",batch_size:h=1}={}){const f={},p=u.normalized_config;if(p.is_encoder_decoder&&"num_encoder_heads"in p&&"num_decoder_heads"in p){const g=p.encoder_dim_kv??p.encoder_hidden_size/p.num_encoder_heads,b=p.decoder_dim_kv??p.decoder_hidden_size/p.num_decoder_heads,_=[h,p.num_encoder_heads,0,g],m=[h,p.num_decoder_heads,0,b];for(let v=0;v<p.num_decoder_layers;++v)f[`${d}.${v}.encoder.key`]=_,f[`${d}.${v}.encoder.value`]=_,f[`${d}.${v}.decoder.key`]=m,f[`${d}.${v}.decoder.value`]=m}else{const g=p.num_heads,b=p.num_layers,_=p.dim_kv??p.hidden_size/(p.num_attention_heads??g);if(p.model_type==="falcon"){const m=[h*g,0,_];for(let v=0;v<b;++v)f[`${d}.${v}.key`]=m,f[`${d}.${v}.value`]=m}else if(p.multi_query){const m=[h*g,0,2*_];for(let v=0;v<b;++v)f[`${d}.${v}.key_value`]=m}else if(p.model_type==="bloom"){const m=[h*g,_,0],v=[h*g,0,_];for(let x=0;x<b;++x)f[`${d}.${x}.key`]=m,f[`${d}.${x}.value`]=v}else if(p.model_type==="openelm")for(let m=0;m<b;++m){const v=[h,g[m],0,_];f[`${d}.${m}.key`]=v,f[`${d}.${m}.value`]=v}else{const m=[h,g,0,_];for(let v=0;v<b;++v)f[`${d}.${v}.key`]=m,f[`${d}.${v}.value`]=m}}return f}class l{model_type=null;is_encoder_decoder=!1;max_position_embeddings;"transformers.js_config";constructor(d){Object.assign(this,d),this.normalized_config=a(this)}static async from_pretrained(d,{progress_callback:h=null,config:f=null,cache_dir:p=null,local_files_only:g=!1,revision:b="main"}={}){f&&!(f instanceof l)&&(f=new l(f));const _=f??await s(d,{progress_callback:h,config:f,cache_dir:p,local_files_only:g,revision:b});return new this(_)}}class c{static async from_pretrained(...d){return l.from_pretrained(...d)}}},"./src/env.js":(n,e,t)=>{t.r(e),t.d(e,{apis:()=>b,env:()=>T});var r=t("?569f"),i=t("?3f59"),s=t("?154a");const a="3.4.0",o=typeof window<"u"&&typeof window.document<"u",l=typeof self<"u"&&self.constructor?.name==="DedicatedWorkerGlobalScope",c=typeof self<"u"&&"caches"in self,u=typeof navigator<"u"&&"gpu"in navigator,d=typeof navigator<"u"&&"ml"in navigator,h=typeof process<"u",f=h&&process?.release?.name==="node",p=!E(r),g=!E(i),b=Object.freeze({IS_BROWSER_ENV:o,IS_WEBWORKER_ENV:l,IS_WEB_CACHE_AVAILABLE:c,IS_WEBGPU_AVAILABLE:u,IS_WEBNN_AVAILABLE:d,IS_PROCESS_AVAILABLE:h,IS_NODE_ENV:f,IS_FS_AVAILABLE:p,IS_PATH_AVAILABLE:g}),_=p&&g;let m="./";if(_){const A=Object(import.meta).url;A?m=i.dirname(i.dirname(s.fileURLToPath(A))):typeof __dirname<"u"&&(m=i.dirname(__dirname))}const v=_?i.join(m,"/.cache/"):null,x="/models/",w=_?i.join(m,x):x,T={version:a,backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(o||l),localModelPath:w,useFS:p,useBrowserCache:c,useFSCache:p,cacheDir:v,useCustomCache:!1,customCache:null};function E(A){return Object.keys(A).length===0}},"./src/generation/configuration_utils.js":(n,e,t)=>{t.r(e),t.d(e,{GenerationConfig:()=>i});var r=t("./src/utils/core.js");class i{max_length=20;max_new_tokens=null;min_length=0;min_new_tokens=null;early_stopping=!1;max_time=null;do_sample=!1;num_beams=1;num_beam_groups=1;penalty_alpha=null;use_cache=!0;temperature=1;top_k=50;top_p=1;typical_p=1;epsilon_cutoff=0;eta_cutoff=0;diversity_penalty=0;repetition_penalty=1;encoder_repetition_penalty=1;length_penalty=1;no_repeat_ngram_size=0;bad_words_ids=null;force_words_ids=null;renormalize_logits=!1;constraints=null;forced_bos_token_id=null;forced_eos_token_id=null;remove_invalid_values=!1;exponential_decay_length_penalty=null;suppress_tokens=null;streamer=null;begin_suppress_tokens=null;forced_decoder_ids=null;guidance_scale=null;num_return_sequences=1;output_attentions=!1;output_hidden_states=!1;output_scores=!1;return_dict_in_generate=!1;pad_token_id=null;bos_token_id=null;eos_token_id=null;encoder_no_repeat_ngram_size=0;decoder_start_token_id=null;generation_kwargs={};constructor(a){Object.assign(this,(0,r.pick)(a,Object.getOwnPropertyNames(this)))}}},"./src/generation/logits_process.js":(n,e,t)=>{t.r(e),t.d(e,{ClassifierFreeGuidanceLogitsProcessor:()=>_,ForcedBOSTokenLogitsProcessor:()=>l,ForcedEOSTokenLogitsProcessor:()=>c,LogitsProcessor:()=>s,LogitsProcessorList:()=>o,LogitsWarper:()=>a,MinLengthLogitsProcessor:()=>p,MinNewTokensLengthLogitsProcessor:()=>g,NoBadWordsLogitsProcessor:()=>b,NoRepeatNGramLogitsProcessor:()=>h,RepetitionPenaltyLogitsProcessor:()=>f,SuppressTokensAtBeginLogitsProcessor:()=>u,TemperatureLogitsWarper:()=>m,TopKLogitsWarper:()=>x,TopPLogitsWarper:()=>v,WhisperTimeStampLogitsProcessor:()=>d});var r=t("./src/utils/generic.js");t("./src/utils/tensor.js");var i=t("./src/utils/maths.js");class s extends r.Callable{_call(T,E){throw Error("`_call` should be implemented in a subclass")}}class a extends r.Callable{_call(T,E){throw Error("`_call` should be implemented in a subclass")}}class o extends r.Callable{constructor(){super(),this.processors=[]}push(T){this.processors.push(T)}extend(T){this.processors.push(...T)}_call(T,E){let A=E;for(const M of this.processors)A=M(T,A);return A}[Symbol.iterator](){return this.processors.values()}}class l extends s{constructor(T){super(),this.bos_token_id=T}_call(T,E){for(let A=0;A<T.length;++A)if(T[A].length===1){const M=E[A].data;M.fill(-1/0),M[this.bos_token_id]=0}return E}}class c extends s{constructor(T,E){super(),this.max_length=T,this.eos_token_id=Array.isArray(E)?E:[E]}_call(T,E){for(let A=0;A<T.length;++A)if(T[A].length===this.max_length-1){const M=E[A].data;M.fill(-1/0);for(const F of this.eos_token_id)M[F]=0}return E}}class u extends s{constructor(T,E){super(),this.begin_suppress_tokens=T,this.begin_index=E}_call(T,E){for(let A=0;A<T.length;++A)if(T[A].length===this.begin_index){const M=E[A].data;for(const F of this.begin_suppress_tokens)M[F]=-1/0}return E}}class d extends s{constructor(T,E){super(),this.eos_token_id=Array.isArray(T.eos_token_id)?T.eos_token_id[0]:T.eos_token_id,this.no_timestamps_token_id=T.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=E.length,E.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=T.max_initial_timestamp_index}_call(T,E){for(let A=0;A<T.length;++A){const M=E[A].data;if(M[this.no_timestamps_token_id]=-1/0,T[A].length===this.begin_index-1){M.fill(-1/0),M[this.timestamp_begin]=0;continue}const F=T[A].slice(this.begin_index),G=F.length>=1&&F[F.length-1]>=this.timestamp_begin,S=F.length<2||F[F.length-2]>=this.timestamp_begin;if(G&&(S?M.subarray(this.timestamp_begin).fill(-1/0):M.subarray(0,this.eos_token_id).fill(-1/0)),T[A].length===this.begin_index&&this.max_initial_timestamp_index!==null){const B=this.timestamp_begin+this.max_initial_timestamp_index;M.subarray(B+1).fill(-1/0)}const I=(0,i.log_softmax)(M),C=Math.log(I.subarray(this.timestamp_begin).map(Math.exp).reduce((B,$)=>B+$)),H=(0,i.max)(I.subarray(0,this.timestamp_begin))[0];C>H&&M.subarray(0,this.timestamp_begin).fill(-1/0)}return E}}class h extends s{constructor(T){super(),this.no_repeat_ngram_size=T}getNgrams(T){const E=T.length,A=[];for(let F=0;F<E+1-this.no_repeat_ngram_size;++F){const G=[];for(let S=0;S<this.no_repeat_ngram_size;++S)G.push(T[F+S]);A.push(G.map(Number))}const M=new Map;for(const F of A){const G=F.slice(0,F.length-1),S=JSON.stringify(G),I=M.get(S)??[];I.push(F[F.length-1]),M.set(S,I)}return M}getGeneratedNgrams(T,E){const A=E.slice(E.length+1-this.no_repeat_ngram_size,E.length);return T.get(JSON.stringify(A.map(Number)))??[]}calcBannedNgramTokens(T){const E=[];if(T.length+1<this.no_repeat_ngram_size)return E;{const A=this.getNgrams(T);return this.getGeneratedNgrams(A,T)}}_call(T,E){for(let A=0;A<T.length;++A){const M=E[A].data,F=this.calcBannedNgramTokens(T[A]);for(const G of F)M[G]=-1/0}return E}}class f extends s{constructor(T){super(),this.penalty=T}_call(T,E){for(let A=0;A<T.length;++A){const M=E[A].data;for(const F of new Set(T[A])){const G=Number(F);M[G]<0?M[G]*=this.penalty:M[G]/=this.penalty}}return E}}class p extends s{constructor(T,E){super(),this.min_length=T,this.eos_token_id=Array.isArray(E)?E:[E]}_call(T,E){for(let A=0;A<T.length;++A)if(T[A].length<this.min_length){const M=E[A].data;for(const F of this.eos_token_id)M[F]=-1/0}return E}}class g extends s{constructor(T,E,A){super(),this.prompt_length_to_skip=T,this.min_new_tokens=E,this.eos_token_id=Array.isArray(A)?A:[A]}_call(T,E){for(let A=0;A<T.length;++A)if(T[A].length-this.prompt_length_to_skip<this.min_new_tokens){const F=E[A].data;for(const G of this.eos_token_id)F[G]=-1/0}return E}}class b extends s{constructor(T,E){super(),this.bad_words_ids=T,this.eos_token_id=Array.isArray(E)?E:[E]}_call(T,E){for(let A=0;A<T.length;++A){const M=E[A].data,F=T[A];for(const G of this.bad_words_ids){let S=!0;for(let I=1;I<=G.length-1&&G.length<F.length;++I)if(G.at(-I-1)!=F.at(-I)){S=!1;break}S&&(M[G.at(-1)]=-1/0)}}return E}}class _ extends s{constructor(T){if(super(),T<=1)throw new Error(`Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ${T}.`);this.guidance_scale=T}_call(T,E){if(E.dims[0]!==2*T.length)throw new Error(`Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got batch size ${E.dims[0]} for the logits and ${T.length} for the input ids.`);const A=T.length,M=E.slice([0,A],null),F=E.slice([A,E.dims[0]],null);for(let G=0;G<F.data.length;++G)F.data[G]+=(M.data[G]-F.data[G])*this.guidance_scale;return F}}class m extends a{constructor(T){super(),this.temperature=T}_call(T,E){const A=E.data;for(let M=0;M<A.length;++M)A[M]/=this.temperature;return E}}class v extends a{constructor(T,{filter_value:E=-1/0,min_tokens_to_keep:A=1}={}){if(super(),T<0||T>1)throw new Error(`\`top_p\` must be a float > 0 and < 1, but is ${T}`);if(!Number.isInteger(A)||A<1)throw new Error(`\`min_tokens_to_keep\` must be a positive integer, but is ${A}`);this.top_p=T,this.filter_value=E,this.min_tokens_to_keep=A}}class x extends a{constructor(T,{filter_value:E=-1/0,min_tokens_to_keep:A=1}={}){if(super(),!Number.isInteger(T)||T<0)throw new Error(`\`top_k\` must be a positive integer, but is ${T}`);this.top_k=Math.max(T,A),this.filter_value=E}}},"./src/generation/logits_sampler.js":(n,e,t)=>{t.r(e),t.d(e,{LogitsSampler:()=>a});var r=t("./src/utils/generic.js"),i=t("./src/utils/tensor.js"),s=t("./src/utils/maths.js");t("./src/generation/configuration_utils.js");class a extends r.Callable{constructor(d){super(),this.generation_config=d}async _call(d){return this.sample(d)}async sample(d){throw Error("sample should be implemented in subclasses.")}getLogits(d,h){let f=d.dims.at(-1),p=d.data;if(h===-1)p=p.slice(-f);else{let g=h*f;p=p.slice(g,g+f)}return p}randomSelect(d){let h=0;for(let p=0;p<d.length;++p)h+=d[p];let f=Math.random()*h;for(let p=0;p<d.length;++p)if(f-=d[p],f<=0)return p;return 0}static getSampler(d){if(d.do_sample)return new l(d);if(d.num_beams>1)return new c(d);if(d.num_return_sequences>1)throw Error(`num_return_sequences has to be 1 when doing greedy search, but is ${d.num_return_sequences}.`);return new o(d)}}class o extends a{async sample(d){const h=(0,s.max)(d.data)[1];return[[BigInt(h),0]]}}class l extends a{async sample(d){let h=d.dims.at(-1);this.generation_config.top_k>0&&(h=Math.min(this.generation_config.top_k,h));const[f,p]=await(0,i.topk)(d,h),g=(0,s.softmax)(f.data);return Array.from({length:this.generation_config.num_beams},()=>{const b=this.randomSelect(g);return[p.data[b],Math.log(g[b])]})}}class c extends a{async sample(d){let h=d.dims.at(-1);this.generation_config.top_k>0&&(h=Math.min(this.generation_config.top_k,h));const[f,p]=await(0,i.topk)(d,h),g=(0,s.softmax)(f.data);return Array.from({length:this.generation_config.num_beams},(b,_)=>[p.data[_],Math.log(g[_])])}}},"./src/generation/stopping_criteria.js":(n,e,t)=>{t.r(e),t.d(e,{EosTokenCriteria:()=>o,InterruptableStoppingCriteria:()=>l,MaxLengthCriteria:()=>a,StoppingCriteria:()=>i,StoppingCriteriaList:()=>s});var r=t("./src/utils/generic.js");class i extends r.Callable{_call(u,d){throw Error("StoppingCriteria needs to be subclassed")}}class s extends r.Callable{constructor(){super(),this.criteria=[]}push(u){this.criteria.push(u)}extend(u){u instanceof s?u=u.criteria:u instanceof i&&(u=[u]),this.criteria.push(...u)}_call(u,d){const h=new Array(u.length).fill(!1);for(const f of this.criteria){const p=f(u,d);for(let g=0;g<h.length;++g)h[g]||=p[g]}return h}[Symbol.iterator](){return this.criteria.values()}}class a extends i{constructor(u,d=null){super(),this.max_length=u,this.max_position_embeddings=d}_call(u){return u.map(d=>d.length>=this.max_length)}}class o extends i{constructor(u){super(),Array.isArray(u)||(u=[u]),this.eos_token_id=u}_call(u,d){return u.map(h=>{const f=h.at(-1);return this.eos_token_id.some(p=>f==p)})}}class l extends i{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(u,d){return new Array(u.length).fill(this.interrupted)}}},"./src/generation/streamers.js":(n,e,t)=>{t.r(e),t.d(e,{BaseStreamer:()=>a,TextStreamer:()=>l,WhisperTextStreamer:()=>c});var r=t("./src/utils/core.js"),i=t("./src/tokenizers.js"),s=t("./src/env.js");class a{put(d){throw Error("Not implemented")}end(){throw Error("Not implemented")}}const o=s.apis.IS_PROCESS_AVAILABLE?u=>process.stdout.write(u):u=>console.log(u);class l extends a{constructor(d,{skip_prompt:h=!1,callback_function:f=null,token_callback_function:p=null,skip_special_tokens:g=!0,decode_kwargs:b={},..._}={}){super(),this.tokenizer=d,this.skip_prompt=h,this.callback_function=f??o,this.token_callback_function=p,this.decode_kwargs={skip_special_tokens:g,...b,..._},this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(d){if(d.length>1)throw Error("TextStreamer only supports batch size of 1");const h=this.next_tokens_are_prompt;if(h&&(this.next_tokens_are_prompt=!1,this.skip_prompt))return;const f=d[0];this.token_callback_function?.(f),this.token_cache=(0,r.mergeArrays)(this.token_cache,f);const p=this.tokenizer.decode(this.token_cache,this.decode_kwargs);let g;h||p.endsWith(`
`)?(g=p.slice(this.print_len),this.token_cache=[],this.print_len=0):p.length>0&&(0,i.is_chinese_char)(p.charCodeAt(p.length-1))?(g=p.slice(this.print_len),this.print_len+=g.length):(g=p.slice(this.print_len,p.lastIndexOf(" ")+1),this.print_len+=g.length),this.on_finalized_text(g,!1)}end(){let d;this.token_cache.length>0?(d=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0):d="",this.next_tokens_are_prompt=!0,this.on_finalized_text(d,!0)}on_finalized_text(d,h){d.length>0&&this.callback_function?.(d),h&&this.callback_function===o&&s.apis.IS_PROCESS_AVAILABLE&&this.callback_function?.(`
`)}}class c extends l{constructor(d,{skip_prompt:h=!1,callback_function:f=null,token_callback_function:p=null,on_chunk_start:g=null,on_chunk_end:b=null,on_finalize:_=null,time_precision:m=.02,skip_special_tokens:v=!0,decode_kwargs:x={}}={}){super(d,{skip_prompt:h,skip_special_tokens:v,callback_function:f,token_callback_function:p,decode_kwargs:x}),this.timestamp_begin=d.timestamp_begin,this.on_chunk_start=g,this.on_chunk_end=b,this.on_finalize=_,this.time_precision=m,this.waiting_for_timestamp=!1}put(d){if(d.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");const h=d[0];if(h.length===1){const f=Number(h[0])-this.timestamp_begin;if(f>=0){const p=f*this.time_precision;this.waiting_for_timestamp?this.on_chunk_end?.(p):this.on_chunk_start?.(p),this.waiting_for_timestamp=!this.waiting_for_timestamp,d=[[]]}}return super.put(d)}end(){super.end(),this.on_finalize?.()}}},"./src/models.js":(n,e,t)=>{t.r(e),t.d(e,{ASTForAudioClassification:()=>F_,ASTModel:()=>Tf,ASTPreTrainedModel:()=>xf,AlbertForMaskedLM:()=>ye,AlbertForQuestionAnswering:()=>Y,AlbertForSequenceClassification:()=>Le,AlbertModel:()=>sc,AlbertPreTrainedModel:()=>_a,AutoModel:()=>D1,AutoModelForAudioClassification:()=>BC,AutoModelForAudioFrameClassification:()=>NC,AutoModelForAudioTextToText:()=>XC,AutoModelForCTC:()=>RC,AutoModelForCausalLM:()=>MC,AutoModelForDepthEstimation:()=>VC,AutoModelForDocumentQuestionAnswering:()=>zC,AutoModelForImageClassification:()=>PC,AutoModelForImageFeatureExtraction:()=>HC,AutoModelForImageMatting:()=>WC,AutoModelForImageSegmentation:()=>kC,AutoModelForImageTextToText:()=>KC,AutoModelForImageToImage:()=>jC,AutoModelForMaskGeneration:()=>LC,AutoModelForMaskedLM:()=>AC,AutoModelForNormalEstimation:()=>GC,AutoModelForObjectDetection:()=>OC,AutoModelForPoseEstimation:()=>qC,AutoModelForQuestionAnswering:()=>CC,AutoModelForSemanticSegmentation:()=>FC,AutoModelForSeq2SeqLM:()=>xC,AutoModelForSequenceClassification:()=>vC,AutoModelForSpeechSeq2Seq:()=>TC,AutoModelForTextToSpectrogram:()=>EC,AutoModelForTextToWaveform:()=>DC,AutoModelForTokenClassification:()=>wC,AutoModelForUniversalSegmentation:()=>IC,AutoModelForVision2Seq:()=>SC,AutoModelForXVector:()=>$C,AutoModelForZeroShotObjectDetection:()=>UC,BartForConditionalGeneration:()=>Vn,BartForSequenceClassification:()=>Bn,BartModel:()=>An,BartPretrainedModel:()=>Lt,BaseModelOutput:()=>U,BeitForImageClassification:()=>xb,BeitModel:()=>wb,BeitPreTrainedModel:()=>Fp,BertForMaskedLM:()=>ie,BertForQuestionAnswering:()=>Ce,BertForSequenceClassification:()=>re,BertForTokenClassification:()=>ge,BertModel:()=>pe,BertPreTrainedModel:()=>he,BlenderbotForConditionalGeneration:()=>fr,BlenderbotModel:()=>Cn,BlenderbotPreTrainedModel:()=>Ii,BlenderbotSmallForConditionalGeneration:()=>Fr,BlenderbotSmallModel:()=>yi,BlenderbotSmallPreTrainedModel:()=>jr,BloomForCausalLM:()=>mp,BloomModel:()=>pp,BloomPreTrainedModel:()=>Cd,CLIPModel:()=>z_,CLIPPreTrainedModel:()=>qa,CLIPSegForImageSegmentation:()=>Q_,CLIPSegModel:()=>Y_,CLIPSegPreTrainedModel:()=>cd,CLIPTextModel:()=>e1,CLIPTextModelWithProjection:()=>od,CLIPVisionModel:()=>W_,CLIPVisionModelWithProjection:()=>j_,CamembertForMaskedLM:()=>Un,CamembertForQuestionAnswering:()=>dr,CamembertForSequenceClassification:()=>ur,CamembertForTokenClassification:()=>vr,CamembertModel:()=>rn,CamembertPreTrainedModel:()=>Tt,CausalLMOutput:()=>gc,CausalLMOutputWithPast:()=>t5,ChineseCLIPModel:()=>K_,ChineseCLIPPreTrainedModel:()=>H_,ClapAudioModelWithProjection:()=>sA,ClapModel:()=>rA,ClapPreTrainedModel:()=>Rb,ClapTextModelWithProjection:()=>iA,CodeGenForCausalLM:()=>md,CodeGenModel:()=>fc,CodeGenPreTrainedModel:()=>Oi,CohereForCausalLM:()=>Jf,CohereModel:()=>Zf,CoherePreTrainedModel:()=>wd,ConvBertForMaskedLM:()=>ft,ConvBertForQuestionAnswering:()=>rr,ConvBertForSequenceClassification:()=>Wt,ConvBertForTokenClassification:()=>Jn,ConvBertModel:()=>xt,ConvBertPreTrainedModel:()=>tt,ConvNextForImageClassification:()=>JD,ConvNextModel:()=>ZD,ConvNextPreTrainedModel:()=>r1,ConvNextV2ForImageClassification:()=>tM,ConvNextV2Model:()=>eM,ConvNextV2PreTrainedModel:()=>i1,DPTForDepthEstimation:()=>BD,DPTModel:()=>Xo,DPTPreTrainedModel:()=>ei,DacDecoderModel:()=>HA,DacDecoderOutput:()=>VA,DacEncoderModel:()=>qA,DacEncoderOutput:()=>jA,DacModel:()=>GA,DacPreTrainedModel:()=>Vb,DebertaForMaskedLM:()=>ct,DebertaForQuestionAnswering:()=>ki,DebertaForSequenceClassification:()=>rt,DebertaForTokenClassification:()=>Mn,DebertaModel:()=>Ze,DebertaPreTrainedModel:()=>Dn,DebertaV2ForMaskedLM:()=>gi,DebertaV2ForQuestionAnswering:()=>Ro,DebertaV2ForSequenceClassification:()=>ms,DebertaV2ForTokenClassification:()=>Lo,DebertaV2Model:()=>mi,DebertaV2PreTrainedModel:()=>bn,DecisionTransformerModel:()=>MA,DecisionTransformerPreTrainedModel:()=>DA,DeiTForImageClassification:()=>D,DeiTModel:()=>Fb,DeiTPreTrainedModel:()=>Rp,DepthAnythingForDepthEstimation:()=>ND,DepthAnythingPreTrainedModel:()=>$D,DepthProForDepthEstimation:()=>GD,DepthProPreTrainedModel:()=>VD,DetrForObjectDetection:()=>Eb,DetrForSegmentation:()=>Ip,DetrModel:()=>Tb,DetrObjectDetectionOutput:()=>Op,DetrPreTrainedModel:()=>Od,DetrSegmentationOutput:()=>Db,Dinov2ForImageClassification:()=>rM,Dinov2Model:()=>nM,Dinov2PreTrainedModel:()=>s1,Dinov2WithRegistersForImageClassification:()=>sM,Dinov2WithRegistersModel:()=>iM,Dinov2WithRegistersPreTrainedModel:()=>a1,DistilBertForMaskedLM:()=>zo,DistilBertForQuestionAnswering:()=>No,DistilBertForSequenceClassification:()=>Bo,DistilBertForTokenClassification:()=>$o,DistilBertModel:()=>ma,DistilBertPreTrainedModel:()=>gs,DonutSwinModel:()=>QD,DonutSwinPreTrainedModel:()=>YD,EfficientNetForImageClassification:()=>hA,EfficientNetModel:()=>dA,EfficientNetPreTrainedModel:()=>g1,ElectraForMaskedLM:()=>fe,ElectraForQuestionAnswering:()=>it,ElectraForSequenceClassification:()=>Me,ElectraForTokenClassification:()=>Ie,ElectraModel:()=>ae,ElectraPreTrainedModel:()=>yr,EsmForMaskedLM:()=>Fi,EsmForSequenceClassification:()=>Jl,EsmForTokenClassification:()=>Jr,EsmModel:()=>Wo,EsmPreTrainedModel:()=>Rs,ExaoneForCausalLM:()=>Ot,ExaoneModel:()=>_d,ExaonePreTrainedModel:()=>kt,FalconForCausalLM:()=>nA,FalconModel:()=>tA,FalconPreTrainedModel:()=>f1,FastViTForImageClassification:()=>ub,FastViTModel:()=>cb,FastViTPreTrainedModel:()=>Ap,Florence2ForConditionalGeneration:()=>Pf,Florence2PreTrainedModel:()=>Sf,GLPNForDepthEstimation:()=>XD,GLPNModel:()=>KD,GLPNPreTrainedModel:()=>n1,GPT2LMHeadModel:()=>If,GPT2Model:()=>ud,GPT2PreTrainedModel:()=>dc,GPTBigCodeForCausalLM:()=>hc,GPTBigCodeModel:()=>Bf,GPTBigCodePreTrainedModel:()=>pd,GPTJForCausalLM:()=>eb,GPTJModel:()=>Qe,GPTJPreTrainedModel:()=>Ho,GPTNeoForCausalLM:()=>Z_,GPTNeoModel:()=>Lf,GPTNeoPreTrainedModel:()=>hd,GPTNeoXForCausalLM:()=>Rf,GPTNeoXModel:()=>J_,GPTNeoXPreTrainedModel:()=>fd,Gemma2ForCausalLM:()=>rp,Gemma2Model:()=>np,Gemma2PreTrainedModel:()=>Td,GemmaForCausalLM:()=>tp,GemmaModel:()=>ep,GemmaPreTrainedModel:()=>xd,GlmForCausalLM:()=>jf,GlmModel:()=>Ko,GlmPreTrainedModel:()=>It,GraniteForCausalLM:()=>Qf,GraniteModel:()=>Yf,GranitePreTrainedModel:()=>vd,GroundingDinoForObjectDetection:()=>oM,GroundingDinoPreTrainedModel:()=>aM,GroupViTModel:()=>lb,GroupViTPreTrainedModel:()=>ob,HeliumForCausalLM:()=>Wf,HeliumModel:()=>zf,HeliumPreTrainedModel:()=>pc,HieraForImageClassification:()=>K,HieraModel:()=>N,HieraPreTrainedModel:()=>P,HubertForCTC:()=>RM,HubertForSequenceClassification:()=>BM,HubertModel:()=>LM,HubertPreTrainedModel:()=>z8,IJepaForImageClassification:()=>Tp,IJepaModel:()=>xp,IJepaPreTrainedModel:()=>Fd,Idefics3ForConditionalGeneration:()=>cc,Idefics3PreTrainedModel:()=>kf,ImageMattingOutput:()=>QC,JAISLMHeadModel:()=>Uf,JAISModel:()=>Of,JAISPreTrainedModel:()=>dd,JinaCLIPModel:()=>X_,JinaCLIPPreTrainedModel:()=>ld,JinaCLIPTextModel:()=>uc,JinaCLIPVisionModel:()=>qo,LiteWhisperForConditionalGeneration:()=>O_,LlamaForCausalLM:()=>Nf,LlamaModel:()=>$f,LlamaPreTrainedModel:()=>gd,LlavaForConditionalGeneration:()=>sd,LlavaOnevisionForConditionalGeneration:()=>R_,LlavaPreTrainedModel:()=>L_,LongT5ForConditionalGeneration:()=>lt,LongT5Model:()=>ot,LongT5PreTrainedModel:()=>Ke,M2M100ForConditionalGeneration:()=>_M,M2M100Model:()=>gM,M2M100PreTrainedModel:()=>c1,MBartForCausalLM:()=>Wr,MBartForConditionalGeneration:()=>qi,MBartForSequenceClassification:()=>Va,MBartModel:()=>hr,MBartPreTrainedModel:()=>Gn,MPNetForMaskedLM:()=>za,MPNetForQuestionAnswering:()=>wr,MPNetForSequenceClassification:()=>bi,MPNetForTokenClassification:()=>Wa,MPNetModel:()=>tc,MPNetPreTrainedModel:()=>kr,MT5ForConditionalGeneration:()=>Ht,MT5Model:()=>st,MT5PreTrainedModel:()=>ut,MarianMTModel:()=>mM,MarianModel:()=>pM,MarianPreTrainedModel:()=>l1,MaskFormerForInstanceSegmentation:()=>HD,MaskFormerModel:()=>qD,MaskFormerPreTrainedModel:()=>t1,MaskedLMOutput:()=>Ir,MgpstrForSceneTextRecognition:()=>kA,MgpstrModelOutput:()=>SA,MgpstrPreTrainedModel:()=>PA,MimiDecoderModel:()=>WA,MimiDecoderOutput:()=>$A,MimiEncoderModel:()=>zA,MimiEncoderOutput:()=>BA,MimiModel:()=>NA,MimiPreTrainedModel:()=>jb,MistralForCausalLM:()=>ZM,MistralModel:()=>QM,MistralPreTrainedModel:()=>d1,MobileBertForMaskedLM:()=>_i,MobileBertForQuestionAnswering:()=>ec,MobileBertForSequenceClassification:()=>jo,MobileBertModel:()=>ga,MobileBertPreTrainedModel:()=>_s,MobileLLMForCausalLM:()=>Gf,MobileLLMModel:()=>Vf,MobileLLMPreTrainedModel:()=>bd,MobileNetV1ForImageClassification:()=>pA,MobileNetV1ForSemanticSegmentation:()=>mA,MobileNetV1Model:()=>fA,MobileNetV1PreTrainedModel:()=>$b,MobileNetV2ForImageClassification:()=>_A,MobileNetV2ForSemanticSegmentation:()=>bA,MobileNetV2Model:()=>gA,MobileNetV2PreTrainedModel:()=>Nb,MobileNetV3ForImageClassification:()=>vA,MobileNetV3ForSemanticSegmentation:()=>wA,MobileNetV3Model:()=>yA,MobileNetV3PreTrainedModel:()=>zb,MobileNetV4ForImageClassification:()=>TA,MobileNetV4ForSemanticSegmentation:()=>EA,MobileNetV4Model:()=>xA,MobileNetV4PreTrainedModel:()=>Wb,MobileViTForImageClassification:()=>pb,MobileViTModel:()=>fb,MobileViTPreTrainedModel:()=>Cp,MobileViTV2ForImageClassification:()=>gb,MobileViTV2Model:()=>mb,MobileViTV2PreTrainedModel:()=>Sp,ModelOutput:()=>Se,ModernBertForMaskedLM:()=>j,ModernBertForSequenceClassification:()=>ee,ModernBertForTokenClassification:()=>se,ModernBertModel:()=>te,ModernBertPreTrainedModel:()=>q,Moondream1ForConditionalGeneration:()=>Cf,MoonshineForConditionalGeneration:()=>U_,MoonshineModel:()=>Jv,MoonshinePreTrainedModel:()=>Mf,MptForCausalLM:()=>_p,MptModel:()=>gp,MptPreTrainedModel:()=>Sd,MultiModalityCausalLM:()=>CA,MultiModalityPreTrainedModel:()=>AA,MusicgenForCausalLM:()=>G8,MusicgenForConditionalGeneration:()=>b1,MusicgenModel:()=>V8,MusicgenPreTrainedModel:()=>_1,NomicBertModel:()=>ke,NomicBertPreTrainedModel:()=>ve,OPTForCausalLM:()=>yp,OPTModel:()=>bp,OPTPreTrainedModel:()=>Pd,Olmo2ForCausalLM:()=>Xf,Olmo2Model:()=>Kf,Olmo2PreTrainedModel:()=>mc,OlmoForCausalLM:()=>Hf,OlmoModel:()=>qf,OlmoPreTrainedModel:()=>yd,OpenELMForCausalLM:()=>sp,OpenELMModel:()=>ip,OpenELMPreTrainedModel:()=>Ed,OwlViTForObjectDetection:()=>bb,OwlViTModel:()=>_b,OwlViTPreTrainedModel:()=>Pp,Owlv2ForObjectDetection:()=>vb,Owlv2Model:()=>yb,Owlv2PreTrainedModel:()=>kp,PaliGemmaForConditionalGeneration:()=>$_,PaliGemmaPreTrainedModel:()=>B_,PatchTSMixerForPrediction:()=>UA,PatchTSMixerModel:()=>OA,PatchTSMixerPreTrainedModel:()=>v1,PatchTSTForPrediction:()=>IA,PatchTSTModel:()=>FA,PatchTSTPreTrainedModel:()=>y1,Phi3ForCausalLM:()=>fp,Phi3Model:()=>hp,Phi3PreTrainedModel:()=>Ad,Phi3VForCausalLM:()=>ad,Phi3VPreTrainedModel:()=>N_,PhiForCausalLM:()=>dp,PhiModel:()=>up,PhiPreTrainedModel:()=>Md,PreTrainedModel:()=>ue,PretrainedMixin:()=>an,PvtForImageClassification:()=>nb,PvtModel:()=>tb,PvtPreTrainedModel:()=>Id,PyAnnoteForAudioFrameClassification:()=>TM,PyAnnoteModel:()=>xM,PyAnnotePreTrainedModel:()=>u1,QuestionAnsweringModelOutput:()=>ti,Qwen2ForCausalLM:()=>op,Qwen2Model:()=>ap,Qwen2PreTrainedModel:()=>Dd,Qwen2VLForConditionalGeneration:()=>cp,Qwen2VLPreTrainedModel:()=>lp,RTDetrForObjectDetection:()=>Ab,RTDetrModel:()=>Mb,RTDetrObjectDetectionOutput:()=>Cb,RTDetrPreTrainedModel:()=>Up,ResNetForImageClassification:()=>Ae,ResNetModel:()=>_e,ResNetPreTrainedModel:()=>J,RoFormerForMaskedLM:()=>ze,RoFormerForQuestionAnswering:()=>qe,RoFormerForSequenceClassification:()=>Te,RoFormerForTokenClassification:()=>Be,RoFormerModel:()=>Oe,RoFormerPreTrainedModel:()=>Re,RobertaForMaskedLM:()=>qn,RobertaForQuestionAnswering:()=>er,RobertaForSequenceClassification:()=>$n,RobertaForTokenClassification:()=>Hn,RobertaModel:()=>Hi,RobertaPreTrainedModel:()=>hn,SamImageSegmentationOutput:()=>fM,SamModel:()=>hM,SamPreTrainedModel:()=>dM,SapiensForDepthEstimation:()=>WD,SapiensForNormalEstimation:()=>jD,SapiensForSemanticSegmentation:()=>zD,SapiensPreTrainedModel:()=>Ib,SegformerForImageClassification:()=>oA,SegformerForSemanticSegmentation:()=>lA,SegformerModel:()=>j8,SegformerPreTrainedModel:()=>Bb,Seq2SeqLMOutput:()=>e5,SequenceClassifierOutput:()=>Bt,SiglipModel:()=>V_,SiglipPreTrainedModel:()=>Ff,SiglipTextModel:()=>G_,SiglipVisionModel:()=>q_,SmolVLMForConditionalGeneration:()=>Ga,SpeechT5ForSpeechToText:()=>qM,SpeechT5ForTextToSpeech:()=>HM,SpeechT5HifiGan:()=>KM,SpeechT5Model:()=>W8,SpeechT5PreTrainedModel:()=>Lb,SqueezeBertForMaskedLM:()=>nc,SqueezeBertForQuestionAnswering:()=>ic,SqueezeBertForSequenceClassification:()=>rc,SqueezeBertModel:()=>ja,SqueezeBertPreTrainedModel:()=>ir,StableLmForCausalLM:()=>uA,StableLmModel:()=>cA,StableLmPreTrainedModel:()=>m1,Starcoder2ForCausalLM:()=>eA,Starcoder2Model:()=>JM,Starcoder2PreTrainedModel:()=>h1,StyleTextToSpeech2Model:()=>GM,StyleTextToSpeech2PreTrainedModel:()=>VM,Swin2SRForImageSuperResolution:()=>mn,Swin2SRModel:()=>Rt,Swin2SRPreTrainedModel:()=>wt,SwinForImageClassification:()=>et,SwinForSemanticSegmentation:()=>dt,SwinModel:()=>Ge,SwinPreTrainedModel:()=>Ne,T5ForConditionalGeneration:()=>We,T5Model:()=>Pe,T5PreTrainedModel:()=>De,TableTransformerForObjectDetection:()=>Pb,TableTransformerModel:()=>Sb,TableTransformerObjectDetectionOutput:()=>kb,TableTransformerPreTrainedModel:()=>Lp,TokenClassifierOutput:()=>xr,TrOCRForCausalLM:()=>YM,TrOCRPreTrainedModel:()=>XM,UltravoxModel:()=>RA,UltravoxPreTrainedModel:()=>LA,UniSpeechForCTC:()=>AM,UniSpeechForSequenceClassification:()=>CM,UniSpeechModel:()=>MM,UniSpeechPreTrainedModel:()=>Ob,UniSpeechSatForAudioFrameClassification:()=>FM,UniSpeechSatForCTC:()=>PM,UniSpeechSatForSequenceClassification:()=>kM,UniSpeechSatModel:()=>SM,UniSpeechSatPreTrainedModel:()=>Bp,ViTForImageClassification:()=>wp,ViTMAEModel:()=>ib,ViTMAEPreTrainedModel:()=>rb,ViTMSNForImageClassification:()=>ab,ViTMSNModel:()=>sb,ViTMSNPreTrainedModel:()=>Mp,ViTModel:()=>vp,ViTPreTrainedModel:()=>kd,VisionEncoderDecoderModel:()=>Af,VitMatteForImageMatting:()=>hb,VitMattePreTrainedModel:()=>db,VitPoseForPoseEstimation:()=>Dp,VitPosePreTrainedModel:()=>Ep,VitsModel:()=>p1,VitsModelOutput:()=>ZC,VitsPreTrainedModel:()=>aA,Wav2Vec2BertForCTC:()=>OM,Wav2Vec2BertForSequenceClassification:()=>UM,Wav2Vec2BertModel:()=>IM,Wav2Vec2BertPreTrainedModel:()=>Ub,Wav2Vec2ForAudioFrameClassification:()=>wM,Wav2Vec2ForCTC:()=>yM,Wav2Vec2ForSequenceClassification:()=>vM,Wav2Vec2Model:()=>bM,Wav2Vec2PreTrainedModel:()=>Yo,WavLMForAudioFrameClassification:()=>jM,WavLMForCTC:()=>NM,WavLMForSequenceClassification:()=>zM,WavLMForXVector:()=>WM,WavLMModel:()=>$M,WavLMPreTrainedModel:()=>Ud,WeSpeakerResNetModel:()=>DM,WeSpeakerResNetPreTrainedModel:()=>EM,WhisperForConditionalGeneration:()=>Df,WhisperModel:()=>I_,WhisperPreTrainedModel:()=>Ef,XLMForQuestionAnswering:()=>C_,XLMForSequenceClassification:()=>A_,XLMForTokenClassification:()=>oc,XLMModel:()=>Vo,XLMPreTrainedModel:()=>sr,XLMRobertaForMaskedLM:()=>S_,XLMRobertaForQuestionAnswering:()=>k_,XLMRobertaForSequenceClassification:()=>wf,XLMRobertaForTokenClassification:()=>P_,XLMRobertaModel:()=>lc,XLMRobertaPreTrainedModel:()=>Go,XLMWithLMHeadModel:()=>ac,XVectorOutput:()=>YC,YolosForObjectDetection:()=>cM,YolosModel:()=>lM,YolosObjectDetectionOutput:()=>uM,YolosPreTrainedModel:()=>o1});var r=t("./src/configs.js"),i=t("./src/backends/onnx.js"),s=t("./src/utils/dtypes.js"),a=t("./src/utils/generic.js"),o=t("./src/utils/core.js"),l=t("./src/utils/hub.js"),c=t("./src/utils/constants.js"),u=t("./src/generation/logits_process.js"),d=t("./src/generation/configuration_utils.js"),h=t("./src/utils/tensor.js"),f=t("./src/utils/image.js"),p=t("./src/utils/maths.js"),g=t("./src/generation/stopping_criteria.js"),b=t("./src/generation/logits_sampler.js"),_=t("./src/env.js"),m=t("./src/models/whisper/generation_whisper.js"),v=t("./src/models/whisper/common_whisper.js");const x={EncoderOnly:0,EncoderDecoder:1,Seq2Seq:2,Vision2Seq:3,DecoderOnly:4,MaskGeneration:5,ImageTextToText:6,Musicgen:7,MultiModality:8,Phi3V:9,AudioTextToText:10,AutoEncoder:11},w=new Map,T=new Map,E=new Map;async function A(W,z,me){const Ue=me.config?.["transformers.js_config"]??{};let $e=me.device??Ue.device;$e&&typeof $e!="string"&&($e.hasOwnProperty(z)?$e=$e[z]:(console.warn(`device not specified for "${z}". Using the default device.`),$e=null));const je=$e??(_.apis.IS_NODE_ENV?"cpu":"wasm"),Ye=(0,i.deviceToExecutionProviders)(je);let Je=me.dtype??Ue.dtype;if(typeof Je!="string"&&(Je&&Je.hasOwnProperty(z)?Je=Je[z]:(Je=s.DEFAULT_DEVICE_DTYPE_MAPPING[je]??s.DATA_TYPES.fp32,console.warn(`dtype not specified for "${z}". Using the default dtype (${Je}) for this device (${je}).`))),Je===s.DATA_TYPES.auto){let Jt=Ue.dtype;typeof Jt!="string"&&(Jt=Jt[z]),Jt&&Jt!==s.DATA_TYPES.auto&&s.DATA_TYPES.hasOwnProperty(Jt)?Je=Jt:Je=s.DEFAULT_DEVICE_DTYPE_MAPPING[je]??s.DATA_TYPES.fp32}const at=Je;if(s.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(at)){if(at===s.DATA_TYPES.fp16&&je==="webgpu"&&!await(0,s.isWebGpuFp16Supported)())throw new Error(`The device (${je}) does not support fp16.`)}else throw new Error(`Invalid dtype: ${at}. Should be one of: ${Object.keys(s.DATA_TYPES).join(", ")}`);const mt=Ue.kv_cache_dtype?typeof Ue.kv_cache_dtype=="string"?Ue.kv_cache_dtype:Ue.kv_cache_dtype[at]??"float32":void 0;if(mt&&!["float32","float16"].includes(mt))throw new Error(`Invalid kv_cache_dtype: ${mt}. Should be one of: float32, float16`);const jt={dtype:at,kv_cache_dtype:mt},Gt=s.DEFAULT_DTYPE_SUFFIX_MAPPING[at],Et=`${z}${Gt}.onnx`,Dt=`${me.subfolder??""}/${Et}`,en={...me.session_options};en.executionProviders??=Ye;const Ct=Ue.free_dimension_overrides;Ct?en.freeDimensionOverrides??=Ct:je.startsWith("webnn")&&!en.freeDimensionOverrides&&console.warn('WebNN does not currently support dynamic shapes and requires `free_dimension_overrides` to be set in config.json as a field within "transformers.js_config". When `free_dimension_overrides` is not set, you may experience significant performance degradation.');const St=(0,l.getModelFile)(W,Dt,!0,me,_.apis.IS_NODE_ENV),Yt=me.use_external_data_format??Ue.use_external_data_format;let gn=[];if(Yt){let Jt;typeof Yt=="object"?Yt.hasOwnProperty(Et)?Jt=Yt[Et]:Yt.hasOwnProperty(z)?Jt=Yt[z]:Jt=!1:Jt=Yt;const Ln=+Jt;if(Ln>l.MAX_EXTERNAL_DATA_CHUNKS)throw new Error(`The number of external data chunks (${Ln}) exceeds the maximum allowed value (${l.MAX_EXTERNAL_DATA_CHUNKS}).`);for(let xn=0;xn<Ln;++xn){const tr=`${Et}_data${xn===0?"":"_"+xn}`,Vr=`${me.subfolder??""}/${tr}`;gn.push(new Promise(async(Ui,Gb)=>{const ni=await(0,l.getModelFile)(W,Vr,!0,me,_.apis.IS_NODE_ENV);Ui(ni instanceof Uint8Array?{path:tr,data:ni}:tr)}))}}else en.externalData!==void 0&&(gn=en.externalData.map(async Jt=>{if(typeof Jt.data=="string"){const Ln=await(0,l.getModelFile)(W,Jt.data,!0,me);return{...Jt,data:Ln}}return Jt}));if(gn.length>0){const Jt=await Promise.all(gn);_.apis.IS_NODE_ENV||(en.externalData=Jt)}if(je==="webgpu"){const Jt=(0,r.getKeyValueShapes)(me.config,{prefix:"present"});if(Object.keys(Jt).length>0&&!(0,i.isONNXProxy)()){const Ln={};for(const xn in Jt)Ln[xn]="gpu-buffer";en.preferredOutputLocation=Ln}}return{buffer_or_path:await St,session_options:en,session_config:jt}}async function M(W,z,me){return Object.fromEntries(await Promise.all(Object.keys(z).map(async Ue=>{const{buffer_or_path:$e,session_options:je,session_config:Ye}=await A(W,z[Ue],me),Je=await(0,i.createInferenceSession)($e,je,Ye);return[Ue,Je]})))}async function F(W,z,me){return Object.fromEntries(await Promise.all(Object.keys(z).map(async Ue=>{const $e=await(0,l.getModelJSON)(W,z[Ue],!1,me);return[Ue,$e]})))}function G(W,z){const me=Object.create(null),Ue=[];for(const Ye of W.inputNames){const Je=z[Ye];if(!(Je instanceof h.Tensor)){Ue.push(Ye);continue}me[Ye]=(0,i.isONNXProxy)()?Je.clone():Je}if(Ue.length>0)throw new Error(`An error occurred during model execution: "Missing the following inputs: ${Ue.join(", ")}.`);const $e=Object.keys(z).length,je=W.inputNames.length;if($e>je){let Ye=Object.keys(z).filter(Je=>!W.inputNames.includes(Je));console.warn(`WARNING: Too many inputs were provided (${$e} > ${je}). The following inputs will be ignored: "${Ye.join(", ")}".`)}return me}async function S(W,z){const me=G(W,z);try{const Ue=Object.fromEntries(Object.entries(me).map(([je,Ye])=>[je,Ye.ort_tensor]));let $e=await W.run(Ue);return $e=I($e),$e}catch(Ue){const $e=Object.fromEntries(Object.entries(me).map(([je,{type:Ye,dims:Je,data:at}])=>[je,{type:Ye,dims:Je,data:at}]));throw console.error(`An error occurred during model execution: "${Ue}".`),console.error("Inputs given to model:",$e),Ue}}function I(W){for(let z in W)(0,i.isONNXTensor)(W[z])?W[z]=new h.Tensor(W[z]):typeof W[z]=="object"&&I(W[z]);return W}function C(W){if(W instanceof h.Tensor)return W;if(W.length===0)throw Error("items must be non-empty");if(Array.isArray(W[0])){if(W.some(z=>z.length!==W[0].length))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new h.Tensor("int64",BigInt64Array.from(W.flat().map(z=>BigInt(z))),[W.length,W[0].length])}else return new h.Tensor("int64",BigInt64Array.from(W.map(z=>BigInt(z))),[1,W.length])}function H(W){return new h.Tensor("bool",[W],[1])}async function B(W,z){let{encoder_outputs:me,input_ids:Ue,decoder_input_ids:$e,...je}=z;if(!me){const Je=(0,o.pick)(z,W.sessions.model.inputNames);me=(await $(W,Je)).last_hidden_state}return je.input_ids=$e,je.encoder_hidden_states=me,W.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(je.encoder_attention_mask=z.attention_mask),await V(W,je,!0)}async function $(W,z){const me=W.sessions.model,Ue=(0,o.pick)(z,me.inputNames);if(me.inputNames.includes("inputs_embeds")&&!Ue.inputs_embeds){if(!z.input_ids)throw new Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");Ue.inputs_embeds=await W.encode_text({input_ids:z.input_ids})}if(me.inputNames.includes("token_type_ids")&&!Ue.token_type_ids){if(!Ue.input_ids)throw new Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");Ue.token_type_ids=(0,h.zeros_like)(Ue.input_ids)}if(me.inputNames.includes("pixel_mask")&&!Ue.pixel_mask){if(!Ue.pixel_values)throw new Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");const $e=Ue.pixel_values.dims;Ue.pixel_mask=(0,h.ones)([$e[0],$e[2],$e[3]])}return await S(me,Ue)}async function X(W,z){const me=await W.encode(z);return await W.decode(me)}async function V(W,z,me=!1){const Ue=W.sessions[me?"decoder_model_merged":"model"],{past_key_values:$e,...je}=z;if(Ue.inputNames.includes("use_cache_branch")&&(je.use_cache_branch=H(!!$e)),Ue.inputNames.includes("position_ids")&&je.attention_mask&&!je.position_ids){const Je=W.config.model_type==="paligemma"?1:0;je.position_ids=be(je,$e,Je)}W.addPastKeyValues(je,$e);const Ye=(0,o.pick)(je,Ue.inputNames);return await S(Ue,Ye)}function Q({modality_token_id:W,inputs_embeds:z,modality_features:me,input_ids:Ue,attention_mask:$e}){const je=Ue.tolist().map(mt=>mt.reduce((jt,Gt,Et)=>(Gt==W&&jt.push(Et),jt),[])),Ye=je.reduce((mt,jt)=>mt+jt.length,0),Je=me.dims[0];if(Ye!==Je)throw new Error(`Number of tokens and features do not match: tokens: ${Ye}, features ${Je}`);let at=0;for(let mt=0;mt<je.length;++mt){const jt=je[mt],Gt=z[mt];for(let Et=0;Et<jt.length;++Et)Gt[jt[Et]].data.set(me[at++].data)}return{inputs_embeds:z,attention_mask:$e}}function R({image_token_id:W,inputs_embeds:z,image_features:me,input_ids:Ue,attention_mask:$e}){return Q({modality_token_id:W,inputs_embeds:z,modality_features:me,input_ids:Ue,attention_mask:$e})}function O({audio_token_id:W,inputs_embeds:z,audio_features:me,input_ids:Ue,attention_mask:$e}){return Q({modality_token_id:W,inputs_embeds:z,modality_features:me,input_ids:Ue,attention_mask:$e})}async function L(W,{encode_function:z,merge_function:me,modality_input_name:Ue,modality_output_name:$e,input_ids:je=null,attention_mask:Ye=null,position_ids:Je=null,inputs_embeds:at=null,past_key_values:mt=null,generation_config:jt=null,logits_processor:Gt=null,...Et}){const Dt=Et[Ue];if(!at){if(at=await W.encode_text({input_ids:je,...Et}),Dt&&je.dims[1]!==1){const Ct=await z({[Ue]:Dt,...Et});({inputs_embeds:at,attention_mask:Ye}=me({[$e]:Ct,inputs_embeds:at,input_ids:je,attention_mask:Ye}))}else if(mt&&Dt&&je.dims[1]===1){const Ct=je.dims[1],St=Object.values(mt)[0].dims.at(-2);Ye=(0,h.cat)([(0,h.ones)([je.dims[0],St]),Ye.slice(null,[Ye.dims[1]-Ct,Ye.dims[1]])],1)}}if(!Je&&W.config.model_type==="qwen2_vl"){const{image_grid_thw:Ct,video_grid_thw:St}=Et;[Je]=W.get_rope_index(je,Ct,St,Ye)}return await V(W,{inputs_embeds:at,past_key_values:mt,attention_mask:Ye,position_ids:Je,generation_config:jt,logits_processor:Gt},!0)}async function ne(W,z){return await L(W,{...z,modality_input_name:"audio_values",modality_output_name:"audio_features",encode_function:W.encode_audio.bind(W),merge_function:W._merge_input_ids_with_audio_features.bind(W)})}async function de(W,z){return await L(W,{...z,modality_input_name:"pixel_values",modality_output_name:"image_features",encode_function:W.encode_image.bind(W),merge_function:W._merge_input_ids_with_image_features.bind(W)})}function we(W,z=0){const[me,Ue]=W.dims,$e=W.data,je=new BigInt64Array($e.length);for(let Ye=0;Ye<me;++Ye){const Je=Ye*Ue;let at=BigInt(z);for(let mt=0;mt<Ue;++mt){const jt=Je+mt;$e[jt]===0n?je[jt]=BigInt(1):(je[jt]=at,at+=$e[jt])}}return{data:je,dims:W.dims}}function be(W,z=null,me=0){const{input_ids:Ue,inputs_embeds:$e,attention_mask:je}=W,{data:Ye,dims:Je}=we(je,me);let at=new h.Tensor("int64",Ye,Je);if(z){const mt=-(Ue??$e).dims.at(1);at=at.slice(null,[mt,null])}return at}function Ee(W,z,me,Ue){if(me.past_key_values){const $e=Object.values(me.past_key_values)[0].dims.at(-2),{input_ids:je,attention_mask:Ye}=me;if(!(Ye&&Ye.dims[1]>je.dims[1])){if($e<je.dims[1])me.input_ids=je.slice(null,[$e,null]);else if(W.config.image_token_index!=null&&je.data.some(Je=>Je==W.config.image_token_index)){const Je=W.config.num_image_tokens;if(!Je)throw new Error("`num_image_tokens` is missing in the model configuration.");const at=je.dims[1]-($e-Je);me.input_ids=je.slice(null,[-at,null]),me.attention_mask=(0,h.ones)([1,$e+at])}}}return me}function Fe(W,z,me,Ue){return me.past_key_values&&(z=z.map($e=>[$e.at(-1)])),{...me,decoder_input_ids:C(z)}}function xe(W,...z){return W.config.is_encoder_decoder?Fe(W,...z):Ee(W,...z)}function ce(W,z,me,Ue){const $e=!!me.past_key_values;return Ue.guidance_scale!==null&&Ue.guidance_scale>1&&($e?me.input_ids=(0,h.cat)([me.input_ids,me.input_ids],0):(me.input_ids=(0,h.cat)([me.input_ids,(0,h.full_like)(me.input_ids,BigInt(Ue.pad_token_id))],0),me.attention_mask=(0,h.cat)([me.attention_mask,(0,h.full_like)(me.attention_mask,0n)],0))),($e||!me.pixel_values)&&(me.pixel_values=(0,h.full)([0,0,3,384,384],1)),$e&&(me.images_seq_mask=new h.Tensor("bool",new Array(1).fill(!0).fill(!1,0,1),[1,1]),me.images_emb_mask=new h.Tensor("bool",new Array(0).fill(!1),[1,1,0])),me}class ue extends a.Callable{main_input_name="input_ids";forward_params=["input_ids","attention_mask"];constructor(z,me,Ue){super(),this.config=z,this.sessions=me,this.configs=Ue;const $e=E.get(this.constructor),je=w.get($e);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,je){case x.DecoderOnly:this.can_generate=!0,this._forward=V,this._prepare_inputs_for_generation=Ee;break;case x.Seq2Seq:case x.Vision2Seq:case x.Musicgen:this.can_generate=!0,this._forward=B,this._prepare_inputs_for_generation=Fe;break;case x.EncoderDecoder:this._forward=B;break;case x.ImageTextToText:this.can_generate=!0,this._forward=de,this._prepare_inputs_for_generation=xe;break;case x.AudioTextToText:this.can_generate=!0,this._forward=ne,this._prepare_inputs_for_generation=xe;break;case x.Phi3V:this.can_generate=!0,this._prepare_inputs_for_generation=xe;break;case x.MultiModality:this.can_generate=!0,this._prepare_inputs_for_generation=ce;break;case x.AutoEncoder:this._forward=X;break;default:this._forward=$;break}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=this.config["transformers.js_config"]??{}}async dispose(){const z=[];for(const me of Object.values(this.sessions))me?.handler?.dispose&&z.push(me.handler.dispose());return await Promise.all(z)}static async from_pretrained(z,{progress_callback:me=null,config:Ue=null,cache_dir:$e=null,local_files_only:je=!1,revision:Ye="main",model_file_name:Je=null,subfolder:at="onnx",device:mt=null,dtype:jt=null,use_external_data_format:Gt=null,session_options:Et={}}={}){let Dt={progress_callback:me,config:Ue,cache_dir:$e,local_files_only:je,revision:Ye,model_file_name:Je,subfolder:at,device:mt,dtype:jt,use_external_data_format:Gt,session_options:Et};const en=E.get(this),Ct=w.get(en);Ue=Dt.config=await r.AutoConfig.from_pretrained(z,Dt);let St;if(Ct===x.DecoderOnly)St=await Promise.all([M(z,{model:Dt.model_file_name??"model"},Dt),F(z,{generation_config:"generation_config.json"},Dt)]);else if(Ct===x.Seq2Seq||Ct===x.Vision2Seq)St=await Promise.all([M(z,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},Dt),F(z,{generation_config:"generation_config.json"},Dt)]);else if(Ct===x.MaskGeneration)St=await Promise.all([M(z,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},Dt)]);else if(Ct===x.EncoderDecoder)St=await Promise.all([M(z,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},Dt)]);else if(Ct===x.ImageTextToText){const Yt={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};Ue.is_encoder_decoder&&(Yt.model="encoder_model"),St=await Promise.all([M(z,Yt,Dt),F(z,{generation_config:"generation_config.json"},Dt)])}else if(Ct===x.AudioTextToText){const Yt={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",decoder_model_merged:"decoder_model_merged"};St=await Promise.all([M(z,Yt,Dt),F(z,{generation_config:"generation_config.json"},Dt)])}else if(Ct===x.Musicgen)St=await Promise.all([M(z,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},Dt),F(z,{generation_config:"generation_config.json"},Dt)]);else if(Ct===x.MultiModality)St=await Promise.all([M(z,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},Dt),F(z,{generation_config:"generation_config.json"},Dt)]);else if(Ct===x.Phi3V)St=await Promise.all([M(z,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},Dt),F(z,{generation_config:"generation_config.json"},Dt)]);else if(Ct===x.AutoEncoder)St=await Promise.all([M(z,{encoder_model:"encoder_model",decoder_model:"decoder_model"},Dt)]);else{if(Ct!==x.EncoderOnly){const Yt=en??Ue?.model_type;Yt!=="custom"&&console.warn(`Model type for '${Yt}' not found, assuming encoder-only architecture. Please report this at ${c.GITHUB_ISSUE_URL}.`)}St=await Promise.all([M(z,{model:Dt.model_file_name??"model"},Dt)])}return new this(Ue,...St)}async _call(z){return await this.forward(z)}async forward(z){return await this._forward(this,z)}get generation_config(){return this.configs?.generation_config??null}_get_logits_warper(z){const me=new u.LogitsProcessorList;return z.temperature!==null&&z.temperature!==1&&me.push(new u.TemperatureLogitsWarper(z.temperature)),z.top_k!==null&&z.top_k!==0&&me.push(new u.TopKLogitsWarper(z.top_k)),z.top_p!==null&&z.top_p<1&&me.push(new u.TopPLogitsWarper(z.top_p)),me}_get_logits_processor(z,me,Ue=null){const $e=new u.LogitsProcessorList;if(z.repetition_penalty!==null&&z.repetition_penalty!==1&&$e.push(new u.RepetitionPenaltyLogitsProcessor(z.repetition_penalty)),z.no_repeat_ngram_size!==null&&z.no_repeat_ngram_size>0&&$e.push(new u.NoRepeatNGramLogitsProcessor(z.no_repeat_ngram_size)),z.bad_words_ids!==null&&$e.push(new u.NoBadWordsLogitsProcessor(z.bad_words_ids,z.eos_token_id)),z.min_length!==null&&z.eos_token_id!==null&&z.min_length>0&&$e.push(new u.MinLengthLogitsProcessor(z.min_length,z.eos_token_id)),z.min_new_tokens!==null&&z.eos_token_id!==null&&z.min_new_tokens>0&&$e.push(new u.MinNewTokensLengthLogitsProcessor(me,z.min_new_tokens,z.eos_token_id)),z.forced_bos_token_id!==null&&$e.push(new u.ForcedBOSTokenLogitsProcessor(z.forced_bos_token_id)),z.forced_eos_token_id!==null&&$e.push(new u.ForcedEOSTokenLogitsProcessor(z.max_length,z.forced_eos_token_id)),z.begin_suppress_tokens!==null){const je=me>1||z.forced_bos_token_id===null?me:me+1;$e.push(new u.SuppressTokensAtBeginLogitsProcessor(z.begin_suppress_tokens,je))}return z.guidance_scale!==null&&z.guidance_scale>1&&$e.push(new u.ClassifierFreeGuidanceLogitsProcessor(z.guidance_scale)),Ue!==null&&$e.extend(Ue),$e}_prepare_generation_config(z,me,Ue=d.GenerationConfig){const $e={...this.config};for(const Ye of["decoder","generator","text_config"])Ye in $e&&Object.assign($e,$e[Ye]);const je=new Ue($e);return Object.assign(je,this.generation_config??{}),z&&Object.assign(je,z),me&&Object.assign(je,(0,o.pick)(me,Object.getOwnPropertyNames(je))),je}_get_stopping_criteria(z,me=null){const Ue=new g.StoppingCriteriaList;return z.max_length!==null&&Ue.push(new g.MaxLengthCriteria(z.max_length,this.config.max_position_embeddings??null)),z.eos_token_id!==null&&Ue.push(new g.EosTokenCriteria(z.eos_token_id)),me&&Ue.extend(me),Ue}_validate_model_class(){if(!this.can_generate){const z=[T1,E1,x1,w1],me=E.get(this.constructor),Ue=new Set,$e=this.config.model_type;for(const Ye of z){const Je=Ye.get($e);Je&&Ue.add(Je[0])}let je=`The current model class (${me}) is not compatible with \`.generate()\`, as it doesn't have a language model head.`;throw Ue.size>0&&(je+=` Please use the following class instead: ${[...Ue].join(", ")}`),Error(je)}}prepare_inputs_for_generation(...z){return this._prepare_inputs_for_generation(this,...z)}_update_model_kwargs_for_generation({generated_input_ids:z,outputs:me,model_inputs:Ue,is_encoder_decoder:$e}){return Ue.past_key_values=this.getPastKeyValues(me,Ue.past_key_values),Ue.input_ids=new h.Tensor("int64",z.flat(),[z.length,1]),$e||(Ue.attention_mask=(0,h.cat)([Ue.attention_mask,(0,h.ones)([Ue.attention_mask.dims[0],1])],1)),Ue.position_ids=null,Ue}_prepare_model_inputs({inputs:z,bos_token_id:me,model_kwargs:Ue}){const $e=(0,o.pick)(Ue,this.forward_params),je=this.main_input_name;if(je in $e){if(z)throw new Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else $e[je]=z;return{inputs_tensor:$e[je],model_inputs:$e,model_input_name:je}}async _prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:z,model_inputs:me,model_input_name:Ue,generation_config:$e}){if(this.sessions.model.inputNames.includes("inputs_embeds")&&!me.inputs_embeds&&"_prepare_inputs_embeds"in this){const{input_ids:Ye,pixel_values:Je,attention_mask:at,...mt}=me,jt=await this._prepare_inputs_embeds(me);me={...mt,...(0,o.pick)(jt,["inputs_embeds","attention_mask"])}}let{last_hidden_state:je}=await $(this,me);if($e.guidance_scale!==null&&$e.guidance_scale>1)je=(0,h.cat)([je,(0,h.full_like)(je,0)],0),"attention_mask"in me&&(me.attention_mask=(0,h.cat)([me.attention_mask,(0,h.zeros_like)(me.attention_mask)],0));else if(me.decoder_input_ids){const Ye=C(me.decoder_input_ids).dims[0];if(Ye!==je.dims[0]){if(je.dims[0]!==1)throw new Error(`The encoder outputs have a different batch size (${je.dims[0]}) than the decoder inputs (${Ye}).`);je=(0,h.cat)(Array.from({length:Ye},()=>je),0)}}return me.encoder_outputs=je,me}_prepare_decoder_input_ids_for_generation({batch_size:z,model_input_name:me,model_kwargs:Ue,decoder_start_token_id:$e,bos_token_id:je,generation_config:Ye}){let{decoder_input_ids:Je,...at}=Ue;if(!(Je instanceof h.Tensor)){if(Je)Array.isArray(Je[0])||(Je=Array.from({length:z},()=>Je));else if($e??=je,this.config.model_type==="musicgen")Je=Array.from({length:z*this.config.decoder.num_codebooks},()=>[$e]);else if(Array.isArray($e)){if($e.length!==z)throw new Error(`\`decoder_start_token_id\` expcted to have length ${z} but got ${$e.length}`);Je=$e}else Je=Array.from({length:z},()=>[$e]);Je=C(Je)}return Ue.decoder_attention_mask=(0,h.ones_like)(Je),{input_ids:Je,model_inputs:at}}async generate({inputs:z=null,generation_config:me=null,logits_processor:Ue=null,stopping_criteria:$e=null,streamer:je=null,...Ye}){this._validate_model_class(),me=this._prepare_generation_config(me,Ye);let{inputs_tensor:Je,model_inputs:at,model_input_name:mt}=this._prepare_model_inputs({inputs:z,model_kwargs:Ye});const jt=this.config.is_encoder_decoder;jt&&("encoder_outputs"in at||(at=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:Je,model_inputs:at,model_input_name:mt,generation_config:me})));let Gt;jt?{input_ids:Gt,model_inputs:at}=this._prepare_decoder_input_ids_for_generation({batch_size:at[mt].dims.at(0),model_input_name:mt,model_kwargs:at,decoder_start_token_id:me.decoder_start_token_id,bos_token_id:me.bos_token_id,generation_config:me}):Gt=at[mt];let Et=Gt.dims.at(-1);me.max_new_tokens!==null&&(me.max_length=Et+me.max_new_tokens);const Dt=this._get_logits_processor(me,Et,Ue),en=this._get_stopping_criteria(me,$e),Ct=at[mt].dims.at(0),St=b.LogitsSampler.getSampler(me),Yt=new Array(Ct).fill(0),gn=Gt.tolist();je&&je.put(gn);let Kn,Jt={};for(;;){if(at=this.prepare_inputs_for_generation(gn,at,me),Kn=await this.forward(at),me.output_attentions&&me.return_dict_in_generate){const ni=this.getAttentions(Kn);for(const Ha in ni)Ha in Jt||(Jt[Ha]=[]),Jt[Ha].push(ni[Ha])}const tr=Kn.logits.slice(null,-1,null),Vr=Dt(gn,tr),Ui=[];for(let ni=0;ni<Vr.dims.at(0);++ni){const Ha=Vr[ni],$p=await St(Ha);for(const[M1,qb]of $p){const Np=BigInt(M1);Yt[ni]+=qb,gn[ni].push(Np),Ui.push([Np]);break}}if(je&&je.put(Ui),en(gn).every(ni=>ni))break;at=this._update_model_kwargs_for_generation({generated_input_ids:Ui,outputs:Kn,model_inputs:at,is_encoder_decoder:jt})}je&&je.end();const Ln=this.getPastKeyValues(Kn,at.past_key_values,!0),xn=new h.Tensor("int64",gn.flat(),[gn.length,gn[0].length]);if(me.return_dict_in_generate)return{sequences:xn,past_key_values:Ln,...Jt};for(const tr of Object.values(Kn))tr.location==="gpu-buffer"&&tr.dispose();return xn}getPastKeyValues(z,me,Ue=!1){const $e=Object.create(null);for(const je in z)if(je.startsWith("present")){const Ye=je.replace("present","past_key_values"),Je=je.includes("encoder");if(Je&&me?$e[Ye]=me[Ye]:$e[Ye]=z[je],me&&(!Je||Ue)){const at=me[Ye];at.location==="gpu-buffer"&&at.dispose()}}return $e}getAttentions(z){const me={};for(const Ue of["cross_attentions","encoder_attentions","decoder_attentions"])for(const $e in z)$e.startsWith(Ue)&&(Ue in me||(me[Ue]=[]),me[Ue].push(z[$e]));return me}addPastKeyValues(z,me){if(me)Object.assign(z,me);else{const $e=(this.sessions.decoder_model_merged??this.sessions.model)?.config?.kv_cache_dtype??"float32",je=$e==="float16"?new h.DataTypeMap.float16:[],Ye=(z[this.main_input_name]??z.attention_mask)?.dims?.[0]??1,Je=(0,r.getKeyValueShapes)(this.config,{batch_size:Ye});for(const at in Je)z[at]=new h.Tensor($e,je,Je[at])}}async encode_image({pixel_values:z}){const me=(await S(this.sessions.vision_encoder,{pixel_values:z})).image_features;return this.config.num_image_tokens||(console.warn(`The number of image tokens was not set in the model configuration. Setting it to the number of features detected by the vision encoder (${me.dims[1]}).`),this.config.num_image_tokens=me.dims[1]),me}async encode_text({input_ids:z}){return(await S(this.sessions.embed_tokens,{input_ids:z})).inputs_embeds}async encode_audio({audio_values:z}){return(await S(this.sessions.audio_encoder,{audio_values:z})).audio_features}}class Se{}class U extends Se{constructor({last_hidden_state:z,hidden_states:me=null,attentions:Ue=null}){super(),this.last_hidden_state=z,this.hidden_states=me,this.attentions=Ue}}class he extends ue{}class pe extends he{}class ie extends he{async _call(z){return new Ir(await super._call(z))}}class re extends he{async _call(z){return new Bt(await super._call(z))}}class ge extends he{async _call(z){return new xr(await super._call(z))}}class Ce extends he{async _call(z){return new ti(await super._call(z))}}class q extends ue{}class te extends q{}class j extends q{async _call(z){return new Ir(await super._call(z))}}class ee extends q{async _call(z){return new Bt(await super._call(z))}}class se extends q{async _call(z){return new xr(await super._call(z))}}class ve extends ue{}class ke extends ve{}class Re extends ue{}class Oe extends Re{}class ze extends Re{async _call(z){return new Ir(await super._call(z))}}class Te extends Re{async _call(z){return new Bt(await super._call(z))}}class Be extends Re{async _call(z){return new xr(await super._call(z))}}class qe extends Re{async _call(z){return new ti(await super._call(z))}}class tt extends ue{}class xt extends tt{}class ft extends tt{async _call(z){return new Ir(await super._call(z))}}class Wt extends tt{async _call(z){return new Bt(await super._call(z))}}class Jn extends tt{async _call(z){return new xr(await super._call(z))}}class rr extends tt{async _call(z){return new ti(await super._call(z))}}class yr extends ue{}class ae extends yr{}class fe extends yr{async _call(z){return new Ir(await super._call(z))}}class Me extends yr{async _call(z){return new Bt(await super._call(z))}}class Ie extends yr{async _call(z){return new xr(await super._call(z))}}class it extends yr{async _call(z){return new ti(await super._call(z))}}class Tt extends ue{}class rn extends Tt{}class Un extends Tt{async _call(z){return new Ir(await super._call(z))}}class ur extends Tt{async _call(z){return new Bt(await super._call(z))}}class vr extends Tt{async _call(z){return new xr(await super._call(z))}}class dr extends Tt{async _call(z){return new ti(await super._call(z))}}class Dn extends ue{}class Ze extends Dn{}class ct extends Dn{async _call(z){return new Ir(await super._call(z))}}class rt extends Dn{async _call(z){return new Bt(await super._call(z))}}class Mn extends Dn{async _call(z){return new xr(await super._call(z))}}class ki extends Dn{async _call(z){return new ti(await super._call(z))}}class bn extends ue{}class mi extends bn{}class gi extends bn{async _call(z){return new Ir(await super._call(z))}}class ms extends bn{async _call(z){return new Bt(await super._call(z))}}class Lo extends bn{async _call(z){return new xr(await super._call(z))}}class Ro extends bn{async _call(z){return new ti(await super._call(z))}}class gs extends ue{}class ma extends gs{}class Bo extends gs{async _call(z){return new Bt(await super._call(z))}}class $o extends gs{async _call(z){return new xr(await super._call(z))}}class No extends gs{async _call(z){return new ti(await super._call(z))}}class zo extends gs{async _call(z){return new Ir(await super._call(z))}}class Rs extends ue{}class Wo extends Rs{}class Fi extends Rs{async _call(z){return new Ir(await super._call(z))}}class Jl extends Rs{async _call(z){return new Bt(await super._call(z))}}class Jr extends Rs{async _call(z){return new xr(await super._call(z))}}class _s extends ue{}class ga extends _s{}class _i extends _s{async _call(z){return new Ir(await super._call(z))}}class jo extends _s{async _call(z){return new Bt(await super._call(z))}}class ec extends _s{async _call(z){return new ti(await super._call(z))}}class kr extends ue{}class tc extends kr{}class za extends kr{async _call(z){return new Ir(await super._call(z))}}class bi extends kr{async _call(z){return new Bt(await super._call(z))}}class Wa extends kr{async _call(z){return new xr(await super._call(z))}}class wr extends kr{async _call(z){return new ti(await super._call(z))}}class ir extends ue{}class ja extends ir{}class nc extends ir{async _call(z){return new Ir(await super._call(z))}}class rc extends ir{async _call(z){return new Bt(await super._call(z))}}class ic extends ir{async _call(z){return new ti(await super._call(z))}}class _a extends ue{}class sc extends _a{}class Le extends _a{async _call(z){return new Bt(await super._call(z))}}class Y extends _a{async _call(z){return new ti(await super._call(z))}}class ye extends _a{async _call(z){return new Ir(await super._call(z))}}class De extends ue{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"]}class Pe extends De{}class We extends De{}class Ke extends ue{}class ot extends Ke{}class lt extends Ke{}class ut extends ue{}class st extends ut{}class Ht extends ut{}class Lt extends ue{}class An extends Lt{}class Vn extends Lt{}class Bn extends Lt{async _call(z){return new Bt(await super._call(z))}}class Gn extends ue{}class hr extends Gn{}class qi extends Gn{}class Va extends Gn{async _call(z){return new Bt(await super._call(z))}}class Wr extends Gn{}class Ii extends ue{}class Cn extends Ii{}class fr extends Ii{}class jr extends ue{}class yi extends jr{}class Fr extends jr{}class hn extends ue{}class Hi extends hn{}class qn extends hn{async _call(z){return new Ir(await super._call(z))}}class $n extends hn{async _call(z){return new Bt(await super._call(z))}}class Hn extends hn{async _call(z){return new xr(await super._call(z))}}class er extends hn{async _call(z){return new ti(await super._call(z))}}class sr extends ue{}class Vo extends sr{}class ac extends sr{async _call(z){return new Ir(await super._call(z))}}class A_ extends sr{async _call(z){return new Bt(await super._call(z))}}class oc extends sr{async _call(z){return new xr(await super._call(z))}}class C_ extends sr{async _call(z){return new ti(await super._call(z))}}class Go extends ue{}class lc extends Go{}class S_ extends Go{async _call(z){return new Ir(await super._call(z))}}class wf extends Go{async _call(z){return new Bt(await super._call(z))}}class P_ extends Go{async _call(z){return new xr(await super._call(z))}}class k_ extends Go{async _call(z){return new ti(await super._call(z))}}class xf extends ue{}class Tf extends xf{}class F_ extends xf{}class Ef extends ue{requires_attention_mask=!1;main_input_name="input_features";forward_params=["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"]}class I_ extends Ef{}class Df extends Ef{_prepare_generation_config(z,me){return super._prepare_generation_config(z,me,m.WhisperGenerationConfig)}_retrieve_init_tokens(z){const me=[z.decoder_start_token_id];let Ue=z.language;const $e=z.task;if(z.is_multilingual){Ue||(console.warn("No language specified - defaulting to English (en)."),Ue="en");const Ye=`<|${(0,v.whisper_language_to_code)(Ue)}|>`;me.push(z.lang_to_id[Ye]),me.push(z.task_to_id[$e??"transcribe"])}else if(Ue||$e)throw new Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!z.return_timestamps&&z.no_timestamps_token_id&&me.at(-1)!==z.no_timestamps_token_id?me.push(z.no_timestamps_token_id):z.return_timestamps&&me.at(-1)===z.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),me.pop()),me.filter(je=>je!=null)}async generate({inputs:z=null,generation_config:me=null,logits_processor:Ue=null,stopping_criteria:$e=null,...je}){me=this._prepare_generation_config(me,je);const Ye=je.decoder_input_ids??this._retrieve_init_tokens(me);if(me.return_timestamps&&(Ue??=new u.LogitsProcessorList,Ue.push(new u.WhisperTimeStampLogitsProcessor(me,Ye))),me.begin_suppress_tokens&&(Ue??=new u.LogitsProcessorList,Ue.push(new u.SuppressTokensAtBeginLogitsProcessor(me.begin_suppress_tokens,Ye.length))),me.return_token_timestamps){if(!me.alignment_heads)throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");me.task==="translate"&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),me.output_attentions=!0,me.return_dict_in_generate=!0}const Je=await super.generate({inputs:z,generation_config:me,logits_processor:Ue,decoder_input_ids:Ye,...je});return me.return_token_timestamps&&(Je.token_timestamps=this._extract_token_timestamps(Je,me.alignment_heads,me.num_frames)),Je}_extract_token_timestamps(z,me,Ue=null,$e=.02){if(!z.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");Ue==null&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let je=this.config.median_filter_width;je===void 0&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),je=7);const Ye=z.cross_attentions,Je=Array.from({length:this.config.decoder_layers},(Ct,St)=>(0,h.cat)(Ye.map(Yt=>Yt[St]),2)),at=(0,h.stack)(me.map(([Ct,St])=>{if(Ct>=Je.length)throw new Error(`Layer index ${Ct} is out of bounds for cross attentions (length ${Je.length}).`);return Ue?Je[Ct].slice(null,St,null,[0,Ue]):Je[Ct].slice(null,St)})).transpose(1,0,2,3),[mt,jt]=(0,h.std_mean)(at,-2,0,!0),Gt=at.clone();for(let Ct=0;Ct<Gt.dims[0];++Ct){const St=Gt[Ct];for(let Yt=0;Yt<St.dims[0];++Yt){const gn=St[Yt],Kn=mt[Ct][Yt][0].data,Jt=jt[Ct][Yt][0].data;for(let Ln=0;Ln<gn.dims[0];++Ln){let xn=gn[Ln].data;for(let tr=0;tr<xn.length;++tr)xn[tr]=(xn[tr]-Jt[tr])/Kn[tr];xn.set((0,p.medianFilter)(xn,je))}}}const Et=[(0,h.mean)(Gt,1)],Dt=z.sequences.dims,en=new h.Tensor("float32",new Float32Array(Dt[0]*Dt[1]),Dt);for(let Ct=0;Ct<Dt[0];++Ct){const St=Et[Ct].neg().squeeze_(0),[Yt,gn]=(0,p.dynamic_time_warping)(St.tolist()),Kn=Array.from({length:Yt.length-1},(xn,tr)=>Yt[tr+1]-Yt[tr]),Jt=(0,o.mergeArrays)([1],Kn).map(xn=>!!xn),Ln=[];for(let xn=0;xn<Jt.length;++xn)Jt[xn]&&Ln.push(gn[xn]*$e);en[Ct].data.set(Ln,1)}return en}}class O_ extends Df{}class Mf extends ue{requires_attention_mask=!1;main_input_name="input_values";forward_params=["input_values","decoder_input_ids","past_key_values"]}class Jv extends Mf{}class U_ extends Mf{}class Af extends ue{main_input_name="pixel_values";forward_params=["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"]}class L_ extends ue{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class sd extends L_{_merge_input_ids_with_image_features({inputs_embeds:z,image_features:me,input_ids:Ue,attention_mask:$e}){const je=this.config.image_token_index,Je=Ue.tolist().map(Et=>Et.findIndex(Dt=>Dt==je)),at=Je.every(Et=>Et===-1),mt=Je.every(Et=>Et!==-1);if(!at&&!mt)throw new Error("Every input should contain either 0 or 1 image token.");if(at)return{inputs_embeds:z,attention_mask:$e};const jt=[],Gt=[];for(let Et=0;Et<Je.length;++Et){const Dt=Je[Et],en=z[Et],Ct=me[Et],St=$e[Et];jt.push((0,h.cat)([en.slice([0,Dt]),Ct,en.slice([Dt+1,en.dims[0]])],0)),Gt.push((0,h.cat)([St.slice([0,Dt]),(0,h.ones)([Ct.dims[0]]),St.slice([Dt+1,St.dims[0]])],0))}return{inputs_embeds:(0,h.stack)(jt,0),attention_mask:(0,h.stack)(Gt,0)}}}class R_ extends sd{}class Cf extends sd{}class Sf extends ue{forward_params=["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"];main_input_name="inputs_embeds"}class Pf extends Sf{_merge_input_ids_with_image_features({inputs_embeds:z,image_features:me,input_ids:Ue,attention_mask:$e}){return{inputs_embeds:(0,h.cat)([me,z],1),attention_mask:(0,h.cat)([(0,h.ones)(me.dims.slice(0,2)),$e],1)}}async _prepare_inputs_embeds({input_ids:z,pixel_values:me,inputs_embeds:Ue,attention_mask:$e}){if(!z&&!me)throw new Error("Either `input_ids` or `pixel_values` should be provided.");let je,Ye;return z&&(je=await this.encode_text({input_ids:z})),me&&(Ye=await this.encode_image({pixel_values:me})),je&&Ye?{inputs_embeds:Ue,attention_mask:$e}=this._merge_input_ids_with_image_features({inputs_embeds:je,image_features:Ye,input_ids:z,attention_mask:$e}):Ue=je||Ye,{inputs_embeds:Ue,attention_mask:$e}}async forward({input_ids:z,pixel_values:me,attention_mask:Ue,decoder_input_ids:$e,decoder_attention_mask:je,encoder_outputs:Ye,past_key_values:Je,inputs_embeds:at,decoder_inputs_embeds:mt}){if(at||({inputs_embeds:at,attention_mask:Ue}=await this._prepare_inputs_embeds({input_ids:z,pixel_values:me,inputs_embeds:at,attention_mask:Ue})),!Ye){let{last_hidden_state:Et}=await $(this,{inputs_embeds:at,attention_mask:Ue});Ye=Et}if(!mt){if(!$e)throw new Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");mt=await this.encode_text({input_ids:$e})}return await V(this,{inputs_embeds:mt,attention_mask:je,encoder_attention_mask:Ue,encoder_hidden_states:Ye,past_key_values:Je},!0)}}class B_ extends ue{forward_params=["input_ids","attention_mask","pixel_values","position_ids","past_key_values"]}class $_ extends B_{_merge_input_ids_with_image_features(z){const me=z.image_features.dims.at(-1),Ue=z.image_features.view(-1,me);return R({image_token_id:this.config.image_token_index,...z,image_features:Ue})}}class kf extends ue{forward_params=["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"]}class cc extends kf{async encode_image({pixel_values:z,pixel_attention_mask:me}){return(await S(this.sessions.vision_encoder,{pixel_values:z,pixel_attention_mask:me})).image_features}_merge_input_ids_with_image_features(z){const me=z.image_features.dims.at(-1),Ue=z.image_features.view(-1,me);return R({image_token_id:this.config.image_token_id,...z,image_features:Ue})}}class Ga extends cc{}class N_ extends ue{forward_params=["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"]}class ad extends N_{async forward({input_ids:z=null,attention_mask:me=null,pixel_values:Ue=null,image_sizes:$e=null,position_ids:je=null,inputs_embeds:Ye=null,past_key_values:Je=null,generation_config:at=null,logits_processor:mt=null,...jt}){if(!Ye){let Et;if(Ue&&z.dims[1]!==1){if(!$e)throw new Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:Et}=await S(this.sessions.vision_encoder,{pixel_values:Ue,image_sizes:$e}))}else{const Dt=this.config.normalized_config.hidden_size;Et=new h.Tensor("float32",[],[0,Dt])}({inputs_embeds:Ye}=await S(this.sessions.prepare_inputs_embeds,{input_ids:z,image_features:Et}))}return await V(this,{inputs_embeds:Ye,past_key_values:Je,attention_mask:me,position_ids:je,generation_config:at,logits_processor:mt},!1)}}class qa extends ue{}class z_ extends qa{}class e1 extends qa{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"text_model"})}}class od extends qa{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"text_model"})}}class W_ extends qa{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"vision_model"})}}class j_ extends qa{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"vision_model"})}}class Ff extends ue{}class V_ extends Ff{}class G_ extends Ff{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"text_model"})}}class q_ extends qa{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"vision_model"})}}class H_ extends ue{}class K_ extends H_{}class ld extends ue{}class X_ extends ld{async forward(z){const me=!z.input_ids,Ue=!z.pixel_values;if(me&&Ue)throw new Error("Either `input_ids` or `pixel_values` should be provided.");if(me&&(z.input_ids=(0,h.ones)([z.pixel_values.dims[0],1])),Ue){const{image_size:mt}=this.config.vision_config;z.pixel_values=(0,h.full)([0,3,mt,mt],0)}const{text_embeddings:$e,image_embeddings:je,l2norm_text_embeddings:Ye,l2norm_image_embeddings:Je}=await super.forward(z),at={};return me||(at.text_embeddings=$e,at.l2norm_text_embeddings=Ye),Ue||(at.image_embeddings=je,at.l2norm_image_embeddings=Je),at}}class uc extends ld{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"text_model"})}}class qo extends ld{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"vision_model"})}}class cd extends ue{}class Y_ extends cd{}class Q_ extends cd{}class dc extends ue{}class ud extends dc{}class If extends dc{}class dd extends ue{}class Of extends dd{}class Uf extends dd{}class hd extends ue{}class Lf extends hd{}class Z_ extends hd{}class fd extends ue{}class J_ extends fd{}class Rf extends fd{}class Ho extends ue{}class Qe extends Ho{}class eb extends Ho{}class pd extends ue{}class Bf extends pd{}class hc extends pd{}class Oi extends ue{}class fc extends Oi{}class md extends Oi{}class gd extends ue{}class $f extends gd{}class Nf extends gd{}class pc extends ue{}class zf extends pc{}class Wf extends pc{}class It extends ue{}class Ko extends It{}class jf extends It{}class kt extends ue{}class _d extends kt{}class Ot extends kt{}class bd extends ue{}class Vf extends bd{}class Gf extends bd{}class yd extends ue{}class qf extends yd{}class Hf extends yd{}class mc extends ue{}class Kf extends mc{}class Xf extends mc{}class vd extends ue{}class Yf extends vd{}class Qf extends vd{}class wd extends ue{}class Zf extends wd{}class Jf extends wd{}class xd extends ue{}class ep extends xd{}class tp extends xd{}class Td extends ue{}class np extends Td{}class rp extends Td{}class Ed extends ue{}class ip extends Ed{}class sp extends Ed{}class Dd extends ue{}class ap extends Dd{}class op extends Dd{}class lp extends ue{forward_params=["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"]}class cp extends lp{get_rope_index(z,me,Ue,$e){const{vision_config:je,image_token_id:Ye,video_token_id:Je,vision_start_token_id:at}=this.config,mt=je.spatial_merge_size??2,jt=[];if(me||Ue){let Gt=z.tolist();$e||($e=(0,h.ones_like)(z));const Et=$e.tolist(),Dt=Array.from({length:3},gn=>Array.from({length:z.dims[0]},Kn=>Array.from({length:z.dims[1]},Jt=>1))),en=me?me.tolist():[],Ct=Ue?Ue.tolist():[];let St=0,Yt=0;for(let gn=0;gn<Gt.length;++gn){const Kn=Gt[gn].filter((kn,pr)=>Et[gn][pr]==1),Ln=Kn.reduce((kn,pr,Qo)=>(pr==at&&kn.push(Qo),kn),[]).map(kn=>Kn[kn+1]),xn=Ln.filter(kn=>kn==Ye).length,tr=Ln.filter(kn=>kn==Je).length;let Vr=[],Ui=0,Gb=xn,ni=tr;for(let kn=0;kn<Ln.length;++kn){const pr=Kn.findIndex((bc,Bs)=>Bs>Ui&&bc==Ye),Qo=Kn.findIndex((bc,Bs)=>Bs>Ui&&bc==Je),_c=Gb>0&&pr!==-1?pr:Kn.length+1,Rd=ni>0&&Qo!==-1?Qo:Kn.length+1;let Hb,A1,C1,S1;_c<Rd?([A1,C1,S1]=en[St],++St,--Gb,Hb=_c):([A1,C1,S1]=Ct[Yt],++Yt,--ni,Hb=Rd);const[r5,P1,Kb]=[Number(A1),Math.floor(Number(C1)/mt),Math.floor(Number(S1)/mt)],k1=Hb-Ui,JC=Vr.length>0?(0,p.max)(Vr.at(-1))[0]+1:0;Vr.push(Array.from({length:3*k1},(bc,Bs)=>JC+Bs%k1));const F1=k1+JC,Xb=r5*P1*Kb,i5=Array.from({length:Xb},(bc,Bs)=>F1+Math.floor(Bs/(P1*Kb))),s5=Array.from({length:Xb},(bc,Bs)=>F1+Math.floor(Bs/Kb)%P1),a5=Array.from({length:Xb},(bc,Bs)=>F1+Bs%Kb);Vr.push([i5,s5,a5].flat()),Ui=Hb+Xb}if(Ui<Kn.length){const kn=Vr.length>0?(0,p.max)(Vr.at(-1))[0]+1:0,pr=Kn.length-Ui;Vr.push(Array.from({length:3*pr},(Qo,_c)=>kn+_c%pr))}const Ha=Vr.reduce((kn,pr)=>kn+pr.length,0),$p=new Array(Ha);let M1=0;for(let kn=0;kn<3;++kn)for(let pr=0;pr<Vr.length;++pr){const Qo=Vr[pr],_c=Qo.length/3;for(let Rd=kn*_c;Rd<(kn+1)*_c;++Rd)$p[M1++]=Qo[Rd]}let qb=0;const Np=Et[gn];for(let kn=0;kn<Np.length;++kn)if(Np[kn]==1){for(let pr=0;pr<3;++pr)Dt[pr][gn][kn]=$p[pr*Ha/3+qb];++qb}const n5=(0,p.max)($p)[0];jt.push(n5+1-Gt[gn].length)}return[new h.Tensor("int64",Dt.flat(1/0),[3,z.dims[0],z.dims[1]]),new h.Tensor("int64",jt,[jt.length,1])]}else if($e){const{data:Gt,dims:Et}=we($e),Dt=BigInt64Array.from({length:3*Gt.length},(Ct,St)=>Gt[St%Gt.length]),en=Array.from({length:Et[0]},(Ct,St)=>(0,p.max)(Gt.subarray(Et[1]*St,Et[1]*(St+1)))[0]+1n+BigInt(Et[1]));return[new h.Tensor("int64",Dt,[3,...Et]),new h.Tensor("int64",en,[en.length,1])]}else{const[Gt,Et]=z.dims,Dt=BigInt64Array.from({length:3*Gt*Et},(en,Ct)=>BigInt(Math.floor(Ct%Et/Gt)));return[new h.Tensor("int64",Dt,[3,...z.dims]),(0,h.zeros)([Gt,1])]}}async encode_image({pixel_values:z,image_grid_thw:me}){return(await S(this.sessions.vision_encoder,{pixel_values:z,grid_thw:me})).image_features}_merge_input_ids_with_image_features(z){return R({image_token_id:this.config.image_token_id,...z})}prepare_inputs_for_generation(z,me,Ue){if(me.attention_mask&&!me.position_ids)if(!me.past_key_values)[me.position_ids,me.rope_deltas]=this.get_rope_index(me.input_ids,me.image_grid_thw,me.video_grid_thw,me.attention_mask);else{me.pixel_values=null;const $e=BigInt(Object.values(me.past_key_values)[0].dims.at(-2)),je=me.rope_deltas.map(Ye=>$e+Ye);me.position_ids=(0,h.stack)([je,je,je],0)}return me}}class Md extends ue{}class up extends Md{}class dp extends Md{}class Ad extends ue{}class hp extends Ad{}class fp extends Ad{}class Cd extends ue{}class pp extends Cd{}class mp extends Cd{}class Sd extends ue{}class gp extends Sd{}class _p extends Sd{}class Pd extends ue{}class bp extends Pd{}class yp extends Pd{}class kd extends ue{}class vp extends kd{}class wp extends kd{async _call(z){return new Bt(await super._call(z))}}class Fd extends ue{}class xp extends Fd{}class Tp extends Fd{async _call(z){return new Bt(await super._call(z))}}class Ep extends ue{}class Dp extends Ep{}class Id extends ue{}class tb extends Id{}class nb extends Id{async _call(z){return new Bt(await super._call(z))}}class rb extends ue{}class ib extends rb{}class Mp extends ue{}class sb extends Mp{}class ab extends Mp{async _call(z){return new Bt(await super._call(z))}}class ob extends ue{}class lb extends ob{}class Ap extends ue{}class cb extends Ap{}class ub extends Ap{async _call(z){return new Bt(await super._call(z))}}class db extends ue{}class hb extends db{async _call(z){return new QC(await super._call(z))}}class Cp extends ue{}class fb extends Cp{}class pb extends Cp{async _call(z){return new Bt(await super._call(z))}}class Sp extends ue{}class mb extends Sp{}class gb extends Sp{async _call(z){return new Bt(await super._call(z))}}class Pp extends ue{}class _b extends Pp{}class bb extends Pp{}class kp extends ue{}class yb extends kp{}class vb extends kp{}class Fp extends ue{}class wb extends Fp{}class xb extends Fp{async _call(z){return new Bt(await super._call(z))}}class Od extends ue{}class Tb extends Od{}class Eb extends Od{async _call(z){return new Op(await super._call(z))}}class Ip extends Od{async _call(z){return new Db(await super._call(z))}}class Op extends Se{constructor({logits:z,pred_boxes:me}){super(),this.logits=z,this.pred_boxes=me}}class Db extends Se{constructor({logits:z,pred_boxes:me,pred_masks:Ue}){super(),this.logits=z,this.pred_boxes=me,this.pred_masks=Ue}}class Up extends ue{}class Mb extends Up{}class Ab extends Up{async _call(z){return new Cb(await super._call(z))}}class Cb extends Se{constructor({logits:z,pred_boxes:me}){super(),this.logits=z,this.pred_boxes=me}}class Lp extends ue{}class Sb extends Lp{}class Pb extends Lp{async _call(z){return new kb(await super._call(z))}}class kb extends Op{}class Rp extends ue{}class Fb extends Rp{}class D extends Rp{async _call(z){return new Bt(await super._call(z))}}class P extends ue{}class N extends P{}class K extends P{async _call(z){return new Bt(await super._call(z))}}class J extends ue{}class _e extends J{}class Ae extends J{async _call(z){return new Bt(await super._call(z))}}class Ne extends ue{}class Ge extends Ne{}class et extends Ne{async _call(z){return new Bt(await super._call(z))}}class dt extends Ne{}class wt extends ue{}class Rt extends wt{}class mn extends wt{}class ei extends ue{}class Xo extends ei{}class BD extends ei{}class $D extends ue{}class ND extends $D{}class Ib extends ue{}class zD extends Ib{}class WD extends Ib{}class jD extends Ib{}class VD extends ue{}class GD extends VD{}class t1 extends ue{}class qD extends t1{}class HD extends t1{}class n1 extends ue{}class KD extends n1{}class XD extends n1{}class YD extends ue{}class QD extends YD{}class r1 extends ue{}class ZD extends r1{}class JD extends r1{async _call(z){return new Bt(await super._call(z))}}class i1 extends ue{}class eM extends i1{}class tM extends i1{async _call(z){return new Bt(await super._call(z))}}class s1 extends ue{}class nM extends s1{}class rM extends s1{async _call(z){return new Bt(await super._call(z))}}class a1 extends ue{}class iM extends a1{}class sM extends a1{async _call(z){return new Bt(await super._call(z))}}class aM extends ue{}class oM extends aM{}class o1 extends ue{}class lM extends o1{}class cM extends o1{async _call(z){return new uM(await super._call(z))}}class uM extends Se{constructor({logits:z,pred_boxes:me}){super(),this.logits=z,this.pred_boxes=me}}class dM extends ue{}class hM extends dM{async get_image_embeddings({pixel_values:z}){return await $(this,{pixel_values:z})}async forward(z){if((!z.image_embeddings||!z.image_positional_embeddings)&&(z={...z,...await this.get_image_embeddings(z)}),!z.input_labels&&z.input_points){const Ue=z.input_points.dims.slice(0,-1),$e=Ue.reduce((je,Ye)=>je*Ye,1);z.input_labels=new h.Tensor("int64",new BigInt64Array($e).fill(1n),Ue)}const me={image_embeddings:z.image_embeddings,image_positional_embeddings:z.image_positional_embeddings};return z.input_points&&(me.input_points=z.input_points),z.input_labels&&(me.input_labels=z.input_labels),z.input_boxes&&(me.input_boxes=z.input_boxes),await S(this.sessions.prompt_encoder_mask_decoder,me)}async _call(z){return new fM(await super._call(z))}}class fM extends Se{constructor({iou_scores:z,pred_masks:me}){super(),this.iou_scores=z,this.pred_masks=me}}class l1 extends ue{}class pM extends l1{}class mM extends l1{}class c1 extends ue{}class gM extends c1{}class _M extends c1{}class Yo extends ue{}class bM extends Yo{}class yM extends Yo{async _call(z){return new gc(await super._call(z))}}class vM extends Yo{async _call(z){return new Bt(await super._call(z))}}class wM extends Yo{async _call(z){return new xr(await super._call(z))}}class u1 extends ue{}class xM extends u1{}class TM extends u1{async _call(z){return new xr(await super._call(z))}}class EM extends ue{}class DM extends EM{}class Ob extends ue{}class MM extends Ob{}class AM extends Ob{async _call(z){return new gc(await super._call(z))}}class CM extends Ob{async _call(z){return new Bt(await super._call(z))}}class Bp extends ue{}class SM extends Bp{}class PM extends Bp{async _call(z){return new gc(await super._call(z))}}class kM extends Bp{async _call(z){return new Bt(await super._call(z))}}class FM extends Bp{async _call(z){return new xr(await super._call(z))}}class Ub extends ue{}class IM extends Ub{}class OM extends Ub{async _call(z){return new gc(await super._call(z))}}class UM extends Ub{async _call(z){return new Bt(await super._call(z))}}class z8 extends ue{}class LM extends Yo{}class RM extends Yo{async _call(z){return new gc(await super._call(z))}}class BM extends Yo{async _call(z){return new Bt(await super._call(z))}}class Ud extends ue{}class $M extends Ud{}class NM extends Ud{async _call(z){return new gc(await super._call(z))}}class zM extends Ud{async _call(z){return new Bt(await super._call(z))}}class WM extends Ud{async _call(z){return new YC(await super._call(z))}}class jM extends Ud{async _call(z){return new xr(await super._call(z))}}class VM extends ue{}class GM extends VM{}class Lb extends ue{}class W8 extends Lb{}class qM extends Lb{}class HM extends Lb{async generate_speech(z,me,{threshold:Ue=.5,minlenratio:$e=0,maxlenratio:je=20,vocoder:Ye=null}={}){const Je={input_ids:z},{encoder_outputs:at,encoder_attention_mask:mt}=await $(this,Je),jt=at.dims[1]/this.config.reduction_factor,Gt=Math.floor(jt*je),Et=Math.floor(jt*$e),Dt=this.config.num_mel_bins;let en=[],Ct=null,St=null,Yt=0;for(;;){++Yt;const Jt=H(!!St);let Ln;St?Ln=St.output_sequence_out:Ln=new h.Tensor("float32",new Float32Array(Dt),[1,1,Dt]);let xn={use_cache_branch:Jt,output_sequence:Ln,encoder_attention_mask:mt,speaker_embeddings:me,encoder_hidden_states:at};this.addPastKeyValues(xn,Ct),St=await S(this.sessions.decoder_model_merged,xn),Ct=this.getPastKeyValues(St,Ct);const{prob:tr,spectrum:Vr}=St;if(en.push(Vr),Yt>=Et&&(Array.from(tr.data).filter(Ui=>Ui>=Ue).length>0||Yt>=Gt))break}const gn=(0,h.cat)(en),{waveform:Kn}=await S(Ye.sessions.model,{spectrogram:gn});return{spectrogram:gn,waveform:Kn}}}class KM extends ue{main_input_name="spectrogram"}class XM extends ue{}class YM extends XM{}class d1 extends ue{}class QM extends d1{}class ZM extends d1{}class h1 extends ue{}class JM extends h1{}class eA extends h1{}class f1 extends ue{}class tA extends f1{}class nA extends f1{}class Rb extends ue{}class rA extends Rb{}class iA extends Rb{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"text_model"})}}class sA extends Rb{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"audio_model"})}}class aA extends ue{}class p1 extends aA{async _call(z){return new ZC(await super._call(z))}}class Bb extends ue{}class j8 extends Bb{}class oA extends Bb{}class lA extends Bb{}class m1 extends ue{}class cA extends m1{}class uA extends m1{}class g1 extends ue{}class dA extends g1{}class hA extends g1{async _call(z){return new Bt(await super._call(z))}}class _1 extends ue{}class V8 extends _1{}class G8 extends _1{}class b1 extends ue{forward_params=["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"];_apply_and_filter_by_delay_pattern_mask(z){const[me,Ue]=z.dims,$e=this.config.decoder.num_codebooks,je=Ue-$e;let Ye=0;for(let mt=0;mt<z.size;++mt){if(z.data[mt]===this.config.decoder.pad_token_id)continue;const jt=mt%Ue,Gt=Math.floor(mt/Ue)%$e,Et=jt-Gt;Et>0&&Et<=je&&(z.data[Ye++]=z.data[mt])}const Je=Math.floor(me/$e),at=Ye/(Je*$e);return new h.Tensor(z.type,z.data.slice(0,Ye),[Je,$e,at])}prepare_inputs_for_generation(z,me,Ue){let $e=structuredClone(z);for(let Ye=0;Ye<$e.length;++Ye)for(let Je=0;Je<$e[Ye].length;++Je)Ye%this.config.decoder.num_codebooks>=Je&&($e[Ye][Je]=BigInt(this.config.decoder.pad_token_id));return Ue.guidance_scale!==null&&Ue.guidance_scale>1&&($e=$e.concat($e)),super.prepare_inputs_for_generation($e,me,Ue)}async generate(z){const me=await super.generate(z),Ue=this._apply_and_filter_by_delay_pattern_mask(me).unsqueeze_(0),{audio_values:$e}=await S(this.sessions.encodec_decode,{audio_codes:Ue});return $e}}class $b extends ue{}class fA extends $b{}class pA extends $b{async _call(z){return new Bt(await super._call(z))}}class mA extends $b{}class Nb extends ue{}class gA extends Nb{}class _A extends Nb{async _call(z){return new Bt(await super._call(z))}}class bA extends Nb{}class zb extends ue{}class yA extends zb{}class vA extends zb{async _call(z){return new Bt(await super._call(z))}}class wA extends zb{}class Wb extends ue{}class xA extends Wb{}class TA extends Wb{async _call(z){return new Bt(await super._call(z))}}class EA extends Wb{}class DA extends ue{}class MA extends DA{}class AA extends ue{}class CA extends AA{forward_params=["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"];constructor(...z){super(...z),this._generation_mode="text"}async forward(z){const me=this._generation_mode??"text";let Ue;if(me==="text"||!z.past_key_values){const at=this.sessions.prepare_inputs_embeds,mt=(0,o.pick)(z,at.inputNames);Ue=await S(at,mt)}else{const at=this.sessions.gen_img_embeds,mt=(0,o.pick)({image_ids:z.input_ids},at.inputNames);Ue=await S(at,mt)}const $e={...z,...Ue},je=await V(this,$e),Ye=this.sessions[me==="text"?"lm_head":"gen_head"];if(!Ye)throw new Error(`Unable to find "${Ye}" generation head`);const Je=await S(Ye,(0,o.pick)(je,Ye.inputNames));return{...Ue,...je,...Je}}async generate(z){return this._generation_mode="text",super.generate(z)}async generate_images(z){this._generation_mode="image";const me=(z.inputs??z[this.main_input_name]).dims[1],$e=(await super.generate(z)).slice(null,[me,null]),je=this.sessions.image_decode,{decoded_image:Ye}=await S(je,{generated_tokens:$e}),Je=Ye.add_(1).mul_(255/2).clamp_(0,255).to("uint8"),at=[];for(const mt of Je){const jt=f.RawImage.fromTensor(mt);at.push(jt)}return at}}class SA extends Se{constructor({char_logits:z,bpe_logits:me,wp_logits:Ue}){super(),this.char_logits=z,this.bpe_logits=me,this.wp_logits=Ue}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class PA extends ue{}class kA extends PA{async _call(z){return new SA(await super._call(z))}}class y1 extends ue{}class FA extends y1{}class IA extends y1{}class v1 extends ue{}class OA extends v1{}class UA extends v1{}class LA extends ue{forward_params=["input_ids","attention_mask","position_ids","audio_values","past_key_values"]}class RA extends LA{_merge_input_ids_with_audio_features(z){const me=z.audio_features.dims.at(-1),Ue=z.audio_features.view(-1,me);return O({audio_token_id:this.config.ignore_index,...z,audio_features:Ue})}}class jb extends ue{main_input_name="input_values";forward_params=["input_values"]}class BA extends Se{constructor({audio_codes:z}){super(),this.audio_codes=z}}class $A extends Se{constructor({audio_values:z}){super(),this.audio_values=z}}class NA extends jb{async encode(z){return new BA(await S(this.sessions.encoder_model,z))}async decode(z){return new $A(await S(this.sessions.decoder_model,z))}}class zA extends jb{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"encoder_model"})}}class WA extends jb{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"decoder_model"})}}class Vb extends ue{main_input_name="input_values";forward_params=["input_values"]}class jA extends Se{constructor({audio_codes:z}){super(),this.audio_codes=z}}class VA extends Se{constructor({audio_values:z}){super(),this.audio_values=z}}class GA extends Vb{async encode(z){return new jA(await S(this.sessions.encoder_model,z))}async decode(z){return new VA(await S(this.sessions.decoder_model,z))}}class qA extends Vb{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"encoder_model"})}}class HA extends Vb{static async from_pretrained(z,me={}){return super.from_pretrained(z,{...me,model_file_name:me.model_file_name??"decoder_model"})}}class an{static async from_pretrained(z,{progress_callback:me=null,config:Ue=null,cache_dir:$e=null,local_files_only:je=!1,revision:Ye="main",model_file_name:Je=null,subfolder:at="onnx",device:mt=null,dtype:jt=null,use_external_data_format:Gt=null,session_options:Et={}}={}){const Dt={progress_callback:me,config:Ue,cache_dir:$e,local_files_only:je,revision:Ye,model_file_name:Je,subfolder:at,device:mt,dtype:jt,use_external_data_format:Gt,session_options:Et};if(Dt.config=await r.AutoConfig.from_pretrained(z,Dt),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);const en=Dt.config.model_type;for(const Ct of this.MODEL_CLASS_MAPPINGS){let St=Ct.get(en);if(!St){for(const Yt of Ct.values())if(Yt[0]===en){St=Yt;break}if(!St)continue}return await St[1].from_pretrained(z,Dt)}if(this.BASE_IF_FAIL)return yC.has(en)||console.warn(`Unknown model class "${en}", attempting to construct from base class.`),await ue.from_pretrained(z,Dt);throw Error(`Unsupported model type: ${en}`)}}Xe(an,"MODEL_CLASS_MAPPINGS",null),Xe(an,"BASE_IF_FAIL",!1);const q8=new Map([["bert",["BertModel",pe]],["modernbert",["ModernBertModel",te]],["nomic_bert",["NomicBertModel",ke]],["roformer",["RoFormerModel",Oe]],["electra",["ElectraModel",ae]],["esm",["EsmModel",Wo]],["convbert",["ConvBertModel",xt]],["camembert",["CamembertModel",rn]],["deberta",["DebertaModel",Ze]],["deberta-v2",["DebertaV2Model",mi]],["mpnet",["MPNetModel",tc]],["albert",["AlbertModel",sc]],["distilbert",["DistilBertModel",ma]],["roberta",["RobertaModel",Hi]],["xlm",["XLMModel",Vo]],["xlm-roberta",["XLMRobertaModel",lc]],["clap",["ClapModel",rA]],["clip",["CLIPModel",z_]],["clipseg",["CLIPSegModel",Y_]],["chinese_clip",["ChineseCLIPModel",K_]],["siglip",["SiglipModel",V_]],["jina_clip",["JinaCLIPModel",X_]],["mobilebert",["MobileBertModel",ga]],["squeezebert",["SqueezeBertModel",ja]],["wav2vec2",["Wav2Vec2Model",bM]],["wav2vec2-bert",["Wav2Vec2BertModel",IM]],["unispeech",["UniSpeechModel",MM]],["unispeech-sat",["UniSpeechSatModel",SM]],["hubert",["HubertModel",LM]],["wavlm",["WavLMModel",$M]],["audio-spectrogram-transformer",["ASTModel",Tf]],["vits",["VitsModel",p1]],["pyannote",["PyAnnoteModel",xM]],["wespeaker-resnet",["WeSpeakerResNetModel",DM]],["detr",["DetrModel",Tb]],["rt_detr",["RTDetrModel",Mb]],["table-transformer",["TableTransformerModel",Sb]],["vit",["ViTModel",vp]],["ijepa",["IJepaModel",xp]],["pvt",["PvtModel",tb]],["vit_msn",["ViTMSNModel",sb]],["vit_mae",["ViTMAEModel",ib]],["groupvit",["GroupViTModel",lb]],["fastvit",["FastViTModel",cb]],["mobilevit",["MobileViTModel",fb]],["mobilevitv2",["MobileViTV2Model",mb]],["owlvit",["OwlViTModel",_b]],["owlv2",["Owlv2Model",yb]],["beit",["BeitModel",wb]],["deit",["DeiTModel",Fb]],["hiera",["HieraModel",N]],["convnext",["ConvNextModel",ZD]],["convnextv2",["ConvNextV2Model",eM]],["dinov2",["Dinov2Model",nM]],["dinov2_with_registers",["Dinov2WithRegistersModel",iM]],["resnet",["ResNetModel",_e]],["swin",["SwinModel",Ge]],["swin2sr",["Swin2SRModel",Rt]],["donut-swin",["DonutSwinModel",QD]],["yolos",["YolosModel",lM]],["dpt",["DPTModel",Xo]],["glpn",["GLPNModel",KD]],["hifigan",["SpeechT5HifiGan",KM]],["efficientnet",["EfficientNetModel",dA]],["decision_transformer",["DecisionTransformerModel",MA]],["patchtst",["PatchTSTForPrediction",FA]],["patchtsmixer",["PatchTSMixerForPrediction",OA]],["mobilenet_v1",["MobileNetV1Model",fA]],["mobilenet_v2",["MobileNetV2Model",gA]],["mobilenet_v3",["MobileNetV3Model",yA]],["mobilenet_v4",["MobileNetV4Model",xA]],["maskformer",["MaskFormerModel",qD]],["mgp-str",["MgpstrForSceneTextRecognition",kA]],["style_text_to_speech_2",["StyleTextToSpeech2Model",GM]]]),H8=new Map([["t5",["T5Model",Pe]],["longt5",["LongT5Model",ot]],["mt5",["MT5Model",st]],["bart",["BartModel",An]],["mbart",["MBartModel",hr]],["marian",["MarianModel",pM]],["whisper",["WhisperModel",I_]],["m2m_100",["M2M100Model",gM]],["blenderbot",["BlenderbotModel",Cn]],["blenderbot-small",["BlenderbotSmallModel",yi]]]),K8=new Map([["mimi",["MimiModel",NA]],["dac",["DacModel",GA]]]),X8=new Map([["bloom",["BloomModel",pp]],["jais",["JAISModel",Of]],["gpt2",["GPT2Model",ud]],["gptj",["GPTJModel",Qe]],["gpt_bigcode",["GPTBigCodeModel",Bf]],["gpt_neo",["GPTNeoModel",Lf]],["gpt_neox",["GPTNeoXModel",J_]],["codegen",["CodeGenModel",fc]],["llama",["LlamaModel",$f]],["exaone",["ExaoneModel",_d]],["olmo",["OlmoModel",qf]],["olmo2",["Olmo2Model",Kf]],["mobilellm",["MobileLLMModel",Vf]],["granite",["GraniteModel",Yf]],["cohere",["CohereModel",Zf]],["gemma",["GemmaModel",ep]],["gemma2",["Gemma2Model",np]],["helium",["HeliumModel",zf]],["glm",["GlmModel",Ko]],["openelm",["OpenELMModel",ip]],["qwen2",["Qwen2Model",ap]],["phi",["PhiModel",up]],["phi3",["Phi3Model",hp]],["mpt",["MptModel",gp]],["opt",["OPTModel",bp]],["mistral",["MistralModel",QM]],["starcoder2",["Starcoder2Model",JM]],["falcon",["FalconModel",tA]],["stablelm",["StableLmModel",cA]]]),w1=new Map([["speecht5",["SpeechT5ForSpeechToText",qM]],["whisper",["WhisperForConditionalGeneration",Df]],["lite-whisper",["LiteWhisperForConditionalGeneration",O_]],["moonshine",["MoonshineForConditionalGeneration",U_]]]),KA=new Map([["speecht5",["SpeechT5ForTextToSpeech",HM]]]),XA=new Map([["vits",["VitsModel",p1]],["musicgen",["MusicgenForConditionalGeneration",b1]]]),YA=new Map([["bert",["BertForSequenceClassification",re]],["modernbert",["ModernBertForSequenceClassification",ee]],["roformer",["RoFormerForSequenceClassification",Te]],["electra",["ElectraForSequenceClassification",Me]],["esm",["EsmForSequenceClassification",Jl]],["convbert",["ConvBertForSequenceClassification",Wt]],["camembert",["CamembertForSequenceClassification",ur]],["deberta",["DebertaForSequenceClassification",rt]],["deberta-v2",["DebertaV2ForSequenceClassification",ms]],["mpnet",["MPNetForSequenceClassification",bi]],["albert",["AlbertForSequenceClassification",Le]],["distilbert",["DistilBertForSequenceClassification",Bo]],["roberta",["RobertaForSequenceClassification",$n]],["xlm",["XLMForSequenceClassification",A_]],["xlm-roberta",["XLMRobertaForSequenceClassification",wf]],["bart",["BartForSequenceClassification",Bn]],["mbart",["MBartForSequenceClassification",Va]],["mobilebert",["MobileBertForSequenceClassification",jo]],["squeezebert",["SqueezeBertForSequenceClassification",rc]]]),QA=new Map([["bert",["BertForTokenClassification",ge]],["modernbert",["ModernBertForTokenClassification",se]],["roformer",["RoFormerForTokenClassification",Be]],["electra",["ElectraForTokenClassification",Ie]],["esm",["EsmForTokenClassification",Jr]],["convbert",["ConvBertForTokenClassification",Jn]],["camembert",["CamembertForTokenClassification",vr]],["deberta",["DebertaForTokenClassification",Mn]],["deberta-v2",["DebertaV2ForTokenClassification",Lo]],["mpnet",["MPNetForTokenClassification",Wa]],["distilbert",["DistilBertForTokenClassification",$o]],["roberta",["RobertaForTokenClassification",Hn]],["xlm",["XLMForTokenClassification",oc]],["xlm-roberta",["XLMRobertaForTokenClassification",P_]]]),x1=new Map([["t5",["T5ForConditionalGeneration",We]],["longt5",["LongT5ForConditionalGeneration",lt]],["mt5",["MT5ForConditionalGeneration",Ht]],["bart",["BartForConditionalGeneration",Vn]],["mbart",["MBartForConditionalGeneration",qi]],["marian",["MarianMTModel",mM]],["m2m_100",["M2M100ForConditionalGeneration",_M]],["blenderbot",["BlenderbotForConditionalGeneration",fr]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",Fr]]]),T1=new Map([["bloom",["BloomForCausalLM",mp]],["gpt2",["GPT2LMHeadModel",If]],["jais",["JAISLMHeadModel",Uf]],["gptj",["GPTJForCausalLM",eb]],["gpt_bigcode",["GPTBigCodeForCausalLM",hc]],["gpt_neo",["GPTNeoForCausalLM",Z_]],["gpt_neox",["GPTNeoXForCausalLM",Rf]],["codegen",["CodeGenForCausalLM",md]],["llama",["LlamaForCausalLM",Nf]],["exaone",["ExaoneForCausalLM",Ot]],["olmo",["OlmoForCausalLM",Hf]],["olmo2",["Olmo2ForCausalLM",Xf]],["mobilellm",["MobileLLMForCausalLM",Gf]],["granite",["GraniteForCausalLM",Qf]],["cohere",["CohereForCausalLM",Jf]],["gemma",["GemmaForCausalLM",tp]],["gemma2",["Gemma2ForCausalLM",rp]],["helium",["HeliumForCausalLM",Wf]],["glm",["GlmForCausalLM",jf]],["openelm",["OpenELMForCausalLM",sp]],["qwen2",["Qwen2ForCausalLM",op]],["phi",["PhiForCausalLM",dp]],["phi3",["Phi3ForCausalLM",fp]],["mpt",["MptForCausalLM",_p]],["opt",["OPTForCausalLM",yp]],["mbart",["MBartForCausalLM",Wr]],["mistral",["MistralForCausalLM",ZM]],["starcoder2",["Starcoder2ForCausalLM",eA]],["falcon",["FalconForCausalLM",nA]],["trocr",["TrOCRForCausalLM",YM]],["stablelm",["StableLmForCausalLM",uA]],["phi3_v",["Phi3VForCausalLM",ad]]]),Y8=new Map([["multi_modality",["MultiModalityCausalLM",CA]]]),ZA=new Map([["bert",["BertForMaskedLM",ie]],["modernbert",["ModernBertForMaskedLM",j]],["roformer",["RoFormerForMaskedLM",ze]],["electra",["ElectraForMaskedLM",fe]],["esm",["EsmForMaskedLM",Fi]],["convbert",["ConvBertForMaskedLM",ft]],["camembert",["CamembertForMaskedLM",Un]],["deberta",["DebertaForMaskedLM",ct]],["deberta-v2",["DebertaV2ForMaskedLM",gi]],["mpnet",["MPNetForMaskedLM",za]],["albert",["AlbertForMaskedLM",ye]],["distilbert",["DistilBertForMaskedLM",zo]],["roberta",["RobertaForMaskedLM",qn]],["xlm",["XLMWithLMHeadModel",ac]],["xlm-roberta",["XLMRobertaForMaskedLM",S_]],["mobilebert",["MobileBertForMaskedLM",_i]],["squeezebert",["SqueezeBertForMaskedLM",nc]]]),JA=new Map([["bert",["BertForQuestionAnswering",Ce]],["roformer",["RoFormerForQuestionAnswering",qe]],["electra",["ElectraForQuestionAnswering",it]],["convbert",["ConvBertForQuestionAnswering",rr]],["camembert",["CamembertForQuestionAnswering",dr]],["deberta",["DebertaForQuestionAnswering",ki]],["deberta-v2",["DebertaV2ForQuestionAnswering",Ro]],["mpnet",["MPNetForQuestionAnswering",wr]],["albert",["AlbertForQuestionAnswering",Y]],["distilbert",["DistilBertForQuestionAnswering",No]],["roberta",["RobertaForQuestionAnswering",er]],["xlm",["XLMForQuestionAnswering",C_]],["xlm-roberta",["XLMRobertaForQuestionAnswering",k_]],["mobilebert",["MobileBertForQuestionAnswering",ec]],["squeezebert",["SqueezeBertForQuestionAnswering",ic]]]),E1=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",Af]],["idefics3",["Idefics3ForConditionalGeneration",cc]],["smolvlm",["SmolVLMForConditionalGeneration",Ga]]]),eC=new Map([["llava",["LlavaForConditionalGeneration",sd]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",R_]],["moondream1",["Moondream1ForConditionalGeneration",Cf]],["florence2",["Florence2ForConditionalGeneration",Pf]],["qwen2-vl",["Qwen2VLForConditionalGeneration",cp]],["idefics3",["Idefics3ForConditionalGeneration",cc]],["smolvlm",["SmolVLMForConditionalGeneration",Ga]],["paligemma",["PaliGemmaForConditionalGeneration",$_]]]),tC=new Map([["ultravox",["UltravoxModel",RA]]]),Q8=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",Af]]]),nC=new Map([["vit",["ViTForImageClassification",wp]],["ijepa",["IJepaForImageClassification",Tp]],["pvt",["PvtForImageClassification",nb]],["vit_msn",["ViTMSNForImageClassification",ab]],["fastvit",["FastViTForImageClassification",ub]],["mobilevit",["MobileViTForImageClassification",pb]],["mobilevitv2",["MobileViTV2ForImageClassification",gb]],["beit",["BeitForImageClassification",xb]],["deit",["DeiTForImageClassification",D]],["hiera",["HieraForImageClassification",K]],["convnext",["ConvNextForImageClassification",JD]],["convnextv2",["ConvNextV2ForImageClassification",tM]],["dinov2",["Dinov2ForImageClassification",rM]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",sM]],["resnet",["ResNetForImageClassification",Ae]],["swin",["SwinForImageClassification",et]],["segformer",["SegformerForImageClassification",oA]],["efficientnet",["EfficientNetForImageClassification",hA]],["mobilenet_v1",["MobileNetV1ForImageClassification",pA]],["mobilenet_v2",["MobileNetV2ForImageClassification",_A]],["mobilenet_v3",["MobileNetV3ForImageClassification",vA]],["mobilenet_v4",["MobileNetV4ForImageClassification",TA]]]),rC=new Map([["detr",["DetrForObjectDetection",Eb]],["rt_detr",["RTDetrForObjectDetection",Ab]],["table-transformer",["TableTransformerForObjectDetection",Pb]],["yolos",["YolosForObjectDetection",cM]]]),iC=new Map([["owlvit",["OwlViTForObjectDetection",bb]],["owlv2",["Owlv2ForObjectDetection",vb]],["grounding-dino",["GroundingDinoForObjectDetection",oM]]]),Ld=new Map([["detr",["DetrForSegmentation",Ip]],["clipseg",["CLIPSegForImageSegmentation",Q_]]]),sC=new Map([["segformer",["SegformerForSemanticSegmentation",lA]],["sapiens",["SapiensForSemanticSegmentation",zD]],["swin",["SwinForSemanticSegmentation",dt]],["mobilenet_v1",["MobileNetV1ForSemanticSegmentation",mA]],["mobilenet_v2",["MobileNetV2ForSemanticSegmentation",bA]],["mobilenet_v3",["MobileNetV3ForSemanticSegmentation",wA]],["mobilenet_v4",["MobileNetV4ForSemanticSegmentation",EA]]]),aC=new Map([["detr",["DetrForSegmentation",Ip]],["maskformer",["MaskFormerForInstanceSegmentation",HD]]]),oC=new Map([["sam",["SamModel",hM]]]),lC=new Map([["wav2vec2",["Wav2Vec2ForCTC",yM]],["wav2vec2-bert",["Wav2Vec2BertForCTC",OM]],["unispeech",["UniSpeechForCTC",AM]],["unispeech-sat",["UniSpeechSatForCTC",PM]],["wavlm",["WavLMForCTC",NM]],["hubert",["HubertForCTC",RM]]]),cC=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",vM]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",UM]],["unispeech",["UniSpeechForSequenceClassification",CM]],["unispeech-sat",["UniSpeechSatForSequenceClassification",kM]],["wavlm",["WavLMForSequenceClassification",zM]],["hubert",["HubertForSequenceClassification",BM]],["audio-spectrogram-transformer",["ASTForAudioClassification",F_]]]),uC=new Map([["wavlm",["WavLMForXVector",WM]]]),dC=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",FM]],["wavlm",["WavLMForAudioFrameClassification",jM]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",wM]],["pyannote",["PyAnnoteForAudioFrameClassification",TM]]]),hC=new Map([["vitmatte",["VitMatteForImageMatting",hb]]]),Z8=new Map([["patchtst",["PatchTSTForPrediction",IA]],["patchtsmixer",["PatchTSMixerForPrediction",UA]]]),fC=new Map([["swin2sr",["Swin2SRForImageSuperResolution",mn]]]),pC=new Map([["dpt",["DPTForDepthEstimation",BD]],["depth_anything",["DepthAnythingForDepthEstimation",ND]],["glpn",["GLPNForDepthEstimation",XD]],["sapiens",["SapiensForDepthEstimation",WD]],["depth_pro",["DepthProForDepthEstimation",GD]]]),mC=new Map([["sapiens",["SapiensForNormalEstimation",jD]]]),gC=new Map([["vitpose",["VitPoseForPoseEstimation",Dp]]]),_C=new Map([["clip",["CLIPVisionModelWithProjection",j_]],["siglip",["SiglipVisionModel",q_]],["jina_clip",["JinaCLIPVisionModel",qo]]]),bC=[[q8,x.EncoderOnly],[H8,x.EncoderDecoder],[X8,x.DecoderOnly],[K8,x.AutoEncoder],[YA,x.EncoderOnly],[QA,x.EncoderOnly],[x1,x.Seq2Seq],[w1,x.Seq2Seq],[T1,x.DecoderOnly],[Y8,x.MultiModality],[ZA,x.EncoderOnly],[JA,x.EncoderOnly],[E1,x.Vision2Seq],[eC,x.ImageTextToText],[tC,x.AudioTextToText],[nC,x.EncoderOnly],[Ld,x.EncoderOnly],[aC,x.EncoderOnly],[sC,x.EncoderOnly],[hC,x.EncoderOnly],[Z8,x.EncoderOnly],[fC,x.EncoderOnly],[pC,x.EncoderOnly],[mC,x.EncoderOnly],[gC,x.EncoderOnly],[rC,x.EncoderOnly],[iC,x.EncoderOnly],[oC,x.MaskGeneration],[lC,x.EncoderOnly],[cC,x.EncoderOnly],[KA,x.Seq2Seq],[XA,x.EncoderOnly],[uC,x.EncoderOnly],[dC,x.EncoderOnly],[_C,x.EncoderOnly]];for(const[W,z]of bC)for(const[me,Ue]of W.values())w.set(me,z),E.set(Ue,me),T.set(me,Ue);const J8=[["MusicgenForConditionalGeneration",b1,x.Musicgen],["Phi3VForCausalLM",ad,x.Phi3V],["CLIPTextModelWithProjection",od,x.EncoderOnly],["SiglipTextModel",G_,x.EncoderOnly],["JinaCLIPTextModel",uc,x.EncoderOnly],["ClapTextModelWithProjection",iA,x.EncoderOnly],["ClapAudioModelWithProjection",sA,x.EncoderOnly],["DacEncoderModel",qA,x.EncoderOnly],["DacDecoderModel",HA,x.EncoderOnly],["MimiEncoderModel",zA,x.EncoderOnly],["MimiDecoderModel",WA,x.EncoderOnly]];for(const[W,z,me]of J8)w.set(W,me),E.set(z,W),T.set(W,z);const yC=new Map([["modnet",Ld],["birefnet",Ld],["isnet",Ld],["ben",Ld]]);for(const[W,z]of yC.entries())z.set(W,["PreTrainedModel",ue]),w.set(W,x.EncoderOnly),E.set(ue,W),T.set(W,ue);class D1 extends an{}Xe(D1,"MODEL_CLASS_MAPPINGS",bC.map(z=>z[0])),Xe(D1,"BASE_IF_FAIL",!0);class vC extends an{}Xe(vC,"MODEL_CLASS_MAPPINGS",[YA]);class wC extends an{}Xe(wC,"MODEL_CLASS_MAPPINGS",[QA]);class xC extends an{}Xe(xC,"MODEL_CLASS_MAPPINGS",[x1]);class TC extends an{}Xe(TC,"MODEL_CLASS_MAPPINGS",[w1]);class EC extends an{}Xe(EC,"MODEL_CLASS_MAPPINGS",[KA]);class DC extends an{}Xe(DC,"MODEL_CLASS_MAPPINGS",[XA]);class MC extends an{}Xe(MC,"MODEL_CLASS_MAPPINGS",[T1]);class AC extends an{}Xe(AC,"MODEL_CLASS_MAPPINGS",[ZA]);class CC extends an{}Xe(CC,"MODEL_CLASS_MAPPINGS",[JA]);class SC extends an{}Xe(SC,"MODEL_CLASS_MAPPINGS",[E1]);class PC extends an{}Xe(PC,"MODEL_CLASS_MAPPINGS",[nC]);class kC extends an{}Xe(kC,"MODEL_CLASS_MAPPINGS",[Ld]);class FC extends an{}Xe(FC,"MODEL_CLASS_MAPPINGS",[sC]);class IC extends an{}Xe(IC,"MODEL_CLASS_MAPPINGS",[aC]);class OC extends an{}Xe(OC,"MODEL_CLASS_MAPPINGS",[rC]);class UC extends an{}Xe(UC,"MODEL_CLASS_MAPPINGS",[iC]);class LC extends an{}Xe(LC,"MODEL_CLASS_MAPPINGS",[oC]);class RC extends an{}Xe(RC,"MODEL_CLASS_MAPPINGS",[lC]);class BC extends an{}Xe(BC,"MODEL_CLASS_MAPPINGS",[cC]);class $C extends an{}Xe($C,"MODEL_CLASS_MAPPINGS",[uC]);class NC extends an{}Xe(NC,"MODEL_CLASS_MAPPINGS",[dC]);class zC extends an{}Xe(zC,"MODEL_CLASS_MAPPINGS",[Q8]);class WC extends an{}Xe(WC,"MODEL_CLASS_MAPPINGS",[hC]);class jC extends an{}Xe(jC,"MODEL_CLASS_MAPPINGS",[fC]);class VC extends an{}Xe(VC,"MODEL_CLASS_MAPPINGS",[pC]);class GC extends an{}Xe(GC,"MODEL_CLASS_MAPPINGS",[mC]);class qC extends an{}Xe(qC,"MODEL_CLASS_MAPPINGS",[gC]);class HC extends an{}Xe(HC,"MODEL_CLASS_MAPPINGS",[_C]);class KC extends an{}Xe(KC,"MODEL_CLASS_MAPPINGS",[eC]);class XC extends an{}Xe(XC,"MODEL_CLASS_MAPPINGS",[tC]);class e5 extends Se{constructor({logits:z,past_key_values:me,encoder_outputs:Ue,decoder_attentions:$e=null,cross_attentions:je=null}){super(),this.logits=z,this.past_key_values=me,this.encoder_outputs=Ue,this.decoder_attentions=$e,this.cross_attentions=je}}class Bt extends Se{constructor({logits:z,...me}){super(),this.logits=z;const Ue=Object.values(me);Ue.length>0&&(this.attentions=Ue)}}class YC extends Se{constructor({logits:z,embeddings:me}){super(),this.logits=z,this.embeddings=me}}class xr extends Se{constructor({logits:z}){super(),this.logits=z}}class Ir extends Se{constructor({logits:z}){super(),this.logits=z}}class ti extends Se{constructor({start_logits:z,end_logits:me}){super(),this.start_logits=z,this.end_logits=me}}class gc extends Se{constructor({logits:z}){super(),this.logits=z}}class t5 extends Se{constructor({logits:z,past_key_values:me}){super(),this.logits=z,this.past_key_values=me}}class QC extends Se{constructor({alphas:z}){super(),this.alphas=z}}class ZC extends Se{constructor({waveform:z,spectrogram:me}){super(),this.waveform=z,this.spectrogram=me}}},"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":(n,e,t)=>{t.r(e),t.d(e,{ASTFeatureExtractor:()=>s});var r=t("./src/base/feature_extraction_utils.js");t("./src/utils/tensor.js");var i=t("./src/utils/audio.js");class s extends r.FeatureExtractor{constructor(o){super(o);const l=this.config.sampling_rate,c=(0,i.mel_filter_bank)(256,this.config.num_mel_bins,20,Math.floor(l/2),l,null,"kaldi",!0);for(let u=0;u<c.length;++u)c[u].push(0);this.mel_filters=c,this.window=(0,i.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(o,l){return(0,i.spectrogram)(o,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:l,transpose:!0})}async _call(o){(0,r.validate_audio_inputs)(o,"ASTFeatureExtractor");const l=await this._extract_fbank_features(o,this.config.max_length);if(this.config.do_normalize){const c=this.std*2,u=l.data;for(let d=0;d<u.length;++d)u[d]=(u[d]-this.mean)/c}return{input_values:l.unsqueeze_(0)}}}},"./src/models/auto/feature_extraction_auto.js":(n,e,t)=>{t.r(e),t.d(e,{AutoFeatureExtractor:()=>a});var r=t("./src/utils/constants.js"),i=t("./src/utils/hub.js");t("./src/base/feature_extraction_utils.js");var s=t("./src/models/feature_extractors.js");class a{static async from_pretrained(l,c={}){const u=await(0,i.getModelJSON)(l,r.FEATURE_EXTRACTOR_NAME,!0,c),d=u.feature_extractor_type,h=s[d];if(!h)throw new Error(`Unknown feature_extractor_type: '${d}'. Please report this at ${r.GITHUB_ISSUE_URL}.`);return new h(u)}}},"./src/models/auto/image_processing_auto.js":(n,e,t)=>{t.r(e),t.d(e,{AutoImageProcessor:()=>o});var r=t("./src/utils/constants.js"),i=t("./src/utils/hub.js"),s=t("./src/base/image_processors_utils.js"),a=t("./src/models/image_processors.js");class o{static async from_pretrained(c,u={}){const d=await(0,i.getModelJSON)(c,r.IMAGE_PROCESSOR_NAME,!0,u),h=d.image_processor_type??d.feature_extractor_type;let f=a[h];return f||(h!==void 0&&console.warn(`Image processor type '${h}' not found, assuming base ImageProcessor. Please report this at ${r.GITHUB_ISSUE_URL}.`),f=s.ImageProcessor),new f(d)}}},"./src/models/auto/processing_auto.js":(n,e,t)=>{t.r(e),t.d(e,{AutoProcessor:()=>c});var r=t("./src/utils/constants.js"),i=t("./src/utils/hub.js"),s=t("./src/base/processing_utils.js"),a=t("./src/models/processors.js"),o=t("./src/models/image_processors.js"),l=t("./src/models/feature_extractors.js");class c{static async from_pretrained(d,h={}){const f=await(0,i.getModelJSON)(d,r.IMAGE_PROCESSOR_NAME,!0,h),{image_processor_type:p,feature_extractor_type:g,processor_class:b}=f;if(b&&a[b])return a[b].from_pretrained(d,h);if(!p&&!g)throw new Error("No `image_processor_type` or `feature_extractor_type` found in the config.");const _={};if(p){const v=o[p];if(!v)throw new Error(`Unknown image_processor_type: '${p}'.`);_.image_processor=new v(f)}if(g){const v=o[g];if(v)_.image_processor=new v(f);else{const x=l[g];if(!x)throw new Error(`Unknown feature_extractor_type: '${g}'.`);_.feature_extractor=new x(f)}}const m={};return new s.Processor(m,_)}}},"./src/models/beit/image_processing_beit.js":(n,e,t)=>{t.r(e),t.d(e,{BeitFeatureExtractor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}},"./src/models/bit/image_processing_bit.js":(n,e,t)=>{t.r(e),t.d(e,{BitImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}},"./src/models/chinese_clip/image_processing_chinese_clip.js":(n,e,t)=>{t.r(e),t.d(e,{ChineseCLIPFeatureExtractor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}},"./src/models/clap/feature_extraction_clap.js":(n,e,t)=>{t.r(e),t.d(e,{ClapFeatureExtractor:()=>s});var r=t("./src/base/feature_extraction_utils.js");t("./src/utils/tensor.js");var i=t("./src/utils/audio.js");class s extends r.FeatureExtractor{constructor(o){super(o),this.mel_filters=(0,i.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,i.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,i.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(o,l,c,u){let d;const h=o.length-l;if(h>0)if(c==="rand_trunc"){const f=Math.floor(Math.random()*(h+1));o=o.subarray(f,f+l),d=await this._extract_fbank_features(o,this.mel_filters_slaney,this.config.nb_max_samples)}else throw new Error(`Truncation strategy "${c}" not implemented`);else{if(h<0){let f=new Float64Array(l);if(f.set(o),u==="repeat")for(let p=o.length;p<l;p+=o.length)f.set(o.subarray(0,Math.min(o.length,l-p)),p);else if(u==="repeatpad")for(let p=o.length;p<-h;p+=o.length)f.set(o,p);o=f}if(c==="fusion")throw new Error(`Truncation strategy "${c}" not implemented`);d=await this._extract_fbank_features(o,this.mel_filters_slaney,this.config.nb_max_samples)}return d.unsqueeze_(0)}async _extract_fbank_features(o,l,c=null){return(0,i.spectrogram)(o,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:l,log_mel:"dB",max_num_frames:c,do_pad:!1,transpose:!0})}async _call(o,{max_length:l=null}={}){return(0,r.validate_audio_inputs)(o,"ClapFeatureExtractor"),{input_features:(await this._get_input_mel(o,l??this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}},"./src/models/clip/image_processing_clip.js":(n,e,t)=>{t.r(e),t.d(e,{CLIPFeatureExtractor:()=>s,CLIPImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}class s extends i{}},"./src/models/convnext/image_processing_convnext.js":(n,e,t)=>{t.r(e),t.d(e,{ConvNextFeatureExtractor:()=>s,ConvNextImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{constructor(o){super(o),this.crop_pct=this.config.crop_pct??224/256}async resize(o){const l=this.size?.shortest_edge;if(l===void 0)throw new Error("Size dictionary must contain 'shortest_edge' key.");if(l<384){const c=Math.floor(l/this.crop_pct),[u,d]=this.get_resize_output_image_size(o,{shortest_edge:c});o=await o.resize(u,d,{resample:this.resample}),o=await o.center_crop(l,l)}else o=await o.resize(l,l,{resample:this.resample});return o}}class s extends i{}},"./src/models/dac/feature_extraction_dac.js":(n,e,t)=>{t.r(e),t.d(e,{DacFeatureExtractor:()=>i});var r=t("./src/models/encodec/feature_extraction_encodec.js");class i extends r.EncodecFeatureExtractor{}},"./src/models/deit/image_processing_deit.js":(n,e,t)=>{t.r(e),t.d(e,{DeiTFeatureExtractor:()=>s,DeiTImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}class s extends i{}},"./src/models/detr/image_processing_detr.js":(n,e,t)=>{t.r(e),t.d(e,{DetrFeatureExtractor:()=>a,DetrImageProcessor:()=>s});var r=t("./src/base/image_processors_utils.js"),i=t("./src/utils/tensor.js");class s extends r.ImageProcessor{async _call(l){const c=await super._call(l),u=[c.pixel_values.dims[0],64,64],d=(0,i.full)(u,1n);return{...c,pixel_mask:d}}post_process_object_detection(...l){return(0,r.post_process_object_detection)(...l)}post_process_panoptic_segmentation(...l){return(0,r.post_process_panoptic_segmentation)(...l)}post_process_instance_segmentation(...l){return(0,r.post_process_instance_segmentation)(...l)}}class a extends s{}},"./src/models/donut/image_processing_donut.js":(n,e,t)=>{t.r(e),t.d(e,{DonutFeatureExtractor:()=>s,DonutImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{pad_image(o,l,c,u={}){const[d,h,f]=l;let p=this.image_mean;Array.isArray(this.image_mean)||(p=new Array(f).fill(p));let g=this.image_std;Array.isArray(g)||(g=new Array(f).fill(p));const b=p.map((_,m)=>-_/g[m]);return super.pad_image(o,l,c,{center:!0,constant_values:b,...u})}}class s extends i{}},"./src/models/dpt/image_processing_dpt.js":(n,e,t)=>{t.r(e),t.d(e,{DPTFeatureExtractor:()=>s,DPTImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}class s extends i{}},"./src/models/efficientnet/image_processing_efficientnet.js":(n,e,t)=>{t.r(e),t.d(e,{EfficientNetImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{constructor(a){super(a),this.include_top=this.config.include_top??!0,this.include_top&&(this.image_std=this.image_std.map(o=>o*o))}}},"./src/models/encodec/feature_extraction_encodec.js":(n,e,t)=>{t.r(e),t.d(e,{EncodecFeatureExtractor:()=>s});var r=t("./src/base/feature_extraction_utils.js"),i=t("./src/utils/tensor.js");class s extends r.FeatureExtractor{async _call(o){(0,r.validate_audio_inputs)(o,"EncodecFeatureExtractor"),o instanceof Float64Array&&(o=new Float32Array(o));const l=this.config.feature_size;if(o.length%l!==0)throw new Error(`The length of the audio data must be a multiple of the number of channels (${l}).`);const c=[1,l,o.length/l];return{input_values:new i.Tensor("float32",o,c)}}}},"./src/models/feature_extractors.js":(n,e,t)=>{t.r(e),t.d(e,{ASTFeatureExtractor:()=>r.ASTFeatureExtractor,ClapFeatureExtractor:()=>s.ClapFeatureExtractor,DacFeatureExtractor:()=>a.DacFeatureExtractor,EncodecFeatureExtractor:()=>i.EncodecFeatureExtractor,ImageFeatureExtractor:()=>p.ImageProcessor,MoonshineFeatureExtractor:()=>o.MoonshineFeatureExtractor,PyAnnoteFeatureExtractor:()=>l.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>c.SeamlessM4TFeatureExtractor,SpeechT5FeatureExtractor:()=>u.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>d.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>h.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>f.WhisperFeatureExtractor});var r=t("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),i=t("./src/models/encodec/feature_extraction_encodec.js"),s=t("./src/models/clap/feature_extraction_clap.js"),a=t("./src/models/dac/feature_extraction_dac.js"),o=t("./src/models/moonshine/feature_extraction_moonshine.js"),l=t("./src/models/pyannote/feature_extraction_pyannote.js"),c=t("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),u=t("./src/models/speecht5/feature_extraction_speecht5.js"),d=t("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),h=t("./src/models/wespeaker/feature_extraction_wespeaker.js"),f=t("./src/models/whisper/feature_extraction_whisper.js"),p=t("./src/base/image_processors_utils.js")},"./src/models/florence2/processing_florence2.js":(n,e,t)=>{t.r(e),t.d(e,{Florence2Processor:()=>a});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js");class a extends r.Processor{constructor(l,c){super(l,c);const{tasks_answer_post_processing_type:u,task_prompts_without_inputs:d,task_prompts_with_input:h}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(u??{})),this.task_prompts_without_inputs=new Map(Object.entries(d??{})),this.task_prompts_with_input=new Map(Object.entries(h??{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts(l){typeof l=="string"&&(l=[l]);const c=[];for(const u of l)if(this.task_prompts_without_inputs.has(u))c.push(this.task_prompts_without_inputs.get(u));else{for(const[d,h]of this.task_prompts_with_input)if(u.includes(d)){c.push(h.replaceAll("{input}",u).replaceAll(d,""));break}c.length!==l.length&&c.push(u)}return c}post_process_generation(l,c,u){const d=this.tasks_answer_post_processing_type.get(c)??"pure_text";l=l.replaceAll("<s>","").replaceAll("</s>","");let h;switch(d){case"pure_text":h=l;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":const f=d==="ocr"?"quad_boxes":"bboxes",p=l.matchAll(this.regexes[f]),g=[],b=[];for(const[_,m,...v]of p)g.push(m?m.trim():g.at(-1)??""),b.push(v.map((x,w)=>(Number(x)+.5)/this.size_per_bin*u[w%2]));h={labels:g,[f]:b};break;default:throw new Error(`Task "${c}" (of type "${d}") not yet implemented.`)}return{[c]:h}}async _call(l,c=null,u={}){if(!l&&!c)throw new Error("Either text or images must be provided");const d=await this.image_processor(l,u),h=c?this.tokenizer(c,u):{};return{...d,...h}}}Xe(a,"tokenizer_class",s.AutoTokenizer),Xe(a,"image_processor_class",i.AutoImageProcessor)},"./src/models/glpn/image_processing_glpn.js":(n,e,t)=>{t.r(e),t.d(e,{GLPNFeatureExtractor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}},"./src/models/grounding_dino/image_processing_grounding_dino.js":(n,e,t)=>{t.r(e),t.d(e,{GroundingDinoImageProcessor:()=>s});var r=t("./src/base/image_processors_utils.js"),i=t("./src/utils/tensor.js");class s extends r.ImageProcessor{async _call(o){const l=await super._call(o),c=l.pixel_values.dims,u=(0,i.ones)([c[0],c[2],c[3]]);return{...l,pixel_mask:u}}}},"./src/models/grounding_dino/processing_grounding_dino.js":(n,e,t)=>{t.r(e),t.d(e,{GroundingDinoProcessor:()=>l});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js"),a=t("./src/base/image_processors_utils.js");function o(c,u){const h=c.dims.at(-1)-1,f=c.tolist();f.fill(!1,0,1),f.fill(!1,h);const p=u.tolist();return f.map((g,b)=>g?b:null).filter(g=>g!==null).map(g=>p[g])}class l extends r.Processor{async _call(u,d,h={}){const f=u?await this.image_processor(u,h):{};return{...d?this.tokenizer(d,h):{},...f}}post_process_grounded_object_detection(u,d,{box_threshold:h=.25,text_threshold:f=.25,target_sizes:p=null}={}){const{logits:g,pred_boxes:b}=u,_=g.dims[0];if(p!==null&&p.length!==_)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const m=g.dims.at(1),v=g.sigmoid(),x=v.max(-1).tolist(),w=b.tolist().map(E=>E.map(A=>(0,a.center_to_corners_format)(A))),T=[];for(let E=0;E<_;++E){const A=p!==null?p[E]:null;A!==null&&(w[E]=w[E].map(I=>I.map((C,H)=>C*A[(H+1)%2])));const M=x[E],F=[],G=[],S=[];for(let I=0;I<m;++I){const C=M[I];if(C<=h)continue;const H=w[E][I],B=v[E][I];F.push(C),S.push(H);const $=o(B.gt(f),d[E]);G.push($)}T.push({scores:F,boxes:S,labels:this.batch_decode(G)})}return T}}Xe(l,"tokenizer_class",s.AutoTokenizer),Xe(l,"image_processor_class",i.AutoImageProcessor)},"./src/models/idefics3/image_processing_idefics3.js":(n,e,t)=>{t.r(e),t.d(e,{Idefics3ImageProcessor:()=>s});var r=t("./src/base/image_processors_utils.js"),i=t("./src/utils/tensor.js");class s extends r.ImageProcessor{constructor(o){super(o),this.do_image_splitting=o.do_image_splitting??!0,this.max_image_size=o.max_image_size}get_resize_for_vision_encoder(o,l){let[c,u]=o.dims.slice(-2);const d=u/c;return u>=c?(u=Math.ceil(u/l)*l,c=Math.floor(u/d),c=Math.ceil(c/l)*l):(c=Math.ceil(c/l)*l,u=Math.floor(c*d),u=Math.ceil(u/l)*l),{height:c,width:u}}async _call(o,{do_image_splitting:l=null,return_row_col_info:c=!1}={}){let u;if(!Array.isArray(o))u=[[o]];else{if(o.length===0||!o[0])throw new Error("No images provided.");Array.isArray(o[0])?u=o:u=[o]}let d=[],h=[],f=[];const p=[],g=[];for(const E of u){let A=await Promise.all(E.map(G=>this.preprocess(G)));p.push(...A.map(G=>G.original_size)),g.push(...A.map(G=>G.reshaped_input_size)),A.forEach(G=>G.pixel_values.unsqueeze_(0));const{longest_edge:M}=this.max_image_size;let F;if(l??this.do_image_splitting){let G=new Array(A.length),S=new Array(A.length);F=await Promise.all(A.map(async(I,C)=>{const H=this.get_resize_for_vision_encoder(I.pixel_values,M),B=await(0,i.interpolate_4d)(I.pixel_values,{size:[H.height,H.width]}),{frames:$,num_splits_h:X,num_splits_w:V}=await this.split_image(B,this.max_image_size);return G[C]=X,S[C]=V,(0,i.cat)($,0)})),h.push(G),f.push(S)}else{const G=[M,M];F=await Promise.all(A.map(S=>(0,i.interpolate_4d)(S.pixel_values,{size:G}))),h.push(new Array(A.length).fill(0)),f.push(new Array(A.length).fill(0))}d.push((0,i.cat)(F,0))}const b=d.length,[_,m,v,x]=d[0].dims;let w,T;if(b===1)w=d[0].unsqueeze_(0),T=(0,i.full)([b,_,v,x],!0);else{const E=Math.max(...d.map(F=>F.dims.at(0)));T=(0,i.full)([b,E,v,x],!0);const A=T.data,M=E*v*x;for(let F=0;F<b;++F){const G=d[F].dims[0];if(G<E){d[F]=(0,i.cat)([d[F],(0,i.full)([E-G,m,v,x],0)],0);const S=F*M+G*v*x,I=(F+1)*M;A.fill(!1,S,I)}}w=(0,i.stack)(d,0)}return{pixel_values:w,pixel_attention_mask:T,original_sizes:p,reshaped_input_sizes:g,...c?{rows:h,cols:f}:{}}}async split_image(o,{longest_edge:l}){const c=l,u=l,d=[],[h,f]=o.dims.slice(-2);let p=0,g=0;if(h>c||f>u){p=Math.ceil(h/c),g=Math.ceil(f/u);const b=Math.ceil(h/p),_=Math.ceil(f/g);for(let x=0;x<p;++x)for(let w=0;w<g;++w){let T,E,A,M;x===p-1?(E=h-b,M=h):(E=x*b,M=(x+1)*b),w===g-1?(T=f-_,A=f):(T=w*_,A=(w+1)*_);const F=[E,T],G=[M,A],S=await(0,i.slice)(o,F,G,[2,3]);d.push(S)}const m=c,v=u;(h!==m||f!==v)&&(o=await(0,i.interpolate_4d)(o,{size:[m,v]}))}return d.push(o),{frames:d,num_splits_h:p,num_splits_w:g}}}},"./src/models/idefics3/processing_idefics3.js":(n,e,t)=>{t.r(e),t.d(e,{Idefics3Processor:()=>u});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js");t("./src/utils/image.js");var a=t("./src/utils/core.js");function o(d,h,f,p,g,b){let _="";for(let m=0;m<h;++m){for(let v=0;v<f;++v)_+=p+`<row_${m+1}_col_${v+1}>`+g.repeat(d);_+=`
`}return _+=`
${p}${b}`+g.repeat(d)+`${p}`,_}function l(d,h,f,p){return`${h}${p}`+f.repeat(d)+`${h}`}function c(d,h,f,p,g,b){return d===0&&h===0?l(f,p,g,b):o(f,d,h,p,g,b)}class u extends r.Processor{fake_image_token="<fake_token_around_image>";image_token="<image>";global_img_token="<global-img>";async _call(h,f=null,p={}){p.return_row_col_info??=!0;let g;f&&(g=await this.image_processor(f,p)),Array.isArray(h)||(h=[h]);const b=g.rows??[new Array(h.length).fill(0)],_=g.cols??[new Array(h.length).fill(0)],m=this.config.image_seq_len,v=[],x=[];for(let T=0;T<h.length;++T){const E=h[T],A=b[T],M=_[T];v.push((0,a.count)(E,this.image_token));const F=A.map((I,C)=>c(I,M[C],m,this.fake_image_token,this.image_token,this.global_img_token)),G=E.split(this.image_token);if(G.length===0)throw new Error("The image token should be present in the text.");let S=G[0];for(let I=0;I<F.length;++I)S+=F[I]+G[I+1];x.push(S)}return{...this.tokenizer(x),...g}}}Xe(u,"image_processor_class",i.AutoImageProcessor),Xe(u,"tokenizer_class",s.AutoTokenizer),Xe(u,"uses_processor_config",!0)},"./src/models/image_processors.js":(n,e,t)=>{t.r(e),t.d(e,{BeitFeatureExtractor:()=>r.BeitFeatureExtractor,BitImageProcessor:()=>i.BitImageProcessor,CLIPFeatureExtractor:()=>a.CLIPFeatureExtractor,CLIPImageProcessor:()=>a.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>s.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>o.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>o.ConvNextImageProcessor,DPTFeatureExtractor:()=>d.DPTFeatureExtractor,DPTImageProcessor:()=>d.DPTImageProcessor,DeiTFeatureExtractor:()=>l.DeiTFeatureExtractor,DeiTImageProcessor:()=>l.DeiTImageProcessor,DetrFeatureExtractor:()=>c.DetrFeatureExtractor,DetrImageProcessor:()=>c.DetrImageProcessor,DonutFeatureExtractor:()=>u.DonutFeatureExtractor,DonutImageProcessor:()=>u.DonutImageProcessor,EfficientNetImageProcessor:()=>h.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>f.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>p.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>g.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>_.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>m.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>v.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>x.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>x.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>w.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>w.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>T.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>T.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>E.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>E.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>A.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>A.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>M.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>M.MobileViTImageProcessor,NougatImageProcessor:()=>F.NougatImageProcessor,OwlViTFeatureExtractor:()=>S.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>S.OwlViTImageProcessor,Owlv2ImageProcessor:()=>G.Owlv2ImageProcessor,Phi3VImageProcessor:()=>I.Phi3VImageProcessor,PvtImageProcessor:()=>C.PvtImageProcessor,Qwen2VLImageProcessor:()=>H.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>B.RTDetrImageProcessor,SamImageProcessor:()=>$.SamImageProcessor,SegformerFeatureExtractor:()=>X.SegformerFeatureExtractor,SegformerImageProcessor:()=>X.SegformerImageProcessor,SiglipImageProcessor:()=>V.SiglipImageProcessor,SmolVLMImageProcessor:()=>Q.SmolVLMImageProcessor,Swin2SRImageProcessor:()=>R.Swin2SRImageProcessor,VLMImageProcessor:()=>b.VLMImageProcessor,ViTFeatureExtractor:()=>O.ViTFeatureExtractor,ViTImageProcessor:()=>O.ViTImageProcessor,VitMatteImageProcessor:()=>L.VitMatteImageProcessor,VitPoseImageProcessor:()=>ne.VitPoseImageProcessor,YolosFeatureExtractor:()=>de.YolosFeatureExtractor,YolosImageProcessor:()=>de.YolosImageProcessor});var r=t("./src/models/beit/image_processing_beit.js"),i=t("./src/models/bit/image_processing_bit.js"),s=t("./src/models/chinese_clip/image_processing_chinese_clip.js"),a=t("./src/models/clip/image_processing_clip.js"),o=t("./src/models/convnext/image_processing_convnext.js"),l=t("./src/models/deit/image_processing_deit.js"),c=t("./src/models/detr/image_processing_detr.js"),u=t("./src/models/donut/image_processing_donut.js"),d=t("./src/models/dpt/image_processing_dpt.js"),h=t("./src/models/efficientnet/image_processing_efficientnet.js"),f=t("./src/models/glpn/image_processing_glpn.js"),p=t("./src/models/grounding_dino/image_processing_grounding_dino.js"),g=t("./src/models/idefics3/image_processing_idefics3.js"),b=t("./src/models/janus/image_processing_janus.js"),_=t("./src/models/jina_clip/image_processing_jina_clip.js"),m=t("./src/models/llava_onevision/image_processing_llava_onevision.js"),v=t("./src/models/mask2former/image_processing_mask2former.js"),x=t("./src/models/maskformer/image_processing_maskformer.js"),w=t("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),T=t("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),E=t("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),A=t("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),M=t("./src/models/mobilevit/image_processing_mobilevit.js"),F=t("./src/models/nougat/image_processing_nougat.js"),G=t("./src/models/owlv2/image_processing_owlv2.js"),S=t("./src/models/owlvit/image_processing_owlvit.js"),I=t("./src/models/phi3_v/image_processing_phi3_v.js"),C=t("./src/models/pvt/image_processing_pvt.js"),H=t("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),B=t("./src/models/rt_detr/image_processing_rt_detr.js"),$=t("./src/models/sam/image_processing_sam.js"),X=t("./src/models/segformer/image_processing_segformer.js"),V=t("./src/models/siglip/image_processing_siglip.js"),Q=t("./src/models/smolvlm/image_processing_smolvlm.js"),R=t("./src/models/swin2sr/image_processing_swin2sr.js"),O=t("./src/models/vit/image_processing_vit.js"),L=t("./src/models/vitmatte/image_processing_vitmatte.js"),ne=t("./src/models/vitpose/image_processing_vitpose.js"),de=t("./src/models/yolos/image_processing_yolos.js")},"./src/models/janus/image_processing_janus.js":(n,e,t)=>{t.r(e),t.d(e,{VLMImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{constructor(a){super({do_pad:!0,pad_size:{width:a.image_size,height:a.image_size},...a}),this.constant_values=this.config.background_color.map(o=>o*this.rescale_factor)}pad_image(a,o,l,c){return super.pad_image(a,o,l,{constant_values:this.constant_values,center:!0,...c})}}},"./src/models/janus/processing_janus.js":(n,e,t)=>{t.r(e),t.d(e,{VLChatProcessor:()=>c});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js"),a=t("./src/utils/core.js"),o=t("./src/utils/tensor.js"),l=t("./src/utils/image.js");class c extends r.Processor{constructor(d,h){super(d,h),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(d,{images:h=null,chat_template:f="default"}={}){h?Array.isArray(h)||(h=[h]):h=await Promise.all(d.filter(F=>F.images).flatMap(F=>F.images).map(F=>l.RawImage.read(F)));const p=this.tokenizer,g=p.apply_chat_template(d,{tokenize:!1,add_generation_prompt:!0,chat_template:f}),b=F=>p.encode(F,{add_special_tokens:!1}),_=g.split(this.image_tag),m=_.length-1;if(h.length!==m)throw new Error(`Number of images provided (${h.length}) does not match number of "${this.image_tag}" image tags (${m})`);const[v,x,w]=p.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]);let T=b(_[0]),E=new Array(T.length).fill(!1);for(let F=1;F<_.length;++F){const G=new Array(this.num_image_tokens).fill(v),S=b(_[F]);T=(0,a.mergeArrays)(T,[x],G,[w],S);const I=new Array(this.num_image_tokens).fill(!0);E=(0,a.mergeArrays)(E,[!1],I,[!1],new Array(S.length).fill(!1))}const A=[1,T.length],M={input_ids:new o.Tensor("int64",T,A),attention_mask:new o.Tensor("int64",new Array(T.length).fill(1),A),images_seq_mask:new o.Tensor("bool",E,A),images_emb_mask:new o.Tensor("bool",new Array(m*this.num_image_tokens).fill(!0),[1,m,this.num_image_tokens])};if(h&&h.length>0){const F=await this.image_processor(h);return F.pixel_values.unsqueeze_(0),{...M,...F}}return M}}Xe(c,"image_processor_class",i.AutoImageProcessor),Xe(c,"tokenizer_class",s.AutoTokenizer),Xe(c,"uses_processor_config",!0)},"./src/models/jina_clip/image_processing_jina_clip.js":(n,e,t)=>{t.r(e),t.d(e,{JinaCLIPImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{constructor(a){const{resize_mode:o,fill_color:l,interpolation:c,size:u,...d}=a,h=o==="squash"?{width:u,height:u}:o==="shortest"?{shortest_edge:u}:{longest_edge:u},f=c==="bicubic"?3:2;super({...d,size:h,resample:f,do_center_crop:!0,crop_size:u,do_normalize:!0})}}},"./src/models/jina_clip/processing_jina_clip.js":(n,e,t)=>{t.r(e),t.d(e,{JinaCLIPProcessor:()=>a});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js");class a extends r.Processor{async _call(l=null,c=null,u={}){if(!l&&!c)throw new Error("Either text or images must be provided");const d=l?this.tokenizer(l,u):{},h=c?await this.image_processor(c,u):{};return{...d,...h}}}Xe(a,"tokenizer_class",s.AutoTokenizer),Xe(a,"image_processor_class",i.AutoImageProcessor)},"./src/models/llava_onevision/image_processing_llava_onevision.js":(n,e,t)=>{t.r(e),t.d(e,{LlavaOnevisionImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}},"./src/models/mask2former/image_processing_mask2former.js":(n,e,t)=>{t.r(e),t.d(e,{Mask2FormerImageProcessor:()=>i});var r=t("./src/models/maskformer/image_processing_maskformer.js");class i extends r.MaskFormerImageProcessor{}},"./src/models/maskformer/image_processing_maskformer.js":(n,e,t)=>{t.r(e),t.d(e,{MaskFormerFeatureExtractor:()=>s,MaskFormerImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{post_process_panoptic_segmentation(...o){return(0,r.post_process_panoptic_segmentation)(...o)}post_process_instance_segmentation(...o){return(0,r.post_process_instance_segmentation)(...o)}}class s extends i{}},"./src/models/mgp_str/processing_mgp_str.js":(n,e,t)=>{t.r(e),t.d(e,{MgpstrProcessor:()=>l});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js"),a=t("./src/utils/maths.js");const o={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class l extends r.Processor{get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(u,d){if(!o.hasOwnProperty(d))throw new Error(`Format ${d} is not supported.`);const[h,f]=o[d],p=this[h].bind(this),[g,b]=u.dims,_=[],m=[],v=u.tolist();for(let w=0;w<g;++w){const T=v[w],E=[],A=[];for(let F=1;F<b;++F){const[G,S]=(0,a.max)((0,a.softmax)(T[F]));if(A.push(G),S==f)break;E.push(S)}const M=A.length>0?A.reduce((F,G)=>F*G,1):0;m.push(E),_.push(M)}return[p(m),_]}char_decode(u){return this.char_tokenizer.batch_decode(u).map(d=>d.replaceAll(" ",""))}bpe_decode(u){return this.bpe_tokenizer.batch_decode(u)}wp_decode(u){return this.wp_tokenizer.batch_decode(u).map(d=>d.replaceAll(" ",""))}batch_decode([u,d,h]){const[f,p]=this._decode_helper(u,"char"),[g,b]=this._decode_helper(d,"bpe"),[_,m]=this._decode_helper(h,"wp"),v=[],x=[];for(let w=0;w<f.length;++w){const[T,E]=(0,a.max)([p[w],b[w],m[w]]);v.push([f[w],g[w],_[w]][E]),x.push(T)}return{generated_text:v,scores:x,char_preds:f,bpe_preds:g,wp_preds:_}}static async from_pretrained(...u){const d=await super.from_pretrained(...u),h=await s.AutoTokenizer.from_pretrained("Xenova/gpt2"),f=await s.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return d.components={image_processor:d.image_processor,char_tokenizer:d.tokenizer,bpe_tokenizer:h,wp_tokenizer:f},d}async _call(u,d=null){const h=await this.image_processor(u);return d&&(h.labels=this.tokenizer(d).input_ids),h}}Xe(l,"tokenizer_class",s.AutoTokenizer),Xe(l,"image_processor_class",i.AutoImageProcessor)},"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":(n,e,t)=>{t.r(e),t.d(e,{MobileNetV1FeatureExtractor:()=>s,MobileNetV1ImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}class s extends i{}},"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":(n,e,t)=>{t.r(e),t.d(e,{MobileNetV2FeatureExtractor:()=>s,MobileNetV2ImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}class s extends i{}},"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":(n,e,t)=>{t.r(e),t.d(e,{MobileNetV3FeatureExtractor:()=>s,MobileNetV3ImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}class s extends i{}},"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":(n,e,t)=>{t.r(e),t.d(e,{MobileNetV4FeatureExtractor:()=>s,MobileNetV4ImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}class s extends i{}},"./src/models/mobilevit/image_processing_mobilevit.js":(n,e,t)=>{t.r(e),t.d(e,{MobileViTFeatureExtractor:()=>s,MobileViTImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}class s extends i{}},"./src/models/moonshine/feature_extraction_moonshine.js":(n,e,t)=>{t.r(e),t.d(e,{MoonshineFeatureExtractor:()=>s});var r=t("./src/base/feature_extraction_utils.js"),i=t("./src/utils/tensor.js");class s extends r.FeatureExtractor{async _call(o){(0,r.validate_audio_inputs)(o,"MoonshineFeatureExtractor"),o instanceof Float64Array&&(o=new Float32Array(o));const l=[1,o.length];return{input_values:new i.Tensor("float32",o,l)}}}},"./src/models/moonshine/processing_moonshine.js":(n,e,t)=>{t.r(e),t.d(e,{MoonshineProcessor:()=>a});var r=t("./src/models/auto/feature_extraction_auto.js"),i=t("./src/tokenizers.js"),s=t("./src/base/processing_utils.js");class a extends s.Processor{async _call(l){return await this.feature_extractor(l)}}Xe(a,"tokenizer_class",i.AutoTokenizer),Xe(a,"feature_extractor_class",r.AutoFeatureExtractor)},"./src/models/nougat/image_processing_nougat.js":(n,e,t)=>{t.r(e),t.d(e,{NougatImageProcessor:()=>i});var r=t("./src/models/donut/image_processing_donut.js");class i extends r.DonutImageProcessor{}},"./src/models/owlv2/image_processing_owlv2.js":(n,e,t)=>{t.r(e),t.d(e,{Owlv2ImageProcessor:()=>i});var r=t("./src/models/owlvit/image_processing_owlvit.js");class i extends r.OwlViTImageProcessor{}},"./src/models/owlvit/image_processing_owlvit.js":(n,e,t)=>{t.r(e),t.d(e,{OwlViTFeatureExtractor:()=>s,OwlViTImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{post_process_object_detection(...o){return(0,r.post_process_object_detection)(...o)}}class s extends i{}},"./src/models/owlvit/processing_owlvit.js":(n,e,t)=>{t.r(e),t.d(e,{OwlViTProcessor:()=>a});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js");class a extends r.Processor{}Xe(a,"tokenizer_class",s.AutoTokenizer),Xe(a,"image_processor_class",i.AutoImageProcessor)},"./src/models/paligemma/processing_paligemma.js":(n,e,t)=>{t.r(e),t.d(e,{PaliGemmaProcessor:()=>l});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js");const a="<image>";function o(c,u,d,h,f){return`${h.repeat(d*f)}${u}${c}
`}class l extends r.Processor{async _call(u,d=null,h={}){d||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),d=""),Array.isArray(u)||(u=[u]),Array.isArray(d)||(d=[d]);const f=this.tokenizer.bos_token,p=this.image_processor.config.image_seq_length;let g;d.some(m=>m.includes(a))?g=d.map(m=>{const v=m.replaceAll(a,a.repeat(p)),x=v.lastIndexOf(a),w=x===-1?0:x+a.length;return v.slice(0,w)+f+v.slice(w)+`
`}):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),g=d.map(m=>o(m,f,p,a,u.length)));const b=this.tokenizer(g,h);return{...await this.image_processor(u,h),...b}}}Xe(l,"tokenizer_class",s.AutoTokenizer),Xe(l,"image_processor_class",i.AutoImageProcessor),Xe(l,"uses_processor_config",!1)},"./src/models/phi3_v/image_processing_phi3_v.js":(n,e,t)=>{t.r(e),t.d(e,{Phi3VImageProcessor:()=>u});var r=t("./src/base/image_processors_utils.js"),i=t("./src/utils/tensor.js");const s=336,a=[2,3],{ceil:o,floor:l,sqrt:c}=Math;class u extends r.ImageProcessor{constructor(h){super({...h,do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0}),this._num_crops=h.num_crops}calc_num_image_tokens_from_image_size(h,f){const{num_img_tokens:p}=this.config;return l((l(f/s)*l(h/s)+1)*p+1+(l(f/s)+1)*c(p))}get_resize_output_image_size(h,f){const p=this._num_crops,[g,b]=h.size;let _=g/b,m=1;for(;m*Math.ceil(m/_)<=p;)m+=1;m-=1;const v=Math.floor(m*336),x=Math.floor(v/_);return[v,x]}pad_image(h,f,p,g={}){const[b,_]=f,m=s*o(b/s),v=s*o(_/s),x=[1,1,1].map((w,T)=>(w-this.image_mean[T])/this.image_std[T]);return super.pad_image(h,f,{width:v,height:m},{center:!0,constant_values:x,...g})}async _call(h,{num_crops:f=null}={}){if(this._num_crops=f??=this.config.num_crops,f<4||c(f)%1!==0)throw new Error("num_crops must be a square number >= 4");Array.isArray(h)||(h=[h]);const p=h.length,g=await Promise.all(h.map(E=>this.preprocess(E))),b=g.map(E=>E.original_size),_=g.map(E=>E.reshaped_input_size),m=[];for(const{pixel_values:E}of g){E.unsqueeze_(0);const[A,M]=E.dims.slice(-2),F=await(0,i.interpolate_4d)(E,{size:[s,s],mode:"bicubic"});if(f>0){const G=[],S=c(f),I=l(M/S),C=l(A/S);for(let B=0;B<S;++B)for(let $=0;$<S;++$){let X,V,Q,R;B===S-1?(V=A-C,R=A):(V=B*C,R=(B+1)*C),$===S-1?(X=M-I,Q=M):(X=$*I,Q=($+1)*I);const O=[V,X],L=[R,Q],ne=await(0,i.slice)(E,O,L,a);G.push(ne)}const H=await(0,i.interpolate_4d)((0,i.cat)(G,0),{size:[s,s],mode:"bicubic"});m.push((0,i.cat)([F,H],0))}else m.push(F)}const v=(0,i.stack)(m,0),x=_.map(E=>E.map(A=>s*o(A/s))),w=new i.Tensor("int64",x.flat(),[p,2]),T=x.map(([E,A])=>this.calc_num_image_tokens_from_image_size(A,E));return{pixel_values:v,original_sizes:b,reshaped_input_sizes:_,image_sizes:w,num_img_tokens:T}}}},"./src/models/phi3_v/processing_phi3_v.js":(n,e,t)=>{t.r(e),t.d(e,{Phi3VProcessor:()=>l});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js");t("./src/utils/image.js");const a="<|image|>",o=/<\|image_\d+\|>/g;class l extends r.Processor{async _call(u,d=null,{padding:h=!0,truncation:f=!0,num_crops:p=null}={}){Array.isArray(u)||(u=[u]);let g,b;if(d){b=await this.image_processor(d,{num_crops:p});const{num_img_tokens:_}=b,m=u.map((x,w)=>x.split(o).join(a.repeat(_[w])));g=this.tokenizer(m,{padding:h,truncation:f});const v=this.tokenizer.model.convert_tokens_to_ids([a])[0];g.input_ids.map_(x=>x==v?-x:x)}else g=this.tokenizer(u);return{...g,...b}}}Xe(l,"image_processor_class",i.AutoImageProcessor),Xe(l,"tokenizer_class",s.AutoTokenizer)},"./src/models/processors.js":(n,e,t)=>{t.r(e),t.d(e,{Florence2Processor:()=>r.Florence2Processor,GroundingDinoProcessor:()=>i.GroundingDinoProcessor,Idefics3Processor:()=>s.Idefics3Processor,JinaCLIPProcessor:()=>o.JinaCLIPProcessor,MgpstrProcessor:()=>l.MgpstrProcessor,MoonshineProcessor:()=>c.MoonshineProcessor,OwlViTProcessor:()=>u.OwlViTProcessor,PaliGemmaProcessor:()=>h.PaliGemmaProcessor,Phi3VProcessor:()=>d.Phi3VProcessor,PyAnnoteProcessor:()=>f.PyAnnoteProcessor,Qwen2VLProcessor:()=>p.Qwen2VLProcessor,SamProcessor:()=>g.SamProcessor,SmolVLMProcessor:()=>b.SmolVLMProcessor,SpeechT5Processor:()=>_.SpeechT5Processor,UltravoxProcessor:()=>m.UltravoxProcessor,VLChatProcessor:()=>a.VLChatProcessor,Wav2Vec2Processor:()=>v.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>x.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>w.WhisperProcessor});var r=t("./src/models/florence2/processing_florence2.js"),i=t("./src/models/grounding_dino/processing_grounding_dino.js"),s=t("./src/models/idefics3/processing_idefics3.js"),a=t("./src/models/janus/processing_janus.js"),o=t("./src/models/jina_clip/processing_jina_clip.js"),l=t("./src/models/mgp_str/processing_mgp_str.js"),c=t("./src/models/moonshine/processing_moonshine.js"),u=t("./src/models/owlvit/processing_owlvit.js"),d=t("./src/models/phi3_v/processing_phi3_v.js"),h=t("./src/models/paligemma/processing_paligemma.js"),f=t("./src/models/pyannote/processing_pyannote.js"),p=t("./src/models/qwen2_vl/processing_qwen2_vl.js"),g=t("./src/models/sam/processing_sam.js"),b=t("./src/models/smolvlm/processing_smolvlm.js"),_=t("./src/models/speecht5/processing_speecht5.js"),m=t("./src/models/ultravox/processing_ultravox.js"),v=t("./src/models/wav2vec2/processing_wav2vec2.js"),x=t("./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js"),w=t("./src/models/whisper/processing_whisper.js")},"./src/models/pvt/image_processing_pvt.js":(n,e,t)=>{t.r(e),t.d(e,{PvtImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}},"./src/models/pyannote/feature_extraction_pyannote.js":(n,e,t)=>{t.r(e),t.d(e,{PyAnnoteFeatureExtractor:()=>a});var r=t("./src/base/feature_extraction_utils.js"),i=t("./src/utils/tensor.js"),s=t("./src/utils/maths.js");class a extends r.FeatureExtractor{async _call(l){(0,r.validate_audio_inputs)(l,"PyAnnoteFeatureExtractor"),l instanceof Float64Array&&(l=new Float32Array(l));const c=[1,1,l.length];return{input_values:new i.Tensor("float32",l,c)}}samples_to_frames(l){return(l-this.config.offset)/this.config.step}post_process_speaker_diarization(l,c){const u=c/this.samples_to_frames(c)/this.config.sampling_rate,d=[];for(const h of l.tolist()){const f=[];let p=-1;for(let g=0;g<h.length;++g){const b=(0,s.softmax)(h[g]),[_,m]=(0,s.max)(b),[v,x]=[g,g+1];m!==p?(p=m,f.push({id:m,start:v,end:x,score:_})):(f.at(-1).end=x,f.at(-1).score+=_)}d.push(f.map(({id:g,start:b,end:_,score:m})=>({id:g,start:b*u,end:_*u,confidence:m/(_-b)})))}return d}}},"./src/models/pyannote/processing_pyannote.js":(n,e,t)=>{t.r(e),t.d(e,{PyAnnoteProcessor:()=>s});var r=t("./src/base/processing_utils.js"),i=t("./src/models/pyannote/feature_extraction_pyannote.js");class s extends r.Processor{async _call(o){return await this.feature_extractor(o)}post_process_speaker_diarization(...o){return this.feature_extractor.post_process_speaker_diarization(...o)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}Xe(s,"feature_extractor_class",i.PyAnnoteFeatureExtractor)},"./src/models/qwen2_vl/image_processing_qwen2_vl.js":(n,e,t)=>{t.r(e),t.d(e,{Qwen2VLImageProcessor:()=>s});var r=t("./src/base/image_processors_utils.js"),i=t("./src/utils/tensor.js");class s extends r.ImageProcessor{async _call(o,...l){const{pixel_values:c,original_sizes:u,reshaped_input_sizes:d}=await super._call(o,...l);let h=c;const{temporal_patch_size:f,merge_size:p,patch_size:g}=this.config;h.dims[0]===1&&(h=(0,i.cat)(Array.from({length:f},()=>h),0));const b=h.dims[0]/f,_=h.dims[1],m=Math.floor(h.dims[2]/g),v=Math.floor(h.dims[3]/g),x=h.view(b,f,_,Math.floor(m/p),p,g,Math.floor(v/p),p,g).permute(0,3,6,4,7,2,1,5,8).view(b*m*v,_*f*g*g),w=new i.Tensor("int64",[b,m,v],[1,3]);return{pixel_values:x,image_grid_thw:w,original_sizes:u,reshaped_input_sizes:d}}}},"./src/models/qwen2_vl/processing_qwen2_vl.js":(n,e,t)=>{t.r(e),t.d(e,{Qwen2VLProcessor:()=>a});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js"),s=t("./src/tokenizers.js");t("./src/utils/image.js");class a extends r.Processor{async _call(l,c=null,...u){Array.isArray(l)||(l=[l]);let d,h;if(c&&(d=await this.image_processor(c),h=d.image_grid_thw),h){let p=this.image_processor.config.merge_size**2,g=0;const b=h.tolist();l=l.map(_=>{for(;_.includes("<|image_pad|>");){const m=Number(b[g++].reduce((v,x)=>v*x,1n));_=_.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(m/p)))}return _.replaceAll("<|placeholder|>","<|image_pad|>")})}return{...this.tokenizer(l),...d}}}Xe(a,"image_processor_class",i.AutoImageProcessor),Xe(a,"tokenizer_class",s.AutoTokenizer)},"./src/models/rt_detr/image_processing_rt_detr.js":(n,e,t)=>{t.r(e),t.d(e,{RTDetrImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{post_process_object_detection(...a){return(0,r.post_process_object_detection)(...a)}}},"./src/models/sam/image_processing_sam.js":(n,e,t)=>{t.r(e),t.d(e,{SamImageProcessor:()=>a});var r=t("./src/base/image_processors_utils.js"),i=t("./src/utils/core.js"),s=t("./src/utils/tensor.js");class a extends r.ImageProcessor{reshape_input_points(l,c,u,d=!1){l=structuredClone(l);let h=(0,i.calculateDimensions)(l);if(h.length===3)d||(h=[1,...h]),l=[l];else if(h.length!==4)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let f=0;f<l.length;++f){let p=c[f],g=u[f],b=[g[0]/p[0],g[1]/p[1]];for(let _=0;_<l[f].length;++_)for(let m=0;m<l[f][_].length;++m)for(let v=0;v<l[f][_][m].length;++v)l[f][_][m][v]*=b[v%2]}return new s.Tensor("float32",Float32Array.from(l.flat(1/0)),h)}add_input_labels(l,c){let u=(0,i.calculateDimensions)(l);if(u.length===2)u=[1,...u],l=[l];else if(u.length!==3)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(u.some((d,h)=>d!==c.dims[h]))throw Error(`The first ${u.length} dimensions of 'input_points' and 'input_labels' must be the same.`);return new s.Tensor("int64",l.flat(1/0).map(BigInt),u)}async _call(l,{input_points:c=null,input_labels:u=null,input_boxes:d=null}={}){const h=await super._call(l);if(c&&(h.input_points=this.reshape_input_points(c,h.original_sizes,h.reshaped_input_sizes)),u){if(!h.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");h.input_labels=this.add_input_labels(u,h.input_points)}return d&&(h.input_boxes=this.reshape_input_points(d,h.original_sizes,h.reshaped_input_sizes,!0)),h}async post_process_masks(l,c,u,{mask_threshold:d=0,binarize:h=!0,pad_size:f=null}={}){const p=[];f=f??this.pad_size;const g=[f.height,f.width];for(let b=0;b<c.length;++b){const _=c[b],m=u[b];let v=await(0,s.interpolate_4d)(l[b],{mode:"bilinear",size:g});if(v=v.slice(null,null,[0,m[0]],[0,m[1]]),v=await(0,s.interpolate_4d)(v,{mode:"bilinear",size:_}),h){const x=v.data,w=new Uint8Array(x.length);for(let T=0;T<x.length;++T)x[T]>d&&(w[T]=1);v=new s.Tensor("bool",w,v.dims)}p.push(v)}return p}generate_crop_boxes(l,c,{crop_n_layers:u=0,overlap_ratio:d=512/1500,points_per_crop:h=32,crop_n_points_downscale_factor:f=1}={}){}}},"./src/models/sam/processing_sam.js":(n,e,t)=>{t.r(e),t.d(e,{SamProcessor:()=>s});var r=t("./src/base/processing_utils.js"),i=t("./src/models/auto/image_processing_auto.js");class s extends r.Processor{async _call(...o){return await this.image_processor(...o)}post_process_masks(...o){return this.image_processor.post_process_masks(...o)}reshape_input_points(...o){return this.image_processor.reshape_input_points(...o)}}Xe(s,"image_processor_class",i.AutoImageProcessor)},"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":(n,e,t)=>{t.r(e),t.d(e,{SeamlessM4TFeatureExtractor:()=>a});var r=t("./src/base/feature_extraction_utils.js"),i=t("./src/utils/tensor.js"),s=t("./src/utils/audio.js");class a extends r.FeatureExtractor{constructor(l){super(l);const c=this.config.sampling_rate,u=(0,s.mel_filter_bank)(256,this.config.num_mel_bins,20,Math.floor(c/2),c,null,"kaldi",!0);for(let d=0;d<u.length;++d)u[d].push(0);this.mel_filters=u,this.window=(0,s.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features(l,c){return l=l.map(u=>u*32768),(0,s.spectrogram)(l,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,max_num_frames:c,transpose:!0})}async _call(l,{padding:c=!0,pad_to_multiple_of:u=2,do_normalize_per_mel_bins:d=!0,return_attention_mask:h=!0}={}){(0,r.validate_audio_inputs)(l,"SeamlessM4TFeatureExtractor");let f=await this._extract_fbank_features(l,this.config.max_length);if(d){const[w,T]=f.dims,E=f.data;for(let A=0;A<T;++A){let M=0;for(let I=0;I<w;++I)M+=E[I*T+A];const F=M/w;let G=0;for(let I=0;I<w;++I)G+=(E[I*T+A]-F)**2;G/=w-1;const S=Math.sqrt(G+1e-7);for(let I=0;I<w;++I){const C=I*T+A;E[C]=(E[C]-F)/S}}}let p;if(c){const[w,T]=f.dims,E=f.data,A=w%u;if(A>0){const M=new Float32Array(T*(w+A));M.set(E),M.fill(this.config.padding_value,E.length);const F=w+A;f=new i.Tensor(f.type,M,[F,T]),h&&(p=new i.Tensor("int64",new BigInt64Array(F),[1,F]),p.data.fill(1n,0,w))}}const[g,b]=f.dims,_=this.config.stride;if(g%_!==0)throw new Error(`The number of frames (${g}) must be a multiple of the stride (${_}).`);const v=f.view(1,Math.floor(g/_),b*_),x={input_features:v};if(h){const w=v.dims[1],T=new BigInt64Array(w);if(p){const E=p.data;for(let A=1,M=0;A<g;A+=_,++M)T[M]=E[A]}else T.fill(1n);x.attention_mask=new i.Tensor("int64",T,[1,w])}return x}}},"./src/models/segformer/image_processing_segformer.js":(n,e,t)=>{t.r(e),t.d(e,{SegformerFeatureExtractor:()=>s,SegformerImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{post_process_semantic_segmentation(...o){return(0,r.post_process_semantic_segmentation)(...o)}}class s extends i{}},"./src/models/siglip/image_processing_siglip.js":(n,e,t)=>{t.r(e),t.d(e,{SiglipImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}},"./src/models/smolvlm/image_processing_smolvlm.js":(n,e,t)=>{t.r(e),t.d(e,{SmolVLMImageProcessor:()=>r.Idefics3ImageProcessor});var r=t("./src/models/idefics3/image_processing_idefics3.js")},"./src/models/smolvlm/processing_smolvlm.js":(n,e,t)=>{t.r(e),t.d(e,{SmolVLMProcessor:()=>r.Idefics3Processor});var r=t("./src/models/idefics3/processing_idefics3.js")},"./src/models/speecht5/feature_extraction_speecht5.js":(n,e,t)=>{t.r(e),t.d(e,{SpeechT5FeatureExtractor:()=>i});var r=t("./src/base/feature_extraction_utils.js");class i extends r.FeatureExtractor{}},"./src/models/speecht5/processing_speecht5.js":(n,e,t)=>{t.r(e),t.d(e,{SpeechT5Processor:()=>a});var r=t("./src/base/processing_utils.js"),i=t("./src/tokenizers.js"),s=t("./src/models/auto/feature_extraction_auto.js");class a extends r.Processor{async _call(l){return await this.feature_extractor(l)}}Xe(a,"tokenizer_class",i.AutoTokenizer),Xe(a,"feature_extractor_class",s.AutoFeatureExtractor)},"./src/models/swin2sr/image_processing_swin2sr.js":(n,e,t)=>{t.r(e),t.d(e,{Swin2SRImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{pad_image(a,o,l,c={}){const[u,d,h]=o;return super.pad_image(a,o,{width:d+(l-d%l)%l,height:u+(l-u%l)%l},{mode:"symmetric",center:!1,constant_values:-1,...c})}}},"./src/models/ultravox/processing_ultravox.js":(n,e,t)=>{t.r(e),t.d(e,{UltravoxProcessor:()=>a});var r=t("./src/models/auto/feature_extraction_auto.js"),i=t("./src/tokenizers.js"),s=t("./src/base/processing_utils.js");class a extends s.Processor{async _call(l,c=null,u={}){if(Array.isArray(l))throw new Error("Batched inputs are not supported yet.");let d={};if(c){const f=c.length,{input_features:p}=await this.feature_extractor(c,{...u,max_length:f}),g=Math.round(f/this.config.encoder_ds_factor+1e-4),b=1+Math.ceil(g/this.config.stack_factor);d.audio_token_len=[b],d.audio_values=p;const _=this.config.audio_placeholder;if(!l.includes(_))throw new Error(`The input text does not contain the image token ${_}.`);l=l.replaceAll(_,_.repeat(b))}return{...this.tokenizer(l,{add_special_tokens:!1,...u}),...d}}}Xe(a,"tokenizer_class",i.AutoTokenizer),Xe(a,"feature_extractor_class",r.AutoFeatureExtractor),Xe(a,"uses_processor_config",!0)},"./src/models/vit/image_processing_vit.js":(n,e,t)=>{t.r(e),t.d(e,{ViTFeatureExtractor:()=>s,ViTImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{}class s extends i{}},"./src/models/vitmatte/image_processing_vitmatte.js":(n,e,t)=>{t.r(e),t.d(e,{VitMatteImageProcessor:()=>s});var r=t("./src/base/image_processors_utils.js"),i=t("./src/utils/tensor.js");class s extends r.ImageProcessor{async _call(o,l){Array.isArray(o)||(o=[o]),Array.isArray(l)||(l=[l]);const c=await Promise.all(o.map(h=>this.preprocess(h))),u=await Promise.all(l.map(h=>this.preprocess(h,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})));return{pixel_values:(0,i.stack)(c.map((h,f)=>(0,i.cat)([h.pixel_values,u[f].pixel_values],0)),0),original_sizes:c.map(h=>h.original_size),reshaped_input_sizes:c.map(h=>h.reshaped_input_size)}}}},"./src/models/vitpose/image_processing_vitpose.js":(n,e,t)=>{t.r(e),t.d(e,{VitPoseImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{post_process_pose_estimation(a,o,{threshold:l=null}={}){const c=a.tolist(),[u,d,h,f]=a.dims,p=[];for(let g=0;g<u;++g){const b=c[g],_=o[g],m=[];for(let v=0;v<_.length;++v){const x=_[v],w=[],T=[],E=[],A=x.at(-2)/f,M=x.at(-1)/h;for(let F=0;F<b.length;++F){let[G,S]=[0,0],I=0,C=-1/0;const H=b[F];for(let $=0;$<H.length;++$){const X=H[$];for(let V=0;V<X.length;++V){const Q=X[V];I+=Q,C=Math.max(C,Q),G+=(V+.5)*Q,S+=$*Q}}if(l!=null&&C<l)continue;const B=[A*G/I,M*S/I];w.push(B),E.push(F),T.push(C)}m.push({bbox:x,scores:T,labels:E,keypoints:w})}p.push(m)}return p}}},"./src/models/wav2vec2/feature_extraction_wav2vec2.js":(n,e,t)=>{t.r(e),t.d(e,{Wav2Vec2FeatureExtractor:()=>s});var r=t("./src/base/feature_extraction_utils.js"),i=t("./src/utils/tensor.js");class s extends r.FeatureExtractor{_zero_mean_unit_var_norm(o){const c=o.reduce((d,h)=>d+h,0)/o.length,u=o.reduce((d,h)=>d+(h-c)**2,0)/o.length;return o.map(d=>(d-c)/Math.sqrt(u+1e-7))}async _call(o){(0,r.validate_audio_inputs)(o,"Wav2Vec2FeatureExtractor"),o instanceof Float64Array&&(o=new Float32Array(o));let l=o;this.config.do_normalize&&(l=this._zero_mean_unit_var_norm(l));const c=[1,l.length];return{input_values:new i.Tensor("float32",l,c),attention_mask:new i.Tensor("int64",new BigInt64Array(l.length).fill(1n),c)}}}},"./src/models/wav2vec2/processing_wav2vec2.js":(n,e,t)=>{t.r(e),t.d(e,{Wav2Vec2Processor:()=>a});var r=t("./src/tokenizers.js"),i=t("./src/models/auto/feature_extraction_auto.js"),s=t("./src/base/processing_utils.js");class a extends s.Processor{async _call(l){return await this.feature_extractor(l)}}Xe(a,"tokenizer_class",r.AutoTokenizer),Xe(a,"feature_extractor_class",i.AutoFeatureExtractor)},"./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js":(n,e,t)=>{t.r(e),t.d(e,{Wav2Vec2ProcessorWithLM:()=>a});var r=t("./src/tokenizers.js"),i=t("./src/models/auto/feature_extraction_auto.js"),s=t("./src/base/processing_utils.js");class a extends s.Processor{async _call(l){return await this.feature_extractor(l)}}Xe(a,"tokenizer_class",r.AutoTokenizer),Xe(a,"feature_extractor_class",i.AutoFeatureExtractor)},"./src/models/wespeaker/feature_extraction_wespeaker.js":(n,e,t)=>{t.r(e),t.d(e,{WeSpeakerFeatureExtractor:()=>s});var r=t("./src/base/feature_extraction_utils.js");t("./src/utils/tensor.js");var i=t("./src/utils/audio.js");class s extends r.FeatureExtractor{constructor(o){super(o);const l=this.config.sampling_rate,c=(0,i.mel_filter_bank)(256,this.config.num_mel_bins,20,Math.floor(l/2),l,null,"kaldi",!0);for(let u=0;u<c.length;++u)c[u].push(0);this.mel_filters=c,this.window=(0,i.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(o){return o=o.map(l=>l*32768),(0,i.spectrogram)(o,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1192092955078125e-22,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(o){(0,r.validate_audio_inputs)(o,"WeSpeakerFeatureExtractor");const l=(await this._extract_fbank_features(o)).unsqueeze_(0);if(this.config.fbank_centering_span===null){const c=l.mean(1).data,u=l.data,[d,h,f]=l.dims;for(let p=0;p<d;++p){const g=p*h*f,b=p*f;for(let _=0;_<h;++_){const m=g+_*f;for(let v=0;v<f;++v)u[m+v]-=c[b+v]}}}return{input_features:l}}}},"./src/models/whisper/common_whisper.js":(n,e,t)=>{t.r(e),t.d(e,{WHISPER_LANGUAGE_MAPPING:()=>i,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>s,whisper_language_to_code:()=>a});const r=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],i=new Map(r),s=new Map([...r.map(([o,l])=>[l,o]),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function a(o){o=o.toLowerCase();let l=s.get(o);if(l===void 0){const c=o.match(/^<\|([a-z]{2})\|>$/);if(c&&(o=c[1]),i.has(o))l=o;else{const d=o.length===2?i.keys():i.values();throw new Error(`Language "${o}" is not supported. Must be one of: ${JSON.stringify(Array.from(d))}`)}}return l}},"./src/models/whisper/feature_extraction_whisper.js":(n,e,t)=>{t.r(e),t.d(e,{WhisperFeatureExtractor:()=>a});var r=t("./src/base/feature_extraction_utils.js");t("./src/utils/tensor.js");var i=t("./src/utils/audio.js"),s=t("./src/utils/maths.js");class a extends r.FeatureExtractor{constructor(l){super(l),this.config.mel_filters??=(0,i.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney"),this.window=(0,i.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features(l){const c=await(0,i.spectrogram)(l,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:Math.min(Math.floor(l.length/this.config.hop_length),this.config.nb_max_frames)}),u=c.data,d=(0,s.max)(u)[0];for(let h=0;h<u.length;++h)u[h]=(Math.max(u[h],d-8)+4)/4;return c}async _call(l,{max_length:c=null}={}){(0,r.validate_audio_inputs)(l,"WhisperFeatureExtractor");let u;const d=c??this.config.n_samples;return l.length>d?(l.length>this.config.n_samples&&console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),u=l.slice(0,d)):(u=new Float32Array(d),u.set(l)),{input_features:(await this._extract_fbank_features(u)).unsqueeze_(0)}}}},"./src/models/whisper/generation_whisper.js":(n,e,t)=>{t.r(e),t.d(e,{WhisperGenerationConfig:()=>i});var r=t("./src/generation/configuration_utils.js");class i extends r.GenerationConfig{return_timestamps=null;return_token_timestamps=null;num_frames=null;alignment_heads=null;task=null;language=null;no_timestamps_token_id=null;prompt_ids=null;is_multilingual=null;lang_to_id=null;task_to_id=null;max_initial_timestamp_index=1}},"./src/models/whisper/processing_whisper.js":(n,e,t)=>{t.r(e),t.d(e,{WhisperProcessor:()=>a});var r=t("./src/models/auto/feature_extraction_auto.js"),i=t("./src/tokenizers.js"),s=t("./src/base/processing_utils.js");class a extends s.Processor{async _call(l){return await this.feature_extractor(l)}}Xe(a,"tokenizer_class",i.AutoTokenizer),Xe(a,"feature_extractor_class",r.AutoFeatureExtractor)},"./src/models/yolos/image_processing_yolos.js":(n,e,t)=>{t.r(e),t.d(e,{YolosFeatureExtractor:()=>s,YolosImageProcessor:()=>i});var r=t("./src/base/image_processors_utils.js");class i extends r.ImageProcessor{post_process_object_detection(...o){return(0,r.post_process_object_detection)(...o)}}class s extends i{}},"./src/ops/registry.js":(n,e,t)=>{t.r(e),t.d(e,{TensorOpRegistry:()=>l});var r=t("./src/backends/onnx.js"),i=t("./src/utils/tensor.js"),s=t("./src/env.js");const a=s.apis.IS_BROWSER_ENV||s.apis.IS_WEBWORKER_ENV,o=async(c,u,d)=>{const h=await(0,r.createInferenceSession)(new Uint8Array(c),u);let f=Promise.resolve();return async p=>{const g=(0,r.isONNXProxy)(),b=Object.fromEntries(Object.entries(p).map(([m,v])=>[m,(g?v.clone():v).ort_tensor])),_=await(f=a?f.then(()=>h.run(b)):h.run(b));return Array.isArray(d)?d.map(m=>new i.Tensor(_[m])):new i.Tensor(_[d])}};class l{static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=o([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=o([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=o([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=o([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=o([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=o([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=o([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=o([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}Xe(l,"session_options",{})},"./src/pipelines.js":(n,e,t)=>{t.r(e),t.d(e,{AudioClassificationPipeline:()=>S,AutomaticSpeechRecognitionPipeline:()=>C,BackgroundRemovalPipeline:()=>X,DepthEstimationPipeline:()=>de,DocumentQuestionAnsweringPipeline:()=>O,FeatureExtractionPipeline:()=>F,FillMaskPipeline:()=>v,ImageClassificationPipeline:()=>B,ImageFeatureExtractionPipeline:()=>G,ImageSegmentationPipeline:()=>$,ImageToImagePipeline:()=>ne,ImageToTextPipeline:()=>H,ObjectDetectionPipeline:()=>Q,Pipeline:()=>g,QuestionAnsweringPipeline:()=>m,SummarizationPipeline:()=>w,Text2TextGenerationPipeline:()=>x,TextClassificationPipeline:()=>b,TextGenerationPipeline:()=>A,TextToAudioPipeline:()=>L,TokenClassificationPipeline:()=>_,TranslationPipeline:()=>T,ZeroShotAudioClassificationPipeline:()=>I,ZeroShotClassificationPipeline:()=>M,ZeroShotImageClassificationPipeline:()=>V,ZeroShotObjectDetectionPipeline:()=>R,pipeline:()=>Ee});var r=t("./src/tokenizers.js"),i=t("./src/models.js"),s=t("./src/models/auto/processing_auto.js");t("./src/base/processing_utils.js");var a=t("./src/utils/generic.js"),o=t("./src/utils/core.js"),l=t("./src/utils/maths.js"),c=t("./src/utils/audio.js"),u=t("./src/utils/tensor.js"),d=t("./src/utils/image.js");async function h(xe){return Array.isArray(xe)||(xe=[xe]),await Promise.all(xe.map(ce=>d.RawImage.read(ce)))}async function f(xe,ce){return Array.isArray(xe)||(xe=[xe]),await Promise.all(xe.map(ue=>typeof ue=="string"||ue instanceof URL?(0,c.read_audio)(ue,ce):ue instanceof Float64Array?new Float32Array(ue):ue))}function p(xe,ce){ce&&(xe=xe.map(pe=>pe|0));const[ue,Se,U,he]=xe;return{xmin:ue,ymin:Se,xmax:U,ymax:he}}class g extends a.Callable{constructor({task:ce,model:ue,tokenizer:Se=null,processor:U=null}){super(),this.task=ce,this.model=ue,this.tokenizer=Se,this.processor=U}async dispose(){await this.model.dispose()}}class b extends g{constructor(ce){super(ce)}async _call(ce,{top_k:ue=1}={}){const Se=this.tokenizer(ce,{padding:!0,truncation:!0}),U=await this.model(Se),he=this.model.config.problem_type==="multi_label_classification"?re=>re.sigmoid():re=>new u.Tensor("float32",(0,l.softmax)(re.data),re.dims),pe=this.model.config.id2label,ie=[];for(const re of U.logits){const ge=he(re),Ce=await(0,u.topk)(ge,ue),q=Ce[0].tolist(),j=Ce[1].tolist().map((ee,se)=>({label:pe?pe[ee]:`LABEL_${ee}`,score:q[se]}));ue===1?ie.push(...j):ie.push(j)}return Array.isArray(ce)||ue===1?ie:ie[0]}}class _ extends g{constructor(ce){super(ce)}async _call(ce,{ignore_labels:ue=["O"]}={}){const Se=Array.isArray(ce),U=this.tokenizer(Se?ce:[ce],{padding:!0,truncation:!0}),pe=(await this.model(U)).logits,ie=this.model.config.id2label,re=[];for(let ge=0;ge<pe.dims[0];++ge){const Ce=U.input_ids[ge],q=pe[ge],te=[];for(let j=0;j<q.dims[0];++j){const ee=q[j],se=(0,l.max)(ee.data)[1],ve=ie?ie[se]:`LABEL_${se}`;if(ue.includes(ve))continue;const ke=this.tokenizer.decode([Ce[j].item()],{skip_special_tokens:!0});if(ke==="")continue;const Re=(0,l.softmax)(ee.data);te.push({entity:ve,score:Re[se],index:j,word:ke})}re.push(te)}return Se?re:re[0]}}class m extends g{constructor(ce){super(ce)}async _call(ce,ue,{top_k:Se=1}={}){const U=this.tokenizer(ce,{text_pair:ue,padding:!0,truncation:!0}),{start_logits:he,end_logits:pe}=await this.model(U),ie=U.input_ids.tolist(),re=U.attention_mask.tolist(),ge=this.tokenizer.all_special_ids,Ce=[];for(let q=0;q<he.dims[0];++q){const te=ie[q],j=te.findIndex(Oe=>Oe==this.tokenizer.sep_token_id);re[q].map((Oe,ze)=>Oe==1&&(ze===0||ze>j&&ge.findIndex(Te=>Te==te[ze])===-1));const ee=he[q].tolist(),se=pe[q].tolist();for(let Oe=1;Oe<ee.length;++Oe)(re[q]==0||Oe<=j||ge.findIndex(ze=>ze==te[Oe])!==-1)&&(ee[Oe]=-1/0,se[Oe]=-1/0);const ve=(0,l.softmax)(ee).map((Oe,ze)=>[Oe,ze]),ke=(0,l.softmax)(se).map((Oe,ze)=>[Oe,ze]);ve[0][0]=0,ke[0][0]=0;const Re=(0,o.product)(ve,ke).filter(Oe=>Oe[0][1]<=Oe[1][1]).map(Oe=>[Oe[0][1],Oe[1][1],Oe[0][0]*Oe[1][0]]).sort((Oe,ze)=>ze[2]-Oe[2]);for(let Oe=0;Oe<Math.min(Re.length,Se);++Oe){const[ze,Te,Be]=Re[Oe],qe=te.slice(ze,Te+1),tt=this.tokenizer.decode(qe,{skip_special_tokens:!0});Ce.push({answer:tt,score:Be})}}return Se===1?Ce[0]:Ce}}class v extends g{constructor(ce){super(ce)}async _call(ce,{top_k:ue=5}={}){const Se=this.tokenizer(ce,{padding:!0,truncation:!0}),{logits:U}=await this.model(Se),he=[],pe=Se.input_ids.tolist();for(let ie=0;ie<pe.length;++ie){const re=pe[ie],ge=re.findIndex(ee=>ee==this.tokenizer.mask_token_id);if(ge===-1)throw Error(`Mask token (${this.tokenizer.mask_token}) not found in text.`);const Ce=U[ie][ge],q=await(0,u.topk)(new u.Tensor("float32",(0,l.softmax)(Ce.data),Ce.dims),ue),te=q[0].tolist(),j=q[1].tolist();he.push(j.map((ee,se)=>{const ve=re.slice();return ve[ge]=ee,{score:te[se],token:Number(ee),token_str:this.tokenizer.decode([ee]),sequence:this.tokenizer.decode(ve,{skip_special_tokens:!0})}}))}return Array.isArray(ce)?he:he[0]}}class x extends g{_key="generated_text";constructor(ce){super(ce)}async _call(ce,ue={}){Array.isArray(ce)||(ce=[ce]),this.model.config.prefix&&(ce=ce.map(re=>this.model.config.prefix+re));const Se=this.model.config.task_specific_params;Se&&Se[this.task]&&Se[this.task].prefix&&(ce=ce.map(re=>Se[this.task].prefix+re));const U=this.tokenizer,he={padding:!0,truncation:!0};let pe;this instanceof T&&"_build_translation_inputs"in U?pe=U._build_translation_inputs(ce,he,ue):pe=U(ce,he);const ie=await this.model.generate({...pe,...ue});return U.batch_decode(ie,{skip_special_tokens:!0}).map(re=>({[this._key]:re}))}}class w extends x{_key="summary_text";constructor(ce){super(ce)}}class T extends x{_key="translation_text";constructor(ce){super(ce)}}function E(xe){return Array.isArray(xe)&&xe.every(ce=>"role"in ce&&"content"in ce)}class A extends g{constructor(ce){super(ce)}async _call(ce,ue={}){let Se=!1,U=!1,he;if(typeof ce=="string")he=ce=[ce];else if(Array.isArray(ce)&&ce.every(j=>typeof j=="string"))Se=!0,he=ce;else{if(E(ce))ce=[ce];else if(Array.isArray(ce)&&ce.every(E))Se=!0;else throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");U=!0,he=ce.map(j=>this.tokenizer.apply_chat_template(j,{tokenize:!1,add_generation_prompt:!0}))}const pe=ue.add_special_tokens??!1,ie=U?!1:ue.return_full_text??!0;this.tokenizer.padding_side="left";const re=this.tokenizer(he,{add_special_tokens:pe,padding:!0,truncation:!0}),ge=await this.model.generate({...re,...ue}),Ce=this.tokenizer.batch_decode(ge,{skip_special_tokens:!0});let q;!ie&&re.input_ids.dims.at(-1)>0&&(q=this.tokenizer.batch_decode(re.input_ids,{skip_special_tokens:!0}).map(j=>j.length));const te=Array.from({length:ce.length},j=>[]);for(let j=0;j<Ce.length;++j){const ee=Math.floor(j/ge.dims[0]*ce.length);q&&(Ce[j]=Ce[j].slice(q[ee])),te[ee].push({generated_text:U?[...ce[ee],{role:"assistant",content:Ce[j]}]:Ce[j]})}return!Se&&te.length===1?te[0]:te}}class M extends g{constructor(ce){super(ce),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map(([ue,Se])=>[ue.toLowerCase(),Se])),this.entailment_id=this.label2id.entailment,this.entailment_id===void 0&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=this.label2id.contradiction??this.label2id.not_entailment,this.contradiction_id===void 0&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(ce,ue,{hypothesis_template:Se="This example is {}.",multi_label:U=!1}={}){const he=Array.isArray(ce);he||(ce=[ce]),Array.isArray(ue)||(ue=[ue]);const pe=ue.map(ge=>Se.replace("{}",ge)),ie=U||ue.length===1,re=[];for(const ge of ce){const Ce=[];for(const j of pe){const ee=this.tokenizer(ge,{text_pair:j,padding:!0,truncation:!0}),se=await this.model(ee);ie?Ce.push([se.logits.data[this.contradiction_id],se.logits.data[this.entailment_id]]):Ce.push(se.logits.data[this.entailment_id])}const te=(ie?Ce.map(j=>(0,l.softmax)(j)[1]):(0,l.softmax)(Ce)).map((j,ee)=>[j,ee]).sort((j,ee)=>ee[0]-j[0]);re.push({sequence:ge,labels:te.map(j=>ue[j[1]]),scores:te.map(j=>j[0])})}return he?re:re[0]}}class F extends g{constructor(ce){super(ce)}async _call(ce,{pooling:ue="none",normalize:Se=!1,quantize:U=!1,precision:he="binary"}={}){const pe=this.tokenizer(ce,{padding:!0,truncation:!0}),ie=await this.model(pe);let re=ie.last_hidden_state??ie.logits??ie.token_embeddings;if(ue!=="none")if(ue==="mean")re=(0,u.mean_pooling)(re,pe.attention_mask);else if(ue==="cls")re=re.slice(null,0);else throw Error(`Pooling method '${ue}' not supported.`);return Se&&(re=re.normalize(2,-1)),U&&(re=(0,u.quantize_embeddings)(re,he)),re}}class G extends g{constructor(ce){super(ce)}async _call(ce,{pool:ue=null}={}){const Se=await h(ce),{pixel_values:U}=await this.processor(Se),he=await this.model({pixel_values:U});let pe;if(ue){if(!("pooler_output"in he))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");pe=he.pooler_output}else pe=he.last_hidden_state??he.logits??he.image_embeds;return pe}}class S extends g{constructor(ce){super(ce)}async _call(ce,{top_k:ue=5}={}){const Se=this.processor.feature_extractor.config.sampling_rate,U=await f(ce,Se),he=this.model.config.id2label,pe=[];for(const ie of U){const re=await this.processor(ie),Ce=(await this.model(re)).logits[0],q=await(0,u.topk)(new u.Tensor("float32",(0,l.softmax)(Ce.data),Ce.dims),ue),te=q[0].tolist(),ee=q[1].tolist().map((se,ve)=>({label:he?he[se]:`LABEL_${se}`,score:te[ve]}));pe.push(ee)}return Array.isArray(ce)?pe:pe[0]}}class I extends g{constructor(ce){super(ce)}async _call(ce,ue,{hypothesis_template:Se="This is a sound of {}."}={}){const U=!Array.isArray(ce);U&&(ce=[ce]);const he=ue.map(Ce=>Se.replace("{}",Ce)),pe=this.tokenizer(he,{padding:!0,truncation:!0}),ie=this.processor.feature_extractor.config.sampling_rate,re=await f(ce,ie),ge=[];for(const Ce of re){const q=await this.processor(Ce),te=await this.model({...pe,...q}),j=(0,l.softmax)(te.logits_per_audio.data);ge.push([...j].map((ee,se)=>({score:ee,label:ue[se]})))}return U?ge[0]:ge}}class C extends g{constructor(ce){super(ce)}async _call(ce,ue={}){switch(this.model.config.model_type){case"whisper":case"lite-whisper":return this._call_whisper(ce,ue);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":return this._call_wav2vec2(ce,ue);case"moonshine":return this._call_moonshine(ce,ue);default:throw new Error(`AutomaticSpeechRecognitionPipeline does not support model type '${this.model.config.model_type}'.`)}}async _call_wav2vec2(ce,ue){ue.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),ue.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const Se=!Array.isArray(ce);Se&&(ce=[ce]);const U=this.processor.feature_extractor.config.sampling_rate,he=await f(ce,U),pe=[];for(const ie of he){const re=await this.processor(ie),Ce=(await this.model(re)).logits[0],q=[];for(const j of Ce)q.push((0,l.max)(j.data)[1]);const te=this.tokenizer.decode(q);pe.push({text:te})}return Se?pe[0]:pe}async _call_whisper(ce,ue){const Se=ue.return_timestamps??!1,U=ue.chunk_length_s??0,he=ue.force_full_sequences??!1;let pe=ue.stride_length_s??null;const ie={...ue};Se==="word"&&(ie.return_token_timestamps=!0,ie.return_timestamps=!1);const re=!Array.isArray(ce);re&&(ce=[ce]);const ge=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,Ce=this.processor.feature_extractor.config.hop_length,q=this.processor.feature_extractor.config.sampling_rate,te=await f(ce,q),j=[];for(const ee of te){let se=[];if(U>0){if(pe===null)pe=U/6;else if(U<=pe)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const Re=q*U,Oe=q*pe,ze=Re-2*Oe;let Te=0;for(;;){const Be=Te+Re,qe=ee.subarray(Te,Be),tt=await this.processor(qe),xt=Te===0,ft=Be>=ee.length;if(se.push({stride:[qe.length,xt?0:Oe,ft?0:Oe],input_features:tt.input_features,is_last:ft}),ft)break;Te+=ze}}else se=[{stride:[ee.length,0,0],input_features:(await this.processor(ee)).input_features,is_last:!0}];for(const Re of se){ie.num_frames=Math.floor(Re.stride[0]/Ce);const Oe=await this.model.generate({inputs:Re.input_features,...ie});Se==="word"?(Re.tokens=Oe.sequences.tolist()[0],Re.token_timestamps=Oe.token_timestamps.tolist()[0].map(ze=>(0,l.round)(ze,2))):Re.tokens=Oe[0].tolist(),Re.stride=Re.stride.map(ze=>ze/q)}const[ve,ke]=this.tokenizer._decode_asr(se,{time_precision:ge,return_timestamps:Se,force_full_sequences:he});j.push({text:ve,...ke})}return re?j[0]:j}async _call_moonshine(ce,ue){const Se=!Array.isArray(ce);Se&&(ce=[ce]);const U=this.processor.feature_extractor.config.sampling_rate,he=await f(ce,U),pe=[];for(const ie of he){const re=await this.processor(ie),ge=Math.floor(ie.length/U)*6,Ce=await this.model.generate({max_new_tokens:ge,...ue,...re}),q=this.processor.batch_decode(Ce,{skip_special_tokens:!0})[0];pe.push({text:q})}return Se?pe[0]:pe}}class H extends g{constructor(ce){super(ce)}async _call(ce,ue={}){const Se=Array.isArray(ce),U=await h(ce),{pixel_values:he}=await this.processor(U),pe=[];for(const ie of he){ie.dims=[1,...ie.dims];const re=await this.model.generate({inputs:ie,...ue}),ge=this.tokenizer.batch_decode(re,{skip_special_tokens:!0}).map(Ce=>({generated_text:Ce.trim()}));pe.push(ge)}return Se?pe:pe[0]}}class B extends g{constructor(ce){super(ce)}async _call(ce,{top_k:ue=5}={}){const Se=await h(ce),{pixel_values:U}=await this.processor(Se),he=await this.model({pixel_values:U}),pe=this.model.config.id2label,ie=[];for(const re of he.logits){const ge=await(0,u.topk)(new u.Tensor("float32",(0,l.softmax)(re.data),re.dims),ue),Ce=ge[0].tolist(),te=ge[1].tolist().map((j,ee)=>({label:pe?pe[j]:`LABEL_${j}`,score:Ce[ee]}));ie.push(te)}return Array.isArray(ce)?ie:ie[0]}}class $ extends g{constructor(ce){super(ce),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(ce,{threshold:ue=.5,mask_threshold:Se=.5,overlap_mask_area_threshold:U=.8,label_ids_to_fuse:he=null,target_sizes:pe=null,subtask:ie=null}={}){if(Array.isArray(ce)&&ce.length!==1)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const ge=await h(ce),Ce=ge.map(Re=>[Re.height,Re.width]),q=await this.processor(ge),{inputNames:te,outputNames:j}=this.model.sessions.model;if(!te.includes("pixel_values")){if(te.length!==1)throw Error(`Expected a single input name, but got ${te.length} inputs: ${te}.`);const Re=te[0];if(Re in q)throw Error(`Input name ${Re} already exists in the inputs.`);q[Re]=q.pixel_values}const ee=await this.model(q);let se=null;if(ie!==null)se=this.subtasks_mapping[ie];else if(this.processor.image_processor){for(const[Re,Oe]of Object.entries(this.subtasks_mapping))if(Oe in this.processor.image_processor){se=this.processor.image_processor[Oe].bind(this.processor.image_processor),ie=Re;break}}const ve=this.model.config.id2label,ke=[];if(ie)if(ie==="panoptic"||ie==="instance"){const Re=se(ee,ue,Se,U,he,pe??Ce)[0],Oe=Re.segmentation;for(const ze of Re.segments_info){const Te=new Uint8ClampedArray(Oe.data.length);for(let qe=0;qe<Oe.data.length;++qe)Oe.data[qe]===ze.id&&(Te[qe]=255);const Be=new d.RawImage(Te,Oe.dims[1],Oe.dims[0],1);ke.push({score:ze.score,label:ve[ze.label_id],mask:Be})}}else if(ie==="semantic"){const{segmentation:Re,labels:Oe}=se(ee,pe??Ce)[0];for(const ze of Oe){const Te=new Uint8ClampedArray(Re.data.length);for(let qe=0;qe<Re.data.length;++qe)Re.data[qe]===ze&&(Te[qe]=255);const Be=new d.RawImage(Te,Re.dims[1],Re.dims[0],1);ke.push({score:null,label:ve[ze],mask:Be})}}else throw Error(`Subtask ${ie} not supported.`);else{const Re=ee[j[0]];for(let Oe=0;Oe<Ce.length;++Oe){const ze=Ce[Oe],Te=Re[Oe];Te.data.some(qe=>qe<0||qe>1)&&Te.sigmoid_();const Be=await d.RawImage.fromTensor(Te.mul_(255).to("uint8")).resize(ze[1],ze[0]);ke.push({label:null,score:null,mask:Be})}}return ke}}class X extends ${constructor(ce){super(ce)}async _call(ce,ue={}){if(Array.isArray(ce)&&ce.length!==1)throw Error("Background removal pipeline currently only supports a batch size of 1.");const U=await h(ce),he=await super._call(ce,ue);return U.map((ie,re)=>{const ge=ie.clone();return ge.putAlpha(he[re].mask),ge})}}class V extends g{constructor(ce){super(ce)}async _call(ce,ue,{hypothesis_template:Se="This is a photo of {}"}={}){const U=Array.isArray(ce),he=await h(ce),pe=ue.map(te=>Se.replace("{}",te)),ie=this.tokenizer(pe,{padding:this.model.config.model_type==="siglip"?"max_length":!0,truncation:!0}),{pixel_values:re}=await this.processor(he),ge=await this.model({...ie,pixel_values:re}),Ce=this.model.config.model_type==="siglip"?te=>te.sigmoid().data:te=>(0,l.softmax)(te.data),q=[];for(const te of ge.logits_per_image){const ee=[...Ce(te)].map((se,ve)=>({score:se,label:ue[ve]}));ee.sort((se,ve)=>ve.score-se.score),q.push(ee)}return U?q:q[0]}}class Q extends g{constructor(ce){super(ce)}async _call(ce,{threshold:ue=.9,percentage:Se=!1}={}){const U=Array.isArray(ce);if(U&&ce.length!==1)throw Error("Object detection pipeline currently only supports a batch size of 1.");const he=await h(ce),pe=Se?null:he.map(j=>[j.height,j.width]),{pixel_values:ie,pixel_mask:re}=await this.processor(he),ge=await this.model({pixel_values:ie,pixel_mask:re}),Ce=this.processor.image_processor.post_process_object_detection(ge,ue,pe),q=this.model.config.id2label,te=Ce.map(j=>j.boxes.map((ee,se)=>({score:j.scores[se],label:q[j.classes[se]],box:p(ee,!Se)})));return U?te:te[0]}}class R extends g{constructor(ce){super(ce)}async _call(ce,ue,{threshold:Se=.1,top_k:U=null,percentage:he=!1}={}){const pe=Array.isArray(ce),ie=await h(ce),re=this.tokenizer(ue,{padding:!0,truncation:!0}),ge=await this.processor(ie),Ce=[];for(let q=0;q<ie.length;++q){const te=ie[q],j=he?null:[[te.height,te.width]],ee=ge.pixel_values[q].unsqueeze_(0),se=await this.model({...re,pixel_values:ee});let ve;if("post_process_grounded_object_detection"in this.processor){const ke=this.processor.post_process_grounded_object_detection(se,re.input_ids,{box_threshold:Se,text_threshold:Se,target_sizes:j})[0];ve=ke.boxes.map((Re,Oe)=>({score:ke.scores[Oe],label:ke.labels[Oe],box:p(Re,!he)}))}else{const ke=this.processor.image_processor.post_process_object_detection(se,Se,j,!0)[0];ve=ke.boxes.map((Re,Oe)=>({score:ke.scores[Oe],label:ue[ke.classes[Oe]],box:p(Re,!he)}))}ve.sort((ke,Re)=>Re.score-ke.score),U!==null&&(ve=ve.slice(0,U)),Ce.push(ve)}return pe?Ce:Ce[0]}}class O extends g{constructor(ce){super(ce)}async _call(ce,ue,Se={}){const U=(await h(ce))[0],{pixel_values:he}=await this.processor(U),pe=`<s_docvqa><s_question>${ue}</s_question><s_answer>`,ie=this.tokenizer(pe,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,re=await this.model.generate({inputs:he,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:ie,...Se}),Ce=this.tokenizer.batch_decode(re)[0].match(/<s_answer>(.*?)<\/s_answer>/);let q=null;return Ce&&Ce.length>=2&&(q=Ce[1].trim()),[{answer:q}]}}class L extends g{DEFAULT_VOCODER_ID="Xenova/speecht5_hifigan";constructor(ce){super(ce),this.vocoder=ce.vocoder??null}async _call(ce,{speaker_embeddings:ue=null}={}){return this.processor?this._call_text_to_spectrogram(ce,{speaker_embeddings:ue}):this._call_text_to_waveform(ce)}async _call_text_to_waveform(ce){const ue=this.tokenizer(ce,{padding:!0,truncation:!0}),{waveform:Se}=await this.model(ue),U=this.model.config.sampling_rate;return new c.RawAudio(Se.data,U)}async _call_text_to_spectrogram(ce,{speaker_embeddings:ue}){if(this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await i.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"})),(typeof ue=="string"||ue instanceof URL)&&(ue=new Float32Array(await(await fetch(ue)).arrayBuffer())),ue instanceof Float32Array)ue=new u.Tensor("float32",ue,[1,ue.length]);else if(!(ue instanceof u.Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");const{input_ids:Se}=this.tokenizer(ce,{padding:!0,truncation:!0}),{waveform:U}=await this.model.generate_speech(Se,ue,{vocoder:this.vocoder}),he=this.processor.feature_extractor.config.sampling_rate;return new c.RawAudio(U.data,he)}}class ne extends g{constructor(ce){super(ce)}async _call(ce){const ue=await h(ce),Se=await this.processor(ue),U=await this.model(Se),he=[];for(const pe of U.reconstruction){const ie=pe.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");he.push(d.RawImage.fromTensor(ie))}return he.length>1?he:he[0]}}class de extends g{constructor(ce){super(ce)}async _call(ce){const ue=await h(ce),Se=await this.processor(ue),{predicted_depth:U}=await this.model(Se),he=[];for(let pe=0;pe<ue.length;++pe){const ie=U[pe],[re,ge]=ie.dims.slice(-2),[Ce,q]=ue[pe].size,te=(await(0,u.interpolate_4d)(ie.view(1,1,re,ge),{size:[q,Ce],mode:"bilinear"})).view(q,Ce),j=te.min().item(),ee=te.max().item(),se=te.sub(j).div_(ee-j).mul_(255).to("uint8").unsqueeze(0),ve=d.RawImage.fromTensor(se);he.push({predicted_depth:te,depth:ve})}return he.length>1?he:he[0]}}const we=Object.freeze({"text-classification":{tokenizer:r.AutoTokenizer,pipeline:b,model:i.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:r.AutoTokenizer,pipeline:_,model:i.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:r.AutoTokenizer,pipeline:m,model:i.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:r.AutoTokenizer,pipeline:v,model:i.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:r.AutoTokenizer,pipeline:w,model:i.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:r.AutoTokenizer,pipeline:T,model:i.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:r.AutoTokenizer,pipeline:x,model:i.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:r.AutoTokenizer,pipeline:A,model:i.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:r.AutoTokenizer,pipeline:M,model:i.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:S,model:i.AutoModelForAudioClassification,processor:s.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:r.AutoTokenizer,pipeline:I,model:i.AutoModel,processor:s.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:r.AutoTokenizer,pipeline:C,model:[i.AutoModelForSpeechSeq2Seq,i.AutoModelForCTC],processor:s.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:r.AutoTokenizer,pipeline:L,model:[i.AutoModelForTextToWaveform,i.AutoModelForTextToSpectrogram],processor:[s.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:r.AutoTokenizer,pipeline:H,model:i.AutoModelForVision2Seq,processor:s.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:B,model:i.AutoModelForImageClassification,processor:s.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:$,model:[i.AutoModelForImageSegmentation,i.AutoModelForSemanticSegmentation,i.AutoModelForUniversalSegmentation],processor:s.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"background-removal":{pipeline:X,model:[i.AutoModelForImageSegmentation,i.AutoModelForSemanticSegmentation,i.AutoModelForUniversalSegmentation],processor:s.AutoProcessor,default:{model:"Xenova/modnet"},type:"image"},"zero-shot-image-classification":{tokenizer:r.AutoTokenizer,pipeline:V,model:i.AutoModel,processor:s.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:Q,model:i.AutoModelForObjectDetection,processor:s.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:r.AutoTokenizer,pipeline:R,model:i.AutoModelForZeroShotObjectDetection,processor:s.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:r.AutoTokenizer,pipeline:O,model:i.AutoModelForDocumentQuestionAnswering,processor:s.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:ne,model:i.AutoModelForImageToImage,processor:s.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:de,model:i.AutoModelForDepthEstimation,processor:s.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:r.AutoTokenizer,pipeline:F,model:i.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:s.AutoProcessor,pipeline:G,model:[i.AutoModelForImageFeatureExtraction,i.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),be=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function Ee(xe,ce=null,{progress_callback:ue=null,config:Se=null,cache_dir:U=null,local_files_only:he=!1,revision:pe="main",device:ie=null,dtype:re=null,subfolder:ge="onnx",use_external_data_format:Ce=null,model_file_name:q=null,session_options:te={}}={}){xe=be[xe]??xe;const j=we[xe.split("_",1)[0]];if(!j)throw Error(`Unsupported pipeline: ${xe}. Must be one of [${Object.keys(we)}]`);ce||(ce=j.default.model,console.log(`No model specified. Using default model: "${ce}".`));const ee={progress_callback:ue,config:Se,cache_dir:U,local_files_only:he,revision:pe,device:ie,dtype:re,subfolder:ge,use_external_data_format:Ce,model_file_name:q,session_options:te},se=new Map([["tokenizer",j.tokenizer],["model",j.model],["processor",j.processor]]),ve=await Fe(se,ce,ee);ve.task=xe,(0,o.dispatchCallback)(ue,{status:"ready",task:xe,model:ce});const ke=j.pipeline;return new ke(ve)}async function Fe(xe,ce,ue){const Se=Object.create(null),U=[];for(const[he,pe]of xe.entries()){if(!pe)continue;let ie;Array.isArray(pe)?ie=new Promise(async(re,ge)=>{let Ce;for(const q of pe){if(q===null){re(null);return}try{re(await q.from_pretrained(ce,ue));return}catch(te){if(te.message?.includes("Unsupported model type"))Ce=te;else if(te.message?.includes("Could not locate file"))Ce=te;else{ge(te);return}}}ge(Ce)}):ie=pe.from_pretrained(ce,ue),Se[he]=ie,U.push(ie)}await Promise.all(U);for(const[he,pe]of Object.entries(Se))Se[he]=await pe;return Se}},"./src/tokenizers.js":(n,e,t)=>{t.r(e),t.d(e,{AlbertTokenizer:()=>Tt,AutoTokenizer:()=>sc,BartTokenizer:()=>gi,BertTokenizer:()=>it,BlenderbotSmallTokenizer:()=>ir,BlenderbotTokenizer:()=>wr,BloomTokenizer:()=>gs,CLIPTokenizer:()=>tc,CamembertTokenizer:()=>rt,CodeGenTokenizer:()=>kr,CodeLlamaTokenizer:()=>$o,CohereTokenizer:()=>ic,ConvBertTokenizer:()=>Dn,DebertaTokenizer:()=>ur,DebertaV2Tokenizer:()=>vr,DistilBertTokenizer:()=>ct,ElectraTokenizer:()=>ki,EsmTokenizer:()=>Fi,FalconTokenizer:()=>Rs,GPT2Tokenizer:()=>mi,GPTNeoXTokenizer:()=>Wo,GemmaTokenizer:()=>Jr,Grok1Tokenizer:()=>_s,HerbertTokenizer:()=>dr,LlamaTokenizer:()=>Bo,M2M100Tokenizer:()=>jo,MBart50Tokenizer:()=>Lo,MBartTokenizer:()=>ms,MPNetTokenizer:()=>zo,MarianTokenizer:()=>bi,MgpstrTokenizer:()=>_a,MobileBertTokenizer:()=>rn,NllbTokenizer:()=>_i,NougatTokenizer:()=>nc,PreTrainedTokenizer:()=>Ie,Qwen2Tokenizer:()=>Jl,RoFormerTokenizer:()=>Ze,RobertaTokenizer:()=>Ro,SiglipTokenizer:()=>za,SpeechT5Tokenizer:()=>ja,SqueezeBertTokenizer:()=>Un,T5Tokenizer:()=>bn,TokenizerModel:()=>G,VitsTokenizer:()=>rc,Wav2Vec2CTCTokenizer:()=>Wa,WhisperTokenizer:()=>ec,XLMRobertaTokenizer:()=>No,XLMTokenizer:()=>Mn,is_chinese_char:()=>v});var r=t("./src/utils/generic.js"),i=t("./src/utils/core.js"),s=t("./src/utils/hub.js"),a=t("./src/utils/maths.js"),o=t("./src/utils/tensor.js"),l=t("./src/utils/data-structures.js"),c=t("./node_modules/@huggingface/jinja/dist/index.js"),u=t("./src/models/whisper/common_whisper.js");async function d(Le,Y){const ye=await Promise.all([(0,s.getModelJSON)(Le,"tokenizer.json",!0,Y),(0,s.getModelJSON)(Le,"tokenizer_config.json",!0,Y)]);return Y.legacy!==null&&(ye[1].legacy=Y.legacy),ye}function h(Le,Y){const ye=[];let De=0;for(const Pe of Le.matchAll(Y)){const We=Pe[0];De<Pe.index&&ye.push(Le.slice(De,Pe.index)),We.length>0&&ye.push(We),De=Pe.index+We.length}return De<Le.length&&ye.push(Le.slice(De)),ye}function f(Le,Y=!0){if(Le.Regex!==void 0){let ye=Le.Regex.replace(/\\([#&~])/g,"$1");for(const[De,Pe]of M)ye=ye.replaceAll(De,Pe);return new RegExp(ye,"gu")}else if(Le.String!==void 0){const ye=(0,i.escapeRegExp)(Le.String);return new RegExp(Y?ye:`(${ye})`,"gu")}else return console.warn("Unknown pattern type:",Le),null}function p(Le){return new Map(Object.entries(Le))}function g(Le){const Y=Le.dims;switch(Y.length){case 1:return Le.tolist();case 2:if(Y[0]!==1)throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return Le.tolist()[0];default:throw new Error(`Expected tensor to have 1-2 dimensions, got ${Y.length}.`)}}function b(Le){return Le.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function _(Le){return Le.replace(new RegExp("\\p{M}","gu"),"")}function m(Le){return _(Le.toLowerCase())}function v(Le){return Le>=19968&&Le<=40959||Le>=13312&&Le<=19903||Le>=131072&&Le<=173791||Le>=173824&&Le<=177983||Le>=177984&&Le<=178207||Le>=178208&&Le<=183983||Le>=63744&&Le<=64255||Le>=194560&&Le<=195103}function x(Le,Y,ye){const De=[];let Pe=0;for(;Pe<Le.length;){if(De.push(Le[Pe]),(Y.get(Le[Pe])??ye)!==ye){++Pe;continue}for(;++Pe<Le.length&&(Y.get(Le[Pe])??ye)===ye;)Y.get(De.at(-1))!==ye&&(De[De.length-1]+=Le[Pe])}return De}function w(Le){return Le.match(/\S+/g)||[]}const T="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",E=new RegExp(`^[${T}]+$`,"gu"),A=".,!?",M=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],[` ?[^(\\s|[${A}])]+`,` ?[^\\s${A}]+`]]);class F{constructor(Y){this.content=Y.content,this.id=Y.id,this.single_word=Y.single_word??!1,this.lstrip=Y.lstrip??!1,this.rstrip=Y.rstrip??!1,this.special=Y.special??!1,this.normalized=Y.normalized??null}}class G extends r.Callable{constructor(Y){super(),this.config=Y,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=this.config.fuse_unk??!1}static fromConfig(Y,...ye){switch(Y.type){case"WordPiece":return new S(Y);case"Unigram":return new I(Y,...ye);case"BPE":return new B(Y);default:if(Y.vocab)return Array.isArray(Y.vocab)?new I(Y,...ye):typeof Y.vocab=="object"&&Y.continuing_subword_prefix&&Y.unk_token?new S(Y):new $(Y,...ye);throw new Error(`Unknown TokenizerModel type: ${Y.type}`)}}_call(Y){return Y=this.encode(Y),this.fuse_unk&&(Y=x(Y,this.tokens_to_ids,this.unk_token_id)),Y}encode(Y){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(Y){return Y.map(ye=>this.tokens_to_ids.get(ye)??this.unk_token_id)}convert_ids_to_tokens(Y){return Y.map(ye=>this.vocab[ye]??this.unk_token)}}class S extends G{constructor(Y){super(Y),this.tokens_to_ids=p(Y.vocab),this.unk_token_id=this.tokens_to_ids.get(Y.unk_token),this.unk_token=Y.unk_token,this.max_input_chars_per_word=Y.max_input_chars_per_word??100,this.vocab=new Array(this.tokens_to_ids.size);for(const[ye,De]of this.tokens_to_ids)this.vocab[De]=ye}encode(Y){const ye=[];for(const De of Y){const Pe=[...De];if(Pe.length>this.max_input_chars_per_word){ye.push(this.unk_token);continue}let We=!1,Ke=0;const ot=[];for(;Ke<Pe.length;){let lt=Pe.length,ut=null;for(;Ke<lt;){let st=Pe.slice(Ke,lt).join("");if(Ke>0&&(st=this.config.continuing_subword_prefix+st),this.tokens_to_ids.has(st)){ut=st;break}--lt}if(ut===null){We=!0;break}ot.push(ut),Ke=lt}We?ye.push(this.unk_token):ye.push(...ot)}return ye}}class I extends G{constructor(Y,ye){super(Y);const De=Y.vocab.length;this.vocab=new Array(De),this.scores=new Array(De);for(let Pe=0;Pe<De;++Pe)[this.vocab[Pe],this.scores[Pe]]=Y.vocab[Pe];this.unk_token_id=Y.unk_id,this.unk_token=this.vocab[Y.unk_id],this.tokens_to_ids=new Map(this.vocab.map((Pe,We)=>[Pe,We])),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=ye.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,a.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new l.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(Y){const ye=Y.chars,De=1;let Pe=0;for(;Pe<ye.length;){let We=!1;const Ke=ye.slice(Pe).join(""),ot=this.trie.commonPrefixSearch(Ke);for(const lt of ot){const ut=this.tokens_to_ids.get(lt),st=this.scores[ut],Ht=(0,i.len)(lt);Y.insert(Pe,Ht,st,ut),!We&&Ht===De&&(We=!0)}We||Y.insert(Pe,De,this.unk_score,this.unk_token_id),Pe+=De}}tokenize(Y){const ye=new l.TokenLattice(Y,this.bos_token_id,this.eos_token_id);return this.populateNodes(ye),ye.tokens()}encode(Y){const ye=[];for(const De of Y){const Pe=this.tokenize(De);ye.push(...Pe)}return ye}}const C=(()=>{const Le=[...Array.from({length:94},(Pe,We)=>We+33),...Array.from({length:12},(Pe,We)=>We+161),...Array.from({length:82},(Pe,We)=>We+174)],Y=Le.slice();let ye=0;for(let Pe=0;Pe<256;++Pe)Le.includes(Pe)||(Le.push(Pe),Y.push(256+ye),ye+=1);const De=Y.map(Pe=>String.fromCharCode(Pe));return Object.fromEntries(Le.map((Pe,We)=>[Pe,De[We]]))})(),H=(0,i.reverseDictionary)(C);class B extends G{constructor(Y){super(Y),this.tokens_to_ids=p(Y.vocab),this.unk_token_id=this.tokens_to_ids.get(Y.unk_token),this.unk_token=Y.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[De,Pe]of this.tokens_to_ids)this.vocab[Pe]=De;const ye=Array.isArray(Y.merges[0]);this.merges=ye?Y.merges:Y.merges.map(De=>De.split(" ",2)),this.bpe_ranks=new Map(this.merges.map((De,Pe)=>[JSON.stringify(De),Pe])),this.end_of_word_suffix=Y.end_of_word_suffix,this.continuing_subword_suffix=Y.continuing_subword_suffix??null,this.byte_fallback=this.config.byte_fallback??!1,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=this.config.ignore_merges??!1,this.cache=new Map}bpe(Y){if(Y.length===0)return[];const ye=this.cache.get(Y);if(ye!==void 0)return ye;const De=Array.from(Y);this.end_of_word_suffix&&(De[De.length-1]+=this.end_of_word_suffix);let Pe=[];if(De.length>1){const We=new l.PriorityQueue((lt,ut)=>lt.score<ut.score);let Ke={token:De[0],bias:0,prev:null,next:null},ot=Ke;for(let lt=1;lt<De.length;++lt){const ut={bias:lt/De.length,token:De[lt],prev:ot,next:null};ot.next=ut,this._add_node(We,ot),ot=ut}for(;!We.isEmpty();){const lt=We.pop();if(lt.deleted||!lt.next||lt.next.deleted)continue;if(lt.deleted=!0,lt.next.deleted=!0,lt.prev){const st={...lt.prev};lt.prev.deleted=!0,lt.prev=st,st.prev?st.prev.next=st:Ke=st}const ut={token:lt.token+lt.next.token,bias:lt.bias,prev:lt.prev,next:lt.next.next};ut.prev?(ut.prev.next=ut,this._add_node(We,ut.prev)):Ke=ut,ut.next&&(ut.next.prev=ut,this._add_node(We,ut))}for(let lt=Ke;lt!==null;lt=lt.next)Pe.push(lt.token)}else Pe=De;if(this.continuing_subword_suffix)for(let We=0;We<Pe.length-1;++We)Pe[We]+=this.continuing_subword_suffix;return this.cache.set(Y,Pe),Pe}_add_node(Y,ye){const De=this.bpe_ranks.get(JSON.stringify([ye.token,ye.next.token]));De!==void 0&&(ye.score=De+ye.bias,Y.push(ye))}encode(Y){const ye=[];for(const De of Y){if(this.ignore_merges&&this.tokens_to_ids.has(De)){ye.push(De);continue}const Pe=this.bpe(De);for(const We of Pe)if(this.tokens_to_ids.has(We))ye.push(We);else if(this.byte_fallback){const Ke=Array.from(this.text_encoder.encode(We)).map(ot=>`<0x${ot.toString(16).toUpperCase().padStart(2,"0")}>`);Ke.every(ot=>this.tokens_to_ids.has(ot))?ye.push(...Ke):ye.push(this.unk_token)}else ye.push(this.unk_token)}return ye}}class $ extends G{constructor(Y,ye){super(Y),this.tokens_to_ids=p(ye.target_lang?Y.vocab[ye.target_lang]:Y.vocab),this.bos_token=ye.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=ye.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=ye.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=ye.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[De,Pe]of this.tokens_to_ids)this.vocab[Pe]=De}encode(Y){return Y}}class X extends r.Callable{constructor(Y){super(),this.config=Y}static fromConfig(Y){if(Y===null)return null;switch(Y.type){case"BertNormalizer":return new xe(Y);case"Precompiled":return new ft(Y);case"Sequence":return new Fe(Y);case"Replace":return new V(Y);case"NFC":return new R(Y);case"NFD":return new O(Y);case"NFKC":return new L(Y);case"NFKD":return new ne(Y);case"Strip":return new de(Y);case"StripAccents":return new we(Y);case"Lowercase":return new be(Y);case"Prepend":return new Ee(Y);default:throw new Error(`Unknown Normalizer type: ${Y.type}`)}}normalize(Y){throw Error("normalize should be implemented in subclass.")}_call(Y){return this.normalize(Y)}}class V extends X{normalize(Y){const ye=f(this.config.pattern);return ye===null?Y:Y.replaceAll(ye,this.config.content)}}class Q extends X{form=void 0;normalize(Y){return Y=Y.normalize(this.form),Y}}class R extends Q{form="NFC"}class O extends Q{form="NFD"}class L extends Q{form="NFKC"}class ne extends Q{form="NFKD"}class de extends X{normalize(Y){return this.config.strip_left&&this.config.strip_right?Y=Y.trim():(this.config.strip_left&&(Y=Y.trimStart()),this.config.strip_right&&(Y=Y.trimEnd())),Y}}class we extends X{normalize(Y){return Y=_(Y),Y}}class be extends X{normalize(Y){return Y=Y.toLowerCase(),Y}}class Ee extends X{normalize(Y){return Y=this.config.prepend+Y,Y}}class Fe extends X{constructor(Y){super(Y),this.normalizers=Y.normalizers.map(ye=>X.fromConfig(ye))}normalize(Y){return this.normalizers.reduce((ye,De)=>De.normalize(ye),Y)}}class xe extends X{_tokenize_chinese_chars(Y){const ye=[];for(let De=0;De<Y.length;++De){const Pe=Y[De],We=Pe.charCodeAt(0);v(We)?(ye.push(" "),ye.push(Pe),ye.push(" ")):ye.push(Pe)}return ye.join("")}stripAccents(Y){return Y.normalize("NFD").replace(new RegExp("\\p{Mn}","gu"),"")}_is_control(Y){switch(Y){case"	":case`
`:case"\r":return!1;default:return new RegExp("^\\p{Cc}|\\p{Cf}|\\p{Co}|\\p{Cs}$","u").test(Y)}}_clean_text(Y){const ye=[];for(const De of Y){const Pe=De.charCodeAt(0);Pe===0||Pe===65533||this._is_control(De)||(/^\s$/.test(De)?ye.push(" "):ye.push(De))}return ye.join("")}normalize(Y){return this.config.clean_text&&(Y=this._clean_text(Y)),this.config.handle_chinese_chars&&(Y=this._tokenize_chinese_chars(Y)),this.config.lowercase?(Y=Y.toLowerCase(),this.config.strip_accents!==!1&&(Y=this.stripAccents(Y))):this.config.strip_accents&&(Y=this.stripAccents(Y)),Y}}class ce extends r.Callable{static fromConfig(Y){if(Y===null)return null;switch(Y.type){case"BertPreTokenizer":return new ue(Y);case"Sequence":return new Wt(Y);case"Whitespace":return new Jn(Y);case"WhitespaceSplit":return new rr(Y);case"Metaspace":return new tt(Y);case"ByteLevel":return new Se(Y);case"Split":return new U(Y);case"Punctuation":return new he(Y);case"Digits":return new pe(Y);case"Replace":return new yr(Y);default:throw new Error(`Unknown PreTokenizer type: ${Y.type}`)}}pre_tokenize_text(Y,ye){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(Y,ye){return(Array.isArray(Y)?Y.map(De=>this.pre_tokenize_text(De,ye)):this.pre_tokenize_text(Y,ye)).flat()}_call(Y,ye){return this.pre_tokenize(Y,ye)}}class ue extends ce{constructor(Y){super(),this.pattern=new RegExp(`[^\\s${T}]+|[${T}]`,"gu")}pre_tokenize_text(Y,ye){return Y.trim().match(this.pattern)||[]}}class Se extends ce{constructor(Y){super(),this.config=Y,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=this.config.use_regex??!0,this.pattern=new RegExp("'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+","gu"),this.byte_encoder=C,this.text_encoder=new TextEncoder}pre_tokenize_text(Y,ye){return this.add_prefix_space&&!Y.startsWith(" ")&&(Y=" "+Y),(this.use_regex?Y.match(this.pattern)||[]:[Y]).map(Pe=>Array.from(this.text_encoder.encode(Pe),We=>this.byte_encoder[We]).join(""))}}class U extends ce{constructor(Y){super(),this.config=Y,this.pattern=f(this.config.pattern,this.config.invert)}pre_tokenize_text(Y,ye){return this.pattern===null?[]:this.config.invert?Y.match(this.pattern)||[]:this.config.behavior?.toLowerCase()==="removed"?Y.split(this.pattern).filter(De=>De):h(Y,this.pattern)}}class he extends ce{constructor(Y){super(),this.config=Y,this.pattern=new RegExp(`[^${T}]+|[${T}]+`,"gu")}pre_tokenize_text(Y,ye){return Y.match(this.pattern)||[]}}class pe extends ce{constructor(Y){super(),this.config=Y;const ye=`[^\\d]+|\\d${this.config.individual_digits?"":"+"}`;this.pattern=new RegExp(ye,"gu")}pre_tokenize_text(Y,ye){return Y.match(this.pattern)||[]}}class ie extends r.Callable{constructor(Y){super(),this.config=Y}static fromConfig(Y){if(Y===null)return null;switch(Y.type){case"TemplateProcessing":return new Ce(Y);case"ByteLevel":return new q(Y);case"RobertaProcessing":return new ge(Y);case"BertProcessing":return new re(Y);case"Sequence":return new te(Y);default:throw new Error(`Unknown PostProcessor type: ${Y.type}`)}}post_process(Y,...ye){throw Error("post_process should be implemented in subclass.")}_call(Y,...ye){return this.post_process(Y,...ye)}}class re extends ie{constructor(Y){super(Y),this.cls=Y.cls[0],this.sep=Y.sep[0]}post_process(Y,ye=null,{add_special_tokens:De=!0}={}){De&&(Y=(0,i.mergeArrays)([this.cls],Y,[this.sep]));let Pe=new Array(Y.length).fill(0);if(ye!==null){const We=De&&this instanceof ge?[this.sep]:[],Ke=De?[this.sep]:[];Y=(0,i.mergeArrays)(Y,We,ye,Ke),Pe=(0,i.mergeArrays)(Pe,new Array(ye.length+We.length+Ke.length).fill(1))}return{tokens:Y,token_type_ids:Pe}}}class ge extends re{}class Ce extends ie{constructor(Y){super(Y),this.single=Y.single,this.pair=Y.pair}post_process(Y,ye=null,{add_special_tokens:De=!0}={}){const Pe=ye===null?this.single:this.pair;let We=[],Ke=[];for(const ot of Pe)"SpecialToken"in ot?De&&(We.push(ot.SpecialToken.id),Ke.push(ot.SpecialToken.type_id)):"Sequence"in ot&&(ot.Sequence.id==="A"?(We=(0,i.mergeArrays)(We,Y),Ke=(0,i.mergeArrays)(Ke,new Array(Y.length).fill(ot.Sequence.type_id))):ot.Sequence.id==="B"&&(We=(0,i.mergeArrays)(We,ye),Ke=(0,i.mergeArrays)(Ke,new Array(ye.length).fill(ot.Sequence.type_id))));return{tokens:We,token_type_ids:Ke}}}class q extends ie{post_process(Y,ye=null){return ye&&(Y=(0,i.mergeArrays)(Y,ye)),{tokens:Y}}}class te extends ie{constructor(Y){super(Y),this.processors=Y.processors.map(ye=>ie.fromConfig(ye))}post_process(Y,ye=null,De={}){let Pe;for(const We of this.processors)if(We instanceof q)Y=We.post_process(Y).tokens,ye&&(ye=We.post_process(ye).tokens);else{const Ke=We.post_process(Y,ye,De);Y=Ke.tokens,Pe=Ke.token_type_ids}return{tokens:Y,token_type_ids:Pe}}}class j extends r.Callable{constructor(Y){super(),this.config=Y,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=Y.trim_offsets}static fromConfig(Y){if(Y===null)return null;switch(Y.type){case"WordPiece":return new Re(Y);case"Metaspace":return new xt(Y);case"ByteLevel":return new Oe(Y);case"Replace":return new ee(Y);case"ByteFallback":return new se(Y);case"Fuse":return new ve(Y);case"Strip":return new ke(Y);case"Sequence":return new Te(Y);case"CTC":return new ze(Y);case"BPEDecoder":return new Be(Y);default:throw new Error(`Unknown Decoder type: ${Y.type}`)}}_call(Y){return this.decode(Y)}decode(Y){return this.decode_chain(Y).join("")}decode_chain(Y){throw Error("`decode_chain` should be implemented in subclass.")}}class ee extends j{decode_chain(Y){const ye=f(this.config.pattern);return ye===null?Y:Y.map(De=>De.replaceAll(ye,this.config.content))}}class se extends j{constructor(Y){super(Y),this.text_decoder=new TextDecoder}decode_chain(Y){const ye=[];let De=[];for(const Pe of Y){let We=null;if(Pe.length===6&&Pe.startsWith("<0x")&&Pe.endsWith(">")){const Ke=parseInt(Pe.slice(3,5),16);isNaN(Ke)||(We=Ke)}if(We!==null)De.push(We);else{if(De.length>0){const Ke=this.text_decoder.decode(Uint8Array.from(De));ye.push(Ke),De=[]}ye.push(Pe)}}if(De.length>0){const Pe=this.text_decoder.decode(Uint8Array.from(De));ye.push(Pe),De=[]}return ye}}class ve extends j{decode_chain(Y){return[Y.join("")]}}class ke extends j{constructor(Y){super(Y),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(Y){return Y.map(ye=>{let De=0;for(let We=0;We<this.start&&ye[We]===this.content;++We){De=We+1;continue}let Pe=ye.length;for(let We=0;We<this.stop;++We){const Ke=ye.length-We-1;if(ye[Ke]===this.content){Pe=Ke;continue}else break}return ye.slice(De,Pe)})}}class Re extends j{constructor(Y){super(Y),this.cleanup=Y.cleanup}decode_chain(Y){return Y.map((ye,De)=>(De!==0&&(ye.startsWith(this.config.prefix)?ye=ye.replace(this.config.prefix,""):ye=" "+ye),this.cleanup&&(ye=b(ye)),ye))}}class Oe extends j{constructor(Y){super(Y),this.byte_decoder=H,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(Y){const ye=Y.join(""),De=new Uint8Array([...ye].map(We=>this.byte_decoder[We]));return this.text_decoder.decode(De)}decode_chain(Y){const ye=[];let De=[];for(const Pe of Y)this.added_tokens.find(We=>We.content===Pe)!==void 0?(De.length>0&&(ye.push(this.convert_tokens_to_string(De)),De=[]),ye.push(Pe)):De.push(Pe);return De.length>0&&ye.push(this.convert_tokens_to_string(De)),ye}}class ze extends j{constructor(Y){super(Y),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(Y){if(Y.length===0)return"";const ye=[Y[0]];for(let We=1;We<Y.length;++We)Y[We]!==ye.at(-1)&&ye.push(Y[We]);let Pe=ye.filter(We=>We!==this.pad_token).join("");return this.cleanup&&(Pe=b(Pe).replaceAll(this.word_delimiter_token," ").trim()),Pe}decode_chain(Y){return[this.convert_tokens_to_string(Y)]}}class Te extends j{constructor(Y){super(Y),this.decoders=Y.decoders.map(ye=>j.fromConfig(ye))}decode_chain(Y){return this.decoders.reduce((ye,De)=>De.decode_chain(ye),Y)}}class Be extends j{constructor(Y){super(Y),this.suffix=this.config.suffix}decode_chain(Y){return Y.map((ye,De)=>ye.replaceAll(this.suffix,De===Y.length-1?"":" "))}}class qe extends j{decode_chain(Y){let ye="";for(let De=1;De<Y.length;De+=2)ye+=Y[De];return[ye]}}class tt extends ce{constructor(Y){super(),this.addPrefixSpace=Y.add_prefix_space,this.replacement=Y.replacement,this.strRep=Y.str_rep||this.replacement,this.prepend_scheme=Y.prepend_scheme??"always"}pre_tokenize_text(Y,{section_index:ye=void 0}={}){let De=Y.replaceAll(" ",this.strRep);return this.addPrefixSpace&&!De.startsWith(this.replacement)&&(this.prepend_scheme==="always"||this.prepend_scheme==="first"&&ye===0)&&(De=this.strRep+De),[De]}}class xt extends j{constructor(Y){super(Y),this.addPrefixSpace=Y.add_prefix_space,this.replacement=Y.replacement}decode_chain(Y){const ye=[];for(let De=0;De<Y.length;++De){let Pe=Y[De].replaceAll(this.replacement," ");this.addPrefixSpace&&De==0&&Pe.startsWith(" ")&&(Pe=Pe.substring(1)),ye.push(Pe)}return ye}}class ft extends X{constructor(Y){super(Y),this.charsmap=Y.precompiled_charsmap}normalize(Y){return Y=Y.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,""),Y=Y.replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," "),Y.includes("")?Y=Y.split("").map(De=>De.normalize("NFKC")).join(""):Y=Y.normalize("NFKC"),Y}}class Wt extends ce{constructor(Y){super(),this.tokenizers=Y.pretokenizers.map(ye=>ce.fromConfig(ye))}pre_tokenize_text(Y,ye){return this.tokenizers.reduce((De,Pe)=>Pe.pre_tokenize(De,ye),[Y])}}class Jn extends ce{constructor(Y){super()}pre_tokenize_text(Y,ye){return Y.match(/\w+|[^\w\s]+/g)||[]}}class rr extends ce{constructor(Y){super()}pre_tokenize_text(Y,ye){return w(Y)}}class yr extends ce{constructor(Y){super(),this.config=Y,this.pattern=f(this.config.pattern),this.content=this.config.content}pre_tokenize_text(Y,ye){return this.pattern===null?[Y]:[Y.replaceAll(this.pattern,this.config.content)]}}const ae=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function fe(Le,Y,ye,De){for(const Pe of Object.keys(Le)){const We=Y-Le[Pe].length,Ke=ye(Pe),ot=new Array(We).fill(Ke);Le[Pe]=De==="right"?(0,i.mergeArrays)(Le[Pe],ot):(0,i.mergeArrays)(ot,Le[Pe])}}function Me(Le,Y){for(const ye of Object.keys(Le))Le[ye].length=Y}class Ie extends r.Callable{return_token_type_ids=!1;padding_side="right";constructor(Y,ye){super(),this._tokenizer_config=ye,this.normalizer=X.fromConfig(Y.normalizer),this.pre_tokenizer=ce.fromConfig(Y.pre_tokenizer),this.model=G.fromConfig(Y.model,ye),this.post_processor=ie.fromConfig(Y.post_processor),this.decoder=j.fromConfig(Y.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const De of Y.added_tokens){const Pe=new F(De);this.added_tokens.push(Pe),this.model.tokens_to_ids.set(Pe.content,Pe.id),this.model.vocab[Pe.id]=Pe.content,Pe.special&&(this.special_tokens.push(Pe.content),this.all_special_ids.push(Pe.id))}if(this.additional_special_tokens=ye.additional_special_tokens??[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_regex=this.added_tokens.length>0?new RegExp(this.added_tokens.slice().sort((De,Pe)=>Pe.content.length-De.content.length).map(De=>`${De.lstrip?"\\s*":""}(${(0,i.escapeRegExp)(De.content)})${De.rstrip?"\\s*":""}`).join("|")):null,this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=ye.model_max_length,this.remove_space=ye.remove_space,this.clean_up_tokenization_spaces=ye.clean_up_tokenization_spaces??!0,this.do_lowercase_and_remove_accent=ye.do_lowercase_and_remove_accent??!1,ye.padding_side&&(this.padding_side=ye.padding_side),this.legacy=!1,this.chat_template=ye.chat_template??null,Array.isArray(this.chat_template)){const De=Object.create(null);for(const{name:Pe,template:We}of this.chat_template){if(typeof Pe!="string"||typeof We!="string")throw new Error('Chat template must be a list of objects with "name" and "template" properties');De[Pe]=We}this.chat_template=De}this._compiled_template_cache=new Map}getToken(...Y){for(const ye of Y){const De=this._tokenizer_config[ye];if(De)if(typeof De=="object"){if(De.__type==="AddedToken")return De.content;throw Error(`Unknown token: ${De}`)}else return De}return null}static async from_pretrained(Y,{progress_callback:ye=null,config:De=null,cache_dir:Pe=null,local_files_only:We=!1,revision:Ke="main",legacy:ot=null}={}){const lt=await d(Y,{progress_callback:ye,config:De,cache_dir:Pe,local_files_only:We,revision:Ke,legacy:ot});return new this(...lt)}_call(Y,{text_pair:ye=null,add_special_tokens:De=!0,padding:Pe=!1,truncation:We=null,max_length:Ke=null,return_tensor:ot=!0,return_token_type_ids:lt=null}={}){const ut=Array.isArray(Y);let st;if(ut){if(Y.length===0)throw Error("text array must be non-empty");if(ye!==null){if(Array.isArray(ye)){if(Y.length!==ye.length)throw Error("text and text_pair must have the same length")}else throw Error("text_pair must also be an array");st=Y.map((Lt,An)=>this._encode_plus(Lt,{text_pair:ye[An],add_special_tokens:De,return_token_type_ids:lt}))}else st=Y.map(Lt=>this._encode_plus(Lt,{add_special_tokens:De,return_token_type_ids:lt}))}else{if(Y==null)throw Error("text may not be null or undefined");if(Array.isArray(ye))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");st=[this._encode_plus(Y,{text_pair:ye,add_special_tokens:De,return_token_type_ids:lt})]}if(Ke===null?Pe==="max_length"?Ke=this.model_max_length:Ke=(0,a.max)(st.map(Lt=>Lt.input_ids.length))[0]:We||console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation=true` to explicitly truncate examples to max length."),Ke=Math.min(Ke,this.model_max_length??1/0),Pe||We)for(let Lt=0;Lt<st.length;++Lt)st[Lt].input_ids.length!==Ke&&(st[Lt].input_ids.length>Ke?We&&Me(st[Lt],Ke):Pe&&fe(st[Lt],Ke,An=>An==="input_ids"?this.pad_token_id:0,this.padding_side));const Ht={};if(ot){if(!(Pe&&We)&&st.some(An=>{for(const Vn of Object.keys(An))if(An[Vn].length!==st[0][Vn]?.length)return!0;return!1}))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const Lt=[st.length,st[0].input_ids.length];for(const An of Object.keys(st[0]))Ht[An]=new o.Tensor("int64",BigInt64Array.from(st.flatMap(Vn=>Vn[An]).map(BigInt)),Lt)}else{for(const Lt of Object.keys(st[0]))Ht[Lt]=st.map(An=>An[Lt]);if(!ut)for(const Lt of Object.keys(Ht))Ht[Lt]=Ht[Lt][0]}return Ht}_encode_text(Y){return Y===null?null:(this.added_tokens_regex?Y.split(this.added_tokens_regex).filter(Pe=>Pe):[Y]).map((Pe,We)=>{if(this.added_tokens.find(ot=>ot.content===Pe)!==void 0)return Pe;{if(this.remove_space===!0&&(Pe=Pe.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(Pe=m(Pe)),this.normalizer!==null&&(Pe=this.normalizer(Pe)),Pe.length===0)return[];const ot=this.pre_tokenizer!==null?this.pre_tokenizer(Pe,{section_index:We}):[Pe];return this.model(ot)}}).flat()}_encode_plus(Y,{text_pair:ye=null,add_special_tokens:De=!0,return_token_type_ids:Pe=null}={}){const{tokens:We,token_type_ids:Ke}=this._tokenize_helper(Y,{pair:ye,add_special_tokens:De}),ot=this.model.convert_tokens_to_ids(We),lt={input_ids:ot,attention_mask:new Array(ot.length).fill(1)};return(Pe??this.return_token_type_ids)&&Ke&&(lt.token_type_ids=Ke),lt}_tokenize_helper(Y,{pair:ye=null,add_special_tokens:De=!1}={}){const Pe=this._encode_text(Y),We=this._encode_text(ye);return this.post_processor?this.post_processor(Pe,We,{add_special_tokens:De}):{tokens:(0,i.mergeArrays)(Pe??[],We??[])}}tokenize(Y,{pair:ye=null,add_special_tokens:De=!1}={}){return this._tokenize_helper(Y,{pair:ye,add_special_tokens:De}).tokens}encode(Y,{text_pair:ye=null,add_special_tokens:De=!0,return_token_type_ids:Pe=null}={}){return this._encode_plus(Y,{text_pair:ye,add_special_tokens:De,return_token_type_ids:Pe}).input_ids}batch_decode(Y,ye={}){return Y instanceof o.Tensor&&(Y=Y.tolist()),Y.map(De=>this.decode(De,ye))}decode(Y,ye={}){if(Y instanceof o.Tensor&&(Y=g(Y)),!Array.isArray(Y)||Y.length===0||!(0,i.isIntegralNumber)(Y[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(Y,ye)}decode_single(Y,{skip_special_tokens:ye=!1,clean_up_tokenization_spaces:De=null}){let Pe=this.model.convert_ids_to_tokens(Y);ye&&(Pe=Pe.filter(Ke=>!this.special_tokens.includes(Ke)));let We=this.decoder?this.decoder(Pe):Pe.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(We=We.replaceAll(this.decoder.end_of_word_suffix," "),ye&&(We=We.trim())),(De??this.clean_up_tokenization_spaces)&&(We=b(We)),We}get_chat_template({chat_template:Y=null,tools:ye=null}={}){if(this.chat_template&&typeof this.chat_template=="object"){const De=this.chat_template;if(Y!==null&&Object.hasOwn(De,Y))Y=De[Y];else if(Y===null)if(ye!==null&&"tool_use"in De)Y=De.tool_use;else if("default"in De)Y=De.default;else throw Error(`This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available template names are ${Object.keys(De).sort()}.`)}else if(Y===null)if(this.chat_template)Y=this.chat_template;else throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating");return Y}apply_chat_template(Y,{tools:ye=null,documents:De=null,chat_template:Pe=null,add_generation_prompt:We=!1,tokenize:Ke=!0,padding:ot=!1,truncation:lt=!1,max_length:ut=null,return_tensor:st=!0,return_dict:Ht=!1,tokenizer_kwargs:Lt={},...An}={}){if(Pe=this.get_chat_template({chat_template:Pe,tools:ye}),typeof Pe!="string")throw Error(`chat_template must be a string, but got ${typeof Pe}`);let Vn=this._compiled_template_cache.get(Pe);Vn===void 0&&(Vn=new c.Template(Pe),this._compiled_template_cache.set(Pe,Vn));const Bn=Object.create(null);for(const hr of ae){const qi=this.getToken(hr);qi&&(Bn[hr]=qi)}const Gn=Vn.render({messages:Y,add_generation_prompt:We,tools:ye,documents:De,...Bn,...An});if(Ke){const hr=this._call(Gn,{add_special_tokens:!1,padding:ot,truncation:lt,max_length:ut,return_tensor:st,...Lt});return Ht?hr:hr.input_ids}return Gn}}class it extends Ie{return_token_type_ids=!0}class Tt extends Ie{return_token_type_ids=!0}class rn extends Ie{return_token_type_ids=!0}class Un extends Ie{return_token_type_ids=!0}class ur extends Ie{return_token_type_ids=!0}class vr extends Ie{return_token_type_ids=!0}class dr extends Ie{return_token_type_ids=!0}class Dn extends Ie{return_token_type_ids=!0}class Ze extends Ie{return_token_type_ids=!0}class ct extends Ie{}class rt extends Ie{}class Mn extends Ie{return_token_type_ids=!0;constructor(Y,ye){super(Y,ye),console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class ki extends Ie{return_token_type_ids=!0}class bn extends Ie{}class mi extends Ie{}class gi extends Ie{}class ms extends Ie{constructor(Y,ye){super(Y,ye),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter(De=>this.languageRegex.test(De)),this.lang_to_token=De=>De}_build_translation_inputs(Y,ye,De){return ga(this,Y,ye,De)}}class Lo extends ms{}class Ro extends Ie{}class gs extends Ie{}const ma="";class Bo extends Ie{padding_side="left";constructor(Y,ye){super(Y,ye),this.legacy=ye.legacy??!0,this.legacy||(this.normalizer=null,this.pre_tokenizer=new tt({replacement:ma,add_prefix_space:!0,prepend_scheme:"first"}))}_encode_text(Y){if(Y===null)return null;if(this.legacy||Y.length===0)return super._encode_text(Y);let ye=super._encode_text(ma+Y.replaceAll(ma," "));return ye.length>1&&ye[0]===ma&&this.special_tokens.includes(ye[1])&&(ye=ye.slice(1)),ye}}class $o extends Ie{}class No extends Ie{}class zo extends Ie{}class Rs extends Ie{}class Wo extends Ie{}class Fi extends Ie{}class Jl extends Ie{}class Jr extends Ie{}class _s extends Ie{}function ga(Le,Y,ye,De){if(!("language_codes"in Le)||!Array.isArray(Le.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in Le)||!(Le.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in Le)||typeof Le.lang_to_token!="function")throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const Pe=De.src_lang,We=De.tgt_lang;if(!Le.language_codes.includes(We))throw new Error(`Target language code "${We}" is not valid. Must be one of: {${Le.language_codes.join(", ")}}`);if(Pe!==void 0){if(!Le.language_codes.includes(Pe))throw new Error(`Source language code "${Pe}" is not valid. Must be one of: {${Le.language_codes.join(", ")}}`);for(const Ke of Le.post_processor.config.single)if("SpecialToken"in Ke&&Le.languageRegex.test(Ke.SpecialToken.id)){Ke.SpecialToken.id=Le.lang_to_token(Pe);break}}return De.forced_bos_token_id=Le.model.convert_tokens_to_ids([Le.lang_to_token(We)])[0],Le._call(Y,ye)}class _i extends Ie{constructor(Y,ye){super(Y,ye),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter(De=>this.languageRegex.test(De)),this.lang_to_token=De=>De}_build_translation_inputs(Y,ye,De){return ga(this,Y,ye,De)}}class jo extends Ie{constructor(Y,ye){super(Y,ye),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter(De=>this.languageRegex.test(De)).map(De=>De.slice(2,-2)),this.lang_to_token=De=>`__${De}__`}_build_translation_inputs(Y,ye,De){return ga(this,Y,ye,De)}}class ec extends Ie{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(Y,{return_timestamps:ye=!1,return_language:De=!1,time_precision:Pe=null,force_full_sequences:We=!0}={}){if(Pe===null)throw Error("Must specify time_precision");let Ke=null;const ot=ye==="word";function lt(){return{language:Ke,timestamp:[null,null],text:""}}const ut=[];let st=lt(),Ht=0;const Lt=this.timestamp_begin,Vn=Lt+1500;let Bn=[],Gn=[],hr=!1,qi=null;const Va=new Set(this.all_special_ids);for(const Cn of Y){const fr=Cn.tokens,jr=ot?Cn.token_timestamps:null;let yi=null,Fr=Lt;if("stride"in Cn){const[qn,$n,Hn]=Cn.stride;if(Ht-=$n,qi=qn-Hn,$n&&(Fr=$n/Pe+Lt),Hn)for(let er=fr.length-1;er>=0;--er){const sr=Number(fr[er]);if(sr>=Lt){if(yi!==null&&(sr-Lt)*Pe<qi)break;yi=sr}}}let hn=[],Hi=[];for(let qn=0;qn<fr.length;++qn){const $n=Number(fr[qn]);if(Va.has($n)){const Hn=this.decode([$n]),er=u.WHISPER_LANGUAGE_MAPPING.get(Hn.slice(2,-2));if(er!==void 0){if(Ke!==null&&er!==Ke&&!ye){Bn.push(hn);const sr=this.findLongestCommonSequence(Bn)[0],Vo=this.decode(sr);st.text=Vo,ut.push(st),Bn=[],hn=[],st=lt()}Ke=st.language=er}}else if($n>=Lt&&$n<=Vn){const Hn=($n-Lt)*Pe+Ht,er=(0,a.round)(Hn,2);if(yi!==null&&$n>=yi)hr=!0;else if(hr||Bn.length>0&&$n<Fr)hr=!1;else if(st.timestamp[0]===null)st.timestamp[0]=er;else if(er!==st.timestamp[0]){st.timestamp[1]=er,Bn.push(hn),ot&&Gn.push(Hi);const[sr,Vo]=this.findLongestCommonSequence(Bn,Gn),ac=this.decode(sr);st.text=ac,ot&&(st.words=this.collateWordTimestamps(sr,Vo,Ke)),ut.push(st),Bn=[],hn=[],Gn=[],Hi=[],st=lt()}}else if(hn.push($n),ot){let Hn=(0,a.round)(jr[qn]+Ht,2),er;if(qn+1<jr.length){er=(0,a.round)(jr[qn+1]+Ht,2);const sr=this.decode([$n]);E.test(sr)&&(er=(0,a.round)(Math.min(Hn+Pe,er),2))}else er=null;Hi.push([Hn,er])}}if("stride"in Cn){const[qn,$n,Hn]=Cn.stride;Ht+=qn-Hn}hn.length>0?(Bn.push(hn),ot&&Gn.push(Hi)):Bn.every(qn=>qn.length===0)&&(st=lt(),Bn=[],hn=[],Gn=[],Hi=[])}if(Bn.length>0){if(We&&ye)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[Cn,fr]=this.findLongestCommonSequence(Bn,Gn),jr=this.decode(Cn);st.text=jr,ot&&(st.words=this.collateWordTimestamps(Cn,fr,Ke)),ut.push(st)}let Wr=Object.create(null);const Ii=ut.map(Cn=>Cn.text).join("");if(ye||De){for(let Cn=0;Cn<ut.length;++Cn){const fr=ut[Cn];ye||delete fr.timestamp,De||delete fr.language}if(ot){const Cn=[];for(const fr of ut)for(const jr of fr.words)Cn.push(jr);Wr={chunks:Cn}}else Wr={chunks:ut}}return[Ii,Wr]}findLongestCommonSequence(Y,ye=null){let De=Y[0],Pe=De.length,We=[];const Ke=Array.isArray(ye)&&ye.length>0;let ot=Ke?[]:null,lt=Ke?ye[0]:null;for(let ut=1;ut<Y.length;++ut){const st=Y[ut];let Ht=0,Lt=[Pe,Pe,0,0];const An=st.length;for(let Wr=1;Wr<Pe+An;++Wr){const Ii=Math.max(0,Pe-Wr),Cn=Math.min(Pe,Pe+An-Wr),fr=De.slice(Ii,Cn),jr=Math.max(0,Wr-Pe),yi=Math.min(An,Wr),Fr=st.slice(jr,yi);if(fr.length!==Fr.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");let hn;Ke?hn=fr.filter(($n,Hn)=>$n===Fr[Hn]&&lt[Ii+Hn]<=ye[ut][jr+Hn]).length:hn=fr.filter(($n,Hn)=>$n===Fr[Hn]).length;const Hi=Wr/1e4,qn=hn/Wr+Hi;hn>1&&qn>Ht&&(Ht=qn,Lt=[Ii,Cn,jr,yi])}const[Vn,Bn,Gn,hr]=Lt,qi=Math.floor((Bn+Vn)/2),Va=Math.floor((hr+Gn)/2);We.push(...De.slice(0,qi)),De=st.slice(Va),Pe=De.length,Ke&&(ot.push(...lt.slice(0,qi)),lt=ye[ut].slice(Va))}return We.push(...De),Ke?(ot.push(...lt),[We,ot]):[We,[]]}collateWordTimestamps(Y,ye,De){const[Pe,We,Ke]=this.combineTokensIntoWords(Y,De),ot=[];for(let lt=0;lt<Pe.length;++lt){const ut=Ke[lt];ot.push({text:Pe[lt],timestamp:[ye[ut.at(0)][0],ye[ut.at(-1)][1]]})}return ot}combineTokensIntoWords(Y,ye,De=`"'([{-`,Pe=`"'.,!?:)]}`){ye=ye??"english";let We,Ke,ot;return["chinese","japanese","thai","lao","myanmar"].includes(ye)?[We,Ke,ot]=this.splitTokensOnUnicode(Y):[We,Ke,ot]=this.splitTokensOnSpaces(Y),this.mergePunctuations(We,Ke,ot,De,Pe)}decode(Y,ye){let De;return ye?.decode_with_timestamps?(Y instanceof o.Tensor&&(Y=g(Y)),De=this.decodeWithTimestamps(Y,ye)):De=super.decode(Y,ye),De}decodeWithTimestamps(Y,ye){const De=ye?.time_precision??.02,Pe=Array.from(this.all_special_ids).at(-1)+1;let We=[[]];for(let Ke of Y)if(Ke=Number(Ke),Ke>=Pe){const ot=((Ke-Pe)*De).toFixed(2);We.push(`<|${ot}|>`),We.push([])}else We[We.length-1].push(Ke);return We=We.map(Ke=>typeof Ke=="string"?Ke:super.decode(Ke,ye)),We.join("")}splitTokensOnUnicode(Y){const ye=this.decode(Y,{decode_with_timestamps:!0}),De="",Pe=[],We=[],Ke=[];let ot=[],lt=[],ut=0;for(let st=0;st<Y.length;++st){const Ht=Y[st];ot.push(Ht),lt.push(st);const Lt=this.decode(ot,{decode_with_timestamps:!0});(!Lt.includes(De)||ye[ut+Lt.indexOf(De)]===De)&&(Pe.push(Lt),We.push(ot),Ke.push(lt),ot=[],lt=[],ut+=Lt.length)}return[Pe,We,Ke]}splitTokensOnSpaces(Y){const[ye,De,Pe]=this.splitTokensOnUnicode(Y),We=[],Ke=[],ot=[],lt=new RegExp(`^[${T}]$`,"gu");for(let ut=0;ut<ye.length;++ut){const st=ye[ut],Ht=De[ut],Lt=Pe[ut],An=Ht[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),Vn=st.startsWith(" "),Bn=st.trim(),Gn=lt.test(Bn);if(An||Vn||Gn||We.length===0)We.push(st),Ke.push(Ht),ot.push(Lt);else{const hr=We.length-1;We[hr]+=st,Ke[hr].push(...Ht),ot[hr].push(...Lt)}}return[We,Ke,ot]}mergePunctuations(Y,ye,De,Pe,We){const Ke=structuredClone(Y),ot=structuredClone(ye),lt=structuredClone(De);let ut=Ke.length-2,st=Ke.length-1;for(;ut>=0;)Ke[ut].startsWith(" ")&&Pe.includes(Ke[ut].trim())?(Ke[st]=Ke[ut]+Ke[st],ot[st]=(0,i.mergeArrays)(ot[ut],ot[st]),lt[st]=(0,i.mergeArrays)(lt[ut],lt[st]),Ke[ut]="",ot[ut]=[],lt[ut]=[]):st=ut,--ut;for(ut=0,st=1;st<Ke.length;)!Ke[ut].endsWith(" ")&&We.includes(Ke[st])?(Ke[ut]+=Ke[st],ot[ut]=(0,i.mergeArrays)(ot[ut],ot[st]),lt[ut]=(0,i.mergeArrays)(lt[ut],lt[st]),Ke[st]="",ot[st]=[],lt[st]=[]):ut=st,++st;return[Ke.filter(Ht=>Ht),ot.filter(Ht=>Ht.length>0),lt.filter(Ht=>Ht.length>0)]}}class kr extends Ie{}class tc extends Ie{}class za extends Ie{}class bi extends Ie{constructor(Y,ye){super(Y,ye),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter(De=>this.languageRegex.test(De)),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(Y){if(Y===null)return null;const[ye,...De]=Y.trim().split(this.languageRegex);if(De.length===0)return super._encode_text(ye);if(De.length===2){const[Pe,We]=De;return this.supported_language_codes.includes(Pe)||console.warn(`Unsupported language code "${Pe}" detected, which may lead to unexpected behavior. Should be one of: ${JSON.stringify(this.supported_language_codes)}`),(0,i.mergeArrays)([Pe],super._encode_text(We))}}}class Wa extends Ie{}class wr extends Ie{}class ir extends Ie{}class ja extends Ie{}class nc extends Ie{}class rc extends Ie{constructor(Y,ye){super(Y,ye),this.decoder=new qe({})}}class ic extends Ie{}class _a extends Ie{}class sc{static async from_pretrained(Y,{progress_callback:ye=null,config:De=null,cache_dir:Pe=null,local_files_only:We=!1,revision:Ke="main",legacy:ot=null}={}){const[lt,ut]=await d(Y,{progress_callback:ye,config:De,cache_dir:Pe,local_files_only:We,revision:Ke,legacy:ot}),st=ut.tokenizer_class?.replace(/Fast$/,"")??"PreTrainedTokenizer";let Ht=this.TOKENIZER_CLASS_MAPPING[st];return Ht||(console.warn(`Unknown tokenizer class "${st}", attempting to construct from base class.`),Ht=Ie),new Ht(lt,ut)}}Xe(sc,"TOKENIZER_CLASS_MAPPING",{T5Tokenizer:bn,DistilBertTokenizer:ct,CamembertTokenizer:rt,DebertaTokenizer:ur,DebertaV2Tokenizer:vr,BertTokenizer:it,HerbertTokenizer:dr,ConvBertTokenizer:Dn,RoFormerTokenizer:Ze,XLMTokenizer:Mn,ElectraTokenizer:ki,MobileBertTokenizer:rn,SqueezeBertTokenizer:Un,AlbertTokenizer:Tt,GPT2Tokenizer:mi,BartTokenizer:gi,MBartTokenizer:ms,MBart50Tokenizer:Lo,RobertaTokenizer:Ro,WhisperTokenizer:ec,CodeGenTokenizer:kr,CLIPTokenizer:tc,SiglipTokenizer:za,MarianTokenizer:bi,BloomTokenizer:gs,NllbTokenizer:_i,M2M100Tokenizer:jo,LlamaTokenizer:Bo,CodeLlamaTokenizer:$o,XLMRobertaTokenizer:No,MPNetTokenizer:zo,FalconTokenizer:Rs,GPTNeoXTokenizer:Wo,EsmTokenizer:Fi,Wav2Vec2CTCTokenizer:Wa,BlenderbotTokenizer:wr,BlenderbotSmallTokenizer:ir,SpeechT5Tokenizer:ja,NougatTokenizer:nc,VitsTokenizer:rc,Qwen2Tokenizer:Jl,GemmaTokenizer:Jr,Grok1Tokenizer:_s,CohereTokenizer:ic,MgpstrTokenizer:_a,PreTrainedTokenizer:Ie})},"./src/utils/audio.js":(n,e,t)=>{t.r(e),t.d(e,{RawAudio:()=>S,hamming:()=>h,hanning:()=>d,mel_filter_bank:()=>v,read_audio:()=>c,spectrogram:()=>A,window_function:()=>M});var r=t("./src/utils/hub.js"),i=t("./src/utils/maths.js"),s=t("./src/utils/core.js"),a=t("./src/env.js"),o=t("?7a2c"),l=t("./src/utils/tensor.js");async function c(I,C){if(typeof AudioContext>"u")throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const H=await(await(0,r.getFile)(I)).arrayBuffer(),B=new AudioContext({sampleRate:C});typeof C>"u"&&console.warn(`No sampling rate provided, using default of ${B.sampleRate}Hz.`);const $=await B.decodeAudioData(H);let X;if($.numberOfChannels===2){const V=Math.sqrt(2),Q=$.getChannelData(0),R=$.getChannelData(1);X=new Float32Array(Q.length);for(let O=0;O<$.length;++O)X[O]=V*(Q[O]+R[O])/2}else X=$.getChannelData(0);return X}function u(I,C){if(I<1)return new Float64Array;if(I===1)return new Float64Array([1]);const H=1-C,B=2*Math.PI/(I-1),$=new Float64Array(I);for(let X=0;X<I;++X)$[X]=C-H*Math.cos(X*B);return $}function d(I){return u(I,.5)}function h(I){return u(I,.54)}const f={htk:I=>2595*Math.log10(1+I/700),kaldi:I=>1127*Math.log(1+I/700),slaney:(I,C=1e3,H=15,B=27/Math.log(6.4))=>I>=C?H+Math.log(I/C)*B:3*I/200};function p(I,C="htk"){const H=f[C];if(!H)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof I=="number"?H(I):I.map(B=>H(B))}const g={htk:I=>700*(10**(I/2595)-1),kaldi:I=>700*(Math.exp(I/1127)-1),slaney:(I,C=1e3,H=15,B=Math.log(6.4)/27)=>I>=H?C*Math.exp(B*(I-H)):200*I/3};function b(I,C="htk"){const H=g[C];if(!H)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return typeof I=="number"?H(I):I.map(B=>H(B))}function _(I,C){const H=Float64Array.from({length:C.length-1},(V,Q)=>C[Q+1]-C[Q]),B=Array.from({length:I.length},()=>new Array(C.length));for(let V=0;V<I.length;++V){const Q=B[V];for(let R=0;R<C.length;++R)Q[R]=C[R]-I[V]}const $=C.length-2,X=Array.from({length:$},()=>new Array(I.length));for(let V=0;V<I.length;++V){const Q=B[V];for(let R=0;R<$;++R){const O=-Q[R]/H[R],L=Q[R+2]/H[R+1];X[R][V]=Math.max(0,Math.min(O,L))}}return X}function m(I,C,H){const B=(C-I)/(H-1);return Float64Array.from({length:H},($,X)=>I+B*X)}function v(I,C,H,B,$,X=null,V="htk",Q=!1){if(X!==null&&X!=="slaney")throw new Error('norm must be one of null or "slaney"');const R=p(H,V),O=p(B,V),L=m(R,O,C+2);let ne=b(L,V),de;if(Q){const be=$/(I*2);de=p(Float64Array.from({length:I},(Ee,Fe)=>Fe*be),V),ne=L}else de=m(0,Math.floor($/2),I);const we=_(de,ne);if(X!==null&&X==="slaney")for(let be=0;be<C;++be){const Ee=we[be],Fe=2/(ne[be+2]-ne[be]);for(let xe=0;xe<I;++xe)Ee[xe]*=Fe}return we}function x(I,C,H){const B=new I.constructor(I.length+C+H),$=I.length-1;for(let X=0;X<I.length;++X)B[C+X]=I[X];for(let X=1;X<=C;++X)B[C-X]=I[(0,s.calculateReflectOffset)(X,$)];for(let X=1;X<=H;++X)B[$+C+X]=I[(0,s.calculateReflectOffset)($-X,$)];return B}function w(I,C,H,B,$){if(H<=0)throw new Error("reference must be greater than zero");if(B<=0)throw new Error("min_value must be greater than zero");H=Math.max(B,H);const X=Math.log10(H);for(let V=0;V<I.length;++V)I[V]=C*Math.log10(Math.max(B,I[V])-X);if($!==null){if($<=0)throw new Error("db_range must be greater than zero");const V=(0,i.max)(I)[0]-$;for(let Q=0;Q<I.length;++Q)I[Q]=Math.max(I[Q],V)}return I}function T(I,C=1,H=1e-5,B=null){return w(I,20,C,H,B)}function E(I,C=1,H=1e-10,B=null){return w(I,10,C,H,B)}async function A(I,C,H,B,{fft_length:$=null,power:X=1,center:V=!0,pad_mode:Q="reflect",onesided:R=!0,preemphasis:O=null,mel_filters:L=null,mel_floor:ne=1e-10,log_mel:de=null,reference:we=1,min_value:be=1e-10,db_range:Ee=null,remove_dc_offset:Fe=null,min_num_frames:xe=null,max_num_frames:ce=null,do_pad:ue=!0,transpose:Se=!1}={}){const U=C.length;if($===null&&($=H),H>$)throw Error(`frame_length (${H}) may not be larger than fft_length (${$})`);if(U!==H)throw new Error(`Length of the window (${U}) must equal frame_length (${H})`);if(B<=0)throw new Error("hop_length must be greater than zero");if(X===null&&L!==null)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(V){if(Q!=="reflect")throw new Error(`pad_mode="${Q}" not implemented yet.`);const ve=Math.floor(($-1)/2)+1;I=x(I,ve,ve)}let he=Math.floor(1+Math.floor((I.length-H)/B));xe!==null&&he<xe&&(he=xe);const pe=R?Math.floor($/2)+1:$;let ie=he,re=he;ce!==null&&(ce>he?ue&&(re=ce):re=ie=ce);const ge=new i.FFT($),Ce=new Float64Array($),q=new Float64Array(ge.outputBufferSize),te=new Float32Array(pe*re);for(let ve=0;ve<ie;++ve){const ke=ve*B,Re=Math.min(I.length-ke,H);Re!==H&&Ce.fill(0,0,H);for(let Oe=0;Oe<Re;++Oe)Ce[Oe]=I[ke+Oe];if(Fe){let Oe=0;for(let Te=0;Te<Re;++Te)Oe+=Ce[Te];const ze=Oe/Re;for(let Te=0;Te<Re;++Te)Ce[Te]-=ze}if(O!==null){for(let Oe=Re-1;Oe>=1;--Oe)Ce[Oe]-=O*Ce[Oe-1];Ce[0]*=1-O}for(let Oe=0;Oe<C.length;++Oe)Ce[Oe]*=C[Oe];ge.realTransform(q,Ce);for(let Oe=0;Oe<pe;++Oe){const ze=Oe<<1;te[Oe*re+ve]=q[ze]**2+q[ze+1]**2}}if(X!==null&&X!==2){const ve=2/X;for(let ke=0;ke<te.length;++ke)te[ke]**=ve}const j=L.length;let ee=await(0,l.matmul)(new l.Tensor("float32",L.flat(),[j,pe]),new l.Tensor("float32",te,[pe,re]));Se&&(ee=ee.transpose(1,0));const se=ee.data;for(let ve=0;ve<se.length;++ve)se[ve]=Math.max(ne,se[ve]);if(X!==null&&de!==null){const ve=Math.min(se.length,ie*j);switch(de){case"log":for(let ke=0;ke<ve;++ke)se[ke]=Math.log(se[ke]);break;case"log10":for(let ke=0;ke<ve;++ke)se[ke]=Math.log10(se[ke]);break;case"dB":if(X===1)T(se,we,be,Ee);else if(X===2)E(se,we,be,Ee);else throw new Error(`Cannot use log_mel option '${de}' with power ${X}`);break;default:throw new Error(`log_mel must be one of null, 'log', 'log10' or 'dB'. Got '${de}'`)}}return ee}function M(I,C,{periodic:H=!0,frame_length:B=null,center:$=!0}={}){const X=H?I+1:I;let V;switch(C){case"boxcar":V=new Float64Array(X).fill(1);break;case"hann":case"hann_window":V=d(X);break;case"hamming":V=h(X);break;case"povey":V=d(X).map(Q=>Math.pow(Q,.85));break;default:throw new Error(`Unknown window type ${C}.`)}if(H&&(V=V.subarray(0,I)),B===null)return V;if(I>B)throw new Error(`Length of the window (${I}) may not be larger than frame_length (${B})`);return V}function F(I,C){let H=44;const B=new ArrayBuffer(H+I.length*4),$=new DataView(B);G($,0,"RIFF"),$.setUint32(4,36+I.length*4,!0),G($,8,"WAVE"),G($,12,"fmt "),$.setUint32(16,16,!0),$.setUint16(20,3,!0),$.setUint16(22,1,!0),$.setUint32(24,C,!0),$.setUint32(28,C*4,!0),$.setUint16(32,4,!0),$.setUint16(34,32,!0),G($,36,"data"),$.setUint32(40,I.length*4,!0);for(let X=0;X<I.length;++X,H+=4)$.setFloat32(H,I[X],!0);return B}function G(I,C,H){for(let B=0;B<H.length;++B)I.setUint8(C+B,H.charCodeAt(B))}class S{constructor(C,H){this.audio=C,this.sampling_rate=H}toWav(){return F(this.audio,this.sampling_rate)}toBlob(){const C=this.toWav();return new Blob([C],{type:"audio/wav"})}async save(C){let H;if(a.apis.IS_BROWSER_ENV){if(a.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save a file from a Web Worker.");H=s.saveBlob}else if(a.apis.IS_FS_AVAILABLE)H=async(B,$)=>{let X=await $.arrayBuffer();o.writeFileSync(B,Buffer.from(X))};else throw new Error("Unable to save because filesystem is disabled in this environment.");await H(C,this.toBlob())}}},"./src/utils/constants.js":(n,e,t)=>{t.r(e),t.d(e,{CHAT_TEMPLATE_NAME:()=>l,CONFIG_NAME:()=>i,FEATURE_EXTRACTOR_NAME:()=>s,GENERATION_CONFIG_NAME:()=>c,GITHUB_ISSUE_URL:()=>r,IMAGE_PROCESSOR_NAME:()=>a,PROCESSOR_NAME:()=>o});const r="https://github.com/huggingface/transformers.js/issues/new/choose",i="config.json",s="preprocessor_config.json",a=s,o="processor_config.json",l="chat_template.json",c="generation_config.json"},"./src/utils/core.js":(n,e,t)=>{t.r(e),t.d(e,{calculateDimensions:()=>c,calculateReflectOffset:()=>f,count:()=>_,dispatchCallback:()=>r,escapeRegExp:()=>s,isIntegralNumber:()=>o,isNullishDimension:()=>l,isTypedArray:()=>a,len:()=>b,mergeArrays:()=>d,pick:()=>g,pop:()=>u,product:()=>h,reverseDictionary:()=>i,saveBlob:()=>p});function r(m,v){m&&m(v)}function i(m){return Object.fromEntries(Object.entries(m).map(([v,x])=>[x,v]))}function s(m){return m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function a(m){return m?.prototype?.__proto__?.constructor?.name==="TypedArray"}function o(m){return Number.isInteger(m)||typeof m=="bigint"}function l(m){return m==null||m===-1}function c(m){const v=[];let x=m;for(;Array.isArray(x);)v.push(x.length),x=x[0];return v}function u(m,v,x=void 0){const w=m[v];if(w!==void 0)return delete m[v],w;if(x===void 0)throw Error(`Key ${v} does not exist in object.`);return x}function d(...m){return Array.prototype.concat.apply([],m)}function h(...m){return m.reduce((v,x)=>v.flatMap(w=>x.map(T=>[w,T])))}function f(m,v){return Math.abs((m+v)%(2*v)-v)}function p(m,v){const x=URL.createObjectURL(v),w=document.createElement("a");w.href=x,w.download=m,w.click(),w.remove(),URL.revokeObjectURL(x)}function g(m,v){return Object.assign({},...v.map(x=>{if(m[x]!==void 0)return{[x]:m[x]}}))}function b(m){let v=0;for(const x of m)++v;return v}function _(m,v){let x=0;for(const w of m)w===v&&++x;return x}},"./src/utils/data-structures.js":(n,e,t)=>{t.r(e),t.d(e,{CharTrie:()=>i,PriorityQueue:()=>r,TokenLattice:()=>a});class r{constructor(c=(d,h)=>d>h,u=1/0){this._heap=[],this._comparator=c,this._maxSize=u}get size(){return this._heap.length}isEmpty(){return this.size===0}peek(){return this._heap[0]}push(...c){return this.extend(c)}extend(c){for(const u of c)if(this.size<this._maxSize)this._heap.push(u),this._siftUp();else{const d=this._smallest();this._comparator(u,this._heap[d])&&(this._heap[d]=u,this._siftUpFrom(d))}return this.size}pop(){const c=this.peek(),u=this.size-1;return u>0&&this._swap(0,u),this._heap.pop(),this._siftDown(),c}replace(c){const u=this.peek();return this._heap[0]=c,this._siftDown(),u}_parent(c){return(c+1>>>1)-1}_left(c){return(c<<1)+1}_right(c){return c+1<<1}_greater(c,u){return this._comparator(this._heap[c],this._heap[u])}_swap(c,u){const d=this._heap[c];this._heap[c]=this._heap[u],this._heap[u]=d}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(c){for(;c>0&&this._greater(c,this._parent(c));)this._swap(c,this._parent(c)),c=this._parent(c)}_siftDown(){let c=0;for(;this._left(c)<this.size&&this._greater(this._left(c),c)||this._right(c)<this.size&&this._greater(this._right(c),c);){const u=this._right(c)<this.size&&this._greater(this._right(c),this._left(c))?this._right(c):this._left(c);this._swap(c,u),c=u}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class i{constructor(){this.root=s.default()}extend(c){for(const u of c)this.push(u)}push(c){let u=this.root;for(const d of c){let h=u.children.get(d);h===void 0&&(h=s.default(),u.children.set(d,h)),u=h}u.isLeaf=!0}*commonPrefixSearch(c){let u=this.root;if(u===void 0)return;let d="";for(const h of c){if(d+=h,u=u.children.get(h),u===void 0)return;u.isLeaf&&(yield d)}}}class s{constructor(c,u){this.isLeaf=c,this.children=u}static default(){return new s(!1,new Map)}}class a{constructor(c,u,d){this.chars=Array.from(c),this.len=this.chars.length,this.bosTokenId=u,this.eosTokenId=d,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},()=>[]),this.endNodes=Array.from({length:this.len+1},()=>[]);const h=new o(this.bosTokenId,0,0,0,0),f=new o(this.eosTokenId,1,this.len,0,0);this.nodes.push(h.clone()),this.nodes.push(f.clone()),this.beginNodes[this.len].push(f),this.endNodes[0].push(h)}insert(c,u,d,h){const f=this.nodes.length,p=new o(h,f,c,u,d);this.beginNodes[c].push(p),this.endNodes[c+u].push(p),this.nodes.push(p)}viterbi(){const c=this.len;let u=0;for(;u<=c;){if(this.beginNodes[u].length==0)return[];for(let g of this.beginNodes[u]){g.prev=null;let b=0,_=null;for(let m of this.endNodes[u]){const v=m.backtraceScore+g.score;(_===null||v>b)&&(_=m.clone(),b=v)}if(_!==null)g.prev=_,g.backtraceScore=b;else return[]}++u}const d=[],f=this.beginNodes[c][0].prev;if(f===null)return[];let p=f.clone();for(;p.prev!==null;)d.push(p.clone()),p=p.clone().prev.clone();return d.reverse(),d}piece(c){return this.chars.slice(c.pos,c.pos+c.length).join("")}tokens(){return this.viterbi().map(u=>this.piece(u))}tokenIds(){return this.viterbi().map(u=>u.tokenId)}}class o{constructor(c,u,d,h,f){this.tokenId=c,this.nodeId=u,this.pos=d,this.length=h,this.score=f,this.prev=null,this.backtraceScore=0}clone(){const c=new o(this.tokenId,this.nodeId,this.pos,this.length,this.score);return c.prev=this.prev,c.backtraceScore=this.backtraceScore,c}}},"./src/utils/devices.js":(n,e,t)=>{t.r(e),t.d(e,{DEVICE_TYPES:()=>r});const r=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})},"./src/utils/dtypes.js":(n,e,t)=>{t.r(e),t.d(e,{DATA_TYPES:()=>a,DEFAULT_DEVICE_DTYPE_MAPPING:()=>o,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>l,isWebGpuFp16Supported:()=>s});var r=t("./src/env.js"),i=t("./src/utils/devices.js");const s=function(){let c;return async function(){if(c===void 0)if(!r.apis.IS_WEBGPU_AVAILABLE)c=!1;else try{c=(await navigator.gpu.requestAdapter()).features.has("shader-f16")}catch{c=!1}return c}}(),a=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),o=Object.freeze({[i.DEVICE_TYPES.wasm]:a.q8}),l=Object.freeze({[a.fp32]:"",[a.fp16]:"_fp16",[a.int8]:"_int8",[a.uint8]:"_uint8",[a.q8]:"_quantized",[a.q4]:"_q4",[a.q4f16]:"_q4f16",[a.bnb4]:"_bnb4"})},"./src/utils/generic.js":(n,e,t)=>{t.r(e),t.d(e,{Callable:()=>r});const r=class{constructor(){let i=function(...s){return i._call(...s)};return Object.setPrototypeOf(i,new.target.prototype)}_call(...i){throw Error("Must implement _call method in subclass")}}},"./src/utils/hub.js":(n,e,t)=>{t.r(e),t.d(e,{MAX_EXTERNAL_DATA_CHUNKS:()=>o,getFile:()=>d,getModelFile:()=>b,getModelJSON:()=>_});var r=t("?7a2c"),i=t("?a42a"),s=t("./src/env.js"),a=t("./src/utils/core.js");const o=100,l={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class c{constructor(w){if(this.filePath=w,this.headers=new Headers,this.exists=r.existsSync(w),this.exists){this.status=200,this.statusText="OK";let T=r.statSync(w);this.headers.set("content-length",T.size.toString()),this.updateContentType();const E=r.createReadStream(w);this.body=new ReadableStream({start(A){E.on("data",M=>A.enqueue(M)),E.on("end",()=>A.close()),E.on("error",M=>A.error(M))},cancel(){E.destroy()}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){const w=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",l[w]??"application/octet-stream")}clone(){let w=new c(this.filePath);return w.exists=this.exists,w.status=this.status,w.statusText=this.statusText,w.headers=new Headers(this.headers),w}async arrayBuffer(){return(await r.promises.readFile(this.filePath)).buffer}async blob(){const w=await r.promises.readFile(this.filePath);return new Blob([w],{type:this.headers.get("content-type")})}async text(){return await r.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function u(x,w=null,T=null){let E;try{E=new URL(x)}catch{return!1}return!(w&&!w.includes(E.protocol)||T&&!T.includes(E.hostname))}async function d(x){if(s.env.useFS&&!u(x,["http:","https:","blob:"]))return new c(x.toString());if(typeof process<"u"&&process?.release?.name==="node"){const w=!!dx?.TESTING_REMOTELY,T=s.env.version,E=new Headers;if(E.set("User-Agent",`transformers.js/${T}; is_ci/${w};`),u(x,["http:","https:"],["huggingface.co","hf.co"])){const M=dx?.HF_TOKEN??dx?.HF_ACCESS_TOKEN;M&&E.set("Authorization",`Bearer ${M}`)}return fetch(x,{headers:E})}else return fetch(x)}const h={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};function f(x,w,T){if(!T)return null;const E=h[x]??`Error (${x}) occurred while trying to load file`;throw Error(`${E}: "${w}".`)}class p{constructor(w){this.path=w}async match(w){let T=i.join(this.path,w),E=new c(T);if(E.exists)return E}async put(w,T,E=void 0){let A=i.join(this.path,w);try{const M=T.headers.get("Content-Length"),F=parseInt(M??"0");let G=0;await r.promises.mkdir(i.dirname(A),{recursive:!0});const S=r.createWriteStream(A),I=T.body.getReader();for(;;){const{done:C,value:H}=await I.read();if(C)break;await new Promise(($,X)=>{S.write(H,V=>{if(V){X(V);return}$()})}),G+=H.length;const B=F?G/F*100:0;E?.({progress:B,loaded:G,total:F})}S.close()}catch(M){try{await r.promises.unlink(A)}catch{}throw M}}}async function g(x,...w){for(let T of w)try{let E=await x.match(T);if(E)return E}catch{continue}}async function b(x,w,T=!0,E={},A=!1){if(!s.env.allowLocalModels){if(E.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!s.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}(0,a.dispatchCallback)(E.progress_callback,{status:"initiate",name:x,file:w});let M;if(!M&&s.env.useBrowserCache){if(typeof caches>"u")throw Error("Browser cache is not available in this environment.");try{M=await caches.open("transformers-cache")}catch(L){console.warn("An error occurred while opening the browser cache:",L)}}if(!M&&s.env.useFSCache&&(M=new p(E.cache_dir??s.env.cacheDir)),!M&&s.env.useCustomCache){if(!s.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!s.env.customCache.match||!s.env.customCache.put)throw new Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");M=s.env.customCache}const F=E.revision??"main";let G=v(x,w),S=v(s.env.localModelPath,G),I=G,C=v(s.env.remoteHost,s.env.remotePathTemplate.replaceAll("{model}",x).replaceAll("{revision}",encodeURIComponent(F)),w),H=F==="main"?G:v(x,F,w),B,$=M instanceof p?H:C,X=!1,V;M&&(V=await g(M,S,$));const Q=V!==void 0;if(V===void 0){if(s.env.allowLocalModels)if(u(G,["http:","https:"])){if(E.local_files_only)throw new Error(`\`local_files_only=true\`, but attempted to load a remote file from: ${I}.`);if(!s.env.allowRemoteModels)throw new Error(`\`env.allowRemoteModels=false\`, but attempted to load a remote file from: ${I}.`)}else try{V=await d(I),B=I}catch(ne){console.warn(`Unable to load from local path "${I}": "${ne}"`)}if(V===void 0||V.status===404){if(E.local_files_only||!s.env.allowRemoteModels){if(T)throw Error(`\`local_files_only=true\` or \`env.allowRemoteModels=false\` and file was not found locally at "${I}".`);return null}if(V=await d(C),V.status!==200)return f(V.status,C,T);B=$}X=M&&typeof Response<"u"&&V instanceof Response&&V.status===200}(0,a.dispatchCallback)(E.progress_callback,{status:"download",name:x,file:w});let R;if(!(s.apis.IS_NODE_ENV&&A)){let L;E.progress_callback?Q&&typeof navigator<"u"&&/firefox/i.test(navigator.userAgent)?(L=new Uint8Array(await V.arrayBuffer()),(0,a.dispatchCallback)(E.progress_callback,{status:"progress",name:x,file:w,progress:100,loaded:L.length,total:L.length})):L=await m(V,ne=>{(0,a.dispatchCallback)(E.progress_callback,{status:"progress",name:x,file:w,...ne})}):L=new Uint8Array(await V.arrayBuffer()),R=L}if(X&&B&&await M.match(B)===void 0&&(R?await M.put(B,new Response(R,{headers:V.headers})).catch(L=>{console.warn(`Unable to add response to browser cache: ${L}.`)}):await M.put(B,V,E.progress_callback)),(0,a.dispatchCallback)(E.progress_callback,{status:"done",name:x,file:w}),R){if(A)throw new Error("Cannot return path in a browser environment.");return R}if(V instanceof c)return V.filePath;const O=await M.match(B);if(O instanceof c)return O.filePath;throw new Error("Unable to return path for response.")}async function _(x,w,T=!0,E={}){const A=await b(x,w,T,E,!1);if(A===null)return{};const F=new TextDecoder("utf-8").decode(A);return JSON.parse(F)}async function m(x,w){const T=x.headers.get("Content-Length");T===null&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let E=parseInt(T??"0"),A=new Uint8Array(E),M=0;const F=x.body.getReader();async function G(){const{done:S,value:I}=await F.read();if(S)return;const C=M+I.length;if(C>E){E=C;const B=new Uint8Array(E);B.set(A),A=B}A.set(I,M),M=C;const H=M/E*100;return w({progress:H,loaded:M,total:E}),G()}return await G(),A}function v(...x){return x=x.map((w,T)=>(T&&(w=w.replace(new RegExp("^/"),"")),T!==x.length-1&&(w=w.replace(new RegExp("/$"),"")),w)),x.join("/")}},"./src/utils/image.js":(n,e,t)=>{t.r(e),t.d(e,{RawImage:()=>p,load_image:()=>g});var r=t("./src/utils/core.js"),i=t("./src/utils/hub.js"),s=t("./src/env.js"),a=t("./src/utils/tensor.js"),o=t("?2b25");let l,c,u;const d=s.apis.IS_BROWSER_ENV||s.apis.IS_WEBWORKER_ENV;if(d)l=(b,_)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(b,_)},u=self.createImageBitmap,c=self.ImageData;else if(o)u=async b=>{const m=(await b.metadata()).channels,{data:v,info:x}=await b.rotate().raw().toBuffer({resolveWithObject:!0}),w=new p(new Uint8ClampedArray(v),x.width,x.height,x.channels);return m!==void 0&&m!==x.channels&&w.convert(m),w};else throw new Error("Unable to load image processing library.");const h={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},f=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class p{constructor(_,m,v,x){this.data=_,this.width=m,this.height=v,this.channels=x}get size(){return[this.width,this.height]}static async read(_){if(_ instanceof p)return _;if(typeof _=="string"||_ instanceof URL)return await this.fromURL(_);throw new Error(`Unsupported input type: ${typeof _}`)}static fromCanvas(_){if(!d)throw new Error("fromCanvas() is only supported in browser environments.");const v=_.getContext("2d").getImageData(0,0,_.width,_.height).data;return new p(v,_.width,_.height,4)}static async fromURL(_){const m=await(0,i.getFile)(_);if(m.status!==200)throw new Error(`Unable to read image from "${_}" (${m.status} ${m.statusText})`);const v=await m.blob();return this.fromBlob(v)}static async fromBlob(_){if(d){const m=await u(_),v=l(m.width,m.height).getContext("2d");return v.drawImage(m,0,0),new this(v.getImageData(0,0,m.width,m.height).data,m.width,m.height,4)}else{const m=o(await _.arrayBuffer());return await u(m)}}static fromTensor(_,m="CHW"){if(_.dims.length!==3)throw new Error(`Tensor should have 3 dimensions, but has ${_.dims.length} dimensions.`);if(m==="CHW")_=_.transpose(1,2,0);else if(m!=="HWC")throw new Error(`Unsupported channel format: ${m}`);if(!(_.data instanceof Uint8ClampedArray||_.data instanceof Uint8Array))throw new Error(`Unsupported tensor type: ${_.type}`);switch(_.dims[2]){case 1:case 2:case 3:case 4:return new p(_.data,_.dims[1],_.dims[0],_.dims[2]);default:throw new Error(`Unsupported number of channels: ${_.dims[2]}`)}}grayscale(){if(this.channels===1)return this;const _=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let m=0,v=0;m<this.data.length;m+=this.channels){const x=this.data[m],w=this.data[m+1],T=this.data[m+2];_[v++]=Math.round(.2989*x+.587*w+.114*T)}break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(_,this.width,this.height,1)}rgb(){if(this.channels===3)return this;const _=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let m=0,v=0;m<this.data.length;++m)_[v++]=this.data[m],_[v++]=this.data[m],_[v++]=this.data[m];break;case 4:for(let m=0,v=0;m<this.data.length;m+=4)_[v++]=this.data[m],_[v++]=this.data[m+1],_[v++]=this.data[m+2];break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(_,this.width,this.height,3)}rgba(){if(this.channels===4)return this;const _=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let m=0,v=0;m<this.data.length;++m)_[v++]=this.data[m],_[v++]=this.data[m],_[v++]=this.data[m],_[v++]=255;break;case 3:for(let m=0,v=0;m<this.data.length;m+=3)_[v++]=this.data[m],_[v++]=this.data[m+1],_[v++]=this.data[m+2],_[v++]=255;break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this._update(_,this.width,this.height,4)}putAlpha(_){if(_.width!==this.width||_.height!==this.height)throw new Error(`Expected mask size to be ${this.width}x${this.height}, but got ${_.width}x${_.height}`);if(_.channels!==1)throw new Error(`Expected mask to have 1 channel, but got ${_.channels}`);const m=this.data,v=_.data,x=this.width*this.height;if(this.channels===3){const w=new Uint8ClampedArray(x*4);for(let T=0,E=0,A=0;T<x;++T)w[A++]=m[E++],w[A++]=m[E++],w[A++]=m[E++],w[A++]=v[T];return this._update(w,this.width,this.height,4)}else if(this.channels===4){for(let w=0;w<x;++w)m[4*w+3]=v[w];return this}throw new Error(`Expected image to have 3 or 4 channels, but got ${this.channels}`)}async resize(_,m,{resample:v=2}={}){if(this.width===_&&this.height===m)return this;let x=h[v]??v;const w=(0,r.isNullishDimension)(_),T=(0,r.isNullishDimension)(m);if(w&&T)return this;if(w?_=m/this.height*this.width:T&&(m=_/this.width*this.height),d){const E=this.channels,A=this.toCanvas(),M=l(_,m).getContext("2d");return M.drawImage(A,0,0,_,m),new p(M.getImageData(0,0,_,m).data,_,m,4).convert(E)}else{let E=this.toSharp();switch(x){case"box":case"hamming":(x==="box"||x==="hamming")&&(console.warn(`Resampling method ${x} is not yet supported. Using bilinear instead.`),x="bilinear");case"nearest":case"bilinear":case"bicubic":E=E.affine([_/this.width,0,0,m/this.height],{interpolator:x});break;case"lanczos":E=E.resize({width:_,height:m,fit:"fill",kernel:"lanczos3"});break;default:throw new Error(`Resampling method ${x} is not supported.`)}return await u(E)}}async pad([_,m,v,x]){if(_=Math.max(_,0),m=Math.max(m,0),v=Math.max(v,0),x=Math.max(x,0),_===0&&m===0&&v===0&&x===0)return this;if(d){const w=this.channels,T=this.toCanvas(),E=this.width+_+m,A=this.height+v+x,M=l(E,A).getContext("2d");return M.drawImage(T,0,0,this.width,this.height,_,v,this.width,this.height),new p(M.getImageData(0,0,E,A).data,E,A,4).convert(w)}else{const w=this.toSharp().extend({left:_,right:m,top:v,bottom:x});return await u(w)}}async crop([_,m,v,x]){if(_=Math.max(_,0),m=Math.max(m,0),v=Math.min(v,this.width-1),x=Math.min(x,this.height-1),_===0&&m===0&&v===this.width-1&&x===this.height-1)return this;const w=v-_+1,T=x-m+1;if(d){const E=this.channels,A=this.toCanvas(),M=l(w,T).getContext("2d");return M.drawImage(A,_,m,w,T,0,0,w,T),new p(M.getImageData(0,0,w,T).data,w,T,4).convert(E)}else{const E=this.toSharp().extract({left:_,top:m,width:w,height:T});return await u(E)}}async center_crop(_,m){if(this.width===_&&this.height===m)return this;const v=(this.width-_)/2,x=(this.height-m)/2;if(d){const w=this.channels,T=this.toCanvas(),E=l(_,m).getContext("2d");let A=0,M=0,F=0,G=0;return v>=0?A=v:F=-v,x>=0?M=x:G=-x,E.drawImage(T,A,M,_,m,F,G,_,m),new p(E.getImageData(0,0,_,m).data,_,m,4).convert(w)}else{let w=this.toSharp();if(v>=0&&x>=0)w=w.extract({left:Math.floor(v),top:Math.floor(x),width:_,height:m});else if(v<=0&&x<=0){const T=Math.floor(-x),E=Math.floor(-v);w=w.extend({top:T,left:E,right:_-this.width-E,bottom:m-this.height-T})}else{let T=[0,0],E=0;x<0?(T[0]=Math.floor(-x),T[1]=m-this.height-T[0]):E=Math.floor(x);let A=[0,0],M=0;v<0?(A[0]=Math.floor(-v),A[1]=_-this.width-A[0]):M=Math.floor(v),w=w.extend({top:T[0],bottom:T[1],left:A[0],right:A[1]}).extract({left:M,top:E,width:_,height:m})}return await u(w)}}async toBlob(_="image/png",m=1){if(!d)throw new Error("toBlob() is only supported in browser environments.");return await this.toCanvas().convertToBlob({type:_,quality:m})}toTensor(_="CHW"){let m=new a.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if(_!=="HWC")if(_==="CHW")m=m.permute(2,0,1);else throw new Error(`Unsupported channel format: ${_}`);return m}toCanvas(){if(!d)throw new Error("toCanvas() is only supported in browser environments.");const _=this.clone().rgba(),m=l(_.width,_.height),v=new c(_.data,_.width,_.height);return m.getContext("2d").putImageData(v,0,0),m}split(){const{data:_,width:m,height:v,channels:x}=this,w=_.constructor,T=_.length/x,E=Array.from({length:x},()=>new w(T));for(let A=0;A<T;++A){const M=x*A;for(let F=0;F<x;++F)E[F][A]=_[M+F]}return E.map(A=>new p(A,m,v,1))}_update(_,m,v,x=null){return this.data=_,this.width=m,this.height=v,x!==null&&(this.channels=x),this}clone(){return new p(this.data.slice(),this.width,this.height,this.channels)}convert(_){if(this.channels===_)return this;switch(_){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error(`Conversion failed due to unsupported number of channels: ${this.channels}`)}return this}async save(_){if(d){if(s.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const m=_.split(".").pop().toLowerCase(),v=f.get(m)??"image/png",x=await this.toBlob(v);(0,r.saveBlob)(_,x)}else{if(s.apis.IS_FS_AVAILABLE)return await this.toSharp().toFile(_);throw new Error("Unable to save the image because filesystem is disabled in this environment.")}}toSharp(){if(d)throw new Error("toSharp() is only supported in server-side environments.");return o(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}const g=p.read.bind(p)},"./src/utils/maths.js":(n,e,t)=>{t.r(e),t.d(e,{FFT:()=>g,bankers_round:()=>m,cos_sim:()=>l,dot:()=>o,dynamic_time_warping:()=>v,interpolate_data:()=>r,log_softmax:()=>a,magnitude:()=>c,max:()=>d,medianFilter:()=>b,min:()=>u,permute_data:()=>i,round:()=>_,softmax:()=>s});function r(x,[w,T,E],[A,M],F="bilinear",G=!1){const S=M/E,I=A/T,C=new x.constructor(A*M*w),H=T*E,B=A*M;for(let $=0;$<A;++$)for(let X=0;X<M;++X){const V=$*M+X,Q=(X+.5)/S-.5,R=($+.5)/I-.5;let O=Math.floor(Q),L=Math.floor(R);const ne=Math.min(O+1,E-1),de=Math.min(L+1,T-1);O=Math.max(O,0),L=Math.max(L,0);const we=Q-O,be=R-L,Ee=(1-we)*(1-be),Fe=we*(1-be),xe=(1-we)*be,ce=we*be,ue=L*E,Se=de*E,U=ue+O,he=ue+ne,pe=Se+O,ie=Se+ne;for(let re=0;re<w;++re){const ge=re*H;C[re*B+V]=Ee*x[ge+U]+Fe*x[ge+he]+xe*x[ge+pe]+ce*x[ge+ie]}}return C}function i(x,w,T){const E=new Array(T.length),A=new Array(T.length);for(let G=T.length-1,S=1;G>=0;--G)A[G]=S,E[G]=w[T[G]],S*=E[G];const M=T.map((G,S)=>A[T.indexOf(S)]),F=new x.constructor(x.length);for(let G=0;G<x.length;++G){let S=0;for(let I=w.length-1,C=G;I>=0;--I)S+=C%w[I]*M[I],C=Math.floor(C/w[I]);F[S]=x[G]}return[F,E]}function s(x){const w=d(x)[0],T=x.map(M=>Math.exp(M-w)),E=T.reduce((M,F)=>M+F,0);return T.map(M=>M/E)}function a(x){const w=d(x)[0];let T=0;for(let M=0;M<x.length;++M)T+=Math.exp(x[M]-w);const E=Math.log(T);return x.map(M=>M-w-E)}function o(x,w){let T=0;for(let E=0;E<x.length;++E)T+=x[E]*w[E];return T}function l(x,w){const T=o(x,w),E=c(x),A=c(w);return T/(E*A)}function c(x){return Math.sqrt(x.reduce((w,T)=>w+T*T,0))}function u(x){if(x.length===0)throw Error("Array must not be empty");let w=x[0],T=0;for(let E=1;E<x.length;++E)x[E]<w&&(w=x[E],T=E);return[w,T]}function d(x){if(x.length===0)throw Error("Array must not be empty");let w=x[0],T=0;for(let E=1;E<x.length;++E)x[E]>w&&(w=x[E],T=E);return[w,T]}function h(x){return x>0&&(x&x-1)===0}class f{constructor(w){if(this.size=w|0,this.size<=1||!h(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=w<<1,this.table=new Float64Array(this.size*2);for(let E=0;E<this.table.length;E+=2){const A=Math.PI*E/this.size;this.table[E]=Math.cos(A),this.table[E+1]=-Math.sin(A)}let T=0;for(let E=1;this.size>E;E<<=1)++T;this._width=T%2===0?T-1:T,this._bitrev=new Int32Array(1<<this._width);for(let E=0;E<this._bitrev.length;++E){this._bitrev[E]=0;for(let A=0;A<this._width;A+=2){const M=this._width-A-2;this._bitrev[E]|=(E>>>A&3)<<M}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(w,T){const E=T||new Array(w.length>>>1);for(let A=0;A<w.length;A+=2)E[A>>>1]=w[A];return E}toComplexArray(w,T){const E=T||this.createComplexArray();for(let A=0;A<E.length;A+=2)E[A]=w[A>>>1],E[A+1]=0;return E}transform(w,T){if(w===T)throw new Error("Input and output buffers must be different");this._transform4(w,T,1)}realTransform(w,T){if(w===T)throw new Error("Input and output buffers must be different");this._realTransform4(w,T,1)}inverseTransform(w,T){if(w===T)throw new Error("Input and output buffers must be different");this._transform4(w,T,-1);for(let E=0;E<w.length;++E)w[E]/=this.size}_transform4(w,T,E){const A=this._csize;let F=1<<this._width,G=A/F<<1,S,I;const C=this._bitrev;if(G===4)for(S=0,I=0;S<A;S+=G,++I){const B=C[I];this._singleTransform2(T,w,S,B,F)}else for(S=0,I=0;S<A;S+=G,++I){const B=C[I];this._singleTransform4(T,w,S,B,F,E)}const H=this.table;for(F>>=2;F>=2;F>>=2){G=A/F<<1;const B=G>>>2;for(S=0;S<A;S+=G){const $=S+B-1;for(let X=S,V=0;X<$;X+=2,V+=F){const Q=X,R=Q+B,O=R+B,L=O+B,ne=w[Q],de=w[Q+1],we=w[R],be=w[R+1],Ee=w[O],Fe=w[O+1],xe=w[L],ce=w[L+1],ue=H[V],Se=E*H[V+1],U=we*ue-be*Se,he=we*Se+be*ue,pe=H[2*V],ie=E*H[2*V+1],re=Ee*pe-Fe*ie,ge=Ee*ie+Fe*pe,Ce=H[3*V],q=E*H[3*V+1],te=xe*Ce-ce*q,j=xe*q+ce*Ce,ee=ne+re,se=de+ge,ve=ne-re,ke=de-ge,Re=U+te,Oe=he+j,ze=E*(U-te),Te=E*(he-j);w[Q]=ee+Re,w[Q+1]=se+Oe,w[R]=ve+Te,w[R+1]=ke-ze,w[O]=ee-Re,w[O+1]=se-Oe,w[L]=ve-Te,w[L+1]=ke+ze}}}}_singleTransform2(w,T,E,A,M){const F=w[A],G=w[A+1],S=w[A+M],I=w[A+M+1];T[E]=F+S,T[E+1]=G+I,T[E+2]=F-S,T[E+3]=G-I}_singleTransform4(w,T,E,A,M,F){const G=M*2,S=M*3,I=w[A],C=w[A+1],H=w[A+M],B=w[A+M+1],$=w[A+G],X=w[A+G+1],V=w[A+S],Q=w[A+S+1],R=I+$,O=C+X,L=I-$,ne=C-X,de=H+V,we=B+Q,be=F*(H-V),Ee=F*(B-Q);T[E]=R+de,T[E+1]=O+we,T[E+2]=L+Ee,T[E+3]=ne-be,T[E+4]=R-de,T[E+5]=O-we,T[E+6]=L-Ee,T[E+7]=ne+be}_realTransform4(w,T,E){const A=this._csize;let F=1<<this._width,G=A/F<<1,S,I;const C=this._bitrev;if(G===4)for(S=0,I=0;S<A;S+=G,++I){const $=C[I];this._singleRealTransform2(T,w,S,$>>>1,F>>>1)}else for(S=0,I=0;S<A;S+=G,++I){const $=C[I];this._singleRealTransform4(T,w,S,$>>>1,F>>>1,E)}const H=this.table;for(F>>=2;F>=2;F>>=2){G=A/F<<1;const $=G>>>1,X=$>>>1,V=X>>>1;for(S=0;S<A;S+=G)for(let Q=0,R=0;Q<=V;Q+=2,R+=F){const O=S+Q,L=O+X,ne=L+X,de=ne+X,we=w[O],be=w[O+1],Ee=w[L],Fe=w[L+1],xe=w[ne],ce=w[ne+1],ue=w[de],Se=w[de+1],U=we,he=be,pe=H[R],ie=E*H[R+1],re=Ee*pe-Fe*ie,ge=Ee*ie+Fe*pe,Ce=H[2*R],q=E*H[2*R+1],te=xe*Ce-ce*q,j=xe*q+ce*Ce,ee=H[3*R],se=E*H[3*R+1],ve=ue*ee-Se*se,ke=ue*se+Se*ee,Re=U+te,Oe=he+j,ze=U-te,Te=he-j,Be=re+ve,qe=ge+ke,tt=E*(re-ve),xt=E*(ge-ke);if(w[O]=Re+Be,w[O+1]=Oe+qe,w[L]=ze+xt,w[L+1]=Te-tt,Q===0){w[ne]=Re-Be,w[ne+1]=Oe-qe;continue}if(Q===V)continue;const ft=S+X-Q,Wt=S+$-Q;w[ft]=ze-E*xt,w[ft+1]=-Te-E*tt,w[Wt]=Re-E*Be,w[Wt+1]=-Oe+E*qe}}const B=A>>>1;for(let $=2;$<B;$+=2)w[A-$]=w[$],w[A-$+1]=-w[$+1]}_singleRealTransform2(w,T,E,A,M){const F=w[A],G=w[A+M];T[E]=F+G,T[E+1]=0,T[E+2]=F-G,T[E+3]=0}_singleRealTransform4(w,T,E,A,M,F){const G=M*2,S=M*3,I=w[A],C=w[A+M],H=w[A+G],B=w[A+S],$=I+H,X=I-H,V=C+B,Q=F*(C-B);T[E]=$+V,T[E+1]=0,T[E+2]=X,T[E+3]=-Q,T[E+4]=$-V,T[E+5]=0,T[E+6]=X,T[E+7]=Q}}class p{constructor(w){const T=2*(w-1),E=2*(2*w-1),A=2**Math.ceil(Math.log2(E));this.bufferSize=A,this._a=T;const M=new Float64Array(E),F=new Float64Array(A);this._chirpBuffer=new Float64Array(A),this._buffer1=new Float64Array(A),this._buffer2=new Float64Array(A),this._outBuffer1=new Float64Array(A),this._outBuffer2=new Float64Array(A);const G=-2*Math.PI/w,S=Math.cos(G),I=Math.sin(G);for(let C=0;C<E>>1;++C){const H=(C+1-w)**2/2,B=Math.sqrt(S**2+I**2)**H,$=H*Math.atan2(I,S),X=2*C;M[X]=B*Math.cos($),M[X+1]=B*Math.sin($),F[X]=M[X],F[X+1]=-M[X+1]}this._slicedChirpBuffer=M.subarray(T,E),this._f=new f(A>>1),this._f.transform(this._chirpBuffer,F)}_transform(w,T,E){const A=this._buffer1,M=this._buffer2,F=this._outBuffer1,G=this._outBuffer2,S=this._chirpBuffer,I=this._slicedChirpBuffer,C=this._a;if(E)for(let H=0;H<I.length;H+=2){const B=H+1,$=H>>1,X=T[$];A[H]=X*I[H],A[B]=X*I[B]}else for(let H=0;H<I.length;H+=2){const B=H+1;A[H]=T[H]*I[H]-T[B]*I[B],A[B]=T[H]*I[B]+T[B]*I[H]}this._f.transform(F,A);for(let H=0;H<S.length;H+=2){const B=H+1;M[H]=F[H]*S[H]-F[B]*S[B],M[B]=F[H]*S[B]+F[B]*S[H]}this._f.inverseTransform(G,M);for(let H=0;H<G.length;H+=2){const B=G[H+C],$=G[H+C+1],X=I[H],V=I[H+1];w[H]=B*X-$*V,w[H+1]=B*V+$*X}}transform(w,T){this._transform(w,T,!1)}realTransform(w,T){this._transform(w,T,!0)}}class g{constructor(w){this.fft_length=w,this.isPowerOfTwo=h(w),this.isPowerOfTwo?(this.fft=new f(w),this.outputBufferSize=2*w):(this.fft=new p(w),this.outputBufferSize=this.fft.bufferSize)}realTransform(w,T){this.fft.realTransform(w,T)}transform(w,T){this.fft.transform(w,T)}}function b(x,w){if(w%2===0||w<=0)throw new Error("Window size must be a positive odd number");const T=new x.constructor(x.length),E=new x.constructor(w),A=Math.floor(w/2);for(let M=0;M<x.length;++M){let F=0;for(let G=-A;G<=A;++G){let S=M+G;S<0?S=Math.abs(S):S>=x.length&&(S=2*(x.length-1)-S),E[F++]=x[S]}E.sort(),T[M]=E[A]}return T}function _(x,w){const T=Math.pow(10,w);return Math.round(x*T)/T}function m(x){const w=Math.round(x);return Math.abs(x)%1===.5?w%2===0?w:w-1:w}function v(x){const w=x.length,T=x[0].length,E=[w+1,T+1],A=Array.from({length:E[0]},()=>Array(E[1]).fill(1/0));A[0][0]=0;const M=Array.from({length:E[0]},()=>Array(E[1]).fill(-1));for(let C=1;C<E[1];++C)for(let H=1;H<E[0];++H){const B=A[H-1][C-1],$=A[H-1][C],X=A[H][C-1];let V,Q;B<$&&B<X?(V=B,Q=0):$<B&&$<X?(V=$,Q=1):(V=X,Q=2),A[H][C]=x[H-1][C-1]+V,M[H][C]=Q}for(let C=0;C<E[1];++C)M[0][C]=2;for(let C=0;C<E[0];++C)M[C][0]=1;let F=w,G=T,S=[],I=[];for(;F>0||G>0;)switch(S.push(F-1),I.push(G-1),M[F][G]){case 0:--F,--G;break;case 1:--F;break;case 2:--G;break;default:throw new Error(`Internal error in dynamic time warping. Unexpected trace[${F}, ${G}]. Please file a bug report.`)}return S.reverse(),I.reverse(),[S,I]}},"./src/utils/tensor.js":(n,e,t)=>{t.r(e),t.d(e,{DataTypeMap:()=>a,Tensor:()=>o,cat:()=>T,full:()=>I,full_like:()=>C,interpolate:()=>u,interpolate_4d:()=>d,layer_norm:()=>m,matmul:()=>h,mean:()=>F,mean_pooling:()=>_,ones:()=>H,ones_like:()=>B,permute:()=>c,quantize_embeddings:()=>Q,rand:()=>V,rfft:()=>f,slice:()=>b,stack:()=>E,std_mean:()=>M,topk:()=>p,zeros:()=>$,zeros_like:()=>X});var r=t("./src/utils/maths.js"),i=t("./src/backends/onnx.js"),s=t("./src/ops/registry.js");const a=Object.freeze({float32:Float32Array,float16:typeof Float16Array<"u"?Float16Array:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class o{get dims(){return this.ort_tensor.dims}set dims(O){this.ort_tensor.dims=O}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}ort_tensor;constructor(...O){return(0,i.isONNXTensor)(O[0])?this.ort_tensor=O[0]:this.ort_tensor=new i.Tensor(O[0],O[1],O[2]),new Proxy(this,{get:(L,ne)=>{if(typeof ne=="string"){let de=Number(ne);if(Number.isInteger(de))return L._getitem(de)}return L[ne]},set:(L,ne,de)=>L[ne]=de})}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){const[O,...L]=this.dims;if(L.length>0){const ne=L.reduce((de,we)=>de*we);for(let de=0;de<O;++de)yield this._subarray(de,ne,L)}else yield*this.data}_getitem(O){const[L,...ne]=this.dims;if(O=w(O,L),ne.length>0){const de=ne.reduce((we,be)=>we*be);return this._subarray(O,de,ne)}else return new o(this.type,[this.data[O]],ne)}indexOf(O){const L=this.data;for(let ne=0;ne<L.length;++ne)if(L[ne]==O)return ne;return-1}_subarray(O,L,ne){const de=O*L,we=(O+1)*L,be="subarray"in this.data?this.data.subarray(de,we):this.data.slice(de,we);return new o(this.type,be,ne)}item(){const O=this.data;if(O.length!==1)throw new Error(`a Tensor with ${O.length} elements cannot be converted to Scalar`);return O[0]}tolist(){return l(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){const O=this.data;for(let L=0;L<O.length;++L)O[L]=1/(1+Math.exp(-O[L]));return this}map(O){return this.clone().map_(O)}map_(O){const L=this.data;for(let ne=0;ne<L.length;++ne)L[ne]=O(L[ne],ne,L);return this}mul(O){return this.clone().mul_(O)}mul_(O){const L=this.data;for(let ne=0;ne<L.length;++ne)L[ne]*=O;return this}div(O){return this.clone().div_(O)}div_(O){const L=this.data;for(let ne=0;ne<L.length;++ne)L[ne]/=O;return this}add(O){return this.clone().add_(O)}add_(O){const L=this.data;for(let ne=0;ne<L.length;++ne)L[ne]+=O;return this}sub(O){return this.clone().sub_(O)}sub_(O){const L=this.data;for(let ne=0;ne<L.length;++ne)L[ne]-=O;return this}clone(){return new o(this.type,this.data.slice(),this.dims.slice())}slice(...O){const L=[],ne=[];for(let xe=0;xe<this.dims.length;++xe){let ce=O[xe];if(ce==null)ne.push([0,this.dims[xe]]),L.push(this.dims[xe]);else if(typeof ce=="number")ce=w(ce,this.dims[xe],xe),ne.push([ce,ce+1]);else if(Array.isArray(ce)&&ce.length===2){let[ue,Se]=ce;if(ue=ue===null?0:w(ue,this.dims[xe],xe,!1),Se=Se===null?this.dims[xe]:w(Se,this.dims[xe],xe,!1),ue>Se)throw new Error(`Invalid slice: ${ce}`);const U=[Math.max(ue,0),Math.min(Se,this.dims[xe])];ne.push(U),L.push(U[1]-U[0])}else throw new Error(`Invalid slice: ${ce}`)}const de=ne.map(([xe,ce])=>ce-xe),we=de.reduce((xe,ce)=>xe*ce),be=this.data,Ee=new be.constructor(we),Fe=this.stride();for(let xe=0;xe<we;++xe){let ce=0;for(let ue=de.length-1,Se=xe;ue>=0;--ue){const U=de[ue];ce+=(Se%U+ne[ue][0])*Fe[ue],Se=Math.floor(Se/U)}Ee[xe]=be[ce]}return new o(this.type,Ee,L)}permute(...O){return c(this,O)}transpose(...O){return this.permute(...O)}sum(O=null,L=!1){return this.norm(1,O,L)}norm(O="fro",L=null,ne=!1){if(O==="fro")O=2;else if(typeof O=="string")throw Error(`Unsupported norm: ${O}`);const de=this.data,we=(xe,ce)=>xe+ce**O;if(L===null){const xe=de.reduce(we,0)**(1/O);return new o(this.type,[xe],[])}const[be,Ee,Fe]=A(we,this,L,ne);if(O!==1)for(let xe=0;xe<Ee.length;++xe)Ee[xe]=Ee[xe]**(1/O);return new o(be,Ee,Fe)}normalize_(O=2,L=1){L=w(L,this.dims.length);const ne=this.norm(O,L,!0),de=this.data,we=ne.data;for(let be=0;be<de.length;++be){let Ee=0;for(let Fe=this.dims.length-1,xe=be,ce=1;Fe>=0;--Fe){const ue=this.dims[Fe];if(Fe!==L){const Se=xe%ue;Ee+=Se*ce,ce*=this.dims[Fe]}xe=Math.floor(xe/ue)}de[be]/=we[Ee]}return this}normalize(O=2,L=1){return this.clone().normalize_(O,L)}stride(){return G(this.dims)}squeeze(O=null){return new o(this.type,this.data,v(this.dims,O))}squeeze_(O=null){return this.dims=v(this.dims,O),this}unsqueeze(O=null){return new o(this.type,this.data,x(this.dims,O))}unsqueeze_(O=null){return this.dims=x(this.dims,O),this}flatten_(O=0,L=-1){L=(L+this.dims.length)%this.dims.length;let ne=this.dims.slice(0,O),de=this.dims.slice(O,L+1),we=this.dims.slice(L+1);return this.dims=[...ne,de.reduce((be,Ee)=>be*Ee,1),...we],this}flatten(O=0,L=-1){return this.clone().flatten_(O,L)}view(...O){let L=-1;for(let de=0;de<O.length;++de)if(O[de]===-1){if(L!==-1)throw new Error("Only one dimension can be inferred");L=de}const ne=this.data;if(L!==-1){const de=O.reduce((we,be,Ee)=>Ee!==L?we*be:we,1);O[L]=ne.length/de}return new o(this.type,ne,O)}neg_(){const O=this.data;for(let L=0;L<O.length;++L)O[L]=-O[L];return this}neg(){return this.clone().neg_()}gt(O){const L=new Uint8Array(this.data.length),ne=this.data;for(let de=0;de<ne.length;++de)L[de]=ne[de]>O?1:0;return new o("bool",L,this.dims)}lt(O){const L=new Uint8Array(this.data.length),ne=this.data;for(let de=0;de<ne.length;++de)L[de]=ne[de]<O?1:0;return new o("bool",L,this.dims)}clamp_(O,L){const ne=this.data;for(let de=0;de<ne.length;++de)ne[de]=Math.min(Math.max(ne[de],O),L);return this}clamp(O,L){return this.clone().clamp_(O,L)}round_(){const O=this.data;for(let L=0;L<O.length;++L)O[L]=Math.round(O[L]);return this}round(){return this.clone().round_()}mean(O=null,L=!1){return F(this,O,L)}min(O=null,L=!1){if(O===null){const be=(0,r.min)(this.data)[0];return new o(this.type,[be],[])}const[ne,de,we]=A((be,Ee)=>Math.min(be,Ee),this,O,L,1/0);return new o(ne,de,we)}max(O=null,L=!1){if(O===null){const be=(0,r.max)(this.data)[0];return new o(this.type,[be],[])}const[ne,de,we]=A((be,Ee)=>Math.max(be,Ee),this,O,L,-1/0);return new o(ne,de,we)}argmin(O=null,L=!1){if(O!==null)throw new Error("`dim !== null` not yet implemented.");const ne=(0,r.min)(this.data)[1];return new o("int64",[BigInt(ne)],[])}argmax(O=null,L=!1){if(O!==null)throw new Error("`dim !== null` not yet implemented.");const ne=(0,r.max)(this.data)[1];return new o("int64",[BigInt(ne)],[])}to(O){if(this.type===O)return this;if(!a.hasOwnProperty(O))throw new Error(`Unsupported type: ${O}`);let L;const ne=["int64","uint64"].includes(this.type),de=["int64","uint64"].includes(O);return ne&&!de?L=Number:!ne&&de&&(L=BigInt),new o(O,a[O].from(this.data,L),this.dims)}}function l(R,O){const L=R.length,ne=O.reduce((we,be)=>we*be);if(L!==ne)throw Error(`cannot reshape array of size ${L} into shape (${O})`);let de=R;for(let we=O.length-1;we>=0;we--)de=de.reduce((be,Ee)=>{let Fe=be[be.length-1];return Fe.length<O[we]?Fe.push(Ee):be.push([Ee]),be},[[]]);return de[0]}function c(R,O){const[L,ne]=(0,r.permute_data)(R.data,R.dims,O);return new o(R.type,L,ne)}function u(R,[O,L],ne="bilinear",de=!1){const we=R.dims.at(-3)??1,be=R.dims.at(-2),Ee=R.dims.at(-1);let Fe=(0,r.interpolate_data)(R.data,[we,be,Ee],[O,L],ne,de);return new o(R.type,Fe,[we,O,L])}async function d(R,{size:O=null,mode:L="bilinear"}={}){if(R.dims.length!==4)throw new Error("`interpolate_4d` currently only supports 4D input.");if(!O)throw new Error("`interpolate_4d` requires a `size` argument.");let ne;if(O.length===2)ne=[...R.dims.slice(0,2),...O];else if(O.length===3)ne=[R.dims[0],...O];else if(O.length===4)ne=O;else throw new Error("`size` must be of length 2, 3, or 4.");let de;if(L==="nearest")de=await s.TensorOpRegistry.nearest_interpolate_4d;else if(L==="bilinear")de=await s.TensorOpRegistry.bilinear_interpolate_4d;else if(L==="bicubic")de=await s.TensorOpRegistry.bicubic_interpolate_4d;else throw new Error(`Unsupported mode: ${L}`);const we=new o("int64",new BigInt64Array(ne.map(BigInt)),[ne.length]);return await de({x:R,s:we})}async function h(R,O){return await(await s.TensorOpRegistry.matmul)({a:R,b:O})}async function f(R,O){return await(await s.TensorOpRegistry.rfft)({x:R,a:O})}async function p(R,O){const L=await s.TensorOpRegistry.top_k;return O==null?O=R.dims.at(-1):O=Math.min(O,R.dims.at(-1)),await L({x:R,k:new o("int64",[BigInt(O)],[1])})}const g=R=>new o("int64",R,[R.length]);async function b(R,O,L,ne,de){return await(await s.TensorOpRegistry.slice)({x:R,s:g(O),e:g(L),a:g(ne),t:g(de??new Array(ne.length).fill(1))})}function _(R,O){const L=R.data,ne=O.data,de=[R.dims[0],R.dims[2]],we=new L.constructor(de[0]*de[1]),[be,Ee,Fe]=R.dims;let xe=0;for(let ce=0;ce<be;++ce){const ue=ce*Fe*Ee;for(let Se=0;Se<Fe;++Se){let U=0,he=0;const pe=ce*Ee,ie=ue+Se;for(let ge=0;ge<Ee;++ge){const Ce=Number(ne[pe+ge]);he+=Ce,U+=L[ie+ge*Fe]*Ce}const re=U/he;we[xe++]=re}}return new o(R.type,we,de)}function m(R,O,{eps:L=1e-5}={}){if(R.dims.length!==2)throw new Error("`layer_norm` currently only supports 2D input.");const[ne,de]=R.dims;if(O.length!==1&&O[0]!==de)throw new Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");const[we,be]=M(R,1,0,!0),Ee=we.data,Fe=be.data,xe=R.data,ce=new xe.constructor(xe.length);for(let ue=0;ue<ne;++ue){const Se=ue*de;for(let U=0;U<de;++U){const he=Se+U;ce[he]=(xe[he]-Fe[ue])/(Ee[ue]+L)}}return new o(R.type,ce,R.dims)}function v(R,O){return R=R.slice(),O===null?R=R.filter(L=>L!==1):typeof O=="number"?R[O]===1&&R.splice(O,1):Array.isArray(O)&&(R=R.filter((L,ne)=>L!==1||!O.includes(ne))),R}function x(R,O){return O=w(O,R.length+1),R=R.slice(),R.splice(O,0,1),R}function w(R,O,L=null,ne=!0){if(ne&&(R<-O||R>=O))throw new Error(`IndexError: index ${R} is out of bounds for dimension${L===null?"":" "+L} with size ${O}`);return R<0&&(R=(R%O+O)%O),R}function T(R,O=0){O=w(O,R[0].dims.length);const L=R[0].dims.slice();L[O]=R.reduce((be,Ee)=>be+Ee.dims[O],0);const ne=L.reduce((be,Ee)=>be*Ee,1),de=new R[0].data.constructor(ne),we=R[0].type;if(O===0){let be=0;for(const Ee of R){const Fe=Ee.data;de.set(Fe,be),be+=Fe.length}}else{let be=0;for(let Ee=0;Ee<R.length;++Ee){const{data:Fe,dims:xe}=R[Ee];for(let ce=0;ce<Fe.length;++ce){let ue=0;for(let Se=xe.length-1,U=ce,he=1;Se>=0;--Se){const pe=xe[Se];let ie=U%pe;Se===O&&(ie+=be),ue+=ie*he,he*=L[Se],U=Math.floor(U/pe)}de[ue]=Fe[ce]}be+=xe[O]}}return new o(we,de,L)}function E(R,O=0){return T(R.map(L=>L.unsqueeze(O)),O)}function A(R,O,L=null,ne=!1,de=null){const we=O.data,be=O.dims;L=w(L,be.length);const Ee=be.slice();Ee[L]=1;const Fe=new we.constructor(we.length/be[L]);de!==null&&Fe.fill(de);for(let xe=0;xe<we.length;++xe){let ce=0;for(let ue=be.length-1,Se=xe,U=1;ue>=0;--ue){const he=be[ue];if(ue!==L){const pe=Se%he;ce+=pe*U,U*=Ee[ue]}Se=Math.floor(Se/he)}Fe[ce]=R(Fe[ce],we[xe],xe,ce)}return ne||Ee.splice(L,1),[O.type,Fe,Ee]}function M(R,O=null,L=1,ne=!1){const de=R.data,we=R.dims;if(O===null){const U=de.reduce((re,ge)=>re+ge,0)/de.length,he=Math.sqrt(de.reduce((re,ge)=>re+(ge-U)**2,0)/(de.length-L)),pe=new o(R.type,[U],[]);return[new o(R.type,[he],[]),pe]}O=w(O,we.length);const be=F(R,O,ne),Ee=be.data,[Fe,xe,ce]=A((Se,U,he,pe)=>Se+(U-Ee[pe])**2,R,O,ne);for(let Se=0;Se<xe.length;++Se)xe[Se]=Math.sqrt(xe[Se]/(we[O]-L));return[new o(Fe,xe,ce),be]}function F(R,O=null,L=!1){const ne=R.dims,de=R.data;if(O===null){const Fe=de.reduce((xe,ce)=>xe+ce,0);return new o(R.type,[Fe/de.length],[])}O=w(O,ne.length);const[we,be,Ee]=A((Fe,xe)=>Fe+xe,R,O,L);if(ne[O]!==1)for(let Fe=0;Fe<be.length;++Fe)be[Fe]/=ne[O];return new o(we,be,Ee)}function G(R){const O=new Array(R.length);for(let L=R.length-1,ne=1;L>=0;--L)O[L]=ne,ne*=R[L];return O}function S(R,O,L,ne){const de=R.reduce((we,be)=>we*be,1);return new o(L,new ne(de).fill(O),R)}function I(R,O){let L,ne;if(typeof O=="number")L="float32",ne=Float32Array;else if(typeof O=="bigint")L="int64",ne=BigInt64Array;else if(typeof O=="boolean")L="bool",ne=Uint8Array;else throw new Error(`Unsupported data type: ${typeof O}`);return S(R,O,L,ne)}function C(R,O){return I(R.dims,O)}function H(R){return S(R,1n,"int64",BigInt64Array)}function B(R){return H(R.dims)}function $(R){return S(R,0n,"int64",BigInt64Array)}function X(R){return $(R.dims)}function V(R){const O=R.reduce((L,ne)=>L*ne,1);return new o("float32",Float32Array.from({length:O},()=>Math.random()),R)}function Q(R,O){if(R.dims.length!==2)throw new Error("The tensor must have 2 dimensions");if(R.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(O))throw new Error("The precision must be either 'binary' or 'ubinary'");const L=O==="binary",ne=L?"int8":"uint8",de=L?Int8Array:Uint8Array,we=R.data,be=new de(we.length/8);for(let Ee=0;Ee<we.length;++Ee){const Fe=we[Ee]>0?1:0,xe=Math.floor(Ee/8),ce=Ee%8;be[xe]|=Fe<<7-ce,L&&ce===0&&(be[xe]-=128)}return new o(ne,be,[R.dims[0],R.dims[1]/8])}},"./src/utils/video.js":(n,e,t)=>{t.r(e),t.d(e,{RawVideo:()=>a,RawVideoFrame:()=>s,load_video:()=>o});var r=t("./src/utils/image.js"),i=t("./src/env.js");class s{constructor(c,u){this.image=c,this.timestamp=u}}class a{constructor(c,u){c.length>0&&c[0]instanceof r.RawImage&&(c=c.map((d,h)=>new s(d,(h+1)/(c.length+1)*u))),this.frames=c,this.duration=u}get width(){return this.frames[0].image.width}get height(){return this.frames[0].image.height}get fps(){return this.frames.length/this.duration}}async function o(l,{num_frames:c=null,fps:u=null}={}){if(!i.apis.IS_BROWSER_ENV)throw new Error("`load_video` is currently only supported in browser environments.");if(c==null&&u==null)throw new Error("Either num_frames or fps must be provided.");const d=[],h=document.createElement("video");if(h.crossOrigin="anonymous",h.muted=!0,typeof l=="string")h.src=l;else if(l instanceof Blob)h.src=URL.createObjectURL(l);else if(l instanceof HTMLVideoElement)h.src=l.src;else throw new Error("Invalid URL or video element provided.");if(await new Promise(v=>h.onloadedmetadata=v),h.seekable.start(0)===h.seekable.end(0)){const x=await(await fetch(h.src)).blob();h.src=URL.createObjectURL(x),await new Promise(w=>h.onloadedmetadata=w)}const f=h.duration;let p,g;c!=null?(p=c,g=c===1?0:f/(c-1)):(g=1/u,p=Math.floor(f/g));let b=[];for(let v=0;v<p;++v)b.push(c===1?f/2:v*g);const _=document.createElement("canvas");_.width=h.videoWidth,_.height=h.videoHeight;const m=_.getContext("2d",{willReadFrequently:!0});for(const v of b){h.currentTime=v,await new Promise(E=>{h.onseeked=E}),m.drawImage(h,0,0,_.width,_.height);const x=m.getImageData(0,0,_.width,_.height),w=new r.RawImage(x.data,_.width,_.height,4),T=new s(w,v);d.push(T)}return h.remove(),new a(d,f)}}},eU={};function ln(n){var e=eU[n];if(e!==void 0)return e.exports;var t=eU[n]={exports:{}};return B7[n](t,t.exports,ln),t.exports}(()=>{var n=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,e;ln.t=function(t,r){if(r&1&&(t=this(t)),r&8||typeof t=="object"&&t&&(r&4&&t.__esModule||r&16&&typeof t.then=="function"))return t;var i=Object.create(null);ln.r(i);var s={};e=e||[null,n({}),n([]),n(n)];for(var a=r&2&&t;typeof a=="object"&&!~e.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach(o=>s[o]=()=>t[o]);return s.default=()=>t,ln.d(i,s),i}})();ln.d=(n,e)=>{for(var t in e)ln.o(e,t)&&!ln.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};ln.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);ln.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var k={};(()=>{/*!*****************************!*\
  !*** ./src/transformers.js ***!
  \*****************************/ln.r(k),ln.d(k,{ASTFeatureExtractor:()=>d.ASTFeatureExtractor,ASTForAudioClassification:()=>t.ASTForAudioClassification,ASTModel:()=>t.ASTModel,ASTPreTrainedModel:()=>t.ASTPreTrainedModel,AlbertForMaskedLM:()=>t.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>t.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>t.AlbertForSequenceClassification,AlbertModel:()=>t.AlbertModel,AlbertPreTrainedModel:()=>t.AlbertPreTrainedModel,AlbertTokenizer:()=>r.AlbertTokenizer,AudioClassificationPipeline:()=>e.AudioClassificationPipeline,AutoConfig:()=>i.AutoConfig,AutoFeatureExtractor:()=>h.AutoFeatureExtractor,AutoImageProcessor:()=>g.AutoImageProcessor,AutoModel:()=>t.AutoModel,AutoModelForAudioClassification:()=>t.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>t.AutoModelForAudioFrameClassification,AutoModelForAudioTextToText:()=>t.AutoModelForAudioTextToText,AutoModelForCTC:()=>t.AutoModelForCTC,AutoModelForCausalLM:()=>t.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>t.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>t.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>t.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>t.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>t.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>t.AutoModelForImageSegmentation,AutoModelForImageTextToText:()=>t.AutoModelForImageTextToText,AutoModelForImageToImage:()=>t.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>t.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>t.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>t.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>t.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>t.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>t.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>t.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>t.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>t.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>t.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>t.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>t.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>t.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>t.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>t.AutoModelForVision2Seq,AutoModelForXVector:()=>t.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>t.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>m.AutoProcessor,AutoTokenizer:()=>r.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>e.AutomaticSpeechRecognitionPipeline,BackgroundRemovalPipeline:()=>e.BackgroundRemovalPipeline,BartForConditionalGeneration:()=>t.BartForConditionalGeneration,BartForSequenceClassification:()=>t.BartForSequenceClassification,BartModel:()=>t.BartModel,BartPretrainedModel:()=>t.BartPretrainedModel,BartTokenizer:()=>r.BartTokenizer,BaseModelOutput:()=>t.BaseModelOutput,BaseStreamer:()=>v.BaseStreamer,BeitFeatureExtractor:()=>p.BeitFeatureExtractor,BeitForImageClassification:()=>t.BeitForImageClassification,BeitModel:()=>t.BeitModel,BeitPreTrainedModel:()=>t.BeitPreTrainedModel,BertForMaskedLM:()=>t.BertForMaskedLM,BertForQuestionAnswering:()=>t.BertForQuestionAnswering,BertForSequenceClassification:()=>t.BertForSequenceClassification,BertForTokenClassification:()=>t.BertForTokenClassification,BertModel:()=>t.BertModel,BertPreTrainedModel:()=>t.BertPreTrainedModel,BertTokenizer:()=>r.BertTokenizer,BitImageProcessor:()=>p.BitImageProcessor,BlenderbotForConditionalGeneration:()=>t.BlenderbotForConditionalGeneration,BlenderbotModel:()=>t.BlenderbotModel,BlenderbotPreTrainedModel:()=>t.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>t.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>t.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>t.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>r.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>r.BlenderbotTokenizer,BloomForCausalLM:()=>t.BloomForCausalLM,BloomModel:()=>t.BloomModel,BloomPreTrainedModel:()=>t.BloomPreTrainedModel,BloomTokenizer:()=>r.BloomTokenizer,CLIPFeatureExtractor:()=>p.CLIPFeatureExtractor,CLIPImageProcessor:()=>p.CLIPImageProcessor,CLIPModel:()=>t.CLIPModel,CLIPPreTrainedModel:()=>t.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>t.CLIPSegForImageSegmentation,CLIPSegModel:()=>t.CLIPSegModel,CLIPSegPreTrainedModel:()=>t.CLIPSegPreTrainedModel,CLIPTextModel:()=>t.CLIPTextModel,CLIPTextModelWithProjection:()=>t.CLIPTextModelWithProjection,CLIPTokenizer:()=>r.CLIPTokenizer,CLIPVisionModel:()=>t.CLIPVisionModel,CLIPVisionModelWithProjection:()=>t.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>t.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>t.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>t.CamembertForSequenceClassification,CamembertForTokenClassification:()=>t.CamembertForTokenClassification,CamembertModel:()=>t.CamembertModel,CamembertPreTrainedModel:()=>t.CamembertPreTrainedModel,CamembertTokenizer:()=>r.CamembertTokenizer,CausalLMOutput:()=>t.CausalLMOutput,CausalLMOutputWithPast:()=>t.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>p.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>t.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>t.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>t.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>d.ClapFeatureExtractor,ClapModel:()=>t.ClapModel,ClapPreTrainedModel:()=>t.ClapPreTrainedModel,ClapTextModelWithProjection:()=>t.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>w.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>t.CodeGenForCausalLM,CodeGenModel:()=>t.CodeGenModel,CodeGenPreTrainedModel:()=>t.CodeGenPreTrainedModel,CodeGenTokenizer:()=>r.CodeGenTokenizer,CodeLlamaTokenizer:()=>r.CodeLlamaTokenizer,CohereForCausalLM:()=>t.CohereForCausalLM,CohereModel:()=>t.CohereModel,CoherePreTrainedModel:()=>t.CoherePreTrainedModel,CohereTokenizer:()=>r.CohereTokenizer,ConvBertForMaskedLM:()=>t.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>t.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>t.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>t.ConvBertForTokenClassification,ConvBertModel:()=>t.ConvBertModel,ConvBertPreTrainedModel:()=>t.ConvBertPreTrainedModel,ConvBertTokenizer:()=>r.ConvBertTokenizer,ConvNextFeatureExtractor:()=>p.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>t.ConvNextForImageClassification,ConvNextImageProcessor:()=>p.ConvNextImageProcessor,ConvNextModel:()=>t.ConvNextModel,ConvNextPreTrainedModel:()=>t.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>t.ConvNextV2ForImageClassification,ConvNextV2Model:()=>t.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>t.ConvNextV2PreTrainedModel,DPTFeatureExtractor:()=>p.DPTFeatureExtractor,DPTForDepthEstimation:()=>t.DPTForDepthEstimation,DPTImageProcessor:()=>p.DPTImageProcessor,DPTModel:()=>t.DPTModel,DPTPreTrainedModel:()=>t.DPTPreTrainedModel,DacDecoderModel:()=>t.DacDecoderModel,DacDecoderOutput:()=>t.DacDecoderOutput,DacEncoderModel:()=>t.DacEncoderModel,DacEncoderOutput:()=>t.DacEncoderOutput,DacFeatureExtractor:()=>d.DacFeatureExtractor,DacModel:()=>t.DacModel,DacPreTrainedModel:()=>t.DacPreTrainedModel,DataTypeMap:()=>l.DataTypeMap,DebertaForMaskedLM:()=>t.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>t.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>t.DebertaForSequenceClassification,DebertaForTokenClassification:()=>t.DebertaForTokenClassification,DebertaModel:()=>t.DebertaModel,DebertaPreTrainedModel:()=>t.DebertaPreTrainedModel,DebertaTokenizer:()=>r.DebertaTokenizer,DebertaV2ForMaskedLM:()=>t.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>t.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>t.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>t.DebertaV2ForTokenClassification,DebertaV2Model:()=>t.DebertaV2Model,DebertaV2PreTrainedModel:()=>t.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>r.DebertaV2Tokenizer,DecisionTransformerModel:()=>t.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>t.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>p.DeiTFeatureExtractor,DeiTForImageClassification:()=>t.DeiTForImageClassification,DeiTImageProcessor:()=>p.DeiTImageProcessor,DeiTModel:()=>t.DeiTModel,DeiTPreTrainedModel:()=>t.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>t.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>t.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>e.DepthEstimationPipeline,DepthProForDepthEstimation:()=>t.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>t.DepthProPreTrainedModel,DetrFeatureExtractor:()=>p.DetrFeatureExtractor,DetrForObjectDetection:()=>t.DetrForObjectDetection,DetrForSegmentation:()=>t.DetrForSegmentation,DetrImageProcessor:()=>p.DetrImageProcessor,DetrModel:()=>t.DetrModel,DetrObjectDetectionOutput:()=>t.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>t.DetrPreTrainedModel,DetrSegmentationOutput:()=>t.DetrSegmentationOutput,Dinov2ForImageClassification:()=>t.Dinov2ForImageClassification,Dinov2Model:()=>t.Dinov2Model,Dinov2PreTrainedModel:()=>t.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>t.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>t.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>t.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>t.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>t.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>t.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>t.DistilBertForTokenClassification,DistilBertModel:()=>t.DistilBertModel,DistilBertPreTrainedModel:()=>t.DistilBertPreTrainedModel,DistilBertTokenizer:()=>r.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>e.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>p.DonutFeatureExtractor,DonutImageProcessor:()=>p.DonutImageProcessor,DonutSwinModel:()=>t.DonutSwinModel,DonutSwinPreTrainedModel:()=>t.DonutSwinPreTrainedModel,EfficientNetForImageClassification:()=>t.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>p.EfficientNetImageProcessor,EfficientNetModel:()=>t.EfficientNetModel,EfficientNetPreTrainedModel:()=>t.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>t.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>t.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>t.ElectraForSequenceClassification,ElectraForTokenClassification:()=>t.ElectraForTokenClassification,ElectraModel:()=>t.ElectraModel,ElectraPreTrainedModel:()=>t.ElectraPreTrainedModel,ElectraTokenizer:()=>r.ElectraTokenizer,EncodecFeatureExtractor:()=>d.EncodecFeatureExtractor,EosTokenCriteria:()=>x.EosTokenCriteria,EsmForMaskedLM:()=>t.EsmForMaskedLM,EsmForSequenceClassification:()=>t.EsmForSequenceClassification,EsmForTokenClassification:()=>t.EsmForTokenClassification,EsmModel:()=>t.EsmModel,EsmPreTrainedModel:()=>t.EsmPreTrainedModel,EsmTokenizer:()=>r.EsmTokenizer,ExaoneForCausalLM:()=>t.ExaoneForCausalLM,ExaoneModel:()=>t.ExaoneModel,ExaonePreTrainedModel:()=>t.ExaonePreTrainedModel,FFT:()=>c.FFT,FalconForCausalLM:()=>t.FalconForCausalLM,FalconModel:()=>t.FalconModel,FalconPreTrainedModel:()=>t.FalconPreTrainedModel,FalconTokenizer:()=>r.FalconTokenizer,FastViTForImageClassification:()=>t.FastViTForImageClassification,FastViTModel:()=>t.FastViTModel,FastViTPreTrainedModel:()=>t.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>e.FeatureExtractionPipeline,FeatureExtractor:()=>u.FeatureExtractor,FillMaskPipeline:()=>e.FillMaskPipeline,Florence2ForConditionalGeneration:()=>t.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>t.Florence2PreTrainedModel,Florence2Processor:()=>_.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>w.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>w.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>p.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>t.GLPNForDepthEstimation,GLPNModel:()=>t.GLPNModel,GLPNPreTrainedModel:()=>t.GLPNPreTrainedModel,GPT2LMHeadModel:()=>t.GPT2LMHeadModel,GPT2Model:()=>t.GPT2Model,GPT2PreTrainedModel:()=>t.GPT2PreTrainedModel,GPT2Tokenizer:()=>r.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>t.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>t.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>t.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>t.GPTJForCausalLM,GPTJModel:()=>t.GPTJModel,GPTJPreTrainedModel:()=>t.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>t.GPTNeoForCausalLM,GPTNeoModel:()=>t.GPTNeoModel,GPTNeoPreTrainedModel:()=>t.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>t.GPTNeoXForCausalLM,GPTNeoXModel:()=>t.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>t.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>r.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>t.Gemma2ForCausalLM,Gemma2Model:()=>t.Gemma2Model,Gemma2PreTrainedModel:()=>t.Gemma2PreTrainedModel,GemmaForCausalLM:()=>t.GemmaForCausalLM,GemmaModel:()=>t.GemmaModel,GemmaPreTrainedModel:()=>t.GemmaPreTrainedModel,GemmaTokenizer:()=>r.GemmaTokenizer,GlmForCausalLM:()=>t.GlmForCausalLM,GlmModel:()=>t.GlmModel,GlmPreTrainedModel:()=>t.GlmPreTrainedModel,GraniteForCausalLM:()=>t.GraniteForCausalLM,GraniteModel:()=>t.GraniteModel,GranitePreTrainedModel:()=>t.GranitePreTrainedModel,Grok1Tokenizer:()=>r.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>t.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>p.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>t.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>_.GroundingDinoProcessor,GroupViTModel:()=>t.GroupViTModel,GroupViTPreTrainedModel:()=>t.GroupViTPreTrainedModel,HeliumForCausalLM:()=>t.HeliumForCausalLM,HeliumModel:()=>t.HeliumModel,HeliumPreTrainedModel:()=>t.HeliumPreTrainedModel,HerbertTokenizer:()=>r.HerbertTokenizer,HieraForImageClassification:()=>t.HieraForImageClassification,HieraModel:()=>t.HieraModel,HieraPreTrainedModel:()=>t.HieraPreTrainedModel,HubertForCTC:()=>t.HubertForCTC,HubertForSequenceClassification:()=>t.HubertForSequenceClassification,HubertModel:()=>t.HubertModel,HubertPreTrainedModel:()=>t.HubertPreTrainedModel,IJepaForImageClassification:()=>t.IJepaForImageClassification,IJepaModel:()=>t.IJepaModel,IJepaPreTrainedModel:()=>t.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>t.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>p.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>t.Idefics3PreTrainedModel,Idefics3Processor:()=>_.Idefics3Processor,ImageClassificationPipeline:()=>e.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>e.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>d.ImageFeatureExtractor,ImageMattingOutput:()=>t.ImageMattingOutput,ImageProcessor:()=>f.ImageProcessor,ImageSegmentationPipeline:()=>e.ImageSegmentationPipeline,ImageToImagePipeline:()=>e.ImageToImagePipeline,ImageToTextPipeline:()=>e.ImageToTextPipeline,InterruptableStoppingCriteria:()=>x.InterruptableStoppingCriteria,JAISLMHeadModel:()=>t.JAISLMHeadModel,JAISModel:()=>t.JAISModel,JAISPreTrainedModel:()=>t.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>p.JinaCLIPImageProcessor,JinaCLIPModel:()=>t.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>t.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>_.JinaCLIPProcessor,JinaCLIPTextModel:()=>t.JinaCLIPTextModel,JinaCLIPVisionModel:()=>t.JinaCLIPVisionModel,LiteWhisperForConditionalGeneration:()=>t.LiteWhisperForConditionalGeneration,LlamaForCausalLM:()=>t.LlamaForCausalLM,LlamaModel:()=>t.LlamaModel,LlamaPreTrainedModel:()=>t.LlamaPreTrainedModel,LlamaTokenizer:()=>r.LlamaTokenizer,LlavaForConditionalGeneration:()=>t.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>t.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>p.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>t.LlavaPreTrainedModel,LogitsProcessor:()=>w.LogitsProcessor,LogitsProcessorList:()=>w.LogitsProcessorList,LogitsWarper:()=>w.LogitsWarper,LongT5ForConditionalGeneration:()=>t.LongT5ForConditionalGeneration,LongT5Model:()=>t.LongT5Model,LongT5PreTrainedModel:()=>t.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>t.M2M100ForConditionalGeneration,M2M100Model:()=>t.M2M100Model,M2M100PreTrainedModel:()=>t.M2M100PreTrainedModel,M2M100Tokenizer:()=>r.M2M100Tokenizer,MBart50Tokenizer:()=>r.MBart50Tokenizer,MBartForCausalLM:()=>t.MBartForCausalLM,MBartForConditionalGeneration:()=>t.MBartForConditionalGeneration,MBartForSequenceClassification:()=>t.MBartForSequenceClassification,MBartModel:()=>t.MBartModel,MBartPreTrainedModel:()=>t.MBartPreTrainedModel,MBartTokenizer:()=>r.MBartTokenizer,MPNetForMaskedLM:()=>t.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>t.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>t.MPNetForSequenceClassification,MPNetForTokenClassification:()=>t.MPNetForTokenClassification,MPNetModel:()=>t.MPNetModel,MPNetPreTrainedModel:()=>t.MPNetPreTrainedModel,MPNetTokenizer:()=>r.MPNetTokenizer,MT5ForConditionalGeneration:()=>t.MT5ForConditionalGeneration,MT5Model:()=>t.MT5Model,MT5PreTrainedModel:()=>t.MT5PreTrainedModel,MarianMTModel:()=>t.MarianMTModel,MarianModel:()=>t.MarianModel,MarianPreTrainedModel:()=>t.MarianPreTrainedModel,MarianTokenizer:()=>r.MarianTokenizer,Mask2FormerImageProcessor:()=>p.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>p.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>t.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>p.MaskFormerImageProcessor,MaskFormerModel:()=>t.MaskFormerModel,MaskFormerPreTrainedModel:()=>t.MaskFormerPreTrainedModel,MaskedLMOutput:()=>t.MaskedLMOutput,MaxLengthCriteria:()=>x.MaxLengthCriteria,MgpstrForSceneTextRecognition:()=>t.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>t.MgpstrModelOutput,MgpstrPreTrainedModel:()=>t.MgpstrPreTrainedModel,MgpstrProcessor:()=>_.MgpstrProcessor,MgpstrTokenizer:()=>r.MgpstrTokenizer,MimiDecoderModel:()=>t.MimiDecoderModel,MimiDecoderOutput:()=>t.MimiDecoderOutput,MimiEncoderModel:()=>t.MimiEncoderModel,MimiEncoderOutput:()=>t.MimiEncoderOutput,MimiModel:()=>t.MimiModel,MimiPreTrainedModel:()=>t.MimiPreTrainedModel,MinLengthLogitsProcessor:()=>w.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>w.MinNewTokensLengthLogitsProcessor,MistralForCausalLM:()=>t.MistralForCausalLM,MistralModel:()=>t.MistralModel,MistralPreTrainedModel:()=>t.MistralPreTrainedModel,MobileBertForMaskedLM:()=>t.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>t.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>t.MobileBertForSequenceClassification,MobileBertModel:()=>t.MobileBertModel,MobileBertPreTrainedModel:()=>t.MobileBertPreTrainedModel,MobileBertTokenizer:()=>r.MobileBertTokenizer,MobileLLMForCausalLM:()=>t.MobileLLMForCausalLM,MobileLLMModel:()=>t.MobileLLMModel,MobileLLMPreTrainedModel:()=>t.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>p.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>t.MobileNetV1ForImageClassification,MobileNetV1ForSemanticSegmentation:()=>t.MobileNetV1ForSemanticSegmentation,MobileNetV1ImageProcessor:()=>p.MobileNetV1ImageProcessor,MobileNetV1Model:()=>t.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>t.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>p.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>t.MobileNetV2ForImageClassification,MobileNetV2ForSemanticSegmentation:()=>t.MobileNetV2ForSemanticSegmentation,MobileNetV2ImageProcessor:()=>p.MobileNetV2ImageProcessor,MobileNetV2Model:()=>t.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>t.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>p.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>t.MobileNetV3ForImageClassification,MobileNetV3ForSemanticSegmentation:()=>t.MobileNetV3ForSemanticSegmentation,MobileNetV3ImageProcessor:()=>p.MobileNetV3ImageProcessor,MobileNetV3Model:()=>t.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>t.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>p.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>t.MobileNetV4ForImageClassification,MobileNetV4ForSemanticSegmentation:()=>t.MobileNetV4ForSemanticSegmentation,MobileNetV4ImageProcessor:()=>p.MobileNetV4ImageProcessor,MobileNetV4Model:()=>t.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>t.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>p.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>t.MobileViTForImageClassification,MobileViTImageProcessor:()=>p.MobileViTImageProcessor,MobileViTModel:()=>t.MobileViTModel,MobileViTPreTrainedModel:()=>t.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>t.MobileViTV2ForImageClassification,MobileViTV2Model:()=>t.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>t.MobileViTV2PreTrainedModel,ModelOutput:()=>t.ModelOutput,ModernBertForMaskedLM:()=>t.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>t.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>t.ModernBertForTokenClassification,ModernBertModel:()=>t.ModernBertModel,ModernBertPreTrainedModel:()=>t.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>t.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>d.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>t.MoonshineForConditionalGeneration,MoonshineModel:()=>t.MoonshineModel,MoonshinePreTrainedModel:()=>t.MoonshinePreTrainedModel,MoonshineProcessor:()=>_.MoonshineProcessor,MptForCausalLM:()=>t.MptForCausalLM,MptModel:()=>t.MptModel,MptPreTrainedModel:()=>t.MptPreTrainedModel,MultiModalityCausalLM:()=>t.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>t.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>t.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>t.MusicgenForConditionalGeneration,MusicgenModel:()=>t.MusicgenModel,MusicgenPreTrainedModel:()=>t.MusicgenPreTrainedModel,NllbTokenizer:()=>r.NllbTokenizer,NoBadWordsLogitsProcessor:()=>w.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>w.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>t.NomicBertModel,NomicBertPreTrainedModel:()=>t.NomicBertPreTrainedModel,NougatImageProcessor:()=>p.NougatImageProcessor,NougatTokenizer:()=>r.NougatTokenizer,OPTForCausalLM:()=>t.OPTForCausalLM,OPTModel:()=>t.OPTModel,OPTPreTrainedModel:()=>t.OPTPreTrainedModel,ObjectDetectionPipeline:()=>e.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>t.Olmo2ForCausalLM,Olmo2Model:()=>t.Olmo2Model,Olmo2PreTrainedModel:()=>t.Olmo2PreTrainedModel,OlmoForCausalLM:()=>t.OlmoForCausalLM,OlmoModel:()=>t.OlmoModel,OlmoPreTrainedModel:()=>t.OlmoPreTrainedModel,OpenELMForCausalLM:()=>t.OpenELMForCausalLM,OpenELMModel:()=>t.OpenELMModel,OpenELMPreTrainedModel:()=>t.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>p.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>t.OwlViTForObjectDetection,OwlViTImageProcessor:()=>p.OwlViTImageProcessor,OwlViTModel:()=>t.OwlViTModel,OwlViTPreTrainedModel:()=>t.OwlViTPreTrainedModel,OwlViTProcessor:()=>_.OwlViTProcessor,Owlv2ForObjectDetection:()=>t.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>p.Owlv2ImageProcessor,Owlv2Model:()=>t.Owlv2Model,Owlv2PreTrainedModel:()=>t.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>t.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>t.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>_.PaliGemmaProcessor,PatchTSMixerForPrediction:()=>t.PatchTSMixerForPrediction,PatchTSMixerModel:()=>t.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>t.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>t.PatchTSTForPrediction,PatchTSTModel:()=>t.PatchTSTModel,PatchTSTPreTrainedModel:()=>t.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>t.Phi3ForCausalLM,Phi3Model:()=>t.Phi3Model,Phi3PreTrainedModel:()=>t.Phi3PreTrainedModel,Phi3VForCausalLM:()=>t.Phi3VForCausalLM,Phi3VImageProcessor:()=>p.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>t.Phi3VPreTrainedModel,Phi3VProcessor:()=>_.Phi3VProcessor,PhiForCausalLM:()=>t.PhiForCausalLM,PhiModel:()=>t.PhiModel,PhiPreTrainedModel:()=>t.PhiPreTrainedModel,Pipeline:()=>e.Pipeline,PreTrainedModel:()=>t.PreTrainedModel,PreTrainedTokenizer:()=>r.PreTrainedTokenizer,PretrainedConfig:()=>i.PretrainedConfig,PretrainedMixin:()=>t.PretrainedMixin,Processor:()=>b.Processor,PvtForImageClassification:()=>t.PvtForImageClassification,PvtImageProcessor:()=>p.PvtImageProcessor,PvtModel:()=>t.PvtModel,PvtPreTrainedModel:()=>t.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>d.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>t.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>t.PyAnnoteModel,PyAnnotePreTrainedModel:()=>t.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>_.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>t.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>e.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>t.Qwen2ForCausalLM,Qwen2Model:()=>t.Qwen2Model,Qwen2PreTrainedModel:()=>t.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>r.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>t.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>p.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>t.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>_.Qwen2VLProcessor,RTDetrForObjectDetection:()=>t.RTDetrForObjectDetection,RTDetrImageProcessor:()=>p.RTDetrImageProcessor,RTDetrModel:()=>t.RTDetrModel,RTDetrObjectDetectionOutput:()=>t.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>t.RTDetrPreTrainedModel,RawAudio:()=>s.RawAudio,RawImage:()=>a.RawImage,RawVideo:()=>o.RawVideo,RawVideoFrame:()=>o.RawVideoFrame,RepetitionPenaltyLogitsProcessor:()=>w.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>t.ResNetForImageClassification,ResNetModel:()=>t.ResNetModel,ResNetPreTrainedModel:()=>t.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>t.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>t.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>t.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>t.RoFormerForTokenClassification,RoFormerModel:()=>t.RoFormerModel,RoFormerPreTrainedModel:()=>t.RoFormerPreTrainedModel,RoFormerTokenizer:()=>r.RoFormerTokenizer,RobertaForMaskedLM:()=>t.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>t.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>t.RobertaForSequenceClassification,RobertaForTokenClassification:()=>t.RobertaForTokenClassification,RobertaModel:()=>t.RobertaModel,RobertaPreTrainedModel:()=>t.RobertaPreTrainedModel,RobertaTokenizer:()=>r.RobertaTokenizer,SamImageProcessor:()=>p.SamImageProcessor,SamImageSegmentationOutput:()=>t.SamImageSegmentationOutput,SamModel:()=>t.SamModel,SamPreTrainedModel:()=>t.SamPreTrainedModel,SamProcessor:()=>_.SamProcessor,SapiensForDepthEstimation:()=>t.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>t.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>t.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>t.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>d.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>p.SegformerFeatureExtractor,SegformerForImageClassification:()=>t.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>t.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>p.SegformerImageProcessor,SegformerModel:()=>t.SegformerModel,SegformerPreTrainedModel:()=>t.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>t.Seq2SeqLMOutput,SequenceClassifierOutput:()=>t.SequenceClassifierOutput,SiglipImageProcessor:()=>p.SiglipImageProcessor,SiglipModel:()=>t.SiglipModel,SiglipPreTrainedModel:()=>t.SiglipPreTrainedModel,SiglipTextModel:()=>t.SiglipTextModel,SiglipTokenizer:()=>r.SiglipTokenizer,SiglipVisionModel:()=>t.SiglipVisionModel,SmolVLMForConditionalGeneration:()=>t.SmolVLMForConditionalGeneration,SmolVLMImageProcessor:()=>p.SmolVLMImageProcessor,SmolVLMProcessor:()=>_.SmolVLMProcessor,SpeechT5FeatureExtractor:()=>d.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>t.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>t.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>t.SpeechT5HifiGan,SpeechT5Model:()=>t.SpeechT5Model,SpeechT5PreTrainedModel:()=>t.SpeechT5PreTrainedModel,SpeechT5Processor:()=>_.SpeechT5Processor,SpeechT5Tokenizer:()=>r.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>t.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>t.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>t.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>t.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>t.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>r.SqueezeBertTokenizer,StableLmForCausalLM:()=>t.StableLmForCausalLM,StableLmModel:()=>t.StableLmModel,StableLmPreTrainedModel:()=>t.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>t.Starcoder2ForCausalLM,Starcoder2Model:()=>t.Starcoder2Model,Starcoder2PreTrainedModel:()=>t.Starcoder2PreTrainedModel,StoppingCriteria:()=>x.StoppingCriteria,StoppingCriteriaList:()=>x.StoppingCriteriaList,StyleTextToSpeech2Model:()=>t.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>t.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>e.SummarizationPipeline,SuppressTokensAtBeginLogitsProcessor:()=>w.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>t.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>p.Swin2SRImageProcessor,Swin2SRModel:()=>t.Swin2SRModel,Swin2SRPreTrainedModel:()=>t.Swin2SRPreTrainedModel,SwinForImageClassification:()=>t.SwinForImageClassification,SwinForSemanticSegmentation:()=>t.SwinForSemanticSegmentation,SwinModel:()=>t.SwinModel,SwinPreTrainedModel:()=>t.SwinPreTrainedModel,T5ForConditionalGeneration:()=>t.T5ForConditionalGeneration,T5Model:()=>t.T5Model,T5PreTrainedModel:()=>t.T5PreTrainedModel,T5Tokenizer:()=>r.T5Tokenizer,TableTransformerForObjectDetection:()=>t.TableTransformerForObjectDetection,TableTransformerModel:()=>t.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>t.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>t.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>w.TemperatureLogitsWarper,Tensor:()=>l.Tensor,Text2TextGenerationPipeline:()=>e.Text2TextGenerationPipeline,TextClassificationPipeline:()=>e.TextClassificationPipeline,TextGenerationPipeline:()=>e.TextGenerationPipeline,TextStreamer:()=>v.TextStreamer,TextToAudioPipeline:()=>e.TextToAudioPipeline,TokenClassificationPipeline:()=>e.TokenClassificationPipeline,TokenClassifierOutput:()=>t.TokenClassifierOutput,TokenizerModel:()=>r.TokenizerModel,TopKLogitsWarper:()=>w.TopKLogitsWarper,TopPLogitsWarper:()=>w.TopPLogitsWarper,TrOCRForCausalLM:()=>t.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>t.TrOCRPreTrainedModel,TranslationPipeline:()=>e.TranslationPipeline,UltravoxModel:()=>t.UltravoxModel,UltravoxPreTrainedModel:()=>t.UltravoxPreTrainedModel,UltravoxProcessor:()=>_.UltravoxProcessor,UniSpeechForCTC:()=>t.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>t.UniSpeechForSequenceClassification,UniSpeechModel:()=>t.UniSpeechModel,UniSpeechPreTrainedModel:()=>t.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>t.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>t.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>t.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>t.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>t.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>_.VLChatProcessor,VLMImageProcessor:()=>p.VLMImageProcessor,ViTFeatureExtractor:()=>p.ViTFeatureExtractor,ViTForImageClassification:()=>t.ViTForImageClassification,ViTImageProcessor:()=>p.ViTImageProcessor,ViTMAEModel:()=>t.ViTMAEModel,ViTMAEPreTrainedModel:()=>t.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>t.ViTMSNForImageClassification,ViTMSNModel:()=>t.ViTMSNModel,ViTMSNPreTrainedModel:()=>t.ViTMSNPreTrainedModel,ViTModel:()=>t.ViTModel,ViTPreTrainedModel:()=>t.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>t.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>t.VitMatteForImageMatting,VitMatteImageProcessor:()=>p.VitMatteImageProcessor,VitMattePreTrainedModel:()=>t.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>t.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>p.VitPoseImageProcessor,VitPosePreTrainedModel:()=>t.VitPosePreTrainedModel,VitsModel:()=>t.VitsModel,VitsModelOutput:()=>t.VitsModelOutput,VitsPreTrainedModel:()=>t.VitsPreTrainedModel,VitsTokenizer:()=>r.VitsTokenizer,Wav2Vec2BertForCTC:()=>t.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>t.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>t.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>t.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>r.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>d.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>t.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>t.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>t.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>t.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>t.Wav2Vec2PreTrainedModel,Wav2Vec2Processor:()=>_.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>_.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>t.WavLMForAudioFrameClassification,WavLMForCTC:()=>t.WavLMForCTC,WavLMForSequenceClassification:()=>t.WavLMForSequenceClassification,WavLMForXVector:()=>t.WavLMForXVector,WavLMModel:()=>t.WavLMModel,WavLMPreTrainedModel:()=>t.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>d.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>t.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>t.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>d.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>t.WhisperForConditionalGeneration,WhisperModel:()=>t.WhisperModel,WhisperPreTrainedModel:()=>t.WhisperPreTrainedModel,WhisperProcessor:()=>_.WhisperProcessor,WhisperTextStreamer:()=>v.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>w.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>r.WhisperTokenizer,XLMForQuestionAnswering:()=>t.XLMForQuestionAnswering,XLMForSequenceClassification:()=>t.XLMForSequenceClassification,XLMForTokenClassification:()=>t.XLMForTokenClassification,XLMModel:()=>t.XLMModel,XLMPreTrainedModel:()=>t.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>t.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>t.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>t.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>t.XLMRobertaForTokenClassification,XLMRobertaModel:()=>t.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>t.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>r.XLMRobertaTokenizer,XLMTokenizer:()=>r.XLMTokenizer,XLMWithLMHeadModel:()=>t.XLMWithLMHeadModel,XVectorOutput:()=>t.XVectorOutput,YolosFeatureExtractor:()=>p.YolosFeatureExtractor,YolosForObjectDetection:()=>t.YolosForObjectDetection,YolosImageProcessor:()=>p.YolosImageProcessor,YolosModel:()=>t.YolosModel,YolosObjectDetectionOutput:()=>t.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>t.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>e.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>e.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>e.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>e.ZeroShotObjectDetectionPipeline,bankers_round:()=>c.bankers_round,cat:()=>l.cat,cos_sim:()=>c.cos_sim,dot:()=>c.dot,dynamic_time_warping:()=>c.dynamic_time_warping,env:()=>n.env,full:()=>l.full,full_like:()=>l.full_like,getKeyValueShapes:()=>i.getKeyValueShapes,hamming:()=>s.hamming,hanning:()=>s.hanning,interpolate:()=>l.interpolate,interpolate_4d:()=>l.interpolate_4d,interpolate_data:()=>c.interpolate_data,is_chinese_char:()=>r.is_chinese_char,layer_norm:()=>l.layer_norm,load_image:()=>a.load_image,load_video:()=>o.load_video,log_softmax:()=>c.log_softmax,magnitude:()=>c.magnitude,matmul:()=>l.matmul,max:()=>c.max,mean:()=>l.mean,mean_pooling:()=>l.mean_pooling,medianFilter:()=>c.medianFilter,mel_filter_bank:()=>s.mel_filter_bank,min:()=>c.min,ones:()=>l.ones,ones_like:()=>l.ones_like,permute:()=>l.permute,permute_data:()=>c.permute_data,pipeline:()=>e.pipeline,quantize_embeddings:()=>l.quantize_embeddings,rand:()=>l.rand,read_audio:()=>s.read_audio,rfft:()=>l.rfft,round:()=>c.round,slice:()=>l.slice,softmax:()=>c.softmax,spectrogram:()=>s.spectrogram,stack:()=>l.stack,std_mean:()=>l.std_mean,topk:()=>l.topk,window_function:()=>s.window_function,zeros:()=>l.zeros,zeros_like:()=>l.zeros_like});var n=ln("./src/env.js"),e=ln("./src/pipelines.js"),t=ln("./src/models.js"),r=ln("./src/tokenizers.js"),i=ln("./src/configs.js"),s=ln("./src/utils/audio.js"),a=ln("./src/utils/image.js"),o=ln("./src/utils/video.js"),l=ln("./src/utils/tensor.js"),c=ln("./src/utils/maths.js"),u=ln("./src/base/feature_extraction_utils.js"),d=ln("./src/models/feature_extractors.js"),h=ln("./src/models/auto/feature_extraction_auto.js"),f=ln("./src/base/image_processors_utils.js"),p=ln("./src/models/image_processors.js"),g=ln("./src/models/auto/image_processing_auto.js"),b=ln("./src/base/processing_utils.js"),_=ln("./src/models/processors.js"),m=ln("./src/models/auto/processing_auto.js"),v=ln("./src/generation/streamers.js"),x=ln("./src/generation/stopping_criteria.js"),w=ln("./src/generation/logits_process.js")})();k.ASTFeatureExtractor;k.ASTForAudioClassification;k.ASTModel;k.ASTPreTrainedModel;k.AlbertForMaskedLM;k.AlbertForQuestionAnswering;k.AlbertForSequenceClassification;k.AlbertModel;k.AlbertPreTrainedModel;k.AlbertTokenizer;k.AudioClassificationPipeline;k.AutoConfig;k.AutoFeatureExtractor;k.AutoImageProcessor;k.AutoModel;k.AutoModelForAudioClassification;k.AutoModelForAudioFrameClassification;k.AutoModelForAudioTextToText;k.AutoModelForCTC;k.AutoModelForCausalLM;k.AutoModelForDepthEstimation;k.AutoModelForDocumentQuestionAnswering;k.AutoModelForImageClassification;k.AutoModelForImageFeatureExtraction;k.AutoModelForImageMatting;k.AutoModelForImageSegmentation;k.AutoModelForImageTextToText;k.AutoModelForImageToImage;k.AutoModelForMaskGeneration;k.AutoModelForMaskedLM;k.AutoModelForNormalEstimation;k.AutoModelForObjectDetection;k.AutoModelForPoseEstimation;k.AutoModelForQuestionAnswering;k.AutoModelForSemanticSegmentation;k.AutoModelForSeq2SeqLM;k.AutoModelForSequenceClassification;k.AutoModelForSpeechSeq2Seq;k.AutoModelForTextToSpectrogram;k.AutoModelForTextToWaveform;k.AutoModelForTokenClassification;k.AutoModelForUniversalSegmentation;k.AutoModelForVision2Seq;k.AutoModelForXVector;k.AutoModelForZeroShotObjectDetection;k.AutoProcessor;k.AutoTokenizer;k.AutomaticSpeechRecognitionPipeline;k.BackgroundRemovalPipeline;k.BartForConditionalGeneration;k.BartForSequenceClassification;k.BartModel;k.BartPretrainedModel;k.BartTokenizer;k.BaseModelOutput;k.BaseStreamer;k.BeitFeatureExtractor;k.BeitForImageClassification;k.BeitModel;k.BeitPreTrainedModel;k.BertForMaskedLM;k.BertForQuestionAnswering;k.BertForSequenceClassification;k.BertForTokenClassification;k.BertModel;k.BertPreTrainedModel;k.BertTokenizer;k.BitImageProcessor;k.BlenderbotForConditionalGeneration;k.BlenderbotModel;k.BlenderbotPreTrainedModel;k.BlenderbotSmallForConditionalGeneration;k.BlenderbotSmallModel;k.BlenderbotSmallPreTrainedModel;k.BlenderbotSmallTokenizer;k.BlenderbotTokenizer;k.BloomForCausalLM;k.BloomModel;k.BloomPreTrainedModel;k.BloomTokenizer;k.CLIPFeatureExtractor;k.CLIPImageProcessor;k.CLIPModel;k.CLIPPreTrainedModel;k.CLIPSegForImageSegmentation;k.CLIPSegModel;k.CLIPSegPreTrainedModel;k.CLIPTextModel;k.CLIPTextModelWithProjection;k.CLIPTokenizer;k.CLIPVisionModel;k.CLIPVisionModelWithProjection;k.CamembertForMaskedLM;k.CamembertForQuestionAnswering;k.CamembertForSequenceClassification;k.CamembertForTokenClassification;k.CamembertModel;k.CamembertPreTrainedModel;k.CamembertTokenizer;k.CausalLMOutput;k.CausalLMOutputWithPast;k.ChineseCLIPFeatureExtractor;k.ChineseCLIPModel;k.ChineseCLIPPreTrainedModel;k.ClapAudioModelWithProjection;k.ClapFeatureExtractor;k.ClapModel;k.ClapPreTrainedModel;k.ClapTextModelWithProjection;k.ClassifierFreeGuidanceLogitsProcessor;k.CodeGenForCausalLM;k.CodeGenModel;k.CodeGenPreTrainedModel;k.CodeGenTokenizer;k.CodeLlamaTokenizer;k.CohereForCausalLM;k.CohereModel;k.CoherePreTrainedModel;k.CohereTokenizer;k.ConvBertForMaskedLM;k.ConvBertForQuestionAnswering;k.ConvBertForSequenceClassification;k.ConvBertForTokenClassification;k.ConvBertModel;k.ConvBertPreTrainedModel;k.ConvBertTokenizer;k.ConvNextFeatureExtractor;k.ConvNextForImageClassification;k.ConvNextImageProcessor;k.ConvNextModel;k.ConvNextPreTrainedModel;k.ConvNextV2ForImageClassification;k.ConvNextV2Model;k.ConvNextV2PreTrainedModel;k.DPTFeatureExtractor;k.DPTForDepthEstimation;k.DPTImageProcessor;k.DPTModel;k.DPTPreTrainedModel;k.DacDecoderModel;k.DacDecoderOutput;k.DacEncoderModel;k.DacEncoderOutput;k.DacFeatureExtractor;k.DacModel;k.DacPreTrainedModel;k.DataTypeMap;k.DebertaForMaskedLM;k.DebertaForQuestionAnswering;k.DebertaForSequenceClassification;k.DebertaForTokenClassification;k.DebertaModel;k.DebertaPreTrainedModel;k.DebertaTokenizer;k.DebertaV2ForMaskedLM;k.DebertaV2ForQuestionAnswering;k.DebertaV2ForSequenceClassification;k.DebertaV2ForTokenClassification;k.DebertaV2Model;k.DebertaV2PreTrainedModel;k.DebertaV2Tokenizer;k.DecisionTransformerModel;k.DecisionTransformerPreTrainedModel;k.DeiTFeatureExtractor;k.DeiTForImageClassification;k.DeiTImageProcessor;k.DeiTModel;k.DeiTPreTrainedModel;k.DepthAnythingForDepthEstimation;k.DepthAnythingPreTrainedModel;k.DepthEstimationPipeline;k.DepthProForDepthEstimation;k.DepthProPreTrainedModel;k.DetrFeatureExtractor;k.DetrForObjectDetection;k.DetrForSegmentation;k.DetrImageProcessor;k.DetrModel;k.DetrObjectDetectionOutput;k.DetrPreTrainedModel;k.DetrSegmentationOutput;k.Dinov2ForImageClassification;k.Dinov2Model;k.Dinov2PreTrainedModel;k.Dinov2WithRegistersForImageClassification;k.Dinov2WithRegistersModel;k.Dinov2WithRegistersPreTrainedModel;k.DistilBertForMaskedLM;k.DistilBertForQuestionAnswering;k.DistilBertForSequenceClassification;k.DistilBertForTokenClassification;k.DistilBertModel;k.DistilBertPreTrainedModel;k.DistilBertTokenizer;k.DocumentQuestionAnsweringPipeline;k.DonutFeatureExtractor;k.DonutImageProcessor;k.DonutSwinModel;k.DonutSwinPreTrainedModel;k.EfficientNetForImageClassification;k.EfficientNetImageProcessor;k.EfficientNetModel;k.EfficientNetPreTrainedModel;k.ElectraForMaskedLM;k.ElectraForQuestionAnswering;k.ElectraForSequenceClassification;k.ElectraForTokenClassification;k.ElectraModel;k.ElectraPreTrainedModel;k.ElectraTokenizer;k.EncodecFeatureExtractor;k.EosTokenCriteria;k.EsmForMaskedLM;k.EsmForSequenceClassification;k.EsmForTokenClassification;k.EsmModel;k.EsmPreTrainedModel;k.EsmTokenizer;k.ExaoneForCausalLM;k.ExaoneModel;k.ExaonePreTrainedModel;k.FFT;k.FalconForCausalLM;k.FalconModel;k.FalconPreTrainedModel;k.FalconTokenizer;k.FastViTForImageClassification;k.FastViTModel;k.FastViTPreTrainedModel;k.FeatureExtractionPipeline;k.FeatureExtractor;k.FillMaskPipeline;k.Florence2ForConditionalGeneration;k.Florence2PreTrainedModel;k.Florence2Processor;k.ForcedBOSTokenLogitsProcessor;k.ForcedEOSTokenLogitsProcessor;k.GLPNFeatureExtractor;k.GLPNForDepthEstimation;k.GLPNModel;k.GLPNPreTrainedModel;k.GPT2LMHeadModel;k.GPT2Model;k.GPT2PreTrainedModel;k.GPT2Tokenizer;k.GPTBigCodeForCausalLM;k.GPTBigCodeModel;k.GPTBigCodePreTrainedModel;k.GPTJForCausalLM;k.GPTJModel;k.GPTJPreTrainedModel;k.GPTNeoForCausalLM;k.GPTNeoModel;k.GPTNeoPreTrainedModel;k.GPTNeoXForCausalLM;k.GPTNeoXModel;k.GPTNeoXPreTrainedModel;k.GPTNeoXTokenizer;k.Gemma2ForCausalLM;k.Gemma2Model;k.Gemma2PreTrainedModel;k.GemmaForCausalLM;k.GemmaModel;k.GemmaPreTrainedModel;k.GemmaTokenizer;k.GlmForCausalLM;k.GlmModel;k.GlmPreTrainedModel;k.GraniteForCausalLM;k.GraniteModel;k.GranitePreTrainedModel;k.Grok1Tokenizer;k.GroundingDinoForObjectDetection;k.GroundingDinoImageProcessor;k.GroundingDinoPreTrainedModel;k.GroundingDinoProcessor;k.GroupViTModel;k.GroupViTPreTrainedModel;k.HeliumForCausalLM;k.HeliumModel;k.HeliumPreTrainedModel;k.HerbertTokenizer;k.HieraForImageClassification;k.HieraModel;k.HieraPreTrainedModel;k.HubertForCTC;k.HubertForSequenceClassification;k.HubertModel;k.HubertPreTrainedModel;k.IJepaForImageClassification;k.IJepaModel;k.IJepaPreTrainedModel;k.Idefics3ForConditionalGeneration;k.Idefics3ImageProcessor;k.Idefics3PreTrainedModel;k.Idefics3Processor;k.ImageClassificationPipeline;k.ImageFeatureExtractionPipeline;k.ImageFeatureExtractor;k.ImageMattingOutput;k.ImageProcessor;k.ImageSegmentationPipeline;k.ImageToImagePipeline;k.ImageToTextPipeline;k.InterruptableStoppingCriteria;k.JAISLMHeadModel;k.JAISModel;k.JAISPreTrainedModel;k.JinaCLIPImageProcessor;k.JinaCLIPModel;k.JinaCLIPPreTrainedModel;k.JinaCLIPProcessor;k.JinaCLIPTextModel;k.JinaCLIPVisionModel;k.LiteWhisperForConditionalGeneration;k.LlamaForCausalLM;k.LlamaModel;k.LlamaPreTrainedModel;k.LlamaTokenizer;k.LlavaForConditionalGeneration;k.LlavaOnevisionForConditionalGeneration;k.LlavaOnevisionImageProcessor;k.LlavaPreTrainedModel;k.LogitsProcessor;k.LogitsProcessorList;k.LogitsWarper;k.LongT5ForConditionalGeneration;k.LongT5Model;k.LongT5PreTrainedModel;k.M2M100ForConditionalGeneration;k.M2M100Model;k.M2M100PreTrainedModel;k.M2M100Tokenizer;k.MBart50Tokenizer;k.MBartForCausalLM;k.MBartForConditionalGeneration;k.MBartForSequenceClassification;k.MBartModel;k.MBartPreTrainedModel;k.MBartTokenizer;k.MPNetForMaskedLM;k.MPNetForQuestionAnswering;k.MPNetForSequenceClassification;k.MPNetForTokenClassification;k.MPNetModel;k.MPNetPreTrainedModel;k.MPNetTokenizer;k.MT5ForConditionalGeneration;k.MT5Model;k.MT5PreTrainedModel;k.MarianMTModel;k.MarianModel;k.MarianPreTrainedModel;k.MarianTokenizer;k.Mask2FormerImageProcessor;k.MaskFormerFeatureExtractor;k.MaskFormerForInstanceSegmentation;k.MaskFormerImageProcessor;k.MaskFormerModel;k.MaskFormerPreTrainedModel;k.MaskedLMOutput;k.MaxLengthCriteria;k.MgpstrForSceneTextRecognition;k.MgpstrModelOutput;k.MgpstrPreTrainedModel;k.MgpstrProcessor;k.MgpstrTokenizer;k.MimiDecoderModel;k.MimiDecoderOutput;k.MimiEncoderModel;k.MimiEncoderOutput;k.MimiModel;k.MimiPreTrainedModel;k.MinLengthLogitsProcessor;k.MinNewTokensLengthLogitsProcessor;k.MistralForCausalLM;k.MistralModel;k.MistralPreTrainedModel;k.MobileBertForMaskedLM;k.MobileBertForQuestionAnswering;k.MobileBertForSequenceClassification;k.MobileBertModel;k.MobileBertPreTrainedModel;k.MobileBertTokenizer;k.MobileLLMForCausalLM;k.MobileLLMModel;k.MobileLLMPreTrainedModel;k.MobileNetV1FeatureExtractor;k.MobileNetV1ForImageClassification;k.MobileNetV1ForSemanticSegmentation;k.MobileNetV1ImageProcessor;k.MobileNetV1Model;k.MobileNetV1PreTrainedModel;k.MobileNetV2FeatureExtractor;k.MobileNetV2ForImageClassification;k.MobileNetV2ForSemanticSegmentation;k.MobileNetV2ImageProcessor;k.MobileNetV2Model;k.MobileNetV2PreTrainedModel;k.MobileNetV3FeatureExtractor;k.MobileNetV3ForImageClassification;k.MobileNetV3ForSemanticSegmentation;k.MobileNetV3ImageProcessor;k.MobileNetV3Model;k.MobileNetV3PreTrainedModel;k.MobileNetV4FeatureExtractor;k.MobileNetV4ForImageClassification;k.MobileNetV4ForSemanticSegmentation;k.MobileNetV4ImageProcessor;k.MobileNetV4Model;k.MobileNetV4PreTrainedModel;k.MobileViTFeatureExtractor;k.MobileViTForImageClassification;k.MobileViTImageProcessor;k.MobileViTModel;k.MobileViTPreTrainedModel;k.MobileViTV2ForImageClassification;k.MobileViTV2Model;k.MobileViTV2PreTrainedModel;k.ModelOutput;k.ModernBertForMaskedLM;k.ModernBertForSequenceClassification;k.ModernBertForTokenClassification;k.ModernBertModel;k.ModernBertPreTrainedModel;k.Moondream1ForConditionalGeneration;k.MoonshineFeatureExtractor;k.MoonshineForConditionalGeneration;k.MoonshineModel;k.MoonshinePreTrainedModel;k.MoonshineProcessor;k.MptForCausalLM;k.MptModel;k.MptPreTrainedModel;k.MultiModalityCausalLM;k.MultiModalityPreTrainedModel;k.MusicgenForCausalLM;k.MusicgenForConditionalGeneration;k.MusicgenModel;k.MusicgenPreTrainedModel;k.NllbTokenizer;k.NoBadWordsLogitsProcessor;k.NoRepeatNGramLogitsProcessor;k.NomicBertModel;k.NomicBertPreTrainedModel;k.NougatImageProcessor;k.NougatTokenizer;k.OPTForCausalLM;k.OPTModel;k.OPTPreTrainedModel;k.ObjectDetectionPipeline;k.Olmo2ForCausalLM;k.Olmo2Model;k.Olmo2PreTrainedModel;k.OlmoForCausalLM;k.OlmoModel;k.OlmoPreTrainedModel;k.OpenELMForCausalLM;k.OpenELMModel;k.OpenELMPreTrainedModel;k.OwlViTFeatureExtractor;k.OwlViTForObjectDetection;k.OwlViTImageProcessor;k.OwlViTModel;k.OwlViTPreTrainedModel;k.OwlViTProcessor;k.Owlv2ForObjectDetection;k.Owlv2ImageProcessor;k.Owlv2Model;k.Owlv2PreTrainedModel;k.PaliGemmaForConditionalGeneration;k.PaliGemmaPreTrainedModel;k.PaliGemmaProcessor;k.PatchTSMixerForPrediction;k.PatchTSMixerModel;k.PatchTSMixerPreTrainedModel;k.PatchTSTForPrediction;k.PatchTSTModel;k.PatchTSTPreTrainedModel;k.Phi3ForCausalLM;k.Phi3Model;k.Phi3PreTrainedModel;k.Phi3VForCausalLM;k.Phi3VImageProcessor;k.Phi3VPreTrainedModel;k.Phi3VProcessor;k.PhiForCausalLM;k.PhiModel;k.PhiPreTrainedModel;k.Pipeline;k.PreTrainedModel;k.PreTrainedTokenizer;k.PretrainedConfig;k.PretrainedMixin;k.Processor;k.PvtForImageClassification;k.PvtImageProcessor;k.PvtModel;k.PvtPreTrainedModel;k.PyAnnoteFeatureExtractor;k.PyAnnoteForAudioFrameClassification;k.PyAnnoteModel;k.PyAnnotePreTrainedModel;k.PyAnnoteProcessor;k.QuestionAnsweringModelOutput;k.QuestionAnsweringPipeline;k.Qwen2ForCausalLM;k.Qwen2Model;k.Qwen2PreTrainedModel;k.Qwen2Tokenizer;k.Qwen2VLForConditionalGeneration;k.Qwen2VLImageProcessor;k.Qwen2VLPreTrainedModel;k.Qwen2VLProcessor;k.RTDetrForObjectDetection;k.RTDetrImageProcessor;k.RTDetrModel;k.RTDetrObjectDetectionOutput;k.RTDetrPreTrainedModel;k.RawAudio;k.RawImage;k.RawVideo;k.RawVideoFrame;k.RepetitionPenaltyLogitsProcessor;k.ResNetForImageClassification;k.ResNetModel;k.ResNetPreTrainedModel;k.RoFormerForMaskedLM;k.RoFormerForQuestionAnswering;k.RoFormerForSequenceClassification;k.RoFormerForTokenClassification;k.RoFormerModel;k.RoFormerPreTrainedModel;k.RoFormerTokenizer;k.RobertaForMaskedLM;k.RobertaForQuestionAnswering;k.RobertaForSequenceClassification;k.RobertaForTokenClassification;k.RobertaModel;k.RobertaPreTrainedModel;k.RobertaTokenizer;k.SamImageProcessor;k.SamImageSegmentationOutput;k.SamModel;k.SamPreTrainedModel;k.SamProcessor;k.SapiensForDepthEstimation;k.SapiensForNormalEstimation;k.SapiensForSemanticSegmentation;k.SapiensPreTrainedModel;k.SeamlessM4TFeatureExtractor;k.SegformerFeatureExtractor;k.SegformerForImageClassification;k.SegformerForSemanticSegmentation;k.SegformerImageProcessor;k.SegformerModel;k.SegformerPreTrainedModel;k.Seq2SeqLMOutput;k.SequenceClassifierOutput;k.SiglipImageProcessor;k.SiglipModel;k.SiglipPreTrainedModel;k.SiglipTextModel;k.SiglipTokenizer;k.SiglipVisionModel;k.SmolVLMForConditionalGeneration;k.SmolVLMImageProcessor;k.SmolVLMProcessor;k.SpeechT5FeatureExtractor;k.SpeechT5ForSpeechToText;k.SpeechT5ForTextToSpeech;k.SpeechT5HifiGan;k.SpeechT5Model;k.SpeechT5PreTrainedModel;k.SpeechT5Processor;k.SpeechT5Tokenizer;k.SqueezeBertForMaskedLM;k.SqueezeBertForQuestionAnswering;k.SqueezeBertForSequenceClassification;k.SqueezeBertModel;k.SqueezeBertPreTrainedModel;k.SqueezeBertTokenizer;k.StableLmForCausalLM;k.StableLmModel;k.StableLmPreTrainedModel;k.Starcoder2ForCausalLM;k.Starcoder2Model;k.Starcoder2PreTrainedModel;k.StoppingCriteria;k.StoppingCriteriaList;k.StyleTextToSpeech2Model;k.StyleTextToSpeech2PreTrainedModel;k.SummarizationPipeline;k.SuppressTokensAtBeginLogitsProcessor;k.Swin2SRForImageSuperResolution;k.Swin2SRImageProcessor;k.Swin2SRModel;k.Swin2SRPreTrainedModel;k.SwinForImageClassification;k.SwinForSemanticSegmentation;k.SwinModel;k.SwinPreTrainedModel;k.T5ForConditionalGeneration;k.T5Model;k.T5PreTrainedModel;k.T5Tokenizer;k.TableTransformerForObjectDetection;k.TableTransformerModel;k.TableTransformerObjectDetectionOutput;k.TableTransformerPreTrainedModel;k.TemperatureLogitsWarper;k.Tensor;k.Text2TextGenerationPipeline;k.TextClassificationPipeline;k.TextGenerationPipeline;k.TextStreamer;k.TextToAudioPipeline;k.TokenClassificationPipeline;k.TokenClassifierOutput;k.TokenizerModel;k.TopKLogitsWarper;k.TopPLogitsWarper;k.TrOCRForCausalLM;k.TrOCRPreTrainedModel;k.TranslationPipeline;k.UltravoxModel;k.UltravoxPreTrainedModel;k.UltravoxProcessor;k.UniSpeechForCTC;k.UniSpeechForSequenceClassification;k.UniSpeechModel;k.UniSpeechPreTrainedModel;k.UniSpeechSatForAudioFrameClassification;k.UniSpeechSatForCTC;k.UniSpeechSatForSequenceClassification;k.UniSpeechSatModel;k.UniSpeechSatPreTrainedModel;k.VLChatProcessor;k.VLMImageProcessor;k.ViTFeatureExtractor;k.ViTForImageClassification;k.ViTImageProcessor;k.ViTMAEModel;k.ViTMAEPreTrainedModel;k.ViTMSNForImageClassification;k.ViTMSNModel;k.ViTMSNPreTrainedModel;k.ViTModel;k.ViTPreTrainedModel;k.VisionEncoderDecoderModel;k.VitMatteForImageMatting;k.VitMatteImageProcessor;k.VitMattePreTrainedModel;k.VitPoseForPoseEstimation;k.VitPoseImageProcessor;k.VitPosePreTrainedModel;k.VitsModel;k.VitsModelOutput;k.VitsPreTrainedModel;k.VitsTokenizer;k.Wav2Vec2BertForCTC;k.Wav2Vec2BertForSequenceClassification;k.Wav2Vec2BertModel;k.Wav2Vec2BertPreTrainedModel;k.Wav2Vec2CTCTokenizer;k.Wav2Vec2FeatureExtractor;k.Wav2Vec2ForAudioFrameClassification;k.Wav2Vec2ForCTC;k.Wav2Vec2ForSequenceClassification;k.Wav2Vec2Model;k.Wav2Vec2PreTrainedModel;k.Wav2Vec2Processor;k.Wav2Vec2ProcessorWithLM;k.WavLMForAudioFrameClassification;k.WavLMForCTC;k.WavLMForSequenceClassification;k.WavLMForXVector;k.WavLMModel;k.WavLMPreTrainedModel;k.WeSpeakerFeatureExtractor;k.WeSpeakerResNetModel;k.WeSpeakerResNetPreTrainedModel;k.WhisperFeatureExtractor;k.WhisperForConditionalGeneration;k.WhisperModel;k.WhisperPreTrainedModel;k.WhisperProcessor;k.WhisperTextStreamer;k.WhisperTimeStampLogitsProcessor;k.WhisperTokenizer;k.XLMForQuestionAnswering;k.XLMForSequenceClassification;k.XLMForTokenClassification;k.XLMModel;k.XLMPreTrainedModel;k.XLMRobertaForMaskedLM;k.XLMRobertaForQuestionAnswering;k.XLMRobertaForSequenceClassification;k.XLMRobertaForTokenClassification;k.XLMRobertaModel;k.XLMRobertaPreTrainedModel;k.XLMRobertaTokenizer;k.XLMTokenizer;k.XLMWithLMHeadModel;k.XVectorOutput;k.YolosFeatureExtractor;k.YolosForObjectDetection;k.YolosImageProcessor;k.YolosModel;k.YolosObjectDetectionOutput;k.YolosPreTrainedModel;k.ZeroShotAudioClassificationPipeline;k.ZeroShotClassificationPipeline;k.ZeroShotImageClassificationPipeline;k.ZeroShotObjectDetectionPipeline;k.bankers_round;k.cat;k.cos_sim;k.dot;k.dynamic_time_warping;k.env;k.full;k.full_like;k.getKeyValueShapes;k.hamming;k.hanning;k.interpolate;k.interpolate_4d;k.interpolate_data;k.is_chinese_char;k.layer_norm;k.load_image;k.load_video;k.log_softmax;k.magnitude;k.matmul;k.max;k.mean;k.mean_pooling;k.medianFilter;k.mel_filter_bank;k.min;k.ones;k.ones_like;k.permute;k.permute_data;var $7=k.pipeline;k.quantize_embeddings;k.rand;k.read_audio;k.rfft;k.round;k.slice;k.softmax;k.spectrogram;k.stack;k.std_mean;k.topk;k.window_function;k.zeros;k.zeros_like;const N7={class:"row"},z7={class:"q-pa-md"},W7={class:"q-pa-md"},j7={class:"row"},V7={class:"q-pa-md"},G7={key:0,class:"q-pa-md"},Y7={__name:"IndexPage",setup(n){const e=Sn(""),t=Sn(null),r=Sn(null),i=Sn(null),s=Sn(null);bf(async()=>{s.value=await $7("sentiment-analysis")});const a=(c,u)=>{e.value=c.replace(/\n\s*\n/g,`

`),u==="fileInput"&&r.value?r.value=null:u==="ocrInput"&&t.value&&(t.value=null)},o=async()=>{if(!s.value){console.error("Sentiment pipeline not loaded");return}if(!e.value.trim()){console.error("No text to analyze");return}try{i.value=await s.value(e.value),console.log("Sentiment Analysis Result:",i.value)}catch(c){console.error("Sentiment analysis error:",c)}},l=()=>{e.value="",i.value=null,t.value&&(t.value=null),r.value&&(r.value=null)};return(c,u)=>(F0(),QT(Q5,{class:"flex flex-center column"},{default:Yb(()=>[Ka("div",N7,[Ka("div",z7,[Zo(MW,{modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=d=>t.value=d),onFileProcessed:u[1]||(u[1]=d=>a(d,"fileInput"))},null,8,["modelValue"])]),Ka("div",W7,[Zo(X9,{modelValue:r.value,"onUpdate:modelValue":u[2]||(u[2]=d=>r.value=d),onFileProcessed:u[3]||(u[3]=d=>a(d,"ocrInput"))},null,8,["modelValue"])])]),Ka("div",j7,[Ka("div",V7,[Zo(K5,{onSubmit:v5(o,["prevent"]),onReset:l,class:"q-gutter-md"},{default:Yb(()=>[Zo(H5,{label:"Paste Text",modelValue:e.value,"onUpdate:modelValue":u[4]||(u[4]=d=>e.value=d),filled:"",autogrow:"",style:{width:"525px"}},null,8,["modelValue"]),Ka("div",null,[Zo(nS,{label:"Analyze",type:"submit",color:"primary"}),Zo(nS,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"})])]),_:1})])]),i.value?(F0(),b5("div",G7,[Zo(Y5,null,{default:Yb(()=>[Zo(X5,null,{default:Yb(()=>[u[5]||(u[5]=Ka("div",{class:"text-h6"},"Sentiment Analysis Result",-1)),Ka("div",null,"Label: "+tS(i.value[0].label),1),Ka("div",null,"Score: "+tS(i.value[0].score.toFixed(4)),1)]),_:1})]),_:1})])):y5("",!0)]),_:1}))}};export{Y7 as default};
